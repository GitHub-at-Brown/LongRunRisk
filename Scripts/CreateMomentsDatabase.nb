(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    174012,       4358]
NotebookOptionsPosition[    164169,       4197]
NotebookOutlinePosition[    164665,       4216]
CellTagsIndexPosition[    164622,       4213]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}, 
   3.895556812534958*^9, 3.895680268596149*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thisFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", 
        RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
       "\"\<.wlt\>\""}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFileBase", "=", 
   RowBox[{"FileBaseName", "[", "thisFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"thisFileName", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}, {3.895490302188603*^9, 3.895490303315134*^9}, {
   3.895555277801629*^9, 3.895555292190344*^9}, {3.8955553434770117`*^9, 
   3.895555387252871*^9}, {3.895555428812483*^9, 3.895555436948851*^9}, 
   3.895555470825795*^9, {3.895555969261059*^9, 3.895555975355225*^9}, {
   3.8955566274456863`*^9, 3.895556658648676*^9}, {3.895690597340239*^9, 
   3.895690598249178*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],

Cell[CellGroupData[{

Cell["Build database", "Subsection",
 CellChangeTimes->{{3.889905622471089*^9, 3.889905629759961*^9}, {
  3.889972063478182*^9, 3.889972065236586*^9}, {3.895555245059051*^9, 
  3.895555248658716*^9}},ExpressionUUID->"d03dfeba-2718-41c7-9b3f-\
19ce5bed64e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{"thisFileBase", "<>", "\"\<.wl\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"4ed5f578-352d-450a-80c3-862d7bf99a10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.895740034843698*^9, 3.895740042969952*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"65bb4142-4641-4071-9777-2e590187c288"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.895794225673542*^9, 3.895797866659919*^9, 
  3.895805902901041*^9, 3.896017903168404*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"e4d8705f-ce93-4a1d-9f3e-64de732ff268"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"createDatabase", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"FernandoDuarte`LongRunRisk`Models", "[", "key", "]"}], ",", 
       "\n", "\t", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
          RowBox[{"\"\<covLong\>\"", "<>", "key", "<>", "\"\<.wl\>\""}]}], 
         "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"key", ",", 
      RowBox[{"Keys", "@", "FernandoDuarte`LongRunRisk`Models"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895690863697507*^9, 3.895690864733301*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5ea9f70b-0b8c-459e-9ee8-7dc6c6672ae0"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "symname", 
   "\"The string \
\\\"\\!\\(\\*RowBox[{\\\"\\\\\\\"ResourceSystemClient`DefinitionUtilities`\
WithContext\\\\\\\"\\\"}]\\)\\\" cannot be used for a symbol name. A symbol \
name must start with a letter followed by letters and numbers.\"", 2, 9, 1, 
   28994221749508604622, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.895794257633594*^9, 3.89579789881708*^9, 
  3.8958059418581657`*^9, 3.896019451202531*^9},
 CellLabel->
  "During evaluation of \
In[9]:=",ExpressionUUID->"c6521f17-f45c-4d0b-b95a-999e7a9fb184"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895690652879582*^9, 
  3.895690660859036*^9}},ExpressionUUID->"b16e2830-ef75-4fed-955f-\
2aa02f8df491"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895690752727099*^9, 
  3.895690756271875*^9}},ExpressionUUID->"fe38193e-e8f0-43aa-9a50-\
7201df9589cb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8956906312727203`*^9, 3.895690633991837*^9}, {
  3.8956906641018877`*^9, 3.8956906777304983`*^9}, {3.895690719488502*^9, 
  3.8956908533286247`*^9}},ExpressionUUID->"2a27c620-1f7f-422b-b849-\
aea1cc675dd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load and test", "Subsection",
 CellChangeTimes->{{3.895668123084955*^9, 3.895668129710462*^9}, {
  3.895670347636486*^9, 
  3.895670351021296*^9}},ExpressionUUID->"6b918d18-7704-45dd-b222-\
55d8d234ce9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895668130981999*^9, 3.895668133141368*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"456aea83-3b17-4426-af60-5b58a2a0573c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"thisFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{"FileBaseName", "[", 
        RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
       "\"\<.wlt\>\""}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFileBase", "=", 
   RowBox[{"FileBaseName", "[", "thisFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"thisFileName", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"1cb52e22-209f-41eb-978c-5c7f5d404f1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenameModels", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dataModels", "=", 
  RowBox[{"Get", "[", "filenameModels", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", "dataModels"}]}], "Input",
 CellChangeTimes->{{3.894805595213706*^9, 3.894805626435652*^9}, {
   3.894805703062829*^9, 3.894805751713066*^9}, 3.894880868918269*^9, {
   3.8948847961295757`*^9, 3.894884796244917*^9}, 3.8948855760134706`*^9, {
   3.8948867475700483`*^9, 3.8948867717367*^9}, {3.894886966447394*^9, 
   3.8948869698475647`*^9}, {3.8948874148815002`*^9, 3.89488741855857*^9}, {
   3.8956681020776243`*^9, 3.8956681346619*^9}, 3.89567006269088*^9, 
   3.895670269430372*^9, 3.8956703113831663`*^9, {3.895671723583414*^9, 
   3.895671733332727*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"61d39cc5-b370-402a-9f30-d3392e6deb46"],

Cell[BoxData[{
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{"thisFileBase", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeUnconditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], 
    "}"}], "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeConditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], "}"}],
    "]"}]}]}], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"47632f64-5dee-462c-9f21-f5a3d49e3d8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{"FernandoDuarte`LongRunRisk`Models", "[", "\"\<DES\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelShortName", "=", 
   RowBox[{"model", "[", "\"\<shortname\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLongFilename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{
      "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<.wl\>\""}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLongFilenameSave", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{
      "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<Save.wl\>\""}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toExogenous", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8954425507789497`*^9, 3.895442551073287*^9}, {
   3.895442611639639*^9, 3.89544266632174*^9}, {3.895442778509056*^9, 
   3.8954429208181267`*^9}, {3.895443064490199*^9, 3.895443081297099*^9}, 
   3.895443142205739*^9, {3.895443203563892*^9, 3.895443325262887*^9}, 
   3.895444437943017*^9, 3.895444478648745*^9, {3.895444828217681*^9, 
   3.895444830639021*^9}, 3.8954892475566874`*^9, {3.89549033776551*^9, 
   3.895490338380775*^9}, {3.895553164149826*^9, 3.89555318772189*^9}, {
   3.895553473803101*^9, 3.8955534756229057`*^9}, {3.895555509562429*^9, 
   3.895555530846114*^9}, {3.8955556200346746`*^9, 3.895555629912984*^9}, {
   3.895555799970644*^9, 3.895555805139558*^9}, {3.895556721949316*^9, 
   3.895556722536572*^9}, {3.895556803109399*^9, 3.895556803450493*^9}, {
   3.895557076271131*^9, 3.895557076584648*^9}, {3.895669315373522*^9, 
   3.895669315812739*^9}, {3.895691326621079*^9, 3.895691326896227*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"30f23af8-6038-4069-8243-a8e8072685a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uncondE", "[", "expr_", "]"}], ":=", 
  RowBox[{"uncondE", "[", 
   RowBox[{"expr", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVar", "[", "expr_", "]"}], ":=", 
  RowBox[{"uncondVar", "[", 
   RowBox[{"expr", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{"expr1_", ",", "expr2_"}], "]"}], ":=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{"expr1", ",", "expr2", ",", "model"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ev", "[", 
   RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"ev", "[", 
   RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "[", 
   RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"var", "[", 
   RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cov", "[", 
    RowBox[{"expr1_", ",", "expr2_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"cov", "[", 
    RowBox[{"expr1", ",", "expr2", ",", "t", ",", "model"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"uncondCovLong", ",", "uncondVarLong"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCovLong", "[", 
   RowBox[{"expr1_", ",", " ", "expr2_", ",", " ", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondCovLongExo", "[", 
   RowBox[{
   "toExogenous", ",", "expr1", ",", " ", "expr2", ",", "  ", "covfun"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondVarLongExo", "[", 
   RowBox[{"toExogenous", ",", "expr", ",", "  ", "covfun"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8954425507789497`*^9, 3.895442551073287*^9}, {
   3.895442611639639*^9, 3.89544266632174*^9}, {3.895442778509056*^9, 
   3.8954429208181267`*^9}, {3.895443064490199*^9, 3.895443081297099*^9}, 
   3.895443142205739*^9, {3.895443203563892*^9, 3.895443325262887*^9}, 
   3.895444437943017*^9, 3.895444478648745*^9, {3.895444828217681*^9, 
   3.895444830639021*^9}, 3.8954892475566874`*^9, {3.89549033776551*^9, 
   3.895490338380775*^9}, {3.895553164149826*^9, 3.89555318772189*^9}, {
   3.895553473803101*^9, 3.8955534756229057`*^9}, {3.895555509562429*^9, 
   3.895555530846114*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"2888b875-28ee-4f08-b551-05df1c125f41"],

Cell[BoxData[{
 RowBox[{"dataCovLong", "=", 
  RowBox[{"Get", "[", "covLongFilename", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", "dataCovLong"}]}], "Input",
 CellChangeTimes->{{3.895671710584262*^9, 3.895671765341384*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b28bdbbf-9e84-4f0f-9cc9-412f8abccedb"],

Cell[BoxData[{
 RowBox[{"Context", "[", "covLongDES", 
  "]"}], "\[IndentingNewLine]", "covLongFilename"}], "Input",
 CellChangeTimes->{{3.895691492038136*^9, 3.89569150776652*^9}, {
   3.895692922089941*^9, 3.8956929223143463`*^9}, 3.8956935194574747`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"6fdd5095-1718-4546-b971-15bac0990051"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"dc", "[", "t", "]"}], ",", "model"}], "]"}], "//.", 
   RowBox[{"model", "[", "\"\<assignParam\>\"", "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", "[", "t", 
     "]"}], ",", 
    "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
covLongDES"}], "]"}], "//", "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.895681084223485*^9, 3.895681085981093*^9}, {
   3.895691347853261*^9, 3.89569135153448*^9}, {3.895691393456112*^9, 
   3.895691557981415*^9}, {3.8956928538194237`*^9, 3.895692866173498*^9}, 
   3.895692904036853*^9, {3.8956929767617188`*^9, 3.8956930366662407`*^9}, {
   3.895693540943253*^9, 3.895693581211513*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"e035627d-f7f6-4f0b-b74f-a562c8336cab"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895691572964756*^9, 3.8956915729725237`*^9}, {
  3.895691735794647*^9, 3.895691780725566*^9}, {3.8956918138914433`*^9, 
  3.8956918767190228`*^9}, {3.895691970780849*^9, 3.895691998540097*^9}, {
  3.895692941541985*^9, 3.895692972814702*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"d53916ef-b35f-45bb-9307-c0dcafb92ee4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895692100781127*^9, 3.8956921376745567`*^9}, {
   3.895693565279971*^9, 3.8956936182485437`*^9}, 
   3.89569452706726*^9},ExpressionUUID->"3bbf1e7d-920d-4b6a-b764-\
228095543844"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
    RowBox[{"t", "+", "1"}], "]"}], ",", 
   RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
    RowBox[{"t", "+", "2"}], "]"}], ",", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
covLongDES"}], "]"}]], "Input",
 CellChangeTimes->{{3.895693624889648*^9, 3.8956936314662848`*^9}, {
   3.895693677949348*^9, 3.895693707543398*^9}, {3.895693747177739*^9, 
   3.895693769474771*^9}, {3.895693805413787*^9, 3.895693806478087*^9}, 
   3.895694543015942*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"b0a7a7d7-6e01-463e-bb68-03ecfc5cd6c0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895693808135229*^9, 
  3.895693817469439*^9}},ExpressionUUID->"b5a90dab-6546-43a5-b44b-\
426d50d3c017"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pis", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
      RowBox[{"t", "+", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
    "pis", ",", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
covLongDES"}], "]"}], "]"}], "//.", 
  RowBox[{"model", "[", "\"\<params\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Timing", "[", 
   RowBox[{"uncondVar", "[", "pis", "]"}], "]"}], "//.", 
  RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], "Input",
 CellChangeTimes->{{3.895693827932209*^9, 3.895693832084416*^9}, {
  3.8956945289940653`*^9, 3.895694669720798*^9}, {3.8956947225724277`*^9, 
  3.8956947471111307`*^9}, {3.8956957997459593`*^9, 3.895695812541032*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"d4271660-79d6-4a2b-8f75-9d299046b6e8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895691595579321*^9, 3.89569161734297*^9}, {
  3.895691728794816*^9, 
  3.895691733036824*^9}},ExpressionUUID->"4f5becb4-417d-44c0-a5db-\
9b4d6abe31ef"],

Cell[BoxData[{
 RowBox[{"Get", "[", "\"\<FernandoDuarte`LongRunRisk`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Names", "[", "\"\<FernandoDuarte`LongRunRisk`*\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.895671834152318*^9, 3.895671863323642*^9}, {
  3.8956719043936567`*^9, 3.895671929033133*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ec170e6e-3cfc-4d72-98f6-a53ddb03fec0"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{"dc", "[", "t", "]"}], ",", 
   RowBox[{"wc", "[", "t", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.895671710584262*^9, 3.895671776840255*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"ba4bd127-e349-4d5a-9d76-82ba632deefb"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{"FernandoDuarte`LongRunRisk`dc", "[", "t", "]"}], ",", 
   RowBox[{"wc", "[", "t", "]"}], ",", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
Private`covLong"}], "]"}]], "Input",
 CellChangeTimes->{{3.8956723416620827`*^9, 3.895672342100902*^9}, {
  3.895681124420908*^9, 3.895681124591964*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"e5d99f81-f1c1-4728-8921-4e9ce80e78bc"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{
   "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", "[", "t", "]"}],
    ",", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", "[", "t", 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.895670559787594*^9, 3.895670614155601*^9}, 
   3.895671390802264*^9, {3.895681133260745*^9, 3.89568116511982*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"c48e6a3a-36ab-4126-8120-47b9b05e0bf5"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{"retc", "[", "t", "]"}], ",", 
   RowBox[{"wc", "[", "t", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.895672368474263*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"ff1dfa66-5872-4078-9774-d4aa40f7fca5"],

Cell[BoxData[
 RowBox[{"uncondCovLong", "[", 
  RowBox[{
   RowBox[{"newvar", "[", 
    RowBox[{"t", ",", "m"}], "]"}], ",", 
   RowBox[{"wc", "[", "t", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.895672531890614*^9, 3.895672556731016*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"83ffc50e-9817-40cb-a285-a67e2e7ec6a8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895672449431533*^9, 
  3.895672450129301*^9}},ExpressionUUID->"6012e8ad-beaa-4242-b048-\
50a587909a58"],

Cell[BoxData[
 RowBox[{"uncondCov", "[", 
  RowBox[{
   RowBox[{"newvar", "[", 
    RowBox[{"t", ",", "m"}], "]"}], ",", 
   RowBox[{"wc", "[", "t", "]"}], ",", "model"}], "]"}]], "Input",
 CellChangeTimes->{{3.895670176989801*^9, 3.895670179529163*^9}, {
  3.89567023773011*^9, 3.895670307978655*^9}, {3.895672599319847*^9, 
  3.895672604532843*^9}, {3.8956726712426434`*^9, 3.895672690919224*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"cc9ac178-06f9-4e51-9ff1-d63e640447f9"],

Cell[BoxData[
 RowBox[{"DownValues", "@", 
  "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
Private`covLong"}]], "Input",
 CellChangeTimes->{{3.895680988200623*^9, 3.895680991430347*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"7fd0b4b2-db22-4e4b-8fab-6a18b26b3c1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["debug", "Section",
 CellChangeTimes->{{3.895799375626346*^9, 
  3.895799377980329*^9}},ExpressionUUID->"72e79a29-293d-428d-900e-\
aee3ff3eef52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.89480383844411*^9, 3.894803841134717*^9}, 
   3.894803954627451*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"64d267ef-c43d-4273-bbc2-c7b225c110ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895799437562594*^9, 3.8957994621673613`*^9}, 
   3.895799599711876*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"f1ccf0d1-7fcd-455f-bbca-3b02b9ecda1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelFilename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], "}"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FindFile", "[", 
     RowBox[{"File", "[", "modelFilename", "]"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895795354095564*^9, 3.895795420602654*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"02a8f277-51a9-43db-b955-d2ef72edc09f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895800672118297*^9, 3.8958006723648443`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"514de941-f32a-49f7-b62c-1268e76de7a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{"FernandoDuarte`LongRunRisk`Models", "[", "\"\<DES\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.895799470176797*^9, 3.8957994873310823`*^9}, 
   3.895799609517866*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"88d221ca-4aaf-4a62-b156-5cd441faa68a"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"modelShortName", "=", 
     RowBox[{"model", "[", "\"\<shortname\>\"", "]"}]}], ";"}], "\n", "\t\t", 
   
   RowBox[{
    RowBox[{"toExogenous", " ", "=", " ", 
     RowBox[{"Normal", "@", 
      RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ";"}], "\n", 
   "\t\t", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"nproc", "=", 
      RowBox[{"OptionValue", "[", "\"\<numParallelProcessors\>\"", "]"}]}], 
     ","}], "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"maxLag", "=", "4"}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"stateVars", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Variables", "[", 
           RowBox[{
            RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}],
            " ", "]"}], ",", 
          RowBox[{
           RowBox[{"x_", "[", "_", "]"}], ":>", "x"}]}], "]"}], ",", "0"}], 
       "]"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"(*", " ", "dd", " ", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"varListdd", "=", 
     RowBox[{
     "{", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "}"}]}], 
    ";"}], "\n", "\t\t", 
   RowBox[{"(*", " ", 
    RowBox[{
    "equations", " ", "that", " ", "do", " ", "not", " ", "depend", " ", "on",
      " ", "stocks", " ", "or", " ", "bonds"}], " ", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"expandList", "=", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", ",", "\n", 
       "\t\t\t", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`sdf", 
       ",", "\n", "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomsdf"}], "\n",
       "\t\t", "}"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"(*", " ", "stocks", " ", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"expandListStocks", "=", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", ",", "\n", 
       "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`ret"}], "\n", 
      "\t\t", "}"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"(*", " ", "bonds", " ", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"expandListBond", "=", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bond", ",", "\n",
        "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombond", ",", 
       "\n", "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondret", ",", 
       "\n", "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombondret", 
       ",", "\n", "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", ",",
        "\n", "\t\t\t", 
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombondyield"}],
       "\n", "\t\t", "}"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"(*", "shocks", "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"shocksList", " ", "=", " ", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", "]"}], 
      RowBox[{"(*", 
       RowBox[{",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<x\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pibar\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sx\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sc\>\"", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sp\>\"", 
         "]"}]}], "*)"}], "\n", "\t\t", "}"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"(*", 
    RowBox[{"covariance", " ", "with", " ", "pd12lag"}], "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"vars1", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<dc\>\"", ",", "\"\<dd\>\""}], 
      RowBox[{"(*", 
       RowBox[{
       ",", "\"\<pd\>\"", ",", "\"\<rf\>\"", ",", "\"\<excret\>\"", ",", 
        "\"\<pdpd\>\"", ",", "\"\<dcdc\>\"", ",", "\"\<dddd\>\"", ",", 
        "\"\<excretexcret\>\"", ",", "\"\<rfrf\>\"", ",", "\"\<dcpd\>\"", 
        ",", "\"\<ddpd\>\"", ",", "\"\<excretpd\>\"", ",", "\"\<rfpd\>\""}], 
       "*)"}], "}"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"vars2", "=", 
     RowBox[{"{", "\"\<pd12lag\>\"", "}"}]}], ";"}], "\n", "\n", "\t", "\n", 
   "\n", "\t", 
   RowBox[{
    RowBox[{
    "Needs", "[", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{
    "Needs", "[", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeConditionalExpectations`\>\"", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stateVarsNoEps", " ", "=", " ", 
     RowBox[{"Complement", "[", 
      RowBox[{"stateVars", ",", 
       RowBox[{"Cases", "[", 
        RowBox[{"stateVars", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "y___", "]"}], ":>", 
          RowBox[{"x", "[", "y", "]"}]}], ",", "Infinity", ",", 
         RowBox[{"Heads", "->", "True"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"varList", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"stateVarsNoEps", ",", 
       RowBox[{"{", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", ",", 
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi"}], "}"}]}],
       "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"covLong", "=", 
     RowBox[{"Symbol", "[", 
      RowBox[{
      "\"\<FernandoDuarte`LongRunRisk`covLong\>\"", "<>", "modelShortName"}], 
      "]"}]}], ";"}], "\n", "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondE", "[", "expr_", "]"}], ":=", 
     RowBox[{"uncondE", "[", 
      RowBox[{"expr", ",", " ", "model"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVar", "[", "expr_", "]"}], ":=", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"expr", ",", " ", "model"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{"expr1_", ",", "expr2_"}], "]"}], ":=", 
     RowBox[{"uncondCov", "[", 
      RowBox[{"expr1", ",", " ", "expr2", ",", " ", "model"}], "]"}]}], ";"}],
    "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"ev", "[", 
      RowBox[{"expr_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"ev", "[", 
      RowBox[{"expr", ",", " ", "t", ",", " ", "model"}], "]"}]}], ";"}], 
   "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"var", "[", 
      RowBox[{"expr_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"var", "[", 
      RowBox[{"expr", ",", " ", "t", ",", " ", "model"}], "]"}]}], ";"}], 
   "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"cov", "[", 
      RowBox[{"expr1_", ",", " ", "expr2_", ",", " ", "t_"}], "]"}], ":=", 
     RowBox[{"cov", "[", 
      RowBox[{"expr1", ",", " ", "expr2", ",", " ", "t", ",", " ", "model"}], 
      "]"}]}], ";"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"expr1_", ",", " ", "expr2_", ",", " ", 
       RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{"uncondCovLongExo", "[", 
      RowBox[{
      "toExogenous", ",", " ", "expr1", ",", " ", "expr2", ",", "  ", 
       "covfun"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{"expr_", ",", " ", 
       RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{"uncondVarLongExo", "[", 
      RowBox[{"toExogenous", ",", " ", "expr", ",", "  ", "covfun"}], "]"}]}],
     ";"}], "\n", "\n", "\t\t", 
   RowBox[{"(*", 
    RowBox[{"law", " ", "of", " ", "total", " ", "variance"}], "*)"}], "\n", 
   "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_", ",", 
       RowBox[{"fun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], ",", "fun"}], "]"}]}]}], ";"}], "\n",
    "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"notAllZero", "[", "q___", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          StyleBox[
           RowBox[{"Unequal", "[", 
            RowBox[{"#", ",", "0"}], "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], "&"}], "/@", 
        RowBox[{"{", "q", "}"}]}], ")"}]}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "at", " ", "least", " ", "one", " ", "input", " ", "argument", " ", "is",
       " ", "non"}], "-", "zero"}], "*)"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{"(*", 
    RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}]}], "*)"}], "\n", 
   "\t\t", 
   RowBox[{
    RowBox[{"varlistWithEps", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"varList", ",", "shocksList"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"tup1", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varlistWithEps", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ":>", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";"}], "\n", "\t\t", 
   
   RowBox[{
    RowBox[{"tup2", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"varlistWithEps", ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varlistWithEps", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], 
    ";"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995933439837`*^9}, {3.895800546518539*^9, 3.8958005479088697`*^9}, {
   3.895800651928104*^9, 3.8958006548560762`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"be1d4434-4229-45b5-8319-40217b9e2b3d"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"OrderlessPatternSequence", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0"}], 
        "]"}], "=", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
        "]"}]}], ")"}], "&"}], "/@", "tup1"}], ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.895799590167821*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"3f7819bb-9a57-4c19-9a7c-c5427f84ed1d"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"OrderlessPatternSequence", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"OrderlessPatternSequence", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
          "]"}], ",", "0", ",", "0"}], "]"}], "=", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
        "]"}]}], ")"}], "&"}], "/@", "tup2"}], ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995785923357`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"634af7b2-4432-429a-8a36-51d501d307a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1_", ",", 
      RowBox[{"{", 
       RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
      "q2_Integer"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"notAllZero", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1", ",", 
      RowBox[{"{", 
       RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2"}], "]"}], 
    "=", 
    RowBox[{"totCovLong", "[", 
     RowBox[{
      RowBox[{"v1", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}], "*", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
      RowBox[{"t", "+", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
     "]"}]}]}], ";"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.895799582393922*^9}, 3.895799725379465*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"c482c1db-7570-4ac3-a0bb-c14bd231ac15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "v3_", ",", "q1_Integer", ",",
       "q2_Integer"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"notAllZero", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", " ", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2"}], 
     "]"}], "=", 
    RowBox[{"totCovLong", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], "*", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
      RowBox[{"v3", "[", 
       RowBox[{"t", "+", "q2"}], "]"}], ",", 
      RowBox[{"t", "+", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
     "]"}]}]}], ";"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.8958010881127987`*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"4ae19c32-ce9a-4581-9048-ab9d083a5402"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rp", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"{", 
        RowBox[{"pos_", ",", "i_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"ReplaceAt", "[", 
      RowBox[{"expr", ",", 
       RowBox[{
        RowBox[{"vv_", "[", 
         RowBox[{"t", "+", "q_."}], "]"}], ":>", 
        RowBox[{"vv", "[", 
         RowBox[{
          RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", "pos"}], "]"}]}],
     ";"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"countStockVars", "[", 
      RowBox[{"vars_List", ",", "patt_"}], "]"}], ":=", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<SymbolQ\>\"", "]"}], "[", 
            "#", "]"}], ",", 
           RowBox[{"SymbolName", "[", "#", "]"}], ",", " ", "Nothing"}], 
          "]"}], "&"}], "/@", "vars"}], ",", "patt"}], "]"}]}], ";"}], "\n", 
   "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"positionStockVars", "[", 
      RowBox[{"vars_List", ",", "patt_"}], "]"}], ":=", 
     RowBox[{"Position", "[", 
      RowBox[{"vars", ",", 
       RowBox[{"_Symbol", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"SymbolName", "[", "#", "]"}], ",", "patt"}], "]"}], 
          "&"}], ")"}]}], ",", 
       RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";"}], "\n", "\t\t", "\n",
    "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1_", ",", 
        RowBox[{"{", 
         RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"countStockVars", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2", ",", " ", "v3"}], "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
         "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "i", "]"}], "]"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "v3"}], "}"}], ",", "q1", ",", "q2", ",", "i"}], 
       "]"}], "=", 
      RowBox[{"Module", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"positionStockVars", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v1", ",", 
              RowBox[{"{", 
               RowBox[{"v2", ",", "v3"}], "}"}]}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}], ",", 
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], "\n", 
       "\t\t", "]"}]}]}], ";"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", " ", ",", "v2_"}], "}"}], ",", "v3_", ",", 
        "q1_Integer", ",", "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"countStockVars", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2", ",", " ", "v3"}], "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
         "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "i", "]"}], "]"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2", 
         ",", "i"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"countStockVars", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"v1", ",", " ", "v2", ",", " ", "v3"}], "}"}], ",", 
           RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
          "]"}], "===", 
         RowBox[{"Length", "[", 
          RowBox[{"List", "[", "i", "]"}], "]"}]}], ")"}]}], "=", 
      RowBox[{"Module", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"positionStockVars", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", " ", ",", "v2"}], "}"}], ",", "v3"}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{"t", "+", "q2"}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], "\n", 
       "\t\t", "]"}]}]}], ";"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{"(*", 
    RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", " ", "v2"}], ",", " ", 
       RowBox[{"v3", " ", "v4"}]}], "]"}]}], "*)"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"tup3", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varlistWithEps", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], ":>", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";"}], "\n", "\t\t", 
   
   RowBox[{
    RowBox[{"tup4", "=", 
     RowBox[{"tup2", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"{", 
          RowBox[{"b_", ",", "c_"}], "}"}]}], "}"}], ":>", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}]}], ";"}], "\n", "\t\t", 
   
   RowBox[{
    RowBox[{"tup5", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"varlistWithEps", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varlistWithEps", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], ";"}], "\n", 
   "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0", ",",
           "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup3"}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup4"}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup5"}], ";"}], "\n", "\t\t", "\n", 
   "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", "q3"}], 
       "]"}], "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], "*", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], "*", " ", 
         RowBox[{"v4", "[", 
          RowBox[{"t", "+", "q3"}], "]"}]}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], "]"}], "-", 
         "1"}]}], "]"}]}]}], ";"}], "\n", "\t\t", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"countStockVars", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2", ",", " ", "v3", ",", " ", "v4"}], 
           "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
         "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "i", "]"}], "]"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", "q3", 
        ",", "i"}], "]"}], "=", 
      RowBox[{"Module", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"positionStockVars", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v3", ",", "v4"}], "}"}]}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}], ",", 
                 RowBox[{"v4", "[", 
                  RowBox[{"t", "+", "q3"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\n", "\t\t\t", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], 
                 "]"}], "-", "1"}]}], "]"}], "&"}], ")"}], "@@", 
           "vdd"}]}]}]}], "\n", "\t\t", "]"}]}]}], ";"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801984856657*^9, 
   3.895801985600532*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"92577d8e-9722-4013-a231-538d93055e50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "remove", " ", "function", " ", "evaluation", " ", "condition", " ", "in", 
    " ", "memoized", " ", "DownValues", " ", "of", " ", "covLong"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", 
     RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"RuleDelayed", "[", 
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{
               RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
               RowBox[{
                RowBox[{"Verbatim", "[", "Condition", "]"}], "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], "]"}], "]"}], ",", 
             "c__"}], "]"}], ")"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"HoldPattern", "[", "b", "]"}], ",", 
               "countStockVars"}], "]"}]}], " ", "&&", " ", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"HoldPattern", "[", "c", "]"}], ",", "Module"}], 
             "]"}]}], ")"}]}], ":>", 
         RowBox[{"(", 
          RowBox[{"RuleDelayed", "[", 
           RowBox[{
            RowBox[{"HoldPattern", "[", "a", "]"}], ",", "c"}], "]"}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"DownValues", "[", 
      RowBox[{"Evaluate", "@", "covLong"}], "]"}]}]}], ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, 3.895801363162952*^9, {
   3.895801485973485*^9, 3.8958014982853107`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"54051711-0548-4c27-8083-c8cb0ff6e32f"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"(*", "shocks", "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{"Do", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{"shocksList", "[", 
        RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "0"}], "]"}], "=", "1"}], ";", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", " ", 
         RowBox[{"q_", "/;", 
          RowBox[{"(", 
           RowBox[{"q", "!=", "0"}], ")"}]}]}], "]"}], "=", "0"}], ";", "\n", 
      "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "v", ",", "q_"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "_", ",", 
         RowBox[{"q_", "/;", 
          RowBox[{"q", "<", "0"}]}]}], "]"}], "=", "0"}], ";", "\n", 
      "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "x_", ",", 
         RowBox[{"q_", "/;", 
          RowBox[{"q", ">=", "0"}]}]}], "]"}], ":=", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v", "[", "t", "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"t", "+", "q"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"x_", ",", "v", ",", "q_"}], "]"}], ":=", 
       RowBox[{"covLong", "[", 
        RowBox[{"v", ",", "x", ",", 
         RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t", ",", "\n", 
     "\t\t\t", 
     RowBox[{"{", 
      RowBox[{"mm", ",", "1", ",", 
       RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", "\t\t", 
    "]"}], ";"}], "\t"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, 3.895801363162952*^9, {
   3.895801485973485*^9, 3.895801486780287*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0163861e-1c73-483f-b8ba-48e215f9251f"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"state", " ", "vars"}], ",", " ", 
    RowBox[{"dc", " ", "and", " ", "pi"}]}], "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{"ParallelDo", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"v1", "=", 
       RowBox[{"varList", "[", 
        RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{"With", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"tempNeg", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{
                RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"tempPos", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "2", ",", 
               RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
         "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", 
            RowBox[{"q_", "/;", 
             RowBox[{"q", " ", "<", " ", 
              RowBox[{"-", "1"}]}]}]}], "]"}], "=", 
          RowBox[{"FindSequenceFunction", "[", 
           RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", 
            RowBox[{"-", "1"}]}], "]"}], "=", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "0"}], "]"}], "=", 
          RowBox[{"uncondVar", "[", 
           RowBox[{"v1", "[", "t", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "1"}], "]"}], "=", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", 
            RowBox[{"q_", "/;", 
             RowBox[{"q", " ", ">", " ", "1"}]}]}], "]"}], "=", 
          RowBox[{"FindSequenceFunction", "[", 
           RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q"}], "]"}]}], ";"}]}], "\n", "\t\t\t", "]"}], 
      ";", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v2", "=", 
          RowBox[{"varList", "[", 
           RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{"With", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"tempNeg", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{
                   RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"tempPos", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", "2", ",", 
                  RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}]}], "\n", 
            "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", " ", "<", " ", 
                 RowBox[{"-", "1"}]}]}]}], "]"}], "=", 
             RowBox[{"FindSequenceFunction", "[", 
              RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "1"}]}], "]"}], "=", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "1"}], "]"}], "=", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", " ", ">", " ", "1"}]}]}], "]"}], "=", 
             RowBox[{"FindSequenceFunction", "[", 
              RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}]}], "\n", "\t\t\t\t", 
          "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"(*", "shocks", "*)"}], "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"shocksList", "[", 
              RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"With", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"tempPos", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"T", ",", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v3", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"T", ",", "3", ",", 
                    RowBox[{"maxLag", "+", "2"}]}], "}"}]}], "]"}]}], "\n", 
               "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", 
                  RowBox[{"q_", "/;", 
                   RowBox[{"q", " ", "<", " ", "0"}]}]}], "]"}], "=", "0"}], 
               ";", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", "0"}], "]"}], "=", 
                RowBox[{"uncondCov", "[", 
                 RowBox[{
                  RowBox[{"v1", "[", "t", "]"}], ",", 
                  RowBox[{"v3", "[", "t", "]"}]}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", "1"}], "]"}], "=", 
                RowBox[{"uncondCov", "[", 
                 RowBox[{
                  RowBox[{"v1", "[", "t", "]"}], ",", 
                  RowBox[{"v3", "[", 
                   RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", "2"}], "]"}], "=", 
                RowBox[{"uncondCov", "[", 
                 RowBox[{
                  RowBox[{"v1", "[", "t", "]"}], ",", 
                  RowBox[{"v3", "[", 
                   RowBox[{"t", "+", "2"}], "]"}]}], "]"}]}], ";", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", 
                  RowBox[{"q_", "/;", 
                   RowBox[{"q", " ", ">", " ", "2"}]}]}], "]"}], "=", 
                RowBox[{"FindSequenceFunction", "[", 
                 RowBox[{"tempPos", ",", "q"}], "]"}]}], ";"}]}], "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"covLong", "[", 
                 RowBox[{"v3", ",", "v1", ",", "q_"}], "]"}], "=", 
                RowBox[{"covLong", "[", 
                 RowBox[{"v1", ",", "v3", ",", 
                  RowBox[{"-", "q"}]}], "]"}]}], ";"}], "*)"}], "\n", 
             "\t\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t\t", ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"mm", ",", "1", ",", 
             RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"qq", ",", 
          RowBox[{"kk", "+", "1"}], ",", 
          RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", "\t\t\t", 
       "]"}], ";"}], "\n", "\t\t\t", ",", "\n", "\t\t\t", 
     RowBox[{"{", 
      RowBox[{"kk", ",", "1", ",", 
       RowBox[{"Length", "[", "varList", "]"}]}], "}"}], "\n", "\t\t\t", ",", 
     "\n", "\t\t\t", 
     RowBox[{"DistributedContexts", "->", "All"}]}], "\n", "\t\t", "]"}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.8958013710375843`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"05052288-97f2-4f6a-8c96-4f645d7747ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "[", 
    RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ParallelEvaluate", "[", 
      RowBox[{"DownValues", "[", 
       RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.89580137290291*^9}, {3.895801817550988*^9, 3.89580181789651*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"abff1ddb-a713-415e-b8c9-891224985de6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FernandoDuarte`LongRunRisk`covLongDES", "[", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pibar", ",", 
    RowBox[{"{", 
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pibar"}], "}"}], 
    ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], " "}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"85c4187b-d6ad-498b-b81a-02eb0f487243"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
   SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", "2"], 
   " ", 
   SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phipbarx", 
    "2"], " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar"}], "+", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
   SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", "2"], 
   " ", 
   SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phipbarxb", 
    "2"], " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", 
         "2"], " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phipbarx",
          "2"]}], "+", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", 
         "2"], " ", 
        SuperscriptBox[
         "FernandoDuarte`LongRunRisk`Model`Parameters`phipbarxb", "2"]}]}], 
      ")"}], " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
     SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar", 
      "3"]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar", 
      "2"]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", 
         "2"], " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phipbarx",
          "2"]}], "+", 
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esx", 
         "2"], " ", 
        SuperscriptBox[
         "FernandoDuarte`LongRunRisk`Model`Parameters`phipbarxb", "2"]}]}], 
      ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar", 
         "3"]}], "-", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
        "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar", 
         "3"]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhopbar", 
      "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.895803882843869*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"a5cea5be-f7e2-4506-b5b0-fc2818455b65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLong", "[", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   RowBox[{"{", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg"}], "}"}], ",", 
   
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"0b138d0a-8999-4253-8db8-38240d473d50"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.895802301073061*^9, 3.895803957135522*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"0440ed5e-94a7-48ad-aee3-0073d61411f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "dd", " ", "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\n", "\t\t\t", 
     RowBox[{"(*", " ", 
      RowBox[{"one", " ", "stock"}], " ", "*)"}], "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "=", 
        RowBox[{"varListdd", "[", 
         RowBox[{"[", "jj", "]"}], "]"}]}], ";", "\n", "\t\t\t", 
       RowBox[{"Module", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"tempNeg", ",", "\n", "\t\t\t\t\t", "tempPos"}], "\n", 
          "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempNeg", "[", "i_", "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "T"}], ",", "i"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{
                RowBox[{"-", "maxLag"}], "-", "2"}], ",", 
               RowBox[{"-", "3"}]}], "}"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
          
          RowBox[{
           RowBox[{"tempPos", "[", "i_", "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "T"}], ",", "i"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "3", ",", 
               RowBox[{"maxLag", "+", "2"}]}], "}"}]}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", " ", "<", " ", 
               RowBox[{"-", "1"}]}]}], ",", "i_"}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempNeg", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", 
             RowBox[{"-", "2"}], ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", 
             RowBox[{"-", "1"}], ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "0", ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondVar", "[", 
            RowBox[{"v1", "[", 
             RowBox[{"t", ",", "i"}], "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "1", ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "2", ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", " ", ">", " ", "1"}]}], ",", "i_"}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempPos", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
          "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}],
            "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";"}]}], "\n", 
        "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
       RowBox[{"(*", " ", 
        RowBox[{"two", " ", "stocks"}], " ", "*)"}], "\n", "\t\t\t", 
       RowBox[{"Module", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{"tempNeg", ",", "\n", "\t\t\t\t\t", "tempPos"}], "\n", 
          "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"tempNeg", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "T"}], ",", "j"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{
                RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
               RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
          
          RowBox[{
           RowBox[{"tempPos", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "T"}], ",", "j"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "2", ",", 
               RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", 
              RowBox[{"q_", "/;", 
               RowBox[{"q", " ", "<", " ", 
                RowBox[{"-", "1"}]}]}], ",", "i_", ",", "j_"}], "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempNeg", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", "q"}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", 
              RowBox[{"-", "1"}], ",", "i_", ",", "j_"}], "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "-", "1"}], ",", "j"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", "0", ",", "i_", ",", "j_"}], "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "j"}], "]"}]}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", "1", ",", "i_", ",", "j_"}], "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v1", "[", 
              RowBox[{
               RowBox[{"t", "+", "1"}], ",", "j"}], "]"}]}], "]"}]}], ";", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", 
              RowBox[{"q_", "/;", 
               RowBox[{"q", " ", ">", " ", "1"}]}], ",", "i_", ",", "j_"}], 
             "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempPos", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", "q"}], "]"}]}], ";", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], 
             "]"}], "/;", 
            RowBox[{"Not", "[", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "q", ",", "i", ",", "j"}], "]"}]}], ";"}]}], 
        "\n", "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
       RowBox[{"(*", "shocks", "*)"}], "\n", "\t\t\t", 
       RowBox[{"Do", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"v3", "=", 
           RowBox[{"shocksList", "[", 
            RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
          RowBox[{"With", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{"tempPos", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v3", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", "3", ",", 
                  RowBox[{"maxLag", "+", "2"}]}], "}"}]}], "]"}]}], "\n", 
             "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", " ", "<", " ", "0"}]}]}], "]"}], "=", "0"}], 
             ";", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", "0", ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v3", "[", "t", "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", "1", ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v3", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", "2", ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v3", "[", 
                 RowBox[{"t", "+", "2"}], "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", " ", ">", " ", "2"}]}], ",", "i_"}], "]"}], "=", 
              RowBox[{"FindSequenceFunction", "[", 
               RowBox[{"tempPos", ",", "q"}], "]"}]}], ";"}]}], "\n", 
           "\t\t\t\t\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v3", ",", "v1", ",", "q_"}], "]"}], "=", 
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v3", ",", 
                RowBox[{"-", "q"}]}], "]"}]}], ";"}], "*)"}], "\n", 
           "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
         
         RowBox[{"{", 
          RowBox[{"mm", ",", "1", ",", 
           RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
        "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
       RowBox[{"ParallelDo", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"v2", "=", 
           RowBox[{"varList", "[", 
            RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
          RowBox[{"Module", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t\t", 
             RowBox[{"tempNeg", ",", "\n", "\t\t\t\t\t\t", "tempPos"}], "\n", 
             "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"tempNeg", "[", "i_", "]"}], "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"t", ",", "i"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{
                   RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
                  RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"tempPos", "[", "i_", "]"}], "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"t", ",", "i"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", "2", ",", 
                  RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}], ";", "\n",
              "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", " ", "<", " ", 
                  RowBox[{"-", "1"}]}]}], ",", "i_"}], "]"}], "=", 
              RowBox[{"FindSequenceFunction", "[", 
               RowBox[{
                RowBox[{"tempNeg", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
             "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"-", "1"}], ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v2", "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", "0", ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", "1", ",", "i_"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], ",", 
                RowBox[{"v2", "[", 
                 RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", 
             "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", " ", ">", " ", "1"}]}], ",", "i_"}], "]"}], "=", 
              RowBox[{"FindSequenceFunction", "[", 
               RowBox[{
                RowBox[{"tempPos", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
             "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v2", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}]}], "\n", 
           "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"kk", ",", "1", ",", 
           RowBox[{"Length", "[", "varList", "]"}]}], "}"}], "\n", "\t\t\t\t",
          ",", "\n", "\t\t\t\t", 
         RowBox[{"DistributedContexts", "->", "All"}]}], "\n", "\t\t\t", 
        "]"}], ";", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"DownValues", "[", 
         RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ParallelEvaluate", "[", 
           RowBox[{"DownValues", "[", 
            RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";"}], "\n", "\t\t\t", ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", 
        RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", "\t\t", 
     "]"}], ";"}], "\n", "\t\t\t"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801380519347*^9}, 3.895802364271516*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"15e9698d-6d6a-451c-a0fc-ed57fa786cfb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLong", "[", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   RowBox[{"{", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg"}], "}"}], ",", 
   
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"9ca0d9a8-c707-41d2-ab25-512682ae9481"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.89580240869306*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"41186ea0-1380-4b8b-8a94-6d4af9eac509"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"(*", " ", 
   RowBox[{
   "equations", " ", "that", " ", "do", " ", "not", " ", "depend", " ", "on", 
    " ", "stocks", " ", "or", " ", "bonds"}], " ", "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{"Parallelize", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandList", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], ";", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t", "\n", 
         "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t\t", ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t\t", ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"pp", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v5", "=", 
             RowBox[{"shocksList", "[", 
              RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", " ", "<", " ", "0"}]}]}], "]"}], "=", "0"}], ";",
             "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", " ", ">", " ", "0"}]}]}], "]"}], "=", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"v5", "[", "t", "]"}], ",", 
               RowBox[{"v1", "[", 
                RowBox[{"t", "+", "q"}], "]"}]}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v5", ",", "q_"}], "]"}], "=", 
              RowBox[{"covLong", "[", 
               RowBox[{"v5", ",", "v1", ",", 
                RowBox[{"-", "q"}]}], "]"}]}], ";"}], "*)"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"mm", ",", "1", ",", 
             RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";"}], "\n", "\t\t\t", ",", "\n", "\t\t\t", 
     RowBox[{"DistributedContexts", "->", "All"}]}], "\n", "\t\t", "]"}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801385093079*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"64e0a54a-4e8d-4e4a-904c-6a568ad0bcdb"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", 
     RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"DownValues", "[", 
        RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801387749342*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"3866a9bf-883e-45da-9eb9-504b148b20d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLong", "[", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   RowBox[{"{", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg"}], "}"}], ",", 
   
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"8da0ba10-9393-49b4-8111-2274dfb963d2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8958024161215153`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"8256f0ea-ff8f-4788-8ca5-0bf5f32b704f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\t\t\t\t\t", 
  RowBox[{"(*", " ", "stocks", " ", "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{"Parallelize", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandListStocks", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{
              RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}], 
           "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "i_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}], 
          "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", "\t", "\n", 
         "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v3", ",", "q_Integer", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "j"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "j", ",", "i"}], "]"}]}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q", ",", "i", ",", "i"}], 
              "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "i", ",", "i"}], "]"}]}], ";"}], "\n",
            "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"pp", ",", "1", ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v5", "=", 
             RowBox[{"expandListStocks", "[", 
              RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v5", ",", "q_Integer", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v5", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "j"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "j", ",", "i"}], "]"}]}], ";", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", "q", ",", "i", ",", "i"}], 
              "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "i", ",", "i"}], "]"}]}], ";"}], "\n",
            "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"rr", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], 
          "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v6", "=", 
             RowBox[{"shocksList", "[", 
              RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v6", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v6", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v6", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v6", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"mm", ",", "1", ",", 
             RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
      RowBox[{"(*", " ", "bonds", " ", "*)"}], "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandListBond", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "n_"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", 
             RowBox[{"t", ",", "n"}], "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{
              RowBox[{"t", "+", "q"}], ",", "n"}], "]"}], ",", "covLong"}], 
           "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "n_", ",", "n_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_Integer", ",", "n_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_Integer", ",", "n_", ",", "n_"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", "\n", "\t\t\t\t",
          "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v3", ",", "q_Integer", ",", "n_", ",", "i_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_", ",", "n_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "n", ",", "i"}], "]"}]}], ";"}], "\n",
            "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_", ",", "n_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"pp", ",", "1", ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v5", "=", 
             RowBox[{"expandListStocks", "[", 
              RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v5", ",", "q_Integer", ",", "n_", ",", "i_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v5", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_", ",", "n_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "n", ",", "i"}], "]"}]}], ";"}], "\n",
            "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"rr", ",", "1", ",", 
             RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], 
          "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v6", "=", 
             RowBox[{"expandListBond", "[", 
              RowBox[{"[", "vv", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v6", ",", "q_Integer", ",", "n1_Integer", ",", 
               "n2_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", " ", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n1"}], "]"}], ",", 
               RowBox[{"v6", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "n2"}], "]"}], ",", 
               "covLong"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v6", ",", "v1", ",", "q_Integer", ",", "n1_Integer", ",", 
               "n2_Integer"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v6", ",", 
               RowBox[{"-", "q"}], ",", "n2", ",", "n1"}], "]"}]}], ";"}], 
           "\n", "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"vv", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", 
         RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v7", "=", 
             RowBox[{"shocksList", "[", 
              RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v7", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v7", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v7", ",", "v1", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v7", ",", 
               RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], "\n", 
           "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"mm", ",", "1", ",", 
             RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
          "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";"}], "\n", "\t\t\t", ",", "\n", "\t\t\t", 
     RowBox[{"DistributedContexts", "->", "All"}]}], "\n", "\t\t", "]"}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801393556481*^9}, 3.895802403319168*^9},
 CellLabel->"In[71]:=",ExpressionUUID->"3b024d84-0992-409c-8e96-cc5346357892"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", 
     RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"DownValues", "[", 
        RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.89580140187087*^9}, {3.895802345167569*^9, 3.8958023455426693`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"2c3358bd-95d6-4ef4-89ad-4f6c9fd50c6a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLong", "[", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   RowBox[{"{", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg"}], "}"}], ",", 
   
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"9e7bd343-07f8-4880-9df1-087879af8d97"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.895802426174675*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"233b43ed-2784-4a3d-9c1c-d225a4edfa4a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "risk", " ", "free", " ", "rates", " ", "are", " ", "yields", " ", "on", 
     " ", "one"}], "-", 
    RowBox[{"period", " ", "bonds"}]}], " ", "*)"}], "\n", "\t\t", 
  RowBox[{
   RowBox[{"Parallelize", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
         "q_Integer"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
         ",", "q", ",", "1"}], "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
         "q_"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
         "q"}], "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",", 
         "q_Integer"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombondyield", 
         ",", "q", ",", "1"}], "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",", 
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",", 
         "q_"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",", 
         "q"}], "]"}]}], ";", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v2", "=", 
          RowBox[{"varList", "[", 
           RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v2", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v2", ",", "q", ",", "1"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v2", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v2", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v2", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v2", ",", "q", ",", "1"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v2", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v2", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t", ",", "\n",
         "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"qq", ",", "1", ",", 
          RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", "\t\t\t", 
       "]"}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v3", "=", 
          RowBox[{"varListdd", "[", 
           RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v3", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v3", ",", "q", ",", "1", ",", "i"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v3", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v3", ",", 
            RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v3", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v3", ",", "q", ",", "1", ",", "i"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v3", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v3", ",", 
            RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", "\t\t\t\t", 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"zz", ",", "1", ",", 
          RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v4", "=", 
          RowBox[{"expandList", "[", 
           RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v4", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v4", ",", "q", ",", "1"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v4", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v4", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\n", "\t\t\t\t", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v4", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v4", ",", "q", ",", "1"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v4", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v4", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t", ",", "\n",
         "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"pp", ",", "1", ",", 
          RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v5", "=", 
          RowBox[{"expandListStocks", "[", 
           RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v5", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v5", ",", "q", ",", "1", ",", "i"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v5", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v5", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\n", "\t\t\t\t", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v5", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v5", ",", "q", ",", "1", ",", "i"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v5", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v5", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t", ",", "\n",
         "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"rr", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t\t", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v6", "=", 
          RowBox[{"expandListBond", "[", 
           RowBox[{"[", "vv", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v6", ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v6", ",", "q", ",", "1", ",", "n"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v6", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v6", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v6", ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v6", ",", "q", ",", "1", ",", "n"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v6", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v6", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], "\n", "\t\t\t\t", 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"vv", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";", "\n", "\t\t\t", 
      RowBox[{"Do", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"v7", "=", 
          RowBox[{"shocksList", "[", 
           RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v7", ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
            ",", "v7", ",", "q", ",", "1", ",", "n"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v7", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`rf", ",", 
            "v7", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";", "\n", "\t\t\t\t", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v7", ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
nombondyield", ",", "v7", ",", "q", ",", "1", ",", "n"}], "]"}]}], ";", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
           "v7", ",", 
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", 
            ",", "q_Integer", ",", "n_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomrf", ",",
             "v7", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], "\n", "\t\t\t\t", 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{"mm", ",", "1", ",", 
          RowBox[{"Length", "[", "shocksList", "]"}]}], "}"}]}], "\n", 
       "\t\t\t", "]"}], ";"}], "\n", "\t\t\t", ",", "\n", "\t\t\t", 
     RowBox[{"DistributedContexts", "->", "All"}]}], "\n", "\t\t", "]"}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801416675325*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"dc8474dc-f6e0-49cc-abbc-34a26d2e1d7a"],

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", 
     RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"DownValues", "[", 
        RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
   ";"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.8958014197005873`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"d2b607e7-a18b-4e2d-84aa-330b1f146107"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLong", "[", 
  RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   RowBox[{"{", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", ",", 
     "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg"}], "}"}], ",", 
   
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"4c7208fa-5ce0-4540-83ca-23ae9485474b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.8958024622965307`*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"5f18b343-e6fb-4409-9838-6ffdd98be1e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FernandoDuarte`LongRunRisk`covLongDES", "[", 
  RowBox[{"x", ",", 
   RowBox[{"{", 
    RowBox[{"sg", ",", "sg"}], "}"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"28955eba-19d4-4e85-9eed-8a8a94cafb27"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.895801907275095*^9, 3.895802462359983*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"ac97f1f3-0dee-4047-8638-29220fd74840"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aveps", "[", 
    RowBox[{"i_", ",", 
     RowBox[{"mud0_", ":", "0.0015"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", 
           RowBox[{"mud0", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], "+", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"mud0", "*", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{"mud0", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"12", "-", "k"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"mud0", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"epsPd", "[", 
     RowBox[{"k_", ",", "i_", ",", 
      RowBox[{"mud0_", ":", "0.0015"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Sum", "[", 
          RowBox[{"mud0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", 
         RowBox[{"12", "-", "k", "-", "1"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"mud0", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdAGeq", "[", 
    RowBox[{"t_", ",", "i_", ",", 
     RowBox[{"mud0_", ":", "0.0015"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"pd", "[", 
     RowBox[{"t", ",", "i"}], "]"}], "-", 
    RowBox[{"aveps", "[", 
     RowBox[{"i", ",", "mud0"}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"epsPd", "[", 
        RowBox[{"q", ",", "i", ",", "mud0"}], "]"}], "*", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "q"}], ",", "i"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "0", ",", 
        RowBox[{"12", "-", "2"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895802681875286*^9, 
  3.895802705949574*^9}},ExpressionUUID->"9cf98f8f-d038-4f16-bd8d-\
fb09fe113440"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pd12lag", "=", 
   RowBox[{"pdAGeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "i"}], "]"}]}], ";"}]], "Input",Expression\
UUID->"60c17552-5251-4a89-9e41-bfd1160eb2f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars1", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<dc\>\"", ",", "\"\<dd\>\""}], 
    RowBox[{"(*", 
     RowBox[{
     ",", "\"\<pd\>\"", ",", "\"\<rf\>\"", ",", "\"\<excret\>\"", ",", 
      "\"\<pdpd\>\"", ",", "\"\<dcdc\>\"", ",", "\"\<dddd\>\"", ",", 
      "\"\<excretexcret\>\"", ",", "\"\<rfrf\>\"", ",", "\"\<dcpd\>\"", ",", 
      "\"\<ddpd\>\"", ",", "\"\<excretpd\>\"", ",", "\"\<rfpd\>\""}], "*)"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars2", "=", 
   RowBox[{"{", "\"\<pd12lag\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hor", "=", 
   RowBox[{"ToString", "/@", 
    RowBox[{"{", 
     RowBox[{"12", ",", "24"}], 
     RowBox[{"(*", 
      RowBox[{",", "36", ",", "48", ",", "60", ",", "72"}], "*)"}], "}"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars1cov", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Outer", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"#1", ",", "#1", ",", "#2"}], "]"}], ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"#1", ",", "\"\<pd\>\"", ",", "#2"}], "]"}]}], "}"}], 
        "&"}], ",", "vars1", ",", "hor"}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars1cov", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"LexicographicSort", "@", 
     RowBox[{"Transpose", "[", "vars1cov", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"memo", "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"SymbolName", "[", 
             RowBox[{"vars1cov", "[", 
              RowBox[{"[", "jj", "]"}], "]"}], "]"}], ",", 
            RowBox[{"SymbolName", "[", 
             RowBox[{"vars2", "[", 
              RowBox[{"[", "qq", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Inactive", "[", "covLong", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"memovec", "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Expand", "[", "memo", "]"}], ",", 
             RowBox[{
              RowBox[{"a_.", " ", 
               RowBox[{
                RowBox[{"Inactive", "[", "covLong", "]"}], "[", "x__", 
                "]"}]}], "->", 
              RowBox[{
               RowBox[{"Inactive", "[", "covLong", "]"}], "[", "x", "]"}]}], 
             ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ParallelMap", "[", 
          RowBox[{"Activate", ",", "memovec"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"retrieve", " ", "from", " ", "parallel", " ", "kernels"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"ParallelEvaluate", "[", 
             RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "remove", " ", "function", " ", "evaluation", " ", "condition", " ",
            "in", " ", "memoized", " ", "DownValues", " ", "of", " ", 
           "covLong"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 TagBox[
                  StyleBox[
                   RowBox[{"RuleDelayed", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{
                    RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Condition", "]"}], "[", 
                    RowBox[{"a__", ",", "b__"}], "]"}], "]"}], "]"}], ",", 
                    "c__"}], "]"}],
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True],
                  FullForm], 
                 StyleBox[")",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True]}], 
                StyleBox["/;",
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True], 
                StyleBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", "b", "]"}], ",", "Count"}], 
                    "]"}]}], " ", "&&", " ", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", "c", "]"}], ",", "Module"}], 
                    "]"}]}], ")"}],
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True]}], 
               StyleBox["->",
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True], 
               StyleBox[
                RowBox[{
                 RowBox[{"HoldPattern", "[", "a", "]"}], ":>", "c"}],
                ShowSpecialCharacters->False,
                ShowStringCharacters->True,
                NumberMarks->True]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"DownValues", "[", "covLong", "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"jj", ",", "1", ",", 
          RowBox[{"Length", "[", "vars1cov", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"qq", ",", "1", ",", 
       RowBox[{"Length", "[", "vars2", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\n", "\t\t", 
  RowBox[{"(*", 
   RowBox[{"retrieve", " ", "from", " ", "parallel", " ", "kernels"}], 
   "*)"}]}], "\n", 
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", 
     RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"ParallelEvaluate", "[", 
       RowBox[{"DownValues", "[", 
        RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
   ";"}]}], "\n", 
 RowBox[{"\t\t"}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801435428623*^9}, 3.8958019152341413`*^9, 3.895802241679747*^9, 
   3.895802331335326*^9, {3.895802944512967*^9, 
   3.895802949933025*^9}},ExpressionUUID->"4e6bdd6c-3420-4278-ba52-\
f2451dfb4351"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "[", 
    RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ParallelEvaluate", "[", 
      RowBox[{"DownValues", "[", 
       RowBox[{"Evaluate", "@", "covLong"}], "]"}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.895802741780113*^9, 3.895802746258977*^9}, 
   3.8958040388382187`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"c43c3f4c-88d9-443b-b469-50f75da17b6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{"(*", 
   RowBox[{
   "remove", " ", "function", " ", "evaluation", " ", "condition", " ", "in", 
    " ", "memoized", " ", "DownValues", " ", "of", " ", "covLong"}], "*)"}], 
  "\n", "\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", 
      RowBox[{"Evaluate", "@", "covLong"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            TagBox[
             StyleBox[
              RowBox[{"RuleDelayed", "[", 
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{
                  RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
                  RowBox[{
                   RowBox[{"Verbatim", "[", "Condition", "]"}], "[", 
                   RowBox[{"a__", ",", "b__"}], "]"}], "]"}], "]"}], ",", 
                "c__"}], "]"}],
              ShowSpecialCharacters->False,
              ShowStringCharacters->True,
              NumberMarks->True],
             FullForm], ")"}], "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{
                RowBox[{"HoldPattern", "[", "b", "]"}], ",", 
                "countStockVars"}], "]"}]}], " ", "&&", " ", 
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"HoldPattern", "[", "c", "]"}], ",", "Module"}], 
              "]"}]}], ")"}]}], ":>", 
          RowBox[{"(", 
           RowBox[{"RuleDelayed", "[", 
            RowBox[{
             RowBox[{"HoldPattern", "[", "a", "]"}], ",", "c"}], "]"}], 
           ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"DownValues", "[", 
       RowBox[{"Evaluate", "@", "covLong"}], "]"}]}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"dv1", "=", 
     RowBox[{"DownValues", "[", 
      RowBox[{"Evaluate", "@", "covLong"}], "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{"dv0", "===", "dv1"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801435428623*^9}, 3.8958019152341413`*^9, {3.895802748571315*^9, 
   3.8958027590031*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"56e91183-1a7e-4d1b-a238-c2371d3dcd52"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8958027948858356`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"0e672a37-da4d-45d1-9886-3232a4badedd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FernandoDuarte`LongRunRisk`covLongDES", "[", 
  RowBox[{"x", ",", 
   RowBox[{"{", 
    RowBox[{"sg", ",", "sg"}], "}"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"984f9dbe-bd43-46e6-975b-c84e866b34c5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.895801918623889*^9, 3.8958023246660213`*^9, 
  3.8958027949468813`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"e8b26647-9092-43a0-bc94-6d21650b8a3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covLongFilename", "=", 
  "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/MomentsLookupTables/covLongDES.wl\
\>\""}]], "Input",
 CellChangeTimes->{{3.8958030129838257`*^9, 3.895803031487645*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"6e8209c3-14ad-49a2-971c-e700bb627c68"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/MomentsLookupTables/covLongDES.wl\
\"\>"], "Output",
 CellChangeTimes->{3.895803034719208*^9, 3.8958040465245733`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"6e1a2697-84e6-4003-9ecf-1395702b8e66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"dataCovLong", "=", 
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<DefinitionData\>\"", "]"}], "[", 
      "covLong", "]"}]}], ";"}], "\n", "\t\t", 
   RowBox[{
    RowBox[{"Put", "[", 
     RowBox[{"dataCovLong", ",", "covLongFilename"}], "]"}], ";"}], "\n", 
   "\t\t", 
   RowBox[{"ToString", "[", "covLong", "]"}], " ", 
   RowBox[{"(*", 
    RowBox[{"full", " ", "name", " ", "with", " ", "context"}], "*)"}], "\n", 
   "\t\t"}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.8957977059596977`*^9, 3.895797745066999*^9, {3.895799494793117*^9, 
   3.8957995838480787`*^9}, 3.895801294712697*^9, {3.895801363162952*^9, 
   3.895801435428623*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"c31726bd-b890-410d-8926-cbe5a09b4f80"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "symname", 
   "\"The string \
\\\"\\!\\(\\*RowBox[{\\\"\\\\\\\"ResourceSystemClient`DefinitionUtilities`\
WithContext\\\\\\\"\\\"}]\\)\\\" cannot be used for a symbol name. A symbol \
name must start with a letter followed by letters and numbers.\"", 2, 67, 53, 
   28992817581377575239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.895803057468286*^9, 3.8958040552903*^9},
 CellLabel->
  "During evaluation of \
In[66]:=",ExpressionUUID->"703f1237-1dbf-4b6a-9daa-e28031dcc5c0"],

Cell[BoxData["\<\"FernandoDuarte`LongRunRisk`covLongDES\"\>"], "Output",
 CellChangeTimes->{3.8958030576314707`*^9, 3.8958040553691187`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"052f888a-5a11-4519-8039-7987d5b0a0df"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1392, 895},
WindowMargins->{{-1243, Automatic}, {-28, Automatic}},
WindowStatusArea->"",
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"28726991-7989-40ff-90db-b85d56c7a0a9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 262, 5, 37, "Input",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],
Cell[665, 20, 2360, 48, 142, "Input",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],
Cell[CellGroupData[{
Cell[3050, 72, 257, 4, 67, "Subsection",ExpressionUUID->"d03dfeba-2718-41c7-9b3f-19ce5bed64e2"],
Cell[3310, 78, 576, 16, 64, "Input",ExpressionUUID->"4ed5f578-352d-450a-80c3-862d7bf99a10"],
Cell[CellGroupData[{
Cell[3911, 98, 217, 3, 37, "Input",ExpressionUUID->"65bb4142-4641-4071-9777-2e590187c288"],
Cell[4131, 103, 234, 4, 42, "Output",ExpressionUUID->"e4d8705f-ce93-4a1d-9f3e-64de732ff268"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4402, 112, 899, 20, 220, "Input",ExpressionUUID->"5ea9f70b-0b8c-459e-9ee8-7dc6c6672ae0"],
Cell[5304, 134, 594, 13, 35, "Message",ExpressionUUID->"c6521f17-f45c-4d0b-b95a-999e7a9fb184"]
}, Open  ]],
Cell[5913, 150, 152, 3, 37, "Input",ExpressionUUID->"b16e2830-ef75-4fed-955f-2aa02f8df491"],
Cell[6068, 155, 152, 3, 37, "Input",ExpressionUUID->"fe38193e-e8f0-43aa-9a50-7201df9589cb"],
Cell[6223, 160, 255, 4, 37, "Input",ExpressionUUID->"2a27c620-1f7f-422b-b849-aea1cc675dd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6515, 169, 210, 4, 67, "Subsection",ExpressionUUID->"6b918d18-7704-45dd-b222-55d8d234ce9f"],
Cell[6728, 175, 214, 4, 37, "Input",ExpressionUUID->"456aea83-3b17-4426-af60-5b58a2a0573c"],
Cell[6945, 181, 1086, 30, 142, "Input",ExpressionUUID->"1cb52e22-209f-41eb-978c-5c7f5d404f1b"],
Cell[8034, 213, 978, 18, 90, "Input",ExpressionUUID->"61d39cc5-b370-402a-9f30-d3392e6deb46"],
Cell[9015, 233, 918, 26, 90, "Input",ExpressionUUID->"47632f64-5dee-462c-9f21-f5a3d49e3d8e"],
Cell[9936, 261, 2102, 43, 142, "Input",ExpressionUUID->"30f23af8-6038-4069-8243-a8e8072685a3"],
Cell[12041, 306, 2542, 60, 298, "Input",ExpressionUUID->"2888b875-28ee-4f08-b551-05df1c125f41"],
Cell[14586, 368, 312, 5, 64, "Input",ExpressionUUID->"b28bdbbf-9e84-4f0f-9cc9-412f8abccedb"],
Cell[14901, 375, 336, 5, 64, "Input",ExpressionUUID->"6fdd5095-1718-4546-b971-15bac0990051"],
Cell[15240, 382, 979, 21, 116, "Input",ExpressionUUID->"e035627d-f7f6-4f0b-b74f-a562c8336cab"],
Cell[16222, 405, 370, 5, 37, "Input",ExpressionUUID->"d53916ef-b35f-45bb-9307-c0dcafb92ee4"],
Cell[16595, 412, 228, 4, 37, "Input",ExpressionUUID->"3bbf1e7d-920d-4b6a-b764-228095543844"],
Cell[16826, 418, 718, 13, 64, "Input",ExpressionUUID->"b0a7a7d7-6e01-463e-bb68-03ecfc5cd6c0"],
Cell[17547, 433, 152, 3, 37, "Input",ExpressionUUID->"b5a90dab-6546-43a5-b44b-426d50d3c017"],
Cell[17702, 438, 1061, 25, 90, "Input",ExpressionUUID->"d4271660-79d6-4a2b-8f75-9d299046b6e8"],
Cell[18766, 465, 200, 4, 37, "Input",ExpressionUUID->"4f5becb4-417d-44c0-a5db-9b4d6abe31ef"],
Cell[18969, 471, 388, 7, 64, "Input",ExpressionUUID->"ec170e6e-3cfc-4d72-98f6-a53ddb03fec0"],
Cell[19360, 480, 294, 6, 37, "Input",ExpressionUUID->"ba4bd127-e349-4d5a-9d76-82ba632deefb"],
Cell[19657, 488, 471, 9, 37, "Input",ExpressionUUID->"e5d99f81-f1c1-4728-8921-4e9ce80e78bc"],
Cell[20131, 499, 488, 11, 37, "Input",ExpressionUUID->"c48e6a3a-36ab-4126-8120-47b9b05e0bf5"],
Cell[20622, 512, 272, 6, 37, "Input",ExpressionUUID->"ff1dfa66-5872-4078-9774-d4aa40f7fca5"],
Cell[20897, 520, 323, 7, 37, "Input",ExpressionUUID->"83ffc50e-9817-40cb-a285-a67e2e7ec6a8"],
Cell[21223, 529, 152, 3, 37, "Input",ExpressionUUID->"6012e8ad-beaa-4242-b048-50a587909a58"],
Cell[21378, 534, 478, 9, 37, "Input",ExpressionUUID->"cc9ac178-06f9-4e51-9ff1-d63e640447f9"],
Cell[21859, 545, 295, 6, 37, "Input",ExpressionUUID->"7fd0b4b2-db22-4e4b-8fab-6a18b26b3c1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22191, 556, 150, 3, 84, "Section",ExpressionUUID->"72e79a29-293d-428d-900e-aee3ff3eef52"],
Cell[22344, 561, 240, 5, 37, "Input",ExpressionUUID->"64d267ef-c43d-4273-bbc2-c7b225c110ae"],
Cell[22587, 568, 459, 11, 64, "Input",ExpressionUUID->"f1ccf0d1-7fcd-455f-bbca-3b02b9ecda1d"],
Cell[23049, 581, 564, 15, 64, "Input",ExpressionUUID->"02a8f277-51a9-43db-b955-d2ef72edc09f"],
Cell[23616, 598, 305, 7, 37, "Input",ExpressionUUID->"514de941-f32a-49f7-b62c-1268e76de7a9"],
Cell[23924, 607, 317, 7, 37, "Input",ExpressionUUID->"88d221ca-4aaf-4a62-b156-5cd441faa68a"],
Cell[24244, 616, 11305, 299, 1702, "Code",ExpressionUUID->"be1d4434-4229-45b5-8319-40217b9e2b3d",
 InitializationCell->False],
Cell[35552, 917, 1204, 35, 45, "Code",ExpressionUUID->"3f7819bb-9a57-4c19-9a7c-c5427f84ed1d",
 InitializationCell->False],
Cell[36759, 954, 1496, 42, 45, "Code",ExpressionUUID->"634af7b2-4432-429a-8a36-51d501d307a2",
 InitializationCell->False],
Cell[38258, 998, 1195, 35, 45, "Code",ExpressionUUID->"c482c1db-7570-4ac3-a0bb-c14bd231ac15",
 InitializationCell->False],
Cell[39456, 1035, 1199, 35, 45, "Code",ExpressionUUID->"4ae19c32-ce9a-4581-9048-ab9d083a5402",
 InitializationCell->False],
Cell[40658, 1072, 17998, 497, 892, "Code",ExpressionUUID->"92577d8e-9722-4013-a231-538d93055e50",
 InitializationCell->False],
Cell[58659, 1571, 1992, 52, 70, "Code",ExpressionUUID->"54051711-0548-4c27-8083-c8cb0ff6e32f",
 InitializationCell->False],
Cell[60654, 1625, 2168, 57, 310, "Code",ExpressionUUID->"0163861e-1c73-483f-b8ba-48e215f9251f",
 InitializationCell->False],
Cell[62825, 1684, 11654, 276, 1318, "Code",ExpressionUUID->"05052288-97f2-4f6a-8c96-4f645d7747ed",
 InitializationCell->False],
Cell[74482, 1962, 697, 16, 45, "Code",ExpressionUUID->"abff1ddb-a713-415e-b8c9-891224985de6",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[75204, 1982, 512, 12, 64, "Input",ExpressionUUID->"85c4187b-d6ad-498b-b81a-02eb0f487243"],
Cell[75719, 1996, 2884, 67, 356, "Output",ExpressionUUID->"a5cea5be-f7e2-4506-b5b0-fc2818455b65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78640, 2068, 445, 10, 64, "Input",ExpressionUUID->"0b138d0a-8999-4253-8db8-38240d473d50"],
Cell[79088, 2080, 171, 2, 42, "Output",ExpressionUUID->"0440ed5e-94a7-48ad-aee3-0073d61411f5"]
}, Open  ]],
Cell[79274, 2085, 20136, 489, 1966, "Code",ExpressionUUID->"15e9698d-6d6a-451c-a0fc-ed57fa786cfb",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[99435, 2578, 445, 10, 64, "Input",ExpressionUUID->"9ca0d9a8-c707-41d2-ab25-512682ae9481"],
Cell[99883, 2590, 148, 2, 42, "Output",ExpressionUUID->"41186ea0-1380-4b8b-8a94-6d4af9eac509"]
}, Open  ]],
Cell[100046, 2595, 6879, 159, 1102, "Code",ExpressionUUID->"64e0a54a-4e8d-4e4a-904c-6a568ad0bcdb",
 InitializationCell->False],
Cell[106928, 2756, 683, 17, 45, "Code",ExpressionUUID->"3866a9bf-883e-45da-9eb9-504b148b20d5",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[107636, 2777, 445, 10, 64, "Input",ExpressionUUID->"8da0ba10-9393-49b4-8111-2274dfb963d2"],
Cell[108084, 2789, 151, 2, 42, "Output",ExpressionUUID->"8256f0ea-ff8f-4788-8ca5-0bf5f32b704f"]
}, Open  ]],
Cell[108250, 2794, 19488, 445, 2590, "Code",ExpressionUUID->"3b024d84-0992-409c-8e96-cc5346357892",
 InitializationCell->False],
Cell[127741, 3241, 730, 17, 45, "Code",ExpressionUUID->"2c3358bd-95d6-4ef4-89ad-4f6c9fd50c6a",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[128496, 3262, 445, 10, 64, "Input",ExpressionUUID->"9e7bd343-07f8-4880-9df1-087879af8d97"],
Cell[128944, 3274, 149, 2, 42, "Output",ExpressionUUID->"233b43ed-2784-4a3d-9c1c-d225a4edfa4a"]
}, Open  ]],
Cell[129108, 3279, 15711, 378, 1750, "Code",ExpressionUUID->"dc8474dc-f6e0-49cc-abbc-34a26d2e1d7a",
 InitializationCell->False],
Cell[144822, 3659, 685, 17, 45, "Code",ExpressionUUID->"d2b607e7-a18b-4e2d-84aa-330b1f146107",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[145532, 3680, 445, 10, 64, "Input",ExpressionUUID->"4c7208fa-5ce0-4540-83ca-23ae9485474b"],
Cell[145980, 3692, 151, 2, 62, "Output",ExpressionUUID->"5f18b343-e6fb-4409-9838-6ffdd98be1e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146168, 3699, 301, 7, 37, "Input",ExpressionUUID->"28955eba-19d4-4e85-9eed-8a8a94cafb27"],
Cell[146472, 3708, 171, 2, 42, "Output",ExpressionUUID->"ac97f1f3-0dee-4047-8638-29220fd74840"]
}, Open  ]],
Cell[146658, 3713, 3697, 112, 142, "Input",ExpressionUUID->"9cf98f8f-d038-4f16-bd8d-fb09fe113440"],
Cell[150358, 3827, 216, 6, 37, "Input",ExpressionUUID->"60c17552-5251-4a89-9e41-bfd1160eb2f8"],
Cell[150577, 3835, 7492, 188, 550, "Code",ExpressionUUID->"4e6bdd6c-3420-4278-ba52-f2451dfb4351",
 InitializationCell->False],
Cell[158072, 4025, 527, 13, 37, "Input",ExpressionUUID->"c43c3f4c-88d9-443b-b469-50f75da17b6c"],
Cell[CellGroupData[{
Cell[158624, 4042, 2512, 66, 118, "Code",ExpressionUUID->"56e91183-1a7e-4d1b-a238-c2371d3dcd52",
 InitializationCell->False],
Cell[161139, 4110, 158, 3, 42, "Output",ExpressionUUID->"0e672a37-da4d-45d1-9886-3232a4badedd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161334, 4118, 305, 8, 37, "Input",ExpressionUUID->"984f9dbe-bd43-46e6-975b-c84e866b34c5"],
Cell[161642, 4128, 204, 4, 42, "Output",ExpressionUUID->"e8b26647-9092-43a0-bc94-6d21650b8a3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161883, 4137, 331, 6, 37, "Input",ExpressionUUID->"6e8209c3-14ad-49a2-971c-e700bb627c68"],
Cell[162217, 4145, 291, 4, 42, "Output",ExpressionUUID->"6e1a2697-84e6-4003-9ecf-1395702b8e66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162545, 4154, 824, 21, 118, "Code",ExpressionUUID->"c31726bd-b890-410d-8926-cbe5a09b4f80",
 InitializationCell->False],
Cell[163372, 4177, 547, 12, 35, "Message",ExpressionUUID->"703f1237-1dbf-4b6a-9daa-e28031dcc5c0"],
Cell[163922, 4191, 219, 2, 42, "Output",ExpressionUUID->"052f888a-5a11-4519-8039-7987d5b0a0df"]
}, Open  ]]
}, Open  ]]
}
]
*)

