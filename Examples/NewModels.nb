(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44316,       1154]
NotebookOptionsPosition[     41321,       1102]
NotebookOutlinePosition[     41813,       1121]
CellTagsIndexPosition[     41770,       1118]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{
  "PacletUninstall", "[", "\"\<FernandoDuarte/LongRunRisk\>\"", 
   "]"}]}]], "Input",
 CellChangeTimes->{3.894967249978444*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"6b9e680b-4a99-4731-9818-5e7fd20f49c9"],

Cell[BoxData[
 RowBox[{"PacletInstall", "[", 
  RowBox[{
   RowBox[{
   "URL", "[", 
    "\"\<https://github.com/GitHub-at-Brown/LongRunRisk/releases/download/pre-\
release-1.0.0/FernandoDuarte__LongRunRisk-1.0.0.paclet\>\"", "]"}], ",", 
   RowBox[{"ForceVersionInstall", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.894964850462384*^9, 3.894964857857126*^9}, {
   3.894969948509913*^9, 3.8949699497304697`*^9}, 3.896007845564061*^9, {
   3.896023478952539*^9, 3.896023492651013*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"bc0429a6-583e-49be-ae64-5f1d2359956b"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<FernandoDuarte`LongRunRisk`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.894803831734251*^9, 3.894803832002036*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2d3118e8-e39a-4cb3-bd9f-0d897a89695c"],

Cell["Models available", "Section",
 CellChangeTimes->{{3.894966767158393*^9, 
  3.894966771371785*^9}},ExpressionUUID->"5de87f10-06a6-4365-8ff9-\
54a1cb560a3f"],

Cell[BoxData[
 RowBox[{"Keys", "[", "Models", "]"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"7a206616-5e38-485d-af3d-118ef115a8e5"],

Cell[BoxData[
 RowBox[{"Info", "[", "Models", "]"}]], "Input",
 CellChangeTimes->{{3.89491288089467*^9, 3.894912883395607*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8f9230b3-7db4-4700-bc56-696dd07e27fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m1", " ", "=", " ", 
    RowBox[{"Models", "[", "\"\<NRCStochVol\>\"", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"NRC", "+", 
    RowBox[{
    "stochastic", " ", "volatility", " ", "of", " ", "expected", " ", 
     "inflation"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m2", " ", "=", " ", 
    RowBox[{"Models", "[", "\"\<DES\>\"", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DES", " ", "with", " ", "long"}], "-", 
    RowBox[{
    "run", " ", "risk", " ", "exposed", " ", "to", " ", "inflation"}]}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8960121161798153`*^9, 3.896012173628414*^9}, {
  3.896021669546241*^9, 3.896021669834331*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"91e6ee1b-38d3-4632-a8f0-11dd27a68307"],

Cell[CellGroupData[{

Cell["NRC + stochastic volatility of expected inflation", "Section",
 CellChangeTimes->{{3.894880477741781*^9, 3.89488048559941*^9}, {
  3.896024729541792*^9, 
  3.896024731325005*^9}},ExpressionUUID->"02a5e353-41ba-49c0-8d60-\
d6e3e905d84d"],

Cell[CellGroupData[{

Cell["Yield Curve", "Subsection",
 CellChangeTimes->{{3.894961075812955*^9, 3.8949610785786743`*^9}, 
   3.894961272272238*^9, {3.896011986404636*^9, 3.896012028643808*^9}, {
   3.896024728964303*^9, 
   3.8960247321981297`*^9}},ExpressionUUID->"1871b2bc-619f-4a13-8cef-\
daf1ec73aeac"],

Cell[BoxData[{
 RowBox[{"meanYield", "=", 
  RowBox[{"Simplify", "@", 
   RowBox[{"UncondE", "[", 
    RowBox[{
     RowBox[{"bondyield", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"meanNomYield", "=", 
  RowBox[{"Simplify", "@", 
   RowBox[{"UncondE", "[", 
    RowBox[{
     RowBox[{"nombondyield", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanYieldCurve", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"100", "*", "meanYield"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"meanNomYieldCurve", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"100", "*", "meanNomYield"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8948805036022377`*^9, 3.894880510964974*^9}, {
   3.8948806118605833`*^9, 3.894880612087715*^9}, {3.8949229333014812`*^9, 
   3.894922942614452*^9}, {3.894923868666265*^9, 3.8949238690785646`*^9}, {
   3.89492401012253*^9, 3.894924011908758*^9}, {3.8949273189743032`*^9, 
   3.894927336652417*^9}, 3.894930040652605*^9, {3.8949305903825197`*^9, 
   3.8949305906212273`*^9}, {3.8949307259503183`*^9, 3.894930726212351*^9}, {
   3.894953661938447*^9, 3.8949536622113743`*^9}, 3.894961095633893*^9, 
   3.894961262482503*^9, 3.8949682501388693`*^9, {3.8960120354525433`*^9, 
   3.896012049996088*^9}, {3.896012104301118*^9, 3.896012109691464*^9}, {
   3.8960218226377983`*^9, 3.896021827751624*^9}, {3.896021869926173*^9, 
   3.896021876537633*^9}, {3.896022805327332*^9, 3.8960228602623253`*^9}, {
   3.896024191304358*^9, 3.896024193799419*^9}, {3.89602439702906*^9, 
   3.896024403741824*^9}, {3.896025530185431*^9, 
   3.8960256043051453`*^9}},ExpressionUUID->"ab37a0e7-b999-4c42-8283-\
fd2f208b8cd0"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sol0", " ", "=", 
   RowBox[{"m1", "[", "\"\<coeffsSolutionN\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solP0", "=", " ", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"m1", "[", "\"\<coeffsSolutionN\>\"", "]"}], ",", 
     RowBox[{"m1", "[", "\"\<params\>\"", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8960227258241177`*^9, 3.896022749305882*^9}, {
  3.896025012536397*^9, 3.896025021692801*^9}, {3.896025090657589*^9, 
  3.8960250952903633`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"49ef27de-d040-42fe-82a6-b4521e6c1fef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{"ToNum", "[", 
        RowBox[{
        "\"\<Rules\>\"", ",", "\[IndentingNewLine]", "m1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"delta", "\[Rule]", "deltaM"}], ",", 
           RowBox[{"Esg", "\[Rule]", "EsgM"}], ",", 
           RowBox[{"Esp", "\[Rule]", "EspM"}], ",", 
           RowBox[{"gamma", "\[Rule]", "gammaM"}], ",", 
           RowBox[{"muc", "\[Rule]", "mucM"}], ",", 
           RowBox[{"mupbar", "\[Rule]", "mupbarM"}], ",", 
           RowBox[{"phic", "\[Rule]", "phicM"}], ",", 
           RowBox[{"phig", "\[Rule]", "phigM"}], ",", 
           RowBox[{"phip", "\[Rule]", "phipM"}], ",", 
           RowBox[{"phipbarpb", "\[Rule]", "phipbarpbM"}], ",", 
           RowBox[{"phispw", "\[Rule]", "phispwM"}], ",", 
           RowBox[{"psi", "\[Rule]", "psiM"}], ",", 
           RowBox[{"rhocp", "\[Rule]", "rhocpM"}], ",", 
           RowBox[{"rhog", "\[Rule]", "rhogM"}], ",", 
           RowBox[{"rhopbar", "\[Rule]", "rhopbarM"}], ",", 
           RowBox[{"rhoppbar", "\[Rule]", "rhoppbarM"}], ",", 
           RowBox[{"vp", "\[Rule]", "vpM"}], ",", 
           RowBox[{"xic", "\[Rule]", "xicM"}], ",", 
           RowBox[{"xip", "\[Rule]", "xipM"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "sol0", ",", "\[IndentingNewLine]", " ", 
         RowBox[{"MaxIterations", "->", "500"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"meanYieldCurve", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Real\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Thick"}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Maturity in months\>\"", ",", "\"\<Yield\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nomyc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"meanNomYieldCurve", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Nominal\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "[", "Green", "]"}], ",", "Thick"}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"yc", ",", "nomyc"}], "]"}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltaM", ",", "0.99`"}], "}"}], ",", "0.9", ",", "0.99999`"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EsgM", ",", 
        RowBox[{"-", "0.00624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EspM", ",", "0.00111`"}], "}"}], ",", "0.00000001", ",", 
      "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gammaM", ",", "15"}], "}"}], ",", "1.5", ",", "75"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mucM", ",", "0.0016426`"}], "}"}], ",", "0.0", ",", "0.01"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mupbarM", ",", "0.00327532`"}], "}"}], ",", "0.0", ",", 
      "0.05"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phicM", ",", "0.00204654`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phigM", ",", "0.002927236529485`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipM", ",", 
        RowBox[{"-", "0.0024624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipbarpbM", ",", "1.5`"}], "}"}], ",", "0", ",", "7.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phispwM", ",", "1.81`*^-7"}], "}"}], ",", "1.0*^-12", ",", 
      "1.0`*^-5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"psiM", ",", "2"}], "}"}], ",", "0.5", ",", "5"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhocpM", ",", 
        RowBox[{"-", "0.0521066`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhogM", ",", "0.996289`"}], "}"}], ",", "0.01", ",", 
      "0.9999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhopbarM", ",", "0.9`"}], "}"}], ",", "0.01", ",", 
      "0.99999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhoppbarM", ",", "0.5`"}], "}"}], ",", "0", ",", "2.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vpM", ",", "0.979`"}], "}"}], ",", "0.01", ",", "0.99999"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xicM", ",", 
        RowBox[{"-", "0.198287`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xipM", ",", "0.00073007`"}], "}"}], ",", "0.00000001", ",", 
      "0.05"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"UnsavedVariables", "->", 
     RowBox[{"{", 
      RowBox[{"sol", ",", "yc", ",", "nomyc"}], "}"}]}], ",", 
    RowBox[{"SynchronousInitialization", "->", "False"}], ",", 
    RowBox[{"SynchronousUpdating", "->", "False"}], ",", 
    RowBox[{"ContinuousAction", "->", "False"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.896022672431493*^9, 3.896022699825124*^9}, {
   3.8960227594966383`*^9, 3.896022795302566*^9}, {3.8960228807313747`*^9, 
   3.8960230623138647`*^9}, {3.8960231527558517`*^9, 3.896023293285163*^9}, {
   3.896023783304031*^9, 3.89602381945719*^9}, 3.896023976752926*^9, {
   3.896024007353853*^9, 3.896024011706107*^9}, {3.89602408321813*^9, 
   3.896024087537364*^9}, 3.896024127025395*^9, {3.896024169618766*^9, 
   3.896024185849025*^9}, {3.8960242563807087`*^9, 3.8960242864561453`*^9}, {
   3.896024318903221*^9, 3.8960243489194183`*^9}, {3.896024418223051*^9, 
   3.8960244314649887`*^9}, {3.8960245135436497`*^9, 3.896024515491942*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5bebaa47-314b-47ff-b790-337663a2d48d"],

Cell["Variance Ratios for Inflation", "Subsection",
 CellChangeTimes->{{3.894968000603485*^9, 
  3.894968007008643*^9}},ExpressionUUID->"edb862e0-d42a-45c5-8231-\
d5a9e82c009b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varianceRatio", "[", 
   RowBox[{"horizon_", ",", "timeAggregation_", ",", "model_"}], "]"}], ":=", 
  
  FractionBox[
   RowBox[{"UncondVar", "[", 
    RowBox[{
     RowBox[{"Growth", "[", 
      RowBox[{"pi", ",", "t", ",", " ", 
       RowBox[{"\"\<numPeriods\>\"", "->", "horizon"}], ",", " ", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", " ", "timeAggregation"}]}], 
      "]"}], ",", "model"}], "]"}], 
   RowBox[{"horizon", "*", 
    RowBox[{"UncondVar", "[", 
     RowBox[{
      RowBox[{"Growth", "[", 
       RowBox[{"pi", ",", "t", ",", " ", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", " ", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", " ", "timeAggregation"}]}], 
       "]"}], ",", "model"}], "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.89496838108081*^9, 3.894968442640113*^9}, {
  3.894968489007152*^9, 3.894968535146727*^9}, {3.894969438068578*^9, 
  3.894969475360697*^9}, {3.896024810004261*^9, 3.896024815396006*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"27ace2cc-8855-47ff-acf0-46718917f35d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"h", "-", "1"}], ",", 
       RowBox[{"varianceRatio", "[", 
        RowBox[{"h", ",", "1", ",", "m1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "1", ",", "60", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.894969480719715*^9, 3.894969516578143*^9}, {
   3.89496960883569*^9, 3.89496960905063*^9}, {3.896024769547813*^9, 
   3.896024776306044*^9}, {3.896024822286059*^9, 3.896024842020152*^9}, 
   3.8960249174207697`*^9, {3.8960250462199097`*^9, 3.8960250504055357`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"265b2c73-d663-4ba3-8fc5-5418d45f7632"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vr", "//.", "sol0"}]], "Input",
 CellChangeTimes->{3.896024937893474*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"2a10ef07-8160-42ed-a018-942658acf237"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "2.3316877610879954`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "3.408311841761259`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "4.159194126183075`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"24", ",", "4.692725224634153`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "5.081046294484753`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"36", ",", "5.370727994621909`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"42", ",", "5.592053398368091`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"48", ",", "5.764999299827197`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"54", ",", "5.902968368677683`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.896025027373942*^9, 3.896025057080659*^9}, 
   3.896025247026877*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"69ffa5ae-7691-41c4-867a-6d7875dc4542"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"sol", "=", "\[IndentingNewLine]", 
       RowBox[{"ToNum", "[", 
        RowBox[{
        "\"\<Rules\>\"", ",", "\[IndentingNewLine]", "m1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"delta", "\[Rule]", "deltaM"}], ",", 
           RowBox[{"Esg", "\[Rule]", "EsgM"}], ",", 
           RowBox[{"Esp", "\[Rule]", "EspM"}], ",", 
           RowBox[{"gamma", "\[Rule]", "gammaM"}], ",", 
           RowBox[{"muc", "\[Rule]", "mucM"}], ",", 
           RowBox[{"mupbar", "\[Rule]", "mupbarM"}], ",", 
           RowBox[{"phic", "\[Rule]", "phicM"}], ",", 
           RowBox[{"phig", "\[Rule]", "phigM"}], ",", 
           RowBox[{"phip", "\[Rule]", "phipM"}], ",", 
           RowBox[{"phipbarpb", "\[Rule]", "phipbarpbM"}], ",", 
           RowBox[{"phispw", "\[Rule]", "phispwM"}], ",", 
           RowBox[{"psi", "\[Rule]", "psiM"}], ",", 
           RowBox[{"rhocp", "\[Rule]", "rhocpM"}], ",", 
           RowBox[{"rhog", "\[Rule]", "rhogM"}], ",", 
           RowBox[{"rhopbar", "\[Rule]", "rhopbarM"}], ",", 
           RowBox[{"rhoppbar", "\[Rule]", "rhoppbarM"}], ",", 
           RowBox[{"vp", "\[Rule]", "vpM"}], ",", 
           RowBox[{"xic", "\[Rule]", "xicM"}], ",", 
           RowBox[{"xip", "\[Rule]", "xipM"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "sol0", ",", "\[IndentingNewLine]", " ", 
         RowBox[{"MaxIterations", "->", "500"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<initialGuess\>\"", "\[Rule]", 
          RowBox[{"\[LeftAssociation]", 
           RowBox[{"\"\<Ewc\>\"", "\[Rule]", 
            RowBox[{"{", "4.6", "}"}]}], "\[RightAssociation]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"vrh", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"vr", "//.", "sol"}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"{", "\"\<Variance ratio\>\"", "}"}]}], ",", " ", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Orange", ",", "Thick"}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Horizon\>\"", ",", "\"\<Ratio\>\""}], "}"}]}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "vrh", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"deltaM", ",", "0.99`"}], "}"}], ",", "0.9", ",", "0.99999`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EsgM", ",", 
       RowBox[{"-", "0.00624`"}]}], "}"}], ",", 
     RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EspM", ",", "0.00111`"}], "}"}], ",", "0.00000001", ",", 
     "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gammaM", ",", "15"}], "}"}], ",", "1.5", ",", "75"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mucM", ",", "0.0016426`"}], "}"}], ",", "0.0", ",", "0.01"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mupbarM", ",", "0.00327532`"}], "}"}], ",", "0.0", ",", 
     "0.05"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phicM", ",", "0.00204654`"}], "}"}], ",", 
     RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phigM", ",", "0.002927236529485`"}], "}"}], ",", 
     RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phipM", ",", 
       RowBox[{"-", "0.0024624`"}]}], "}"}], ",", 
     RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phipbarpbM", ",", "1.5`"}], "}"}], ",", "0", ",", "7.5`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"phispwM", ",", "1.81`*^-7"}], "}"}], ",", "1.0*^-12", ",", 
     "1.0`*^-5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"psiM", ",", "2"}], "}"}], ",", "0.5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rhocpM", ",", 
       RowBox[{"-", "0.0521066`"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rhogM", ",", "0.996289`"}], "}"}], ",", "0.01", ",", 
     "0.9999"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rhopbarM", ",", "0.9`"}], "}"}], ",", "0.01", ",", "0.99999"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rhoppbarM", ",", "0.5`"}], "}"}], ",", "0", ",", "2.5`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vpM", ",", "0.979`"}], "}"}], ",", "0.01", ",", "0.99999"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xicM", ",", 
       RowBox[{"-", "0.198287`"}]}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xipM", ",", "0.00073007`"}], "}"}], ",", "0.00000001", ",", 
     "0.05"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"UnsavedVariables", "->", 
    RowBox[{"{", 
     RowBox[{"sol", ",", "vrh"}], "}"}]}], ",", 
   RowBox[{"SynchronousInitialization", "->", "False"}], ",", 
   RowBox[{"SynchronousUpdating", "->", "False"}], ",", 
   RowBox[{"ContinuousAction", "->", "False"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.896024852464416*^9, 3.896024887347872*^9}, {
  3.8960252993036337`*^9, 3.896025315980719*^9}, {3.8960253973724403`*^9, 
  3.8960253978802023`*^9}, {3.8960254285509167`*^9, 3.8960255000766563`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"923835e7-f31d-4c64-a173-af4707275ab3"],

Cell[CellGroupData[{

Cell["Covariance of yields and stock returns", "Subsection",
 CellChangeTimes->{{3.89602562345885*^9, 3.896025627773714*^9}, {
  3.8960263027459307`*^9, 
  3.8960263035770206`*^9}},ExpressionUUID->"b1eb18a4-daba-4713-af26-\
58c8fae0cf9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"realNRC", "=", 
   RowBox[{
    RowBox[{"UncondCov", "[", 
     RowBox[{
      RowBox[{"bondyield", "[", 
       RowBox[{"t", ",", "m"}], "]"}], ",", 
      RowBox[{"ret", "[", 
       RowBox[{"t", ",", "1"}], "]"}], ",", "m1"}], "]"}], "/", 
    RowBox[{"UncondVar", "[", 
     RowBox[{
      RowBox[{"bondyield", "[", 
       RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nomNRC", "=", 
    RowBox[{
     RowBox[{"UncondCov", "[", 
      RowBox[{
       RowBox[{"nombondyield", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", 
       RowBox[{"ret", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", "m1"}], "]"}], "/", 
     RowBox[{"UncondVar", "[", 
      RowBox[{
       RowBox[{"nombondyield", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yieldCurveNRC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "realNRC"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nomYieldCurveNRC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "nomNRC"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8960256881021833`*^9, 3.896025707671872*^9}, {
   3.896025832909362*^9, 3.896025838611642*^9}, {3.896026139499865*^9, 
   3.896026156538024*^9}, 3.8960262052967052`*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"533efc97-58d3-40d2-bcee-92412aa4213c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol0", " ", "=", 
   RowBox[{"m1", "[", "\"\<coeffsSolutionN\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"1bd8b0f5-13bd-4676-abb2-ae0eccc8b648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{"ToNum", "[", 
        RowBox[{
        "\"\<Rules\>\"", ",", "\[IndentingNewLine]", "m1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"delta", "\[Rule]", "deltaM"}], ",", 
           RowBox[{"Esg", "\[Rule]", "EsgM"}], ",", 
           RowBox[{"Esp", "\[Rule]", "EspM"}], ",", 
           RowBox[{"gamma", "\[Rule]", "gammaM"}], ",", 
           RowBox[{"muc", "\[Rule]", "mucM"}], ",", 
           RowBox[{"mupbar", "\[Rule]", "mupbarM"}], ",", 
           RowBox[{"phic", "\[Rule]", "phicM"}], ",", 
           RowBox[{"phig", "\[Rule]", "phigM"}], ",", 
           RowBox[{"phip", "\[Rule]", "phipM"}], ",", 
           RowBox[{"phipbarpb", "\[Rule]", "phipbarpbM"}], ",", 
           RowBox[{"phispw", "\[Rule]", "phispwM"}], ",", 
           RowBox[{"psi", "\[Rule]", "psiM"}], ",", 
           RowBox[{"rhocp", "\[Rule]", "rhocpM"}], ",", 
           RowBox[{"rhog", "\[Rule]", "rhogM"}], ",", 
           RowBox[{"rhopbar", "\[Rule]", "rhopbarM"}], ",", 
           RowBox[{"rhoppbar", "\[Rule]", "rhoppbarM"}], ",", 
           RowBox[{"vp", "\[Rule]", "vpM"}], ",", 
           RowBox[{"xic", "\[Rule]", "xicM"}], ",", 
           RowBox[{"xip", "\[Rule]", "xipM"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "sol0", ",", "\[IndentingNewLine]", " ", 
         RowBox[{"MaxIterations", "->", "500"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"yieldCurveNRC", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Real\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Thick"}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Maturity in months\>\"", ",", "\"\<Covariance/Variance\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nomyc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"nomYieldCurveNRC", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Nominal\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "[", "Green", "]"}], ",", "Thick"}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"yc", ",", "nomyc", ",", 
       RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltaM", ",", "0.99`"}], "}"}], ",", "0.9", ",", "0.99999`"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EsgM", ",", 
        RowBox[{"-", "0.00624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EspM", ",", "0.00111`"}], "}"}], ",", "0.00000001", ",", 
      "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gammaM", ",", "15"}], "}"}], ",", "1.5", ",", "75"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mucM", ",", "0.0016426`"}], "}"}], ",", "0.0", ",", "0.01"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mupbarM", ",", "0.00327532`"}], "}"}], ",", "0.0", ",", 
      "0.05"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phicM", ",", "0.00204654`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phigM", ",", "0.002927236529485`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipM", ",", 
        RowBox[{"-", "0.0024624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipbarpbM", ",", "1.5`"}], "}"}], ",", "0", ",", "7.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phispwM", ",", "1.81`*^-7"}], "}"}], ",", "1.0*^-12", ",", 
      "1.0`*^-5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"psiM", ",", "2"}], "}"}], ",", "0.5", ",", "5"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhocpM", ",", 
        RowBox[{"-", "0.0521066`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhogM", ",", "0.996289`"}], "}"}], ",", "0.01", ",", 
      "0.9999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhopbarM", ",", "0.9`"}], "}"}], ",", "0.01", ",", 
      "0.99999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhoppbarM", ",", "0.5`"}], "}"}], ",", "0", ",", "2.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vpM", ",", "0.979`"}], "}"}], ",", "0.01", ",", "0.99999"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xicM", ",", 
        RowBox[{"-", "0.198287`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xipM", ",", "0.00073007`"}], "}"}], ",", "0.00000001", ",", 
      "0.05"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"UnsavedVariables", "->", 
     RowBox[{"{", 
      RowBox[{"sol", ",", "yc", ",", "nomyc"}], "}"}]}], ",", 
    RowBox[{"SynchronousInitialization", "->", "False"}], ",", 
    RowBox[{"SynchronousUpdating", "->", "False"}], ",", 
    RowBox[{"ContinuousAction", "->", "False"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.896022672431493*^9, 3.896022699825124*^9}, {
   3.8960227594966383`*^9, 3.896022795302566*^9}, {3.8960228807313747`*^9, 
   3.8960230623138647`*^9}, {3.8960231527558517`*^9, 3.896023293285163*^9}, {
   3.896023783304031*^9, 3.89602381945719*^9}, 3.896023976752926*^9, {
   3.896024007353853*^9, 3.896024011706107*^9}, {3.89602408321813*^9, 
   3.896024087537364*^9}, 3.896024127025395*^9, {3.896024169618766*^9, 
   3.896024185849025*^9}, {3.8960242563807087`*^9, 3.8960242864561453`*^9}, {
   3.896024318903221*^9, 3.8960243489194183`*^9}, {3.896024418223051*^9, 
   3.8960244314649887`*^9}, {3.8960245135436497`*^9, 3.896024515491942*^9}, {
   3.896025727884159*^9, 3.896025737056219*^9}, {3.89602618735502*^9, 
   3.896026194947616*^9}, {3.89602624963317*^9, 3.896026253359852*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"67b56d5d-75b4-494e-9483-ba4fd1bd5151"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Covariance of bond returns and stock returns", "Subsection",
 CellChangeTimes->{{3.89602562345885*^9, 3.896025627773714*^9}, {
  3.896026294544671*^9, 
  3.896026298296212*^9}},ExpressionUUID->"479513c2-e773-4c34-b190-\
4d6c79fb27cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"realNRC", "=", 
   RowBox[{
    RowBox[{"UncondCov", "[", 
     RowBox[{
      RowBox[{"bondret", "[", 
       RowBox[{"t", ",", "m"}], "]"}], ",", 
      RowBox[{"ret", "[", 
       RowBox[{"t", ",", "1"}], "]"}], ",", "m1"}], "]"}], "/", 
    RowBox[{"UncondVar", "[", 
     RowBox[{
      RowBox[{"bondret", "[", 
       RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nomNRC", "=", 
    RowBox[{
     RowBox[{"UncondCov", "[", 
      RowBox[{
       RowBox[{"nombondret", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", 
       RowBox[{"ret", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", "m1"}], "]"}], "/", 
     RowBox[{"UncondVar", "[", 
      RowBox[{
       RowBox[{"nombondret", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", "m1"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yieldCurveNRC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "realNRC"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nomYieldCurveNRC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "nomNRC"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "120", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8960256881021833`*^9, 3.896025707671872*^9}, {
   3.896025832909362*^9, 3.896025838611642*^9}, {3.896026139499865*^9, 
   3.896026156538024*^9}, 3.8960262052967052`*^9, {3.896026307817583*^9, 
   3.8960263182972603`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"38dca7e9-3dda-4bfb-bae4-1e6f0a646d68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol0", " ", "=", 
   RowBox[{"m1", "[", "\"\<coeffsSolutionN\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"b9f626d6-a792-4e39-841a-b12db4a8bfe9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
       RowBox[{"ToNum", "[", 
        RowBox[{
        "\"\<Rules\>\"", ",", "\[IndentingNewLine]", "m1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"delta", "\[Rule]", "deltaM"}], ",", 
           RowBox[{"Esg", "\[Rule]", "EsgM"}], ",", 
           RowBox[{"Esp", "\[Rule]", "EspM"}], ",", 
           RowBox[{"gamma", "\[Rule]", "gammaM"}], ",", 
           RowBox[{"muc", "\[Rule]", "mucM"}], ",", 
           RowBox[{"mupbar", "\[Rule]", "mupbarM"}], ",", 
           RowBox[{"phic", "\[Rule]", "phicM"}], ",", 
           RowBox[{"phig", "\[Rule]", "phigM"}], ",", 
           RowBox[{"phip", "\[Rule]", "phipM"}], ",", 
           RowBox[{"phipbarpb", "\[Rule]", "phipbarpbM"}], ",", 
           RowBox[{"phispw", "\[Rule]", "phispwM"}], ",", 
           RowBox[{"psi", "\[Rule]", "psiM"}], ",", 
           RowBox[{"rhocp", "\[Rule]", "rhocpM"}], ",", 
           RowBox[{"rhog", "\[Rule]", "rhogM"}], ",", 
           RowBox[{"rhopbar", "\[Rule]", "rhopbarM"}], ",", 
           RowBox[{"rhoppbar", "\[Rule]", "rhoppbarM"}], ",", 
           RowBox[{"vp", "\[Rule]", "vpM"}], ",", 
           RowBox[{"xic", "\[Rule]", "xicM"}], ",", 
           RowBox[{"xip", "\[Rule]", "xipM"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "sol0", ",", "\[IndentingNewLine]", " ", 
         RowBox[{"MaxIterations", "->", "500"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"yieldCurveNRC", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Real\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", "Thick"}], "}"}]}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Maturity in months\>\"", ",", "\"\<Covariance/Variance\>\""}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nomyc", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{
        RowBox[{"nomYieldCurveNRC", "//.", "sol"}], ",", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<Nominal\>\"", "}"}]}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "[", "Green", "]"}], ",", "Thick"}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"yc", ",", "nomyc", ",", 
       RowBox[{"PlotRange", "->", "Full"}]}], "]"}]}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltaM", ",", "0.99`"}], "}"}], ",", "0.9", ",", "0.99999`"}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EsgM", ",", 
        RowBox[{"-", "0.00624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EspM", ",", "0.00111`"}], "}"}], ",", "0.00000001", ",", 
      "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gammaM", ",", "15"}], "}"}], ",", "1.5", ",", "75"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mucM", ",", "0.0016426`"}], "}"}], ",", "0.0", ",", "0.01"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mupbarM", ",", "0.00327532`"}], "}"}], ",", "0.0", ",", 
      "0.05"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phicM", ",", "0.00204654`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phigM", ",", "0.002927236529485`"}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipM", ",", 
        RowBox[{"-", "0.0024624`"}]}], "}"}], ",", 
      RowBox[{"-", "0.01"}], ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phipbarpbM", ",", "1.5`"}], "}"}], ",", "0", ",", "7.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"phispwM", ",", "1.81`*^-7"}], "}"}], ",", "1.0*^-12", ",", 
      "1.0`*^-5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"psiM", ",", "2"}], "}"}], ",", "0.5", ",", "5"}], "}"}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhocpM", ",", 
        RowBox[{"-", "0.0521066`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhogM", ",", "0.996289`"}], "}"}], ",", "0.01", ",", 
      "0.9999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhopbarM", ",", "0.9`"}], "}"}], ",", "0.01", ",", 
      "0.99999"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhoppbarM", ",", "0.5`"}], "}"}], ",", "0", ",", "2.5`"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vpM", ",", "0.979`"}], "}"}], ",", "0.01", ",", "0.99999"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xicM", ",", 
        RowBox[{"-", "0.198287`"}]}], "}"}], ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xipM", ",", "0.00073007`"}], "}"}], ",", "0.00000001", ",", 
      "0.05"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"UnsavedVariables", "->", 
     RowBox[{"{", 
      RowBox[{"sol", ",", "yc", ",", "nomyc"}], "}"}]}], ",", 
    RowBox[{"SynchronousInitialization", "->", "False"}], ",", 
    RowBox[{"SynchronousUpdating", "->", "False"}], ",", 
    RowBox[{"ContinuousAction", "->", "False"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.896022672431493*^9, 3.896022699825124*^9}, {
   3.8960227594966383`*^9, 3.896022795302566*^9}, {3.8960228807313747`*^9, 
   3.8960230623138647`*^9}, {3.8960231527558517`*^9, 3.896023293285163*^9}, {
   3.896023783304031*^9, 3.89602381945719*^9}, 3.896023976752926*^9, {
   3.896024007353853*^9, 3.896024011706107*^9}, {3.89602408321813*^9, 
   3.896024087537364*^9}, 3.896024127025395*^9, {3.896024169618766*^9, 
   3.896024185849025*^9}, {3.8960242563807087`*^9, 3.8960242864561453`*^9}, {
   3.896024318903221*^9, 3.8960243489194183`*^9}, {3.896024418223051*^9, 
   3.8960244314649887`*^9}, {3.8960245135436497`*^9, 3.896024515491942*^9}, {
   3.896025727884159*^9, 3.896025737056219*^9}, {3.89602618735502*^9, 
   3.896026194947616*^9}, {3.89602624963317*^9, 3.896026253359852*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"b687014f-9152-4f35-811e-6f5033eeee11"]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1418, 849},
WindowMargins->{{240, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9bd92503-43aa-406b-8799-62c92c3f1f1e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 255, 6, 37, "Input",ExpressionUUID->"6b9e680b-4a99-4731-9818-5e7fd20f49c9"],
Cell[816, 28, 575, 11, 116, "Input",ExpressionUUID->"bc0429a6-583e-49be-ae64-5f1d2359956b"],
Cell[1394, 41, 234, 3, 37, "Input",ExpressionUUID->"2d3118e8-e39a-4cb3-bd9f-0d897a89695c"],
Cell[1631, 46, 161, 3, 84, "Section",ExpressionUUID->"5de87f10-06a6-4365-8ff9-54a1cb560a3f"],
Cell[1795, 51, 140, 2, 31, "Input",ExpressionUUID->"7a206616-5e38-485d-af3d-118ef115a8e5"],
Cell[1938, 55, 206, 3, 37, "Input",ExpressionUUID->"8f9230b3-7db4-4700-bc56-696dd07e27fe"],
Cell[2147, 60, 850, 22, 90, "Input",ExpressionUUID->"91e6ee1b-38d3-4632-a8f0-11dd27a68307"],
Cell[CellGroupData[{
Cell[3022, 86, 242, 4, 84, "Section",ExpressionUUID->"02a5e353-41ba-49c0-8d60-d6e3e905d84d"],
Cell[CellGroupData[{
Cell[3289, 94, 286, 5, 67, "Subsection",ExpressionUUID->"1871b2bc-619f-4a13-8cef-daf1ec73aeac"],
Cell[3578, 101, 2094, 49, 116, "Input",ExpressionUUID->"ab37a0e7-b999-4c42-8283-fd2f208b8cd0"]
}, Open  ]]
}, Open  ]],
Cell[5699, 154, 613, 14, 64, "Input",ExpressionUUID->"49ef27de-d040-42fe-82a6-b4521e6c1fef"],
Cell[6315, 170, 6914, 177, 636, "Input",ExpressionUUID->"5bebaa47-314b-47ff-b790-337663a2d48d"],
Cell[13232, 349, 177, 3, 67, "Subsection",ExpressionUUID->"edb862e0-d42a-45c5-8231-d5a9e82c009b"],
Cell[13412, 354, 1072, 24, 85, "Input",ExpressionUUID->"27ace2cc-8855-47ff-acf0-46718917f35d"],
Cell[14487, 380, 736, 17, 37, "Input",ExpressionUUID->"265b2c73-d663-4ba3-8fc5-5418d45f7632"],
Cell[CellGroupData[{
Cell[15248, 401, 176, 3, 37, "Input",ExpressionUUID->"2a10ef07-8160-42ed-a018-942658acf237"],
Cell[15427, 406, 976, 25, 69, "Output",ExpressionUUID->"69ffa5ae-7691-41c4-867a-6d7875dc4542"]
}, Open  ]],
Cell[16418, 434, 6095, 163, 610, "Input",ExpressionUUID->"923835e7-f31d-4c64-a173-af4707275ab3"],
Cell[CellGroupData[{
Cell[22538, 601, 238, 4, 67, "Subsection",ExpressionUUID->"b1eb18a4-daba-4713-af26-58c8fae0cf9b"],
Cell[22779, 607, 1757, 51, 142, "Input",ExpressionUUID->"533efc97-58d3-40d2-bcee-92412aa4213c"],
Cell[24539, 660, 206, 4, 37, "Input",ExpressionUUID->"1bd8b0f5-13bd-4676-abb2-ae0eccc8b648"],
Cell[24748, 666, 7132, 181, 636, "Input",ExpressionUUID->"67b56d5d-75b4-494e-9483-ba4fd1bd5151"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31917, 852, 240, 4, 67, "Subsection",ExpressionUUID->"479513c2-e773-4c34-b190-4d6c79fb27cd"],
Cell[32160, 858, 1801, 52, 142, "Input",ExpressionUUID->"38dca7e9-3dda-4bfb-bae4-1e6f0a646d68"],
Cell[33964, 912, 206, 4, 37, "Input",ExpressionUUID->"b9f626d6-a792-4e39-841a-b12db4a8bfe9"],
Cell[34173, 918, 7132, 181, 636, "Input",ExpressionUUID->"b687014f-9152-4f35-811e-6f5033eeee11"]
}, Open  ]]
}
]
*)

