(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1017814,      26262]
NotebookOptionsPosition[    988077,      25899]
NotebookOutlinePosition[    988525,      25917]
CellTagsIndexPosition[    988482,      25914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEnd", ",", " ", 
   RowBox[{
   "\"\<ClearEvaluationQueueOnKernelQuit\>\"", " ", "->", " ", "False"}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"d7471f33-46e7-4d7e-b07b-17407cb1fb64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.910223684493947*^9, 3.9102236872051086`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"463cf0d1-60b9-43e6-87cd-bb9bd9569e3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{
   "PacletUninstall", "[", "\"\<FernandoDuarte/LongRunRisk\>\"", "]"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", " ", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PacletTools`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"built", "=", 
   RowBox[{"PacletBuild", "[", "pacletDir", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"installed", "=", 
   RowBox[{"PacletInstall", "[", 
    RowBox[{"built", "[", "\"\<PacletArchive\>\"", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.910223375175461*^9, 3.910223382882806*^9}, {
   3.910223422462421*^9, 3.9102234570391417`*^9}, {3.910223658622826*^9, 
   3.910223661689867*^9}, 3.910223704469796*^9, {3.910223948687858*^9, 
   3.910223949084873*^9}, 3.910223999444728*^9, {3.910225017033011*^9, 
   3.91022502400035*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e29a71cc-2a46-412d-903e-7389bc2b352e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Catalog", "Section",
 CellChangeTimes->{
  3.906296861115862*^9},ExpressionUUID->"24d8431e-89a7-41b2-8075-\
95f8985b90c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"aa28dca4-9d13-4fc9-8219-9f5c1ccb4e5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.906297111478962*^9, {3.9062972113554697`*^9, 3.906297212850051*^9}, 
   3.906297285570588*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"3db88f77-f9fc-45a2-9130-a352f3076129"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891314843074428*^9, 3.8913148458084183`*^9}, {
   3.906297173666102*^9, 3.9062971868598337`*^9}, 3.906297219485413*^9, {
   3.9062972864717493`*^9, 3.906297288810418*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b53e2382-cadd-402b-bb88-9a68821c32c4"],

Cell[BoxData[{
 RowBox[{"packageFileName", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DirectoryName", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
     "\"\<Kernel\>\"", ",", "\"\<Model\>\"", ",", 
     RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Model`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.906297223611237*^9, 3.906297246707427*^9}, 3.906297290793303*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"0cd0595a-d93f-4afc-b0af-1bb84c846cde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Keys", " ", "are", " ", "strings"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"StringQ", "/@", 
     RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.89000889839254*^9, {3.890016339728188*^9, 3.890016342139681*^9}, {
   3.893004161637231*^9, 3.893004161876924*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"633303b2-0ff3-4c63-a8fa-47f0ca61811c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"string", " ", "fields"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"StringQ", "/@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"models", "[", "#", "]"}], "[", "\"\<name\>\"", "]"}], 
           ",", 
           RowBox[{
            RowBox[{"models", "[", "#", "]"}], "[", "\"\<shortname\>\"", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"models", "[", "#", "]"}], "[", "\"\<bibRef\>\"", "]"}], 
           ",", 
           RowBox[{
            RowBox[{"models", "[", "#", "]"}], "[", "\"\<desc\>\"", "]"}]}], 
          "}"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.890008770382118*^9, 3.890008858894733*^9}, {
  3.890016345133547*^9, 3.8900163569166937`*^9}, {3.893003226448749*^9, 
  3.8930032321343946`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"e4e0c400-759e-42fa-bd29-fefc22b8b1e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"parameters", " ", "evaluate", " ", "to", " ", "numbers"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"NumberQ", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"models", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
            "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "//.", 
          RowBox[{
           RowBox[{"models", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
           "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Keys", "[", "models", "]"}]}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.893002442739602*^9, 3.8930024527246227`*^9}, {
  3.893003235556836*^9, 3.893003243137875*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cb0ace6d-d6ed-4085-b883-a5bba8ac3a04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"can", " ", "find", " ", "some", " ", "models"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Keys", "[", "models", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
     
     RowBox[{"{", 
      RowBox[{"\"\<BY\>\"", ",", "\"\<BKY\>\""}], "}"}]}], ")"}]}]}]], "Input",\

 CellChangeTimes->{{3.8900087062162313`*^9, 3.890008740193614*^9}, {
  3.89001637048425*^9, 3.890016372993977*^9}, {3.893003256321348*^9, 
  3.893003261862228*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"e429a653-6ec5-4a83-a773-17648bbde990"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"models", " ", "is", " ", "an", " ", "association"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{"models", ",", "AssociationQ"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "each", " ", "model", " ", "inside", " ", "models", " ", "is", " ", "an", 
     " ", "association"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"models", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "models", "]"}]}], ",", "AssociationQ"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8900086430073547`*^9, 3.890008684982678*^9}, {
  3.890010177349143*^9, 3.890010179091837*^9}, {3.8900163791247263`*^9, 
  3.890016449580503*^9}, {3.893003265285705*^9, 3.893003296133358*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"2244a6f7-49f2-4384-8733-fd7551766553"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "exogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "#", "===", 
             "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}]\
, ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Context", "/@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"models", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
               "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                  ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}],
              "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
     RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.893001201934902*^9, 3.893001214021667*^9}, {
   3.893001245798745*^9, 3.8930012743606873`*^9}, {3.893001352341578*^9, 
   3.893001386197197*^9}, {3.893001448430169*^9, 3.893001448726687*^9}, 
   3.8930026482885447`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"c44e9ffe-0fc3-4e47-b1bf-d23b7cac6ded"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "shocks", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "#", "===", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
            ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Context", "/@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"models", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
               "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"var_Symbol", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
           ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
     RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.893001499960679*^9, {3.893002667440094*^9, 3.89300269939427*^9}, {
   3.893003083367228*^9, 3.893003083692607*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1d9dbe3d-5af4-49fd-8375-18289d763ad9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "parameters", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\"\<parameters\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "#", "===", 
              "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], ")"}],
             "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Context", "/@", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"models", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
                "]"}], ",", 
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                  ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], ")"}]}],
           ")"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "#", "===", 
              "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], ")"}],
             "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Context", "/@", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"models", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
                "]"}], ",", 
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                  ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], ")"}]}],
           ")"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.893001501399847*^9, {3.893002703969759*^9, 3.893002740019191*^9}, {
   3.893003056880762*^9, 3.893003109272599*^9}, {3.893003787588058*^9, 
   3.893003788104986*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"9a046d71-541d-4fc3-b16f-5e530fc212c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "state", " ", "variables", " ", "do", " ", "not", " ", "have", " ", "any", 
    " ", "endogenous", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"models", "[", "#", "]"}], "[", "\"\<stateVars\>\"", "]"}],
           ",", 
          RowBox[{
           RowBox[{
            RowBox[{"var_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                  "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                 RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
              ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", "models", "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.89300111387222*^9, 3.8930011727459707`*^9}, {
   3.893001247830225*^9, 3.893001299678648*^9}, {3.893001353751255*^9, 
   3.8930015072417727`*^9}, {3.893002707727394*^9, 3.893002708411419*^9}, {
   3.893002748062245*^9, 3.893002826831513*^9}, 3.89300297523416*^9, {
   3.893003086535989*^9, 3.893003086763905*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"1514c1cf-7fe2-4195-bfb6-e4ab6ab2a224"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"modelsExtraInfo", " ", "is", " ", "an", " ", "association"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{"modelsExtraInfo", ",", "AssociationQ"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "each", " ", "model", " ", "inside", " ", "modelsExtraInfo", " ", "is", 
     " ", "an", " ", "association"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"modelsExtraInfo", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "modelsExtraInfo", "]"}]}], ",", "AssociationQ"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.901353583738072*^9, 3.901353594897225*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d5b835a2-ce19-4542-828e-1a210e6e8a13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "models", " ", "in", " ", "modelsExtraInfo", " ", "are", " ", "a", " ", 
    "subset", " ", "of", " ", "those", " ", "defined", " ", "in", " ", 
    "models"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SubsetQ", "[", 
   RowBox[{
    RowBox[{"Keys", "[", "models", "]"}], ",", 
    RowBox[{"Keys", "[", "modelsExtraInfo", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.901353606406434*^9, 3.901353651160013*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"b65bd1d1-5e8f-458b-af2f-953d92e580d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"if", " ", "provided"}], ",", " ", 
    RowBox[{
     RowBox[{
     "initial", " ", "guess", " ", "for", " ", "Ewc", " ", "is", " ", "a", 
      " ", "vector", " ", "and", " ", "for", " ", "Epd", " ", "is", " ", 
      "2"}], "-", 
     RowBox[{"dimensional", " ", "array"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{
            RowBox[{"modelsExtraInfo", "[", "#", "]"}], ",", 
            "\"\<initialGuess\>\""}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"modelsExtraInfo", "[", "#", "]"}], "[", 
                 "\"\<initialGuess\>\"", "]"}], ",", "\"\<Ewc\>\""}], "]"}], 
              ",", 
              RowBox[{"VectorQ", "[", 
               RowBox[{"\"\<Ewc\>\"", "/.", 
                RowBox[{
                 RowBox[{"modelsExtraInfo", "[", "#", "]"}], "[", 
                 "\"\<initialGuess\>\"", "]"}]}], "]"}], " ", ",", "True"}], 
             "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"modelsExtraInfo", "[", "#", "]"}], "[", 
                 "\"\<initialGuess\>\"", "]"}], ",", "\"\<Epd\>\""}], "]"}], 
              ",", 
              RowBox[{"ArrayQ", "[", 
               RowBox[{
                RowBox[{"\"\<Epd\>\"", "/.", 
                 RowBox[{
                  RowBox[{"modelsExtraInfo", "[", "#", "]"}], "[", 
                  "\"\<initialGuess\>\"", "]"}]}], ",", "2"}], "]"}], " ", 
              ",", "True"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "True"}], 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       RowBox[{"Keys", "[", "modelsExtraInfo", "]"}]}], "\[IndentingNewLine]",
       ")"}]}], "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellChangeTimes->{{3.901353710509602*^9, 3.901353858822919*^9}, {
   3.901353922804742*^9, 3.9013539583277817`*^9}, {3.9013540371889668`*^9, 
   3.901354054019368*^9}, {3.901354592688126*^9, 3.901354622947588*^9}, {
   3.90135498400948*^9, 3.901354986990878*^9}, 3.905697389007025*^9, {
   3.905697427905238*^9, 3.905697428289213*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8c499e00-7829-4cf9-94df-42cd4c259f51"]
}, Closed]],

Cell[CellGroupData[{

Cell["ComputeConditionalExpectations", "Section",
 CellChangeTimes->{
  3.9062968623658113`*^9},ExpressionUUID->"6db5d835-4bf0-46ac-85fb-\
c9b0b479b4f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9062969449311543`*^9, 3.906296947200609*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4157ec9c-33d2-4fc8-9718-e1821f036f77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"70a27cf4-7b46-490f-8395-488640c81674"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, 3.9062972487285233`*^9, {
   3.906297304800356*^9, 3.90629730707056*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"dfcfd47b-ae99-4af8-9eb7-aa8c0e1564b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.906297309881369*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"7d6e309c-f5cf-44a8-b2eb-e5340360e795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895423614719633*^9, 3.895423614881898*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d4a039fe-51d1-49b8-aed9-aecfb837d993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Kernel/ComputationalEngine/\
ComputeConditionalExpectations.wl\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$ContextAliases", "[", "\"\<ce`\>\"", "]"}], "=", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeConditionalExpectations`Private`\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.891915640666362*^9, 3.891915642574032*^9}, 
   3.891974020991497*^9, {3.893029480381468*^9, 3.893029480551715*^9}, 
   3.90629731410357*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"cd7b3474-8bec-4544-aac6-5285230212d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], 
          RowBox[{"pi", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
        "]"}]}], "-", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"mup", "+", 
          RowBox[{"rhop", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
          
          RowBox[{"xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mud", "[", "i", "]"}], "+", 
          RowBox[{
           RowBox[{"rhodp", "[", "i", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
          RowBox[{
           RowBox[{"xid", "[", "i", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
         ")"}]}], " ", "\[IndentingNewLine]", " ", ")"}]}], "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mud", "[", "i", "]"}], "+", 
          RowBox[{
           RowBox[{"rhodp", "[", "i", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
          RowBox[{
           RowBox[{"xid", "[", "i", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
         ")"}], 
        RowBox[{"(", 
         RowBox[{"muc", "+", 
          RowBox[{"rhocp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
          RowBox[{"xic", " ", 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}]}], " ", "\[IndentingNewLine]", "+", " ", 
       RowBox[{"phic", " ", 
        RowBox[{"phidc", "[", "i", "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
    "//", "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892388091012373*^9, 3.892388281244906*^9}, 
   3.892388332580035*^9, 3.893035142672811*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"80b13e85-33f0-418b-82ba-3e2fc29b6899"],

Cell[BoxData[
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "3"}], "]"}], 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Esg", "+", 
         RowBox[{
          SuperscriptBox["rhog", "3"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"mup", "+", 
            RowBox[{"rhop", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
            "  ", 
            RowBox[{"xip", " ", 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
           " ", ")"}], 
          RowBox[{"(", 
           RowBox[{"muc", "+", 
            RowBox[{"rhocp", " ", "rhop", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
            RowBox[{"rhocp", " ", "xip", " ", 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
           ")"}]}], " ", "\[IndentingNewLine]", "+", 
         RowBox[{"rhocp", " ", 
          SuperscriptBox["phip", "2"]}], "+", 
         RowBox[{"xic", " ", "phip", " ", 
          RowBox[{"sg", "[", "t", "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", " ", "//", 
    "Simplify"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.892387899545425*^9, 3.8923879016979733`*^9}, {
  3.8923879323154793`*^9, 3.8923879986919518`*^9}, {3.8923880520612917`*^9, 
  3.8923880522448807`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"90d7d504-7006-4ea4-b002-a3cf0f813f79"],

Cell[BoxData[
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"mup", "+", 
          RowBox[{"rhop", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
          
          RowBox[{"xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], 
        RowBox[{"(", 
         RowBox[{"mup", "+", " ", 
          RowBox[{
           SuperscriptBox["rhop", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
          RowBox[{"rhop", " ", "xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
         ")"}]}], " ", "\[IndentingNewLine]", "+", 
       RowBox[{"rhop", " ", 
        SuperscriptBox["phip", "2"]}], "+", 
       RowBox[{"xip", " ", "phip"}]}], " ", "\[IndentingNewLine]", " ", 
      ")"}]}], "//", "Simplify"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.892387818251787*^9, 3.892387886194807*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"09aa0254-54c0-420e-b689-66d6afd54189"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], 
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "2"}], "]"}], ",", 
         RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}]}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"mup", "+", 
          RowBox[{"rhop", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
          
          RowBox[{"xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], 
        RowBox[{"(", 
         RowBox[{"muc", "+", 
          RowBox[{"rhocp", " ", "rhop", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
          RowBox[{"rhocp", " ", "xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
         ")"}]}], " ", "\[IndentingNewLine]", "+", 
       RowBox[{"rhocp", " ", 
        SuperscriptBox["phip", "2"]}], "+", 
       RowBox[{"xic", " ", "phip", " ", 
        RowBox[{"sg", "[", "t", "]"}]}]}], "\[IndentingNewLine]", " ", 
      ")"}]}], "//", "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892387417261086*^9, 3.89238747702839*^9}, {
  3.8923875138547697`*^9, 3.892387709779817*^9}, {3.892387774940489*^9, 
  3.8923877885842752`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b4d54d26-3b7e-430f-a1ca-6c612f18cd19"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"mup", "+", 
        RowBox[{"rhop", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
        RowBox[{"xip", " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
       ")"}], 
      RowBox[{"(", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
        RowBox[{"xic", " ", 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
       ")"}]}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], 
      RowBox[{"(", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
        RowBox[{"xic", " ", 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], " ", "+", 
        RowBox[{"phic", " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", "t", "]"}]}]}], 
       ")"}]}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
        "]"}]}], "-", 
      RowBox[{
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"muc", "+", 
         RowBox[{"rhocp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
         
         RowBox[{"xic", " ", 
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "3"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "2"}], "]"}]}], "  ", "+", 
         RowBox[{"phic", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}]}], ")"}]}]}], " ", "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "-", "2"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "3"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
        RowBox[{"xic", " ", 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "4"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "3"}], "]"}]}], "  ", "+", 
        RowBox[{"phic", " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "-", "2"}], "]"}]}]}], ")"}]}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892387100431244*^9, 3.892387153790432*^9}, 
   3.892387196832964*^9, {3.892387239763137*^9, 3.892387287581477*^9}, {
   3.892387328053542*^9, 3.892387394718596*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"177bb1dd-38eb-406a-b5cf-c6ba9e48ea66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "2"}], "]"}], 
          SuperscriptBox[
           RowBox[{"sg", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}],
         "]"}]}], "-", 
      RowBox[{"(", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "rhog"}], ")"}], "Esg", " ", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"ev", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}],
            "]"}]}]}], "+", 
        RowBox[{"rhog", " ", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"ev", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "3"], ",", "t", ",", "modNRC"}],
            "]"}]}]}]}], "\[IndentingNewLine]", ")"}]}], " ", "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "2"}], "]"}], 
          SuperscriptBox[
           RowBox[{"sg", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}],
         "]"}]}], "-", 
      RowBox[{"(", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "rhog"}], ")"}], "Esg", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
              RowBox[{"rhog", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], 
             ")"}], "2"], "+", 
           SuperscriptBox["phig", "2"]}], ")"}]}], "+", 
        RowBox[{"rhog", " ", 
         RowBox[{"(", " ", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
              RowBox[{"rhog", " ", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], 
             ")"}], "3"], "+", 
           RowBox[{"3", 
            SuperscriptBox["phig", "2"], 
            RowBox[{"(", 
             RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
              RowBox[{"rhog", " ", "*", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], 
             ")"}]}]}], " ", ")"}]}]}], "\[IndentingNewLine]", ")"}]}], " ", "//",
      "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "3"}], "]"}], 
          SuperscriptBox[
           RowBox[{"sg", "[", 
            RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}],
         "]"}]}], "-", 
      RowBox[{"(", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["rhog", "2"]}], ")"}], "Esg", " ", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"ev", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}],
            "]"}]}]}], "+", 
        RowBox[{
         SuperscriptBox["rhog", "2"], 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"ev", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}], "3"], ",", "t", ",", "modNRC"}],
            "]"}]}]}]}], "\[IndentingNewLine]", ")"}]}], " ", "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "3"}], "]"}], 
         SuperscriptBox[
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["rhog", "2"]}], ")"}], "Esg", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
             RowBox[{"rhog", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}],
            "2"], "+", 
          SuperscriptBox["phig", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhog", "2"], " ", 
        RowBox[{"(", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
             RowBox[{"rhog", " ", "*", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}],
            "3"], "+", 
          RowBox[{"3", 
           SuperscriptBox["phig", "2"], 
           RowBox[{"(", 
            RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
             RowBox[{"rhog", " ", "*", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], 
            ")"}]}]}], " ", ")"}]}]}], "\[IndentingNewLine]", ")"}]}], " ", "//",
     "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892385479540084*^9, 3.89238587469134*^9}, {
   3.892385910672845*^9, 3.892385951354706*^9}, {3.892386090671238*^9, 
   3.8923861106698723`*^9}, {3.89238616255355*^9, 3.8923862374780397`*^9}, {
   3.892386324394506*^9, 3.89238640208628*^9}, {3.8923866523899593`*^9, 
   3.892386732782836*^9}, {3.892386985555079*^9, 3.892387060845914*^9}, 
   3.893035135537915*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"bbbaa3c8-dc87-4f73-a183-05e355b89fe1"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "2"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{"rhog", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{"rhog", " ", 
        SuperscriptBox["phig", "2"]}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "3"}], "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "3"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{"rhog", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["rhog", "2"], " ", 
        SuperscriptBox["phig", "2"]}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "3"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "2"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhog", "3"], " ", 
        SuperscriptBox["phig", "2"]}], " ", "+", 
       RowBox[{"rhog", " ", 
        SuperscriptBox["phig", "2"]}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "3"}], "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "4"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "2"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhog", "4"], " ", 
        SuperscriptBox["phig", "2"]}], " ", "+", 
       RowBox[{
        SuperscriptBox["rhog", "2"], " ", 
        SuperscriptBox["phig", "2"]}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892385068143785*^9, 3.8923853062259407`*^9}, {
  3.892385337108007*^9, 3.892385410737529*^9}, {3.892385456981402*^9, 
  3.892385457380747*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"55dab54c-227a-476f-a534-47ce6741df58"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
         RowBox[{"rhog", " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
        ")"}]}], "  ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{"pi", "[", "t", "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"sg", "[", 
        RowBox[{"t", "-", "1"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"sg", "[", 
        RowBox[{"t", "-", "2"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.8923849122311697`*^9, 3.892384952546315*^9}, {
  3.892384989130402*^9, 3.892385025419183*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"38a6a259-7fe1-423f-bfe1-82ea23f9601f"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"sg", "[", 
        RowBox[{"t", "+", "1"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
         RowBox[{"rhog", " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
        ")"}]}], "  ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
         RowBox[{
          SuperscriptBox["rhog", "2"], " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{
          SuperscriptBox["rhop", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
         
         RowBox[{"rhop", "  ", "xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}]}], " ", ")"}]}], "  ", ")"}]}], 
    " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
         RowBox[{
          SuperscriptBox["rhog", "3"], " ", "*", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "2"}], "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{
          SuperscriptBox["rhop", "3"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
         
         RowBox[{
          SuperscriptBox["rhop", "2"], "  ", "xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "2"}], "]"}]}]}], " ", ")"}]}], "  ", ")"}]}], 
    " ", "//", "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892384578327064*^9, 3.892384697220325*^9}, {
  3.8923847366012707`*^9, 3.892384837316545*^9}, {3.892384892665102*^9, 
  3.892384892828616*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"63053f2f-5948-482a-8699-307324b33641"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{"rhog", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        "2"], "+", 
       SuperscriptBox["phig", "2"]}], " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", "t", "]"}], "2"], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"sg", "[", "t", "]"}], "2"], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"sg", "[", 
        RowBox[{"t", "-", "1"}], "]"}], "2"], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "2"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"sg", "[", 
        RowBox[{"t", "-", "2"}], "]"}], "2"], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892165784962098*^9, 3.892165798401553*^9}, {
  3.892165988767288*^9, 3.892166010478404*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"11f8cb0c-9265-4d3a-8c76-fa19b548c740"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "2"], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"sg", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "2"], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{"rhog", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], " ", 
         ")"}], "2"], "+", " ", 
       SuperscriptBox["phig", "2"]}], ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "2"], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "2"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], " ", 
         ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["rhog", "2"], "+", "1"}], ")"}], " ", 
        SuperscriptBox["phig", "2"]}]}], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "2"], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
          RowBox[{
           SuperscriptBox["rhog", "3"], " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "2"}], "]"}], "-", "Esg"}], ")"}]}]}], " ", 
         ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["rhog", "4"], "+", 
          SuperscriptBox["rhog", "2"], "+", "1"}], ")"}], " ", 
        SuperscriptBox["phig", "2"]}]}], ")"}]}], "//", "Simplify"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.89216574040302*^9, 3.8921657688700047`*^9}, {
  3.8921658088281593`*^9, 3.892165914815765*^9}, {3.892165955660293*^9, 
  3.8921659583027*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"e0347b8d-10cc-4019-a448-61b6931c62fe"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
       RowBox[{"rhog", " ", "*", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", "t", "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"sg", "[", "t", "]"}], " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"sg", "[", 
       RowBox[{"t", "-", "1"}], "]"}], " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "2"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"sg", "[", 
       RowBox[{"t", "-", "2"}], "]"}], " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{
  3.892164568164735*^9, {3.89216495679355*^9, 3.892164958589527*^9}, {
   3.892164995966777*^9, 3.8921650460885477`*^9}, 3.8921657339486427`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"4ee46528-3c9d-4b7b-8c56-2f806295e5f0"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"sg", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
       RowBox[{"rhog", "  ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"Esg", " ", "+", " ", "\n", "\t", 
       RowBox[{
        SuperscriptBox["rhog", "2"], "  ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], "-", "Esg"}], ")"}]}]}], "  ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892164518273871*^9, 3.892164543364629*^9}, {
   3.892164587910801*^9, 3.89216463302312*^9}, {3.892164678405649*^9, 
   3.892164703554016*^9}, 3.892164820593704*^9, {3.8921648624099607`*^9, 
   3.892164863192449*^9}, {3.892164930189417*^9, 3.892164932033349*^9}, 
   3.893035129946063*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"438a32ba-0736-4f2d-88b7-d530594bedf6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
      RowBox[{"(", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", "rhop", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", 
        RowBox[{"rhocp", " ", "xip", " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}], " ", ")"}]}], " ", "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
      RowBox[{"(", " ", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], " ", "+", 
        "  ", 
        RowBox[{"xic", " ", 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "2"}], "]"}], " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}], "  ", ")"}]}], " ", "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc1", "=", 
   RowBox[{"SetSymbolsContext", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "1"}], "]"}], "/.", 
      RowBox[{"Normal", "@", 
       RowBox[{"modNRC", "[", "\"\<exogenousEq\>\"", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc1", "===", 
   RowBox[{"(", 
    RowBox[{"muc", "+", 
     RowBox[{"rhocp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
     RowBox[{"xic", " ", 
      RowBox[{"sg", "[", 
       RowBox[{"t", "-", "3"}], "]"}], 
      RowBox[{
       RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
       RowBox[{"t", "-", "2"}], "]"}]}], "+", 
     RowBox[{"phic", " ", 
      RowBox[{
       RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
       RowBox[{"t", "-", "1"}], "]"}]}]}], "  ", ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "===", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"SetSymbolsContext", "@", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
      RowBox[{"(", 
       RowBox[{"muc", "+", 
        RowBox[{"rhocp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
        RowBox[{"xic", " ", 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "3"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], "+", 
        RowBox[{"phic", " ", 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}]}], "  ", ")"}]}], "//", 
     "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2", "=", 
   RowBox[{"SetSymbolsContext", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "2"}], "]"}], "/.", 
      RowBox[{"Normal", "@", 
       RowBox[{"modNRC", "[", "\"\<exogenousEq\>\"", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2", "===", 
   RowBox[{"(", 
    RowBox[{"muc", "+", 
     RowBox[{"rhocp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "-", "3"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
     RowBox[{"xic", " ", 
      RowBox[{"sg", "[", 
       RowBox[{"t", "-", "4"}], "]"}], 
      RowBox[{
       RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
       RowBox[{"t", "-", "3"}], "]"}]}], "+", 
     RowBox[{"phic", " ", 
      RowBox[{
       RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
       RowBox[{"t", "-", "2"}], "]"}]}]}], "  ", "  ", ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"muc", "+", 
       RowBox[{"rhocp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "3"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
       RowBox[{"xic", " ", 
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "4"}], "]"}], 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "3"}], "]"}]}], "+", 
       RowBox[{"phic", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
         RowBox[{"t", "-", "2"}], "]"}]}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.8921309646307096`*^9, 3.892130974931851*^9}, {
   3.892131019945743*^9, 3.89213104166258*^9}, {3.892131157154008*^9, 
   3.892131162275845*^9}, {3.892163875457185*^9, 3.892163925844955*^9}, {
   3.8921639607028723`*^9, 3.8921639826920347`*^9}, 3.892164099834055*^9, {
   3.892164230248891*^9, 3.892164253220779*^9}, {3.892164370489328*^9, 
   3.892164484988875*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"6861b402-f75c-4667-b501-8011a1172c3d"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"muc", "+", 
       RowBox[{"rhocp", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
       RowBox[{"xic", " ", 
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "1"}], "]"}], 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{"muc", "+", 
       RowBox[{"rhocp", " ", "rhop", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], " ", "+", 
       " ", 
       RowBox[{"rhocp", " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{"muc", "+", 
       RowBox[{"rhocp", " ", 
        SuperscriptBox["rhop", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], " ", ")"}]}], "+", 
       " ", 
       RowBox[{"rhocp", " ", "rhop", " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "2"}], "]"}]}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.892128276043799*^9, 3.892128280426422*^9}, {
  3.892128332797394*^9, 3.89212846774083*^9}, {3.892128504273937*^9, 
  3.892128507411642*^9}, {3.892128540461727*^9, 3.892128565910746*^9}, {
  3.8921286061366663`*^9, 3.8921286616838818`*^9}, {3.892128698431341*^9, 
  3.892128839846138*^9}, {3.892129795698588*^9, 3.892130003858015*^9}, {
  3.892130035123691*^9, 3.892130042790258*^9}, {3.892130196150508*^9, 
  3.892130220033628*^9}, {3.892130369077922*^9, 3.892130425562563*^9}, {
  3.892130800934286*^9, 3.892130828050942*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"b672071e-8a56-48d5-bbd2-462a17413a2b"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "phip", "  ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"rhop", " ", "phip"}], "+", " ", "xip"}], " ", ")"}]}], " ", "//",
     "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{
          SuperscriptBox["rhop", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", 
         RowBox[{"rhop", " ", "xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{
          SuperscriptBox["rhop", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", 
         RowBox[{"rhop", " ", "xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892128276043799*^9, 3.892128280426422*^9}, {
  3.892128332797394*^9, 3.89212846774083*^9}, {3.892128504273937*^9, 
  3.892128507411642*^9}, {3.892128540461727*^9, 3.892128565910746*^9}, {
  3.8921286061366663`*^9, 3.8921286616838818`*^9}, {3.892128698431341*^9, 
  3.892128839846138*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"577ca75c-f1e8-4c5f-b81a-69ed4611682a"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", "phip", "  ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
        ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], " ", " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
        ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], 
        ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], "  ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892128276043799*^9, 3.892128280426422*^9}, {
  3.892128332797394*^9, 3.89212846774083*^9}, {3.892128504273937*^9, 
  3.892128507411642*^9}, {3.892128540461727*^9, 3.892128565910746*^9}, {
  3.8921286061366663`*^9, 3.892128629614345*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"98b96f48-2371-42ce-b6f3-c2d3ec419b9f"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "1"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "2"}], "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "-", "2"}], "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.892128276043799*^9, 3.892128280426422*^9}, {
  3.892128332797394*^9, 3.8921284332897778`*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"669bbbeb-79e0-407e-97e7-78ed6ce747ec"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{"rhop", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"rhop", " ", "phip"}], "+", "xip"}], " ", ")"}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"rhop", " ", "phip"}], "+", "xip"}], " ", " ", ")"}]}], " ", "//",
     "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "phip", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.892128276043799*^9, 3.892128280426422*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"d74dec9d-a539-4d0e-ab60-d5b9bbfddc6a"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{"rhop", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"rhop", " ", "phip"}], "+", "xip"}], " ", ")"}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"rhop", " ", "phip"}], "+", "xip"}], " ", " ", ")"}]}], " ", "//",
     "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "phip", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", "0", " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.892092382894245*^9, 3.892092464593955*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"421a78a2-5444-47c1-96bb-d5d4aec3db4d"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{
          SuperscriptBox["rhop", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", " ", 
         RowBox[{"rhop", " ", "xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
        ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", "  ", 
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
        ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", "t", "]"}]}], " ", ")"}]}], " ", "//", "Simplify"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], 
       "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.89209229547681*^9, 3.8920923576913567`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"3bc7bdb3-c874-4a81-95db-6125de48aace"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"mup", "+", 
         RowBox[{"rhop", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "+", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
         
         RowBox[{"xip", " ", 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}]}]}], " ", ")"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", "t", "]"}]}], " ", ")"}]}], " ", "//", "Simplify"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
         RowBox[{"pi", "[", 
          RowBox[{"t", "-", "2"}], "]"}]}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       RowBox[{"pi", "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], " ", ")"}]}], " ", "//", 
    "Simplify"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.8920918551825447`*^9, 3.892091873244816*^9}, {
   3.8920919102546177`*^9, 3.892091966759994*^9}, 3.89209202656561*^9, 
   3.892092146218433*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"22a40649-4fc1-4479-a1e7-36a98819de83"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "2"}], "]"}], ",", 
        RowBox[{"t", "+", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"pi", "[", 
       RowBox[{"t", "+", "2"}], "]"}], " ", ")"}]}], " ", "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "2"}], "]"}], ",", 
        RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{"rhop", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", " ", 
       RowBox[{"xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}]}]}], "  ", ")"}]}], "//", 
    "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "2"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{
        SuperscriptBox["rhop", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{"rhop", " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "2"}], "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{
        SuperscriptBox["rhop", "3"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhop", "2"], " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], " ", ")"}]}], "//", "Simplify"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "2"}], "]"}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{
        SuperscriptBox["rhop", "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhop", "3"], " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "2"}], "]"}]}]}], " ", ")"}]}], "//", "Simplify"}],
    ")"}]}]}], "Input",
 CellChangeTimes->{{3.8920915469634523`*^9, 3.8920916857035303`*^9}, {
  3.892091793915536*^9, 3.8920918005660763`*^9}, {3.892091888835329*^9, 
  3.892091891055735*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"da941f2b-6e55-4088-b4a9-7e8406525328"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{"rhop", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{"xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{
        SuperscriptBox["rhop", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{"rhop", " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], " ", ")"}]}], "//", "Simplify"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", 
        RowBox[{"t", "-", "2"}], ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{
        SuperscriptBox["rhop", "3"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "2"}], "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["rhop", "2"], " ", "xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "2"}], "]"}]}]}], " ", ")"}]}], "//", "Simplify"}],
    ")"}]}]}], "Input",
 CellChangeTimes->{{3.892040815866974*^9, 3.892040904169372*^9}, 
   3.893035123204645*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"cff362b6-e8dd-4205-886c-7091dd42a87f"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"mup", "+", 
       RowBox[{"rhop", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{"xip", " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], " ", "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"muc", "+", 
       RowBox[{"rhocp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{"xic", " ", 
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "1"}], "]"}], 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      RowBox[{"Esg", " ", "+", " ", 
       RowBox[{"rhog", " ", "*", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}]}], "//",
     "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "t", ",", 
        "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"mud", "[", "i", "]"}], "+", 
       RowBox[{
        RowBox[{"rhodp", "[", "i", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"xid", "[", "i", "]"}], 
        RowBox[{"sg", "[", 
         RowBox[{"t", "-", "1"}], "]"}], " ", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ", 
      ")"}]}], "//", "Simplify"}], ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.892004564471697*^9, 3.892004667172761*^9}, {
   3.892004717138644*^9, 3.892004748947639*^9}, {3.892038898732336*^9, 
   3.892038899348302*^9}, 3.892038988081668*^9, {3.892039455867078*^9, 
   3.892039456433589*^9}, {3.892039568060585*^9, 3.892039702101787*^9}, {
   3.892039738705064*^9, 3.892039903509625*^9}, {3.89209212949294*^9, 
   3.8920921298605957`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"bd52b2bc-0a39-41ad-97ed-32a2bf43ef42"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "^", "2"}], ",", "t", ",", 
        "modNRC"}], "]"}]}], "-", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"mup", "+", 
          RowBox[{"rhop", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
          RowBox[{"xip", " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], "2"], "+", 
       SuperscriptBox["phip", "2"]}], " ", ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "^", "2"}], ",", "t", ",", 
        "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"muc", "+", 
          RowBox[{"rhocp", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
          RowBox[{"xic", " ", 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], "2"], "+", 
       SuperscriptBox["phic", "2"]}], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], "^", "2"}], ",", "t", ",", 
        "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Esg", " ", "+", " ", 
          RowBox[{"rhog", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "-", "Esg"}], ")"}]}]}], ")"}], 
        "2"], "+", 
       SuperscriptBox["phig", "2"]}], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "^", "2"}], ",", "t", 
        ",", "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mud", "[", "i", "]"}], "+", 
          RowBox[{
           RowBox[{"rhodp", "[", "i", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], "-", "mup"}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"xid", "[", "i", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], " ", 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}]}], " ",
          ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"phidc", "[", "i", "]"}], "2"]}], ")"}]}], "//", "Simplify"}],
    ")"}]}]}], "Input",
 CellChangeTimes->{{3.892039917743197*^9, 3.892040033064176*^9}, {
  3.892040070386093*^9, 3.892040109534567*^9}, {3.8920402018432302`*^9, 
  3.892040204441041*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"b9d5ba71-434d-43b0-8b41-c2fa077df7da"],

Cell[BoxData[{
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"var", "[", 
       RowBox[{
        RowBox[{"pi", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", " ", 
     RowBox[{"(", 
      SuperscriptBox["phip", "2"], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"var", "[", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      SuperscriptBox["phic", "2"], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"var", "[", 
       RowBox[{
        RowBox[{"sg", "[", 
         RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
     "-", 
     RowBox[{"(", 
      SuperscriptBox["phig", "2"], ")"}]}], "//", "Simplify"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"0", "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"SetSymbolsContext", "@", 
      RowBox[{"var", "[", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "t", ",", 
        "modNRC"}], "]"}]}], "-", 
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{"phidc", "[", "i", "]"}], "2"], ")"}]}], "//", "Simplify"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.8920402245447617`*^9, 3.892040263978037*^9}, {
  3.892051788745008*^9, 3.892051790340418*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"93e936c8-b32b-476d-9d65-b8bc48c1f8f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"law", " ", "of", " ", "iterated", " ", "expectations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", " ", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], 
         ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], 
         ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{"sg", "[", 
            RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], 
         ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "t", ",", 
           "modNRC"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "+", "1"}], "]"}], 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", " ", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "+", "1"}], "]"}], 
            RowBox[{"dc", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
          "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "1"}], "]"}], 
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dc", "[", 
             RowBox[{"t", "+", "1"}], "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], 
          "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
          "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "-", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"ev", "[", 
          RowBox[{
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", "t", ",", 
           "modNRC"}], "]"}], ",", 
         RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], "//", 
      "Simplify"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8925198087123404`*^9, 3.892519933200197*^9}, {
  3.892520040491601*^9, 3.892520086328964*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"7a18e4a4-576a-4c5d-9e28-f38346f43cb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "law", " ", "of", " ", "iterated", " ", "expectations", " ", "used", " ", 
    "to", " ", "compute", " ", "unconditional", " ", "moments"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"pi", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"pi", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"pi", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"pi", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"pi", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"pi", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"sg", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"sg", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"0", "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"sg", "[", "t", "]"}], "2"], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", "t", "]"}], "2"], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
          RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], 
      ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8925200997264338`*^9, 3.892520211658146*^9}, {
  3.892520243790668*^9, 3.8925204069939213`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"cf4d0f5b-8869-43de-96d7-64386c5b43a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "law", " ", "of", " ", "iterated", " ", "expectations", " ", "for", " ", 
    "shocks", " ", "squared"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "pi", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "sg", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"sg", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"sg", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"sg", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "dc", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dc", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dc", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dc", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "dd", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<sg\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       RowBox[{"ev", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"], ",", "t", ",", "modNRC"}], 
        "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], 
       SuperscriptBox[
        RowBox[{
         RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
         RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], 
         SuperscriptBox[
          RowBox[{
           RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "2"]}], ",", "t", ",", "modNRC"}], 
       "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8925200997264338`*^9, 3.892520172184609*^9}, {
   3.892520410935438*^9, 3.892520649012622*^9}, 3.893035116891119*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"c2e55eec-6ab2-4679-bcfa-91260fc9a7b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "works", " ", "in", " ", "different", " ", "contexts", " ", "for", " ", 
    "variable", " ", "symbol"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], "===", 
    RowBox[{"ev", "[", 
     RowBox[{
      RowBox[{"foo`pi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ev", "[", 
       RowBox[{
        RowBox[{"foo`pi", "[", 
         RowBox[{"foo`t", "+", "1"}], "]"}], ",", "foo`t", ",", "modNRC"}], 
       "]"}], "/.", 
      RowBox[{"foo`t", "->", "t"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "differentiates", " ", "contexts", " ", "for", " ", "time", " ", 
     "index"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"pi", "[", 
          RowBox[{"foo`t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "foo`t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", "foo`t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"foo`pi", "[", 
          RowBox[{"foo`t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "foo`t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"foo`pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", "foo`t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"foo`pi", "[", 
          RowBox[{"bar`t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "bar`t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"foo`pi", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", "bar`t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "t"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"foo`pi", "[", 
          RowBox[{"bar`t", "+", "1"}], "]"}], ",", "goo`t", ",", "modNRC"}], 
        "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
        RowBox[{"1", "+", "bar`t"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
    " "}]}]}]], "Input",
 CellChangeTimes->{{3.892480837085096*^9, 3.892480845676284*^9}, {
  3.893035174947915*^9, 3.8930353073224497`*^9}, {3.893035569601533*^9, 
  3.8930356381625032`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"d7b1dc2e-1816-4181-8ff0-31fa1e5c77aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"basic", " ", "functionality", " ", "of", " ", "lagStateVarst"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"(", 
     RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
         "+", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "modNRC"}], "]"}], "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ce`lagStateVarst", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", 
        RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "/.", 
      RowBox[{"t", "->", 
       RowBox[{"t", "+", "1"}]}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"(", 
     RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{"1", "+", "t"}], "]"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.893028784122538*^9, 3.8930287904797153`*^9}, {
  3.8930288442541723`*^9, 3.893028861896193*^9}, {3.8930289040153437`*^9, 
  3.893028923936532*^9}, {3.893033727025272*^9, 3.8930337311264668`*^9}, {
  3.893033768742291*^9, 3.893033796330021*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"4c8ea0b5-37e5-453b-b0b1-9b25654e2a26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ce`lagStateVarst", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pi", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
      RowBox[{"t", "+", "2"}], "]"}]}], ",", "t", ",", "modNRC"}], "]"}], "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
     "]"}], " ", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", "]"}], 
     "[", 
     RowBox[{"2", "+", "t"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.893033943526992*^9, 3.893033967606761*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"b26e257d-ce09-4aad-b16a-47832fc4d8d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ce`lagStateVarst", "[", 
   RowBox[{"delta", ",", 
    RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
  RowBox[{
  "(", "FernandoDuarte`LongRunRisk`Model`Parameters`delta", ")"}]}]], "Input",\

 CellChangeTimes->{{3.8930291813952017`*^9, 3.893029183997579*^9}, {
   3.8930337367807407`*^9, 3.893033737784956*^9}, 3.893033977567157*^9, {
   3.893034010579432*^9, 3.893034013116539*^9}, {3.893034068790395*^9, 
   3.893034077625339*^9}, 3.893035100769223*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"3b327004-c342-4209-9481-98e7951cabc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ce`lagStateVarst", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pi", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
    RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", "]"}], 
     "[", "t", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
         "+", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8930299661795263`*^9, 3.89302997211147*^9}, 
   3.893033740021538*^9, {3.893034015086516*^9, 3.893034017201024*^9}, 
   3.8930340976700783`*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"12eb5878-e473-43c6-9629-7e938e3f4969"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ce`lagStateVarst", "[", 
   RowBox[{
    RowBox[{"A", "[", "0", "]"}], ",", 
    RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
  RowBox[{
  "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.8930301701724*^9, 3.893030213543448*^9}, {
   3.893030277414679*^9, 3.893030286076674*^9}, {3.893033743258727*^9, 
   3.893033744467154*^9}, 3.893033986751322*^9, {3.89303402243717*^9, 
   3.893034025868874*^9}, {3.893034122326703*^9, 3.8930341283015747`*^9}, {
   3.893034476705768*^9, 3.893034481050859*^9}, 3.893035103235656*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"5aca4785-9f39-4919-b7a9-140ddad15717"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ce`lagStateVarst", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "m"}], "]"}], "[", "0", "]"}], ",", 
    RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
  RowBox[{
   RowBox[{"FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`R", "[", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "m"}], "]"}], "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.893030305583428*^9, 3.89303031971541*^9}, {
   3.893030369528104*^9, 3.893030375303877*^9}, 3.893030427767521*^9, {
   3.893033747525502*^9, 3.89303374857977*^9}, {3.893033926275772*^9, 
   3.893033927296484*^9}, 3.8930339884144897`*^9, {3.893034028054696*^9, 
   3.893034030032544*^9}, {3.893034497149098*^9, 3.893034507981268*^9}, 
   3.8930351046281967`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"215c8466-99e7-41b2-980f-077548b87937"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "does", " ", "not", " ", "evaluate", " ", "with", " ", "XXeq", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pieq", "[", 
       RowBox[{"t", ",", "m"}], "]"}], ",", 
      RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"pieq", "[", 
     RowBox[{"t", ",", "m"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"wceq", "[", "t", "]"}], ",", 
      RowBox[{"t", "+", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"wceq", "[", "t", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.893030661016945*^9, 3.893030679849428*^9}, {
  3.893034527862958*^9, 3.893034546335446*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"5a63533e-2bf7-4e75-9f29-26af82526760"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"lagStateVarst", " ", "is", " ", "listable"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ce`lagStateVarst", "[", 
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], ",", 
       RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], ",", 
     RowBox[{"ce`lagStateVarst", "[", 
      RowBox[{
       RowBox[{"sg", "[", "t", "]"}], ",", 
       RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], ",", 
     RowBox[{"ce`lagStateVarst", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", "t", ",", "modNRC"}], "]"}]}], 
    "}"}], "===", 
   RowBox[{"ce`lagStateVarst", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], ",", 
       RowBox[{"sg", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}]}], "}"}], ",", 
     RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.893028800295095*^9, 3.8930288034864187`*^9}, {
  3.893035017647455*^9, 3.89303507700286*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"73309b2c-3fb5-4403-bf1c-ed0d88627b36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"contexts", " ", "in", " ", "lagStateVarst"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"contexts", " ", "of", " ", "expr"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"foo`pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"foo`pi", "[", "t", "]"}], 
       RowBox[{"pi", "[", "t", "]"}]}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"foo`pi", "[", "t", "]"}], "2"], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"pi", "[", "t", "]"}], "2"], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"foo`pi", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       "bar`delta"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", "t", "]"}], 
       RowBox[{
        RowBox[{"foo`eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
       "delta"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"contexts", " ", "of", " ", "conditionalTime"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", "foo`t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "foo`t", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ce`lagStateVarst", "[", 
       RowBox[{
        RowBox[{"pi", "[", "foo`t", "]"}], ",", 
        RowBox[{"foo`t", "-", "1"}], ",", "modNRC"}], "]"}], "/.", 
      RowBox[{"foo`t", "->", "t"}]}], ")"}], "===", 
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{"pi", "[", "t", "]"}], ",", 
      RowBox[{"t", "-", "1"}], ",", "modNRC"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpandAll", "[", 
     RowBox[{"ce`lagStateVarst", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi", "[", "foo`t", "]"}], 
        RowBox[{"pi", "[", "t", "]"}]}], ",", 
       RowBox[{"foo`t", "-", "1"}], ",", "modNRC"}], "]"}], "]"}], "===", 
    RowBox[{"ExpandAll", "[", 
     RowBox[{
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}], 
      RowBox[{"ce`lagStateVarst", "[", 
       RowBox[{
        RowBox[{"pi", "[", "foo`t", "]"}], ",", 
        RowBox[{"foo`t", "-", "1"}], ",", "modNRC"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ce`lagStateVarst", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pi", "[", 
        RowBox[{"foo`t", "-", "1"}], "]"}], 
       RowBox[{"pi", "[", "t", "]"}]}], ",", 
      RowBox[{"foo`t", "-", "1"}], ",", "modNRC"}], "]"}], "===", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "foo`t"}], "]"}], " ", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8930287914963627`*^9, 3.8930288337204933`*^9}, {
   3.893029230141986*^9, 3.893029268732963*^9}, 3.893029321069252*^9, {
   3.8930296321052637`*^9, 3.893029643772081*^9}, {3.893029674273879*^9, 
   3.8930296802598457`*^9}, {3.893029909545547*^9, 3.8930299179011793`*^9}, {
   3.8930345945205383`*^9, 3.893034783023508*^9}, {3.893034814832643*^9, 
   3.8930348732840242`*^9}, {3.893034914469473*^9, 3.893034967850953*^9}, {
   3.893034999459182*^9, 3.893035007953271*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"83143a82-aa32-43be-b8a2-b64dafc20560"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ContextAliases", "[", "\"\<ce`\>\"", "]"}], "=."}]], "Input",
 CellChangeTimes->{{3.893028099160915*^9, 3.893028099304707*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"a0d59c9d-d376-4f94-aa50-8a45943a9f47"]
}, Closed]],

Cell[CellGroupData[{

Cell["ComputeUnconditionalExpectations", "Section",
 CellChangeTimes->{
  3.906296864119318*^9},ExpressionUUID->"7a850a41-9f5f-44ec-a4c4-\
a3dfe09a3c8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"0aedab66-c3e2-436e-863d-bd1bb5fc43fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"58d095b6-e5e2-40a6-990a-ede4ca6c1c5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}, 3.906297249453999*^9, {3.9062973218938026`*^9, 
   3.906297324332849*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"fb7e68bf-ffbf-4b07-afb1-c682e1ec0f22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.891595279589191*^9, 3.891616060767905*^9, 3.8916343707639523`*^9, {
   3.891913938964695*^9, 3.8919139392219143`*^9}, {3.891915985036783*^9, 
   3.8919159853773212`*^9}, {3.892039540791751*^9, 3.8920395410421963`*^9}, {
   3.892161069893014*^9, 3.892161073697487*^9}, {3.892167389746036*^9, 
   3.89216739021437*^9}, {3.892985575548376*^9, 3.892985579785521*^9}, {
   3.893087090785573*^9, 3.8930871021359863`*^9}, {3.893143287649158*^9, 
   3.893143311290959*^9}, {3.895419408907625*^9, 3.895419444813488*^9}, 
   3.895419558061615*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"45da648f-bd4d-4d77-8f98-d461e6af33eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Kernel/ComputationalEngine/\
ComputeUnconditionalExpectations.wl\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "createSystem", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`createSystem"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "evNoEpsStateVarsProduct", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`evNoEpsStateVarsProduct"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "uncondEStep", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`uncondEStep"}], ";"}]}], "Input",
 CellChangeTimes->{{3.891915640666362*^9, 3.891915642574032*^9}, 
   3.891974020991497*^9, {3.8923885202156773`*^9, 3.892388522699502*^9}, {
   3.893086966177046*^9, 3.8930869779756327`*^9}, 3.906297328754773*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"c81a04de-5053-4fdb-8765-926d66d5aa6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "system", " ", "of", " ", "equations", " ", "for", " ", "unconditional", 
    " ", "moments", " ", "of", " ", "state", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules1", ",", "system1", ",", "unknowns1"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"1", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules2", ",", "system2", ",", "unknowns2"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"2", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules3", ",", "system3", ",", "unknowns3"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"3", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules4", ",", "system4", ",", "unknowns4"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"4", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol1", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system1", ",", "unknowns1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol2", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system2", ",", "unknowns2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol3", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system3", ",", "unknowns3"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol4", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system4", ",", "unknowns4"}], "]"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules1", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system1", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns1", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\n", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules2", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system2", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns2", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules3", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system3", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns3", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules4", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system4", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns4", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{"there", " ", "is", " ", "a", " ", "solution"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"sol1", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol2", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol3", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol4", "===", 
           RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",",
       "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "solutions", " ", "are", " ", "the", " ", "same", " ", "for", " ", 
        "same", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns1", ",", "unknowns3"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol1", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns2", ",", "unknowns3"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol2", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns1", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol1", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns2", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol2", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns3", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol3", ",", "sol4"}], "}"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8928872783997917`*^9, 3.8928872825022306`*^9}, {
   3.893058081176363*^9, 3.893058081797423*^9}, 3.8930584588887653`*^9, {
   3.893083667979657*^9, 3.893083681854567*^9}, {3.8930837480086393`*^9, 
   3.893083781840391*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0638bbd9-e365-4810-9cca-432e93d39f32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
    "hand"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi1", "/.", "sol1"}], ")"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`sg1", "/.", "sol1"}], ")"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi2", "/.", "sol2"}], "]"}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
          "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip", 
             "2"], "+", 
            RowBox[{
            "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ",
              "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
             "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
            " ", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phip",
              "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhop",
              "2"]}], ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`sg2", "/.", "sol2"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
         "2"], "+", 
        FractionBox[
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
          "2"], 
         RowBox[{"1", "-", 
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
           "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi1sg1", "/.", "sol2"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.892524523636704*^9, 3.892524538980324*^9}, {
   3.892524963969441*^9, 3.892524997873*^9}, {3.8925250491209106`*^9, 
   3.892525102081677*^9}, {3.892525153236815*^9, 3.892525230281101*^9}, {
   3.8925712267857227`*^9, 3.89257122924771*^9}, {3.89305855312013*^9, 
   3.893058646744561*^9}, {3.893059266545212*^9, 3.893059334165757*^9}, {
   3.893083789529174*^9, 3.893083797521639*^9}, 3.901592696340942*^9, 
   3.9015933817077312`*^9, {3.9015937701195107`*^9, 3.901593786181929*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"dd6f4633-90a0-4275-8e19-d01855868830"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
    "hand"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{
        RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"pi", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], 
        "]"}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
          "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip", 
             "2"], "+", 
            RowBox[{
            "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ",
              "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
             "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
            " ", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phip",
              "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhop",
              "2"]}], ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], "]"}], 
      "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
         "2"], "+", 
        FractionBox[
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
          "2"], 
         RowBox[{"1", "-", 
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
           "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930848967948723`*^9, 3.893084935031836*^9}, {
   3.893085027101679*^9, 3.893085045144382*^9}, {3.8930857992167387`*^9, 
   3.893085830327442*^9}, {3.893085980007868*^9, 3.8930860239405127`*^9}, 
   3.893087085948606*^9, {3.895419479552326*^9, 3.895419482422165*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"037d02e6-aa35-4628-92e8-8a4cbf27be8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "moments", " ", "can", " ", "be", " ", "evaluated", " ", "numerically", 
    " ", "using", " ", "parameters", " ", "values", " ", "only"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol1"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol2"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol3"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol4"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.893082237801841*^9, {3.893082288507763*^9, 3.893082397545843*^9}, {
   3.89308380447088*^9, 3.893083826885064*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"0288c96c-f688-4c73-9231-150d87b0ffaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "evNoEpsStateVarsProduct", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stateVarsNoEps", "=", 
     RowBox[{"{", 
      RowBox[{"sg", ",", "pi"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", "=", "modNRC"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.892838674699943*^9, 3.892838701015687*^9}, {
   3.8928871836412153`*^9, 3.892887201737369*^9}, {3.893057674036683*^9, 
   3.893057694298431*^9}, 3.89305790637994*^9, {3.893081993098256*^9, 
   3.89308199954256*^9}, 3.8930869590423203`*^9, 3.893087080903373*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"cc07390d-6b1b-4646-bd91-f304aa81244a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"basic", " ", "use"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", "stateVarsNoEps"}], 
       "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
        "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
          "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phig", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"", 
            "]"}], "[", "t", "]"}]}]}], ")"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
         "model", ",", "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "-", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
         SuperscriptBox[
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}], "2"]}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], ")"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`mud", "[", "i", "]"}], 
         " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "-", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`phidc", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
           "]"}], "[", "t", "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`xid", "[", "i", "]"}], 
         " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893081708234816*^9, 3.8930817475700893`*^9}, {
  3.893082619951611*^9, 3.893082620668397*^9}, {3.8930826743611507`*^9, 
  3.893082674969939*^9}, {3.89308271889793*^9, 3.893082764899756*^9}, {
  3.893083300110649*^9, 3.8930833295765333`*^9}, {3.893083371906817*^9, 
  3.893083397811235*^9}, {3.8930835396615067`*^9, 3.8930836030394173`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"3e2e7b8d-5ebf-4922-96b1-7028cd202689"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "context", " ", "for", " ", "shocks", " ", "is", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"sg", "[", "t", "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930830724712353`*^9, 3.893083259734127*^9}, 
   3.893083445300497*^9, {3.893083843952413*^9, 3.893083861525839*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"720a71e5-0b69-4c2d-aebc-d1b85444a226"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "if", " ", "variables", " ", "lagged", " ", "to", " ", "the",
     " ", "right", " ", "time", " ", "period"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}]}],
     "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.892837690169054*^9, 3.892837854348692*^9}, 
   3.89283864284869*^9, 3.892838715667156*^9, 3.893057562171788*^9, 
   3.893057898180541*^9, 3.893058027361483*^9, {3.893059945383209*^9, 
   3.893059945387575*^9}, 3.893059994856317*^9, {3.893060102391067*^9, 
   3.893060146717375*^9}, {3.893060178483892*^9, 3.893060220488847*^9}, 
   3.893081080462633*^9, 3.893083437165765*^9, {3.893083871926509*^9, 
   3.893083892419632*^9}, {3.893105071113224*^9, 3.893105111747327*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"d252d2f6-149d-4228-ac95-bde4316d2de0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "use", " ", "variables", " ", "indexed", " ", "by", " ", "time", " ", 
    "that", " ", "are", " ", "not", " ", "lagged"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"foo", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], 
       RowBox[{"foo", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpandAll", "@", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ")"}], "===", 
      RowBox[{"(", 
       RowBox[{"ExpandAll", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "*", 
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
             RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}]}], ")"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8928378645917997`*^9, 3.8928380134079*^9}, {
   3.89283856318399*^9, 3.892838569033311*^9}, {3.893059945388934*^9, 
   3.893059945395464*^9}, 3.893081075924605*^9, {3.893081367930172*^9, 
   3.893081370124003*^9}, 3.893083433344887*^9, {3.893083496494205*^9, 
   3.8930835310955772`*^9}, {3.893083900795011*^9, 3.8930839188691053`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"3c4cb1b8-fcbb-4e8e-a542-93eadba29cdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "add", " ", "irrelevant", " ", "variables", " ", "to", " ", "lag"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "myVariable"}], "]"}]}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "irrelevantVar"}], "]"}]}], "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"anotherIrrelevantVar", " ", 
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "anotherIrrelevantVar"}], "]"}]}], 
       "]"}], "===", 
      RowBox[{"anotherIrrelevantVar", "*", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
        "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930839246758204`*^9, 3.893083937930691*^9}, {
  3.8930840322990923`*^9, 3.893084140616804*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"fb6fd815-6e1a-4a5b-bf15-e38f61fe224d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"lag", " ", "dd"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "lag", " ", "dd", " ", "and", " ", "expression", " ", "has", " ", 
       RowBox[{"eps", "[", "\"\<dd\>\"", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "\"\<dd\>\"", "]"}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "_", "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"uncondEStep", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
       RowBox[{"_Symbol", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], "]"}],
           "&"}], ")"}]}], ",", "Infinity"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"uncondEStep", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
      "]"}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89283802890134*^9, 3.892838030900941*^9}, {
   3.892838083823448*^9, 3.892838092310711*^9}, {3.892838138034411*^9, 
   3.89283817641862*^9}, {3.892838220044372*^9, 3.892838228823832*^9}, {
   3.892838286807514*^9, 3.892838399679389*^9}, {3.892838547622286*^9, 
   3.89283855837638*^9}, {3.89305994539712*^9, 3.893059945404882*^9}, {
   3.893060330946208*^9, 3.893060396602564*^9}, 3.8930604807433987`*^9, {
   3.893066361049811*^9, 3.89306639221675*^9}, 3.893083429850601*^9, {
   3.893083954996154*^9, 3.893084012596081*^9}, {3.8931051334785633`*^9, 
   3.893105141267414*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"94d07d91-10d7-4b58-994c-471477f43722"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"wc", ",", 
    RowBox[{"pd", " ", "ratios"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", "[", "t", 
        "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"wc", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
          "model", ",", 
          RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "1", 
        "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
          "model", ",", 
          RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", "i", 
         "]"}], "[", "1", "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893086072267931*^9, 3.893086151775504*^9}, 
   3.893086247368884*^9, 3.8930863039185677`*^9, {3.893086419204494*^9, 
   3.893086419846327*^9}, {3.893086609193349*^9, 3.893086694155324*^9}, {
   3.893086761160204*^9, 3.8930868172023783`*^9}, {3.8930868600489817`*^9, 
   3.893086876039349*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"9922d2b8-d120-4b0b-8b63-7a1e04956b59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"unconditional", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], ",", "modNRC"}], "]"}], "]"}], "===", 
      
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], ",", "modBY"}], "]"}], "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"uncondE", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], ",", "modNRC"}], "]"}], 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}]}], "-", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}], ")"}], 
       " ", "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"pi", "[", "t", "]"}], "3"], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "-", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "*", "\n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "^", "2"}], " ",
            "-", " ", "\n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "^", 
                 "2"}], " ", "+", "  ", 
                RowBox[{
                "2", "*", "FernandoDuarte`LongRunRisk`Model`Parameters`phip", 
                 "*", "  ", 
                 "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "*", 
                 "FernandoDuarte`LongRunRisk`Model`Parameters`xip"}], " ", 
                "+", "  ", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`Parameters`xip", "^", 
                 "2"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], " ", "+", " ", 
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "^", 
               "2"}]}], ")"}]}]}], ")"}]}]}], " ", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "@", 
       RowBox[{"SetSymbolsContext", "@", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"dc", "[", "t", "]"}], ",", "modNRC"}], "]"}]}]}], "===", 
      "muc"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dc", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}]}]}]}],
       "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["muc", "2"], "+", 
          SuperscriptBox["phic", "2"], "+", 
          RowBox[{"2", " ", "Esg", " ", "phip", " ", "rhocp", " ", "xic"}], 
          "+", 
          RowBox[{
           SuperscriptBox["xic", "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Esg", "2"], "+", 
             FractionBox[
              SuperscriptBox["phig", "2"], 
              RowBox[{"1", "-", 
               SuperscriptBox["rhog", "2"]}]]}], ")"}]}], " ", "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["rhocp", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", " ", "phip", " ", "rhop", " ", "xip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muc", " ", "mup"}], "+", 
          RowBox[{"rhocp", " ", "xip", " ", "phip"}], "+", 
          RowBox[{"xic", " ", "rhop", " ", "phip", " ", "Esg"}], "+", 
          RowBox[{"xic", " ", "xip", " ", "Esg"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rhocp", " ", "rhop"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["xip", "2"], "+", 
              RowBox[{"2", " ", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["phip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{"muc", " ", "Esg"}], ")"}]}]}]}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Esg", "2"], "+", 
          RowBox[{
           FractionBox["rhog", 
            RowBox[{"1", "-", 
             SuperscriptBox["rhog", "2"]}]], 
           SuperscriptBox["phig", "2"]}]}], " ", ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Esg", "2"], "+", 
          RowBox[{
           FractionBox["rhog", 
            RowBox[{"1", "-", 
             SuperscriptBox["rhog", "2"]}]], 
           SuperscriptBox["phig", "2"]}]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"pi", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mup", "2"], "+", 
          RowBox[{"phip", " ", "xip"}], "+", 
          FractionBox[
           RowBox[{"rhop", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mup", "2"], "+", 
          RowBox[{"phip", " ", "xip"}], "+", 
          FractionBox[
           RowBox[{"rhop", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{"Esg", " ", "mup"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muc", " ", "mup"}], " ", "+", 
          RowBox[{"Esg", " ", "phip", "  ", "xic"}], "+", 
          FractionBox[
           RowBox[{"rhocp", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], " ", "+", " ", 
              RowBox[{"2", " ", "phip", " ", "rhop", "  ", "xip"}], "+", " ", 
              
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930931586861763`*^9, 3.893093169795704*^9}, {
   3.893102429143783*^9, 3.8931024298433332`*^9}, {3.893102466623125*^9, 
   3.893102586761202*^9}, {3.8931026368045473`*^9, 3.893102685312832*^9}, {
   3.893102716922923*^9, 3.8931028746270733`*^9}, {3.893102924509729*^9, 
   3.8931029338818493`*^9}, {3.893103097597286*^9, 3.893103302215263*^9}, 
   3.893103954197452*^9, {3.893104412861294*^9, 3.893104516056366*^9}, {
   3.895419485235199*^9, 3.895419485245006*^9}, 3.8954196079524612`*^9, 
   3.895419669406982*^9, {3.8954211643782167`*^9, 3.895421216998274*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"de064c0b-2f7e-429a-a559-fa4ce3277769"]
}, Closed]],

Cell[CellGroupData[{

Cell["CreateEulerEq", "Section",
 CellChangeTimes->{
  3.9062968656576233`*^9},ExpressionUUID->"4f434e64-db78-42bd-974f-\
702d1060937b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"e6ee2ce0-feeb-4731-928c-026daec974d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"34b19a21-345e-4878-82c2-fdc5db7c8a7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}, 3.893336453091833*^9, 3.8933472708044786`*^9, 
   3.906297250105605*^9, {3.906297337652598*^9, 3.906297340091423*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"81887a07-96cb-4d21-9e3d-887065dfdece"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mods", "=", 
   RowBox[{"{", 
    RowBox[{"modBY", ",", "modNRC", ",", "modDES"}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.895400995806225*^9, 3.8954009959498043`*^9}, {
   3.895401333682231*^9, 3.8954013437477283`*^9}, {3.895415511062855*^9, 
   3.895415512534185*^9}, 3.895416761698543*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"95c71336-cb73-4767-b51c-706cc01b35e3"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`CreateEulerEq`\>\"", 
  "]"}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"56512aa3-c598-475d-8467-eab2c8a7fc00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ee", "[", "model_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"eulereq", "[", 
     RowBox[{
      RowBox[{"retc", "[", 
       RowBox[{"t", "+", "1"}], "]"}], ",", "t", ",", "model"}], "]"}], ",", 
    RowBox[{"eulereq", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "j"}], "]"}], ",", "t", ",", "model"}], 
     "]"}], ",", 
    RowBox[{"eulereq", "[", 
     RowBox[{
      RowBox[{"bondret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "m"}], "]"}], ",", "t", ",", "model"}], 
     "]"}], ",", 
    RowBox[{"nomeulereq", "[", 
     RowBox[{
      RowBox[{"nombondret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "m"}], "]"}], ",", "t", ",", "model"}], 
     "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eeAll", "=", 
   RowBox[{"ee", "/@", "mods"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8953865605128613`*^9, 3.895386622896431*^9}, {
   3.895387204728034*^9, 3.895387224501824*^9}, {3.895387517392034*^9, 
   3.895387525954526*^9}, {3.895388030754921*^9, 3.895388033416654*^9}, {
   3.895388249874099*^9, 3.89538826152811*^9}, {3.8953886938107567`*^9, 
   3.895388694343625*^9}, 3.895388735643899*^9, {3.895389727495597*^9, 
   3.895389727709811*^9}, 3.8953948635559893`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"12e4b726-83ab-4548-86f9-73383a574081"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coeffWc", "[", "model_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefwc", "[", "i",
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffPd", "[", "model_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd", "[", "i",
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffBond", "[", "model_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb", "[", "i", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeffNomBond", "[", "model_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefnb", "[", "i",
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
        "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffWcAll", "=", 
   RowBox[{"coeffWc", "/@", "mods"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffPdAll", "=", 
   RowBox[{"coeffPd", "/@", "mods"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffBondAll", "=", 
   RowBox[{"coeffBond", "/@", "mods"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffNomBondAll", "=", 
   RowBox[{"coeffNomBond", "/@", "mods"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8953865605128613`*^9, 3.895386622896431*^9}, {
   3.895387204728034*^9, 3.895387224501824*^9}, {3.895387517392034*^9, 
   3.895387525954526*^9}, {3.895388030754921*^9, 3.895388033416654*^9}, {
   3.895388249874099*^9, 3.89538826152811*^9}, {3.8953886938107567`*^9, 
   3.895388694343625*^9}, 3.895388735643899*^9, {3.895389727495597*^9, 
   3.895389727709811*^9}, 3.8953948635559893`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"cfe19a41-1b3c-4c04-8ee6-d0fb814e5ec4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"*", "test", " ", "eulereq"}], ",", " ", "nomeulereq"}], 
  "**)"}]], "Input",
 CellChangeTimes->{{3.8953896985566893`*^9, 3.895389733299385*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"96e03bc1-7fe7-4523-9241-77c0b8957d6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "euler", " ", "eq", " ", "linear", " ", "in", " ", "state", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "@", 
           RowBox[{"Keys", "@", 
            RowBox[{"CoefficientRules", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DeleteDuplicates", "@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modBY", "[", "\"\<stateVars\>\"", "]"}], "[", "t", 
                  "]"}], ",", 
                 SuperscriptBox[
                  RowBox[{"_Symbol", "[", "t", "]"}], "p_."], ",", 
                 "Infinity"}], "]"}]}]}], "]"}]}]}], "==", "1"}], ")"}], 
        "&"}], "/@", 
       RowBox[{"ee", "[", "modBY", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "@", 
           RowBox[{"Keys", "@", 
            RowBox[{"CoefficientRules", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DeleteDuplicates", "@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modNRC", "[", "\"\<stateVars\>\"", "]"}], "[", "t",
                   "]"}], ",", 
                 SuperscriptBox[
                  RowBox[{"_Symbol", "[", "t", "]"}], "p_."], ",", 
                 "Infinity"}], "]"}]}]}], "]"}]}]}], "==", "1"}], ")"}], 
        "&"}], "/@", 
       RowBox[{"ee", "[", "modNRC", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Max", "@", 
           RowBox[{"Keys", "@", 
            RowBox[{"CoefficientRules", "[", 
             RowBox[{"#", ",", 
              RowBox[{"DeleteDuplicates", "@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modDES", "[", "\"\<stateVars\>\"", "]"}], "[", "t",
                   "]"}], ",", 
                 SuperscriptBox[
                  RowBox[{"_Symbol", "[", "t", "]"}], "p_."], ",", 
                 "Infinity"}], "]"}]}]}], "]"}]}]}], "==", "1"}], ")"}], 
        "&"}], "/@", 
       RowBox[{"ee", "[", "modDES", "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895385311831744*^9, 3.895385481494638*^9}, {
   3.895385672619301*^9, 3.895385717739428*^9}, {3.8953859145684547`*^9, 
   3.895385964555834*^9}, {3.8953862837960443`*^9, 3.895386295909346*^9}, {
   3.895386989764208*^9, 3.895387006333869*^9}, {3.895388061592813*^9, 
   3.8953880660972147`*^9}, 3.895388147209415*^9, {3.895388202226654*^9, 
   3.8953882082150087`*^9}, {3.89538826632761*^9, 3.895388273833865*^9}, 
   3.895388382755307*^9, {3.895388720275887*^9, 3.8953887290016813`*^9}, {
   3.8953899769186487`*^9, 3.895390048007641*^9}, 3.895394725800404*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"382933e8-a18a-43b2-9bd5-7cd322f719ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "euler", " ", "eq", " ", "has", " ", "all", " ", "wc", " ", 
    "coefficients"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eeAll", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}]}], "&"}], "/@", 
          RowBox[{"coeffWcAll", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "mods", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eeAll", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}]}], "&"}], "/@", 
          RowBox[{"coeffPdAll", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "mods", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eeAll", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "3"}], "]"}], "]"}], "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}]}], "&"}], "/@", 
          RowBox[{"coeffBondAll", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "mods", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eeAll", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "4"}], "]"}], "]"}], "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}]}], "&"}], "/@", 
          RowBox[{"coeffNomBondAll", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "mods", "]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895385311831744*^9, 3.895385481494638*^9}, {
   3.895385672619301*^9, 3.895385717739428*^9}, {3.8953859145684547`*^9, 
   3.895385964555834*^9}, {3.8953862837960443`*^9, 3.895386295909346*^9}, {
   3.895386989764208*^9, 3.895387006333869*^9}, {3.895388061592813*^9, 
   3.8953880660972147`*^9}, 3.895388147209415*^9, {3.895388202226654*^9, 
   3.8953882082150087`*^9}, {3.89538826632761*^9, 3.895388273833865*^9}, 
   3.895388382755307*^9, {3.895388720275887*^9, 3.8953887290016813`*^9}, {
   3.8953899769186487`*^9, 3.895390048007641*^9}, 3.895394725800404*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"3e0ea8d1-c496-4ab2-9b48-2100f0fd1a3c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", "test", " ", "findEulerEqConstants"}], "**)"}]], "Input",
 CellChangeTimes->{3.895389747518649*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"759b42d4-5a5d-48a8-8f3d-f6255631a3fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "equations", " ", "for", " ", "the", " ", 
    "coefficients", " ", "equals", " ", "number", " ", "of", " ", "state", 
    " ", "variables", " ", "plus", " ", "1", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "the", " ", "term", " ", "that", " ", "does", " ", "not", 
      " ", "multiply", " ", "any", " ", "state", " ", "var"}], ")"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"findEulerEqConstants", "[", 
                RowBox[{
                 RowBox[{"retc", "[", "t", "]"}], ",", "#"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"0", "==", "x__"}], " ", ":>", " ", "True"}]}], "]"}], 
            ",", "True"}], "]"}], "===", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"#", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
            "]"}], "+", "1"}]}], ")"}], "&"}], "/@", "mods"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"findEulerEqConstants", "[", 
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{"t", ",", "j"}], "]"}], ",", "#"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"0", "==", "x__"}], " ", ":>", " ", "True"}]}], "]"}], 
            ",", "True"}], "]"}], "===", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"#", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
            "]"}], "+", "1"}]}], ")"}], "&"}], "/@", "mods"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"findEulerEqConstants", "[", 
                RowBox[{
                 RowBox[{"bondret", "[", 
                  RowBox[{"t", ",", "m"}], "]"}], ",", "#"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"0", "==", "x__"}], " ", ":>", " ", "True"}]}], "]"}], 
            ",", "True"}], "]"}], "===", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"#", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
            "]"}], "+", "1"}]}], ")"}], "&"}], "/@", "mods"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"findEulerEqConstants", "[", 
                RowBox[{
                 RowBox[{"nombondret", "[", 
                  RowBox[{"t", ",", "m"}], "]"}], ",", "#", ",", " ", 
                 "True"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"0", "==", "x__"}], " ", ":>", " ", "True"}]}], "]"}], 
            ",", "True"}], "]"}], "===", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"#", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
            "]"}], "+", "1"}]}], ")"}], "&"}], "/@", "mods"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895388860815771*^9, 3.8953889743856173`*^9}, {
   3.8953890079692087`*^9, 3.8953891898696423`*^9}, {3.895389236315548*^9, 
   3.895389237140854*^9}, {3.8953896036751204`*^9, 3.8953896049656277`*^9}, {
   3.895389645228754*^9, 3.8953896519199467`*^9}, {3.8953901187330217`*^9, 
   3.895390119142971*^9}, 3.895391684154141*^9, {3.8953922455415573`*^9, 
   3.895392355602806*^9}, {3.8953925147579393`*^9, 3.895392515041278*^9}, {
   3.895394715263129*^9, 3.895394734669942*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"b6d3d70b-281f-40ca-9d06-9022cedaaae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "eq", " ", "for", " ", "coefficients", " ", "do", " ", "not", " ", "have", 
    " ", "t"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"retc", "[", "t", "]"}], ",", "#"}], "]"}], ",", "t"}], 
         "]"}], "&"}], "/@", "mods"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"t", ",", "j"}], "]"}], ",", "#"}], "]"}], ",", "t"}], 
         "]"}], "&"}], "/@", "mods"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}], ",", "#"}], "]"}], ",", "t"}], 
         "]"}], "&"}], "/@", "mods"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"nombondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}], ",", "#", ",", " ", "True"}], 
           "]"}], ",", "t"}], "]"}], "&"}], "/@", "mods"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895388860815771*^9, 3.8953889743856173`*^9}, {
   3.8953890079692087`*^9, 3.8953891898696423`*^9}, {3.895389236315548*^9, 
   3.895389237140854*^9}, {3.8953896036751204`*^9, 3.8953896049656277`*^9}, {
   3.895389645228754*^9, 3.8953896519199467`*^9}, {3.8953901187330217`*^9, 
   3.895390119142971*^9}, 3.895391684154141*^9, {3.8953922455415573`*^9, 
   3.895392355602806*^9}, {3.8953925147579393`*^9, 3.895392515041278*^9}, {
   3.895394715263129*^9, 3.895394737802577*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1bb9219a-8c4a-4795-ac91-25e355770c51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "constants", " ", "for", " ", "wc", " ", "ratio", " ", "are", " ", 
    "independent", " ", "of", " ", "time", " ", "period"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"retc", "[", "t", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         "mods"}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"retc", "[", 
             RowBox[{"t", "+", "1"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         "mods"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"t", ",", "j"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         "mods"}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", "j"}], "]"}], ",", "#"}], "]"}], 
          "&"}], "/@", "mods"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         "mods"}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", "m"}], "]"}], ",", "#"}], "]"}], 
          "&"}], "/@", "mods"}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"nombondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}], ",", "#", ",", " ", "True"}], 
           "]"}], "&"}], "/@", "mods"}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"findEulerEqConstants", "[", 
           RowBox[{
            RowBox[{"nombondret", "[", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", "m"}], "]"}], ",", "#", ",", " ", 
            "True"}], "]"}], "&"}], "/@", "mods"}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895388860815771*^9, 3.8953889743856173`*^9}, {
   3.8953890079692087`*^9, 3.8953891898696423`*^9}, {3.895389236315548*^9, 
   3.895389237140854*^9}, {3.8953896036751204`*^9, 3.8953896049656277`*^9}, {
   3.895389645228754*^9, 3.8953896519199467`*^9}, {3.8953901187330217`*^9, 
   3.895390119142971*^9}, 3.895391684154141*^9, {3.8953922455415573`*^9, 
   3.895392355602806*^9}, {3.8953925147579393`*^9, 3.895392515041278*^9}, {
   3.895394715263129*^9, 3.8953947409558907`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"b13b2f38-c952-467d-89a3-8ebfd83d4590"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "unknowns", " ", "in", " ", "Euler", " ", "eq", " ", "are", " ", "in", " ",
     "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
    "}"}], "===", 
   RowBox[{"DeleteDuplicates", "@", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Context", "[", 
           RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Rest", "@", 
                 RowBox[{"findEulerEqConstants", "[", 
                  RowBox[{
                   RowBox[{"retc", "[", "t", "]"}], ",", "#"}], "]"}]}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "0"}], "]"}], "]"}], "&"}], "/@", "mods"}], 
           ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Context", "[", 
           RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Rest", "@", 
                 RowBox[{"findEulerEqConstants", "[", 
                  RowBox[{
                   RowBox[{"ret", "[", 
                    RowBox[{"t", ",", "j"}], "]"}], ",", "#"}], "]"}]}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "0", ",", "0"}], "]"}], "]"}], "&"}], "/@", 
            "mods"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Context", "[", 
           RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Rest", "@", 
                 RowBox[{"findEulerEqConstants", "[", 
                  RowBox[{
                   RowBox[{"bondret", "[", 
                    RowBox[{"t", ",", "m"}], "]"}], ",", "#"}], "]"}]}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "0", ",", "0"}], "]"}], "]"}], "&"}], "/@", 
            "mods"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Context", "[", 
           RowBox[{"Evaluate", "[", "#", "]"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Rest", "@", 
                 RowBox[{"findEulerEqConstants", "[", 
                  RowBox[{
                   RowBox[{"nombondret", "[", 
                    RowBox[{"t", ",", "m"}], "]"}], ",", "#", ",", "True"}], 
                  "]"}]}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "0", ",", "0"}], "]"}], "]"}], "&"}], "/@", 
            "mods"}], ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8953947088712397`*^9, 3.895394709442305*^9}, 
   3.895394744666971*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"1cb2d04d-5b93-41dd-910f-7b1f79b34941"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "each", " ", "equation", " ", "evaluates", " ", "to", " ", "True", " ", 
    "or", " ", "False", " ", "when", " ", "evaluated", " ", "numerically"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"checkBoolean", "[", "model_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "e0", ",", "e1", ",", "e2", ",", "e3", ",", "e0p", ",", "e1p", ",", 
        "e2p", ",", "e3p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"e0", "=", 
        RowBox[{"findEulerEqConstants", "[", 
         RowBox[{
          RowBox[{"retc", "[", "t", "]"}], ",", "model"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e1", "=", 
        RowBox[{"findEulerEqConstants", "[", 
         RowBox[{
          RowBox[{"ret", "[", 
           RowBox[{"t", ",", "1"}], "]"}], ",", "model"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e2", "=", 
        RowBox[{"findEulerEqConstants", "[", 
         RowBox[{
          RowBox[{"bondret", "[", 
           RowBox[{"t", ",", "m"}], "]"}], ",", "model"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e3", "=", 
        RowBox[{"findEulerEqConstants", "[", 
         RowBox[{
          RowBox[{"nombondret", "[", 
           RowBox[{"t", ",", "m"}], "]"}], ",", "model", ",", " ", "True"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e0p", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Normal", "@", 
            RowBox[{"model", "[", "\"\<parameters\>\"", "]"}]}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"e0", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "->", "4"}], "]"}], ",", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`Ewc", "->", 
            "4"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e1p", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{"e0p", ",", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd", 
             "[", "_", "]"}], "->", "4"}], ",", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`Epd", "[", 
             "_", "]"}], "->", "4"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e2p", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{"e0p", ",", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb", 
             "[", "m_", "]"}], "->", "4"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e3p", "=", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{"e0p", ",", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefnb", 
             "[", "m_", "]"}], "->", "4"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"e0", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "e0p"}], ",", 
         RowBox[{
          RowBox[{"e1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "e1p"}], ",", 
         RowBox[{
          RowBox[{"e2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "e2p"}], ",", 
         RowBox[{
          RowBox[{"e3", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "e3p"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"BooleanQ", "/@", 
      RowBox[{"(", 
       RowBox[{"Flatten", "@", 
        RowBox[{"checkBoolean", "[", "modBY", "]"}]}], ")"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8953947088712397`*^9, 3.895394709442305*^9}, 
   3.895394744666971*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"7f4d9f49-59de-4b52-93fb-2963531a2a58"]
}, Closed]],

Cell[CellGroupData[{

Cell["EndogenousEq", "Section",
 CellChangeTimes->{
  3.9062968674946747`*^9},ExpressionUUID->"21973bd9-2870-465f-928a-\
5174622faf9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"7bd62628-134f-44df-ad26-b268d1ea37f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"93bc7d74-96e6-4bf7-a6a2-9cd98ba5dc42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891258400453268*^9, 3.891258400821343*^9}, 
   3.906297250955801*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"ab92f4ac-3142-49e7-9ec3-8424356db416"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Model\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Model`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.891249043174148*^9, 
   3.891249043429118*^9}, {3.906297252089654*^9, 3.9062972530226507`*^9}, {
   3.906297356844983*^9, 3.906297357914658*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0f0fc4e3-dfb6-4834-b000-8b711318309d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "exogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", 
        "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Symbol", "/@", "$endogenousVars"}], ")"}]}], ")"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{"var_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringDrop", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                 "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
             ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
        "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.893001201934902*^9, 3.893001214021667*^9}, {
  3.893001245798745*^9, 3.8930012743606873`*^9}, {3.893001352341578*^9, 
  3.893001386197197*^9}, {3.893001448430169*^9, 3.893001448726687*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"2c09420c-adc0-40d7-8fe2-6605a99cd947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "shocks", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Symbol", "/@", "$endogenousVars"}], ")"}]}], ")"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"var_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "__", "]"}], "[", "__", "]"}], ":>",
           "var"}], ",", "Infinity"}], "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{3.893001499960679*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"4455a14b-dc84-444d-9c64-628b94338030"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "parameters", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Symbol", "/@", "$endogenousVars"}], ")"}]}], ")"}], ",", 
         
         RowBox[{
          RowBox[{"var_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters", ",", 
               
               RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}],
           ":>", "var"}], ",", "Infinity"}], "]"}]}], ")"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{3.893001501399847*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"575159dc-85e4-48ba-80a3-c0a122cee928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "endogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", 
        "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Symbol", "/@", "$endogenousVars"}], ")"}]}], ")"}], ",", 
         
         RowBox[{
          RowBox[{
           RowBox[{"var_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringDrop", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                 "$endogenousVars"}], ",", 
                RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
             ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
        "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.89300111387222*^9, 3.8930011727459707`*^9}, {
  3.893001247830225*^9, 3.893001299678648*^9}, {3.893001353751255*^9, 
  3.8930015072417727`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"c5a7804e-3dd4-4dee-8cc6-54cf9a8017c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "different", " ", "contexts", " ", "for", " ", "t", " ", "and", " ", "eq", 
    " ", "vars"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"bondyieldeq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", "foo`t"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}], ",", "t"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"bondyieldeq", "[", 
        RowBox[{"foo`t", ",", "m"}], "]"}], ",", "t"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"foo`t", ",", "m"}], "]"}], ",", "foo`t"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"foo`bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "===", 
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "===", 
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"foo`t", ",", "m"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.891249141704917*^9, 3.89124916402168*^9}, {
   3.891249445870871*^9, 3.8912494720282707`*^9}, {3.891250866902298*^9, 
   3.891250867076214*^9}, {3.8930015258912563`*^9, 3.8930016288464193`*^9}, 
   3.893001996652837*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"29f2ab77-a993-4266-9069-ae7c9416be9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "different", " ", "contexts", " ", "for", " ", "m", " ", "and", " ", "eq", 
    " ", "vars"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"bondyieldeq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], ",", "foo`m"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}], ",", "m"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"bondyieldeq", "[", 
        RowBox[{"t", ",", "foo`m"}], "]"}], ",", "m"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "foo`m"}], "]"}], ",", "foo`m"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "===", 
        RowBox[{"bondyieldeq", "[", 
         RowBox[{"t", ",", "foo`m"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.891249141704917*^9, 3.89124916402168*^9}, {
   3.891249445870871*^9, 3.8912494720282707`*^9}, {3.891250866902298*^9, 
   3.891250867076214*^9}, {3.8930015258912563`*^9, 3.8930016288464193`*^9}, 
   3.893001996652837*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"4aebe6ea-d52a-476c-a84c-de249413bcc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"default", " ", "values", " ", "for", " ", "arguments"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bondfweq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], "===", 
       RowBox[{"bondfweq", "[", 
        RowBox[{"t", ",", "m", ",", "1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bondreteq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], "===", 
       RowBox[{"bondreteq", "[", 
        RowBox[{"t", ",", "m", ",", "1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bondfwspreadeq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], "===", 
       RowBox[{"bondfwspreadeq", "[", 
        RowBox[{"t", ",", "m", ",", "1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bondexcreteq", "[", 
        RowBox[{"t", ",", "m"}], "]"}], "===", 
       RowBox[{"bondexcreteq", "[", 
        RowBox[{"t", ",", "m", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.889976523114066*^9, 3.889976540444695*^9}, {
  3.893001639326522*^9, 3.893001727628183*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"d4ba8c28-d5d1-48cd-a2c8-bfbb6fb006db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "indices", " ", "of", " ", "coefficients", " ", "are", " ", "exact", " ", 
    "integers"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "coefwc", "=", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefwc"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "coefpd", "=", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "coefb", "=", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "coefnb", "=", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefnb"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hpd", "=", 
     RowBox[{"Head", "@", "coefpd"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hb", "=", 
     RowBox[{"Head", "@", "coefb"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hnb", "=", 
     RowBox[{"Head", "@", "coefnb"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ch", "=", 
     RowBox[{"Flatten", "@", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"coefwc", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"N", "@", 
           RowBox[{"coefwc", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{"coefwc", "[", "0", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coefwc", "[", "0.", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"N", "@", 
           RowBox[{"coefwc", "[", "0.", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{"coefwc", "[", "0.", "]"}], "]"}]}], "\[IndentingNewLine]",
          "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"c", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"N", "@", 
             RowBox[{"c", "[", "0", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"N", "[", 
             RowBox[{"c", "[", "0", "]"}], "]"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"c", "[", "0.", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"N", "@", 
             RowBox[{"c", "[", "0.", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"N", "[", 
             RowBox[{"c", "[", "0.", "]"}], "]"}]}], "}"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"{", 
             RowBox[{"coefpd", ",", "coefb", ",", "coefnb"}], "}"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"h", "[", "1", "]"}], "[", "0", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "1", "]"}], "[", "0", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "1", "]"}], "[", "0", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "1", "]"}], "[", "0.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "1", "]"}], "[", "0.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "1", "]"}], "[", "0.", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0", "]"}], "[", "1", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "1", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0.", "]"}], "[", "1", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "1", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "1", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "1.", "]"}], "[", "0", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "1.", "]"}], "[", "0", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "1.", "]"}], "[", "0", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "1.", "]"}], "[", "0.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "1.", "]"}], "[", "0.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "1.", "]"}], "[", "0.", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0", "]"}], "[", "1.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "1.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{"h", "[", "0", "]"}], "]"}], "[", "1.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0.", "]"}], "[", "1.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "1.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "1.", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0", "]"}], "[", "j", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "j", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "j", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0.", "]"}], "[", "j", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "j", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "j", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "j", "]"}], "[", "0", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "j", "]"}], "[", "0", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "j", "]"}], "[", "0", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "j", "]"}], "[", "0.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "j", "]"}], "[", "0.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "j", "]"}], "[", "0.", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0", "]"}], "[", "jj", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "jj", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "[", "jj", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "0.", "]"}], "[", "jj", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "jj", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "0.", "]"}], "[", "jj", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "jj", "]"}], "[", "0", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "0", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "0", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "jj", "]"}], "[", "0.", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "0.", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "0.", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", "[", "jj", "]"}], "[", "kk", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "kk", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"h", "[", "jj", "]"}], "[", "kk", "]"}], "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"N", "@", 
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"h", "[", "ii", "]"}], "[", "qq", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"N", "@", 
                    RowBox[{
                    RowBox[{"h", "[", "ii", "]"}], "[", "qq", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"h", "[", "ii", "]"}], "[", "qq", "]"}], "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "0", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"qq", ",", "2", ",", "3"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], " ", "/.", 
            RowBox[{"jj", "->", "2"}]}], "/.", 
           RowBox[{"kk", "->", "3"}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"h", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Head", "@", "coefpd"}], ",", 
              RowBox[{"Head", "@", "coefb"}], ",", 
              RowBox[{"Head", "@", "coefnb"}]}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Not", "/@", 
         RowBox[{"InexactNumberQ", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"Cases", "[", 
              RowBox[{"ch", ",", 
               RowBox[{
                RowBox[{"x_", "[", "i_", "]"}], ":>", "i"}]}], "]"}]}], ",", 
            "NumberQ"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Not", "/@", 
         RowBox[{"InexactNumberQ", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"Cases", "[", 
              RowBox[{"ch", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"x_", "[", "i_", "]"}], "[", "j_", "]"}], ":>", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}]}]}], "]"}]}], ",", 
            "NumberQ"}], "]"}]}]}]}], "}"}], "\[IndentingNewLine]", 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.903284197964473*^9, 3.903284451708227*^9}, {
  3.903284489773975*^9, 3.903284495622746*^9}, {3.9032845325526657`*^9, 
  3.903284577032341*^9}, {3.903284611773882*^9, 3.903284627874106*^9}, {
  3.903315169597864*^9, 3.903315184051227*^9}, {3.903315803874839*^9, 
  3.903315809654161*^9}, {3.903316271248337*^9, 3.903316271649033*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"3a7c45d4-f1e8-414c-bdd2-aac1165dcdc1"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExogenousEq", "Section",
 CellChangeTimes->{
  3.906296869204805*^9},ExpressionUUID->"72f815b2-92e8-409c-8877-\
47727967fe66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"4b72e8c2-0160-440e-80a5-ddbab454ca83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b1d6208d-e706-4f69-955f-fab32850c035"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, 3.891705186596882*^9, 3.901503325517468*^9, 
   3.906297254505946*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"f6449add-421e-430b-a4f5-074001e539c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Model\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Model`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.891159388110983*^9, 
   3.891159388420541*^9}, {3.906297255656575*^9, 3.906297256438151*^9}, {
   3.906297370441753*^9, 3.9062973711512823`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"2f93a02f-5072-47c5-9d08-1ee32c875012"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allShocks", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<SetSymbolsContext\>\"", "]"}], 
      "[", 
      RowBox[{"ToExpression", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "<>", "\"\<[t]\>\""}], ")"}], "&"}], "/@", 
         "$exogenousVars"}], ")"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"eps", "[", "var_", "]"}], "[", "t_", "]"}], ":>", 
      RowBox[{
       RowBox[{"ToString", "[", "var", "]"}], "<>", "\"\<eq\>\""}]}], ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SubsetQ", "[", 
  RowBox[{"$exogenousVars", ",", 
   RowBox[{"DeleteDuplicates", "@", "allShocks"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8913142070537786`*^9, 3.891314434192008*^9}, {
  3.891314466313642*^9, 3.891314472490741*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"07421a8f-e067-4a05-b93d-c59daeefef95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "exogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"xeq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<x\>\""}], 
                  "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"pieq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}],
                   "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"pibareq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                   "\"\<pibar\>\""}], "]"}], "&"}], ")"}]}], "[", "___", 
              "]"}], ":>", "var"}], ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"sgeq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}],
                   "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"sxeq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sx\>\""}],
                   "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"sceq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sc\>\""}],
                   "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"speq", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_Symbol", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sp\>\""}],
                   "]"}], "&"}], ")"}]}], "[", "___", "]"}], ":>", "var"}], 
            ",", "Infinity"}], "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Symbol", "/@", 
          RowBox[{
          "Names", "[", 
           "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`*\>\"", 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"var_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], 
              "]"}], "&"}], ")"}]}], ":>", "var"}], ",", "Infinity"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Symbol", "/@", 
          RowBox[{
          "Names", "[", 
           "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`*\>\"", 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"var_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
              "]"}], "&"}], ")"}]}], ":>", "var"}], ",", "Infinity"}], 
        "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Symbol", "/@", 
             RowBox[{
             "Names", "[", 
              "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`*\>\"\
", "]"}]}], ",", 
            RowBox[{
             RowBox[{"var_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], 
                 "]"}], "&"}], ")"}]}], ":>", "var"}], ",", "Infinity"}], 
           "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"(", 
         RowBox[{"Context", "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Symbol", "/@", 
             RowBox[{
             "Names", "[", 
              "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`*\>\"\
", "]"}]}], ",", 
            RowBox[{
             RowBox[{"var_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
                 "]"}], "&"}], ")"}]}], ":>", "var"}], ",", "Infinity"}], 
           "]"}]}], ")"}]}], ",", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "]"}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.892991381424305*^9, 3.8929916518802958`*^9}, {
  3.8929916861199837`*^9, 3.892991779484473*^9}, {3.892992066667197*^9, 
  3.892992102299266*^9}, {3.892992774657414*^9, 3.892992841499052*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2bef80d4-5ef3-4b10-a7bb-170fd312b4a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "exogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", 
        "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Symbol", "/@", "$exogenousVars"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"var_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringDrop", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                 "$exogenousVars"}], ",", 
                RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
             ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
        "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.892993737772028*^9, 3.892993762389083*^9}, 
   3.892993820231213*^9, {3.892993909876807*^9, 3.892993921321001*^9}, {
   3.892993957942197*^9, 3.892993975404036*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"11c255cf-0c0a-4d2c-866c-43c4308d6aa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "shocks", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "#", "===", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
        ")"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"Context", "/@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Symbol", "/@", "$exogenousVars"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"var_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}],
                  "]"}], "&"}], ")"}]}], "[", "__", "]"}], "[", "__", "]"}], ":>",
            "var"}], ",", "Infinity"}], "]"}]}], ")"}]}], ")"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.89299304534096*^9, 3.892993331708364*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7f31c5b5-2247-46eb-92a2-81b3f9080ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "parameters", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "#", "===", "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
       ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"Context", "/@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "[", "t", "]"}], ")"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Symbol", "/@", "$exogenousVars"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"var_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters", ",", 
               
               RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], ")"}]}],
           ":>", "var"}], ",", "Infinity"}], "]"}]}], ")"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8929930628202457`*^9, 3.892993074086934*^9}, {
  3.8929933403959827`*^9, 3.892993340674637*^9}, {3.892993382056836*^9, 
  3.892993388417315*^9}, {3.892993430422512*^9, 3.8929934561734447`*^9}, {
  3.8929936732366657`*^9, 3.8929936803494873`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4b183f66-06c6-45ad-bd71-195f71608574"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "different", " ", "contexts", " ", "for", " ", "t", " ", "and", " ", "eq", 
    " ", "vars"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"xeq", "[", "t", "]"}], ",", "foo`t"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"xeq", "[", "t", "]"}], ",", "t"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"xeq", "[", "foo`t", "]"}], ",", "t"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"xeq", "[", "foo`t", "]"}], ",", "foo`t"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"foo`xeq", "[", "t", "]"}], "===", 
        RowBox[{"xeq", "[", "t", "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xeq", "[", "t", "]"}], "===", 
        RowBox[{"xeq", "[", "foo`t", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8899726167879753`*^9, 3.8899726421861687`*^9}, 
   3.889973060122468*^9, {3.890118946451016*^9, 3.890118971417235*^9}, {
   3.890119016281435*^9, 3.89011902196559*^9}, {3.892992860119802*^9, 
   3.892993001999461*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"a5f29822-1961-4f0e-831b-9f8af176406e"]
}, Closed]],

Cell[CellGroupData[{

Cell["NiceOutput", "Section",
 CellChangeTimes->{
  3.9062968725948563`*^9},ExpressionUUID->"3a441f08-3e3d-4ee9-8df1-\
48bee4dea4eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.890031566462019*^9, 3.890031568811056*^9}, 
   3.891753377415228*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"2c3104c9-1884-4521-ad68-63f2a0fd365c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"16569ed3-8654-4c01-aade-36aabd33e66e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891257888860939*^9, 3.8912578891768503`*^9}, 
   3.905170973360199*^9, 3.906297257337756*^9, 3.906297384394552*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"0bf10123-fcfe-4836-a02e-5e528450bf4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Tools\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Tools`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", " ", "=", " ", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Prepend", "[", 
     RowBox[{
     "$ContextPath", ",", 
      "\"\<FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\>\""}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.891159388110983*^9, 
   3.891159388420541*^9}, {3.891159688056053*^9, 3.891159704172017*^9}, {
   3.891748927421254*^9, 3.8917489278823643`*^9}, {3.891749223961915*^9, 
   3.891749231277231*^9}, {3.891749519456523*^9, 3.891749519771348*^9}, {
   3.90515611186259*^9, 3.905156112130745*^9}, {3.90517426920163*^9, 
   3.905174278720889*^9}, {3.906297258072156*^9, 3.906297259323777*^9}, {
   3.906297387294798*^9, 3.906297388974872*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"8e7093f9-b516-42c8-a9be-e4c4ac7696ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk\>\"", ",", "\"\<Models.wl\>\""}], "}"}],
      "]"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBKY", "=", 
   RowBox[{"msp", "[", "\"\<BKY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRCStochVol", "=", 
   RowBox[{"msp", "[", "\"\<NRCStochVol\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"myModels", "=", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<BY\>\"", "->", "modBY"}], ",", 
       RowBox[{"\"\<BKY\>\"", "->", "modBKY"}], ",", 
       RowBox[{"\"\<NRC\>\"", "->", "modNRC"}], ",", 
       RowBox[{"\"\<DES\>\"", "->", "modDES"}], ",", 
       RowBox[{"\"\<NRCStochVol\>\"", "->", "modNRCStochVol"}]}], " ", 
      "|>"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.905156041870823*^9, 3.905156053614505*^9}, {
   3.905156126678938*^9, 3.90515613250208*^9}, 3.9051568191108217`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"5a17a0d1-7ec2-4a6e-9714-76caf4bd7d0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"inspect", " ", "visually"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "symbols", " ", "should", " ", "not", " ", "display", " ", "their", " ", 
    "context"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"myModelsInfo", "=", 
   RowBox[{"PacletizedResourceFunctions`SetSymbolsContext", "@", 
    RowBox[{"info", "[", "msp", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8917495538778677`*^9, 3.8917495775508204`*^9}, 
   3.891749774892411*^9, {3.891750469682312*^9, 3.891750518135106*^9}, {
   3.891750560646047*^9, 3.8917505628539457`*^9}, {3.891750796319543*^9, 
   3.89175079921373*^9}, {3.891750865678462*^9, 3.891750869123267*^9}, {
   3.905156554989571*^9, 3.905156561743312*^9}, {3.905162519874879*^9, 
   3.90516252701362*^9}, {3.905174323221078*^9, 3.905174326319228*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0c8d1477-2b65-41f1-b1b9-7f0e982928c5"],

Cell[BoxData[
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "myModelsInfo", "]"}], "===", "Column"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"myModelsInfo", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"myModelsInfo", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "OpenerView"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"#", ",", "Grid"}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Head", "/@", 
         RowBox[{"myModelsInfo", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", ";;", ",", "1", ",", "2"}], "]"}], "]"}]}], 
        ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.891751937937875*^9, 3.891751940577396*^9}, {
  3.905157042557342*^9, 3.9051570514361677`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"9b077381-d8a6-4f86-8e7f-50c90f388e07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "that", " ", "Info", " ", "is", " ", "correct", " ", "when", 
    " ", "model", " ", "key", " ", "does", " ", "not", " ", "match", " ", 
    "shortname"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"justBY", "=", 
     RowBox[{"<|", 
      RowBox[{"\"\<BY\>\"", "->", 
       RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], "|>"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"infoBY", "=", 
     RowBox[{"PacletizedResourceFunctions`SetSymbolsContext", "@", 
      RowBox[{"info", "[", "justBY", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newBY", "=", 
     RowBox[{"<|", 
      RowBox[{"\"\<myModel\>\"", "->", 
       RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], "|>"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"infoNewBY", "=", 
     RowBox[{"PacletizedResourceFunctions`SetSymbolsContext", "@", 
      RowBox[{"info", "[", "newBY", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"infoBY", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "==", 
       "\"\<BY\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"infoBY", "[", 
        RowBox[{"[", 
         RowBox[{
         "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "4", ",", "1", ",",
           "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], "]"}], 
        "]"}], "===", 
       RowBox[{"x", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"infoNewBY", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], "==", 
       "\"\<BY\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"infoNewBY", "[", 
        RowBox[{"[", 
         RowBox[{
         "1", ",", "1", ",", "1", ",", "2", ",", "1", ",", "4", ",", "1", ",",
           "1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], "]"}], 
        "]"}], "===", 
       RowBox[{"x", "[", "t", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.890140021630383*^9, 3.890140040264176*^9}, {
   3.8911598232359867`*^9, 3.891159824939945*^9}, 3.891159870680977*^9, {
   3.8911649478485518`*^9, 3.891164969623293*^9}, 3.8911651835823393`*^9, 
   3.89116566169151*^9, {3.891170529265967*^9, 3.891170540528756*^9}, 
   3.891172091915544*^9, 3.891751026146418*^9, {3.891751212056683*^9, 
   3.8917512180969152`*^9}, {3.89175130841641*^9, 3.8917513106188173`*^9}, {
   3.9051566553259*^9, 3.905156674635653*^9}, {3.905156794657361*^9, 
   3.905156797851418*^9}, {3.9051568677703733`*^9, 3.9051568805673037`*^9}, {
   3.905156947197817*^9, 3.905157038104455*^9}, {3.9051745700694113`*^9, 
   3.9051745829817963`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"63401f51-56f1-42cb-ac75-23c0fbe5d378"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "should", " ", "all", " ", "be", " ", "True", " ", "if", " ", "formatting",
     " ", "is", " ", "correct"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "infoBY", "]"}], "===", "Column"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"infoBY", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"infoBY", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "OpenerView"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "Grid"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Head", "/@", 
          RowBox[{"infoBY", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", ";;", ",", "1", ",", "2"}], "]"}], "]"}]}], 
         ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"Head", "[", "infoNewBY", "]"}], "===", "Column"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"infoNewBY", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"infoNewBY", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "===", "OpenerView"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "Grid"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Head", "/@", 
          RowBox[{"infoNewBY", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", ";;", ",", "1", ",", "2"}], "]"}], "]"}]}], 
         ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.891752016529977*^9, 3.8917520312748423`*^9}, {
  3.905157071597375*^9, 3.905157098838859*^9}, {3.905162589279602*^9, 
  3.905162601134802*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"302d4994-ac1d-47da-8e55-989ad27c80b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"localPi", "=", "3.14"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", "3.14", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"3.14", ",", 
        RowBox[{"NumberMarks", "->", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"3.14", ",", 
        RowBox[{"NumberMarks", "->", "False"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", "localPi", "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"localPi", ",", 
        RowBox[{"NumberMarks", "->", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"localPi", ",", 
        RowBox[{"NumberMarks", "->", "False"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", "\[CapitalPi]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"\[CapitalPi]", ",", 
        RowBox[{"CharacterEncoding", "\[Rule]", "\"\<ASCII\>\""}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", "Pi", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"N", "[", "Pi", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"3.14", "*", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "7"}], ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
numberFormattingTemplate", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`stripContext",
             "[", "delta", "]"}], "/", "2"}], "/.", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`stripContext", 
           "[", 
           RowBox[{"{", 
            RowBox[{"delta", "->", "0.99"}], "}"}], "]"}]}], "}"}], "]"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], "===", 
  RowBox[{"{", 
   RowBox[{
   "\"\<3.14\>\"", ",", "\"\<3.14`\>\"", ",", "\"\<3.14\>\"", ",", 
    "\"\<3.14\>\"", ",", "\"\<3.14`\>\"", ",", "\"\<3.14\>\"", ",", 
    "\"\<\[CapitalPi]\>\"", ",", "\"\<\\\\[CapitalPi]\>\"", ",", 
    "\"\<3.141592653589793\>\"", ",", "\"\<3.141592653589793\>\"", ",", 
    "\"\<3.14*^-7\>\"", ",", "\"\<{0.495}\>\""}], "}"}]}]], "Input",
 CellChangeTimes->{{3.905175192106395*^9, 3.905175202058524*^9}, 
   3.90577160897528*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"9b010e72-103d-4fa7-b565-7edf57e0dc08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "should", " ", "be", " ", "True", " ", "if", " ", "string", " ", "has", 
    " ", "linebreaks", " ", "\\n", " ", "and", " ", 
    RowBox[{"tabs", " ", "\\", "t"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Not", "@", 
   RowBox[{"StringFreeQ", "[", 
    RowBox[{
     RowBox[{
     "FernandoDuarte`LongRunRisk`Tools`NiceOutput`Private`\
stringFormattingTemplate", "[", 
      "\"\<Long-run risk model with stochastic volatility in the original \
2004 paper by Bansal and Yaron\>\"", "]"}], ",", 
     RowBox[{"\"\<\\t\>\"", "|", "\"\<\\n\>\""}]}], "]"}]}]}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"801c549f-d3e7-4678-bee2-ad76e7dfc2c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"check", " ", "re"}], "-", 
    RowBox[{
    "creating", " ", "formatting", " ", "of", " ", "model", " ", 
     "definitions", " ", "in", " ", "Catalog"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Needs", "[", "\"\<FernandoDuarte`LongRunRisk`Model`Catalog`\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"CreateNotebook", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rawModels", "=", 
     RowBox[{"toCatalog", "[", 
      RowBox[{"msp", ",", 
       RowBox[{"Keys", "@", 
        RowBox[{"First", "@", "models"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"content", "=", 
     RowBox[{"formatModels", "[", "rawModels", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookWrite", "[", 
     RowBox[{"nb", ",", "content"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"opens", " ", "new", " ", "notebook"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectionMove", "[", 
     RowBox[{"nb", ",", "All", ",", "Notebook"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FrontEndTokenExecute", "[", 
     RowBox[{"nb", ",", "\"\<ClearCellOptions\>\""}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.890015347069269*^9, 3.8900153891524878`*^9}, {
   3.890015708961783*^9, 3.890015758379883*^9}, {3.905157155789332*^9, 
   3.905157156198612*^9}, {3.9051580203248167`*^9, 3.905158034265682*^9}, {
   3.9051580945476522`*^9, 3.9051580949519587`*^9}, {3.9051581597959547`*^9, 
   3.905158193174815*^9}, {3.905162434055037*^9, 3.9051624547227917`*^9}, {
   3.90516643520125*^9, 3.905166435486589*^9}, {3.905166517901642*^9, 
   3.905166518608368*^9}, {3.9051669180156803`*^9, 3.9051669185400267`*^9}, 
   3.90517395713421*^9, {3.9057715547125893`*^9, 3.905771561273679*^9}, {
   3.905771625545314*^9, 3.9057716304048147`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"223aafce-507b-4087-b6c5-b0395bf3b7ff"]
}, Closed]],

Cell[CellGroupData[{

Cell["PacletizeResources", "Section",
 CellChangeTimes->{
  3.906296875741563*^9},ExpressionUUID->"6d43ddcd-4ed6-4620-b72b-\
de6fa980e917"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.906297401179203*^9, 3.9062974031453247`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d89d5200-0648-40a9-9593-014a08095b7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b0f31637-bcb3-403e-bfad-c8ba62fffaeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<FernandoDuarte`LongRunRisk`\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.89124517308853*^9, 3.891245207264389*^9}, 
   3.891247933220352*^9, 3.89176493741186*^9, 3.9057711288659353`*^9, 
   3.905771195887855*^9, 3.90629726020605*^9, {3.906297407766737*^9, 
   3.906297411913597*^9}, {3.9102252233990583`*^9, 
   3.910225223597439*^9}},ExpressionUUID->"beb7f168-b42d-4416-b21e-\
add08d9f9ff5"],

Cell[BoxData[{
 RowBox[{"MemberQ", "[", 
  RowBox[{"$ContextPath", ",", "\"\<MaTeX`\>\""}], "]"}], "\n", 
 RowBox[{"Not", "@", 
  RowBox[{"SameQ", "[", 
   RowBox[{
    RowBox[{"PacletFind", "[", "\"\<MaTeX\>\"", "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\n", 
 RowBox[{"Not", "@", 
  RowBox[{"SameQ", "[", 
   RowBox[{
    RowBox[{"PacletFind", "[", "\"\<PacletizedResourceFunctions\>\"", "]"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\n", 
 RowBox[{"MemberQ", "[", 
  RowBox[{"$Packages", ",", "\"\<MaTeX`\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PacletFind", "[", "\"\<MaTeX\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<Version\>\"", "]"}], "===", 
  "\"\<1.7.9\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Not", "@", 
  RowBox[{"SameQ", "[", 
   RowBox[{
    RowBox[{"PacletFind", "[", 
     RowBox[{"Names", "[", "\"\<*NeedsDefinitions\>\"", "]"}], "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Not", "@", 
  RowBox[{"SameQ", "[", 
   RowBox[{
    RowBox[{"PacletFind", "[", 
     RowBox[{"Names", "[", "\"\<*SetSymbolsContext\>\"", "]"}], "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.89049326620848*^9, 3.8904932792269497`*^9}, {
   3.891244668260336*^9, 3.891244677348711*^9}, {3.891244709399273*^9, 
   3.891244715663413*^9}, 3.905771184742223*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"f474afed-0994-4ca2-ae59-537ae10d7ed5"]
}, Closed]],

Cell[CellGroupData[{

Cell["ProcessModels", "Section",
 CellChangeTimes->{
  3.906296876984962*^9},ExpressionUUID->"cde8fab6-703e-4254-b629-\
56792769bb50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"72a93bfa-45e8-420f-91e8-5d40326b626b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"4d9229d9-a8d3-4e2c-92c6-71d1d40264cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891250905264741*^9, 3.891250915510642*^9}, 
   3.9062972608731613`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"c3423b85-109b-49fa-a3df-675d9709f55c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Model\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Model`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Get", "[", "\"\<FernandoDuarte`LongRunRisk`Model`Catalog`\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.8934756468185673`*^9, 
   3.893475650004422*^9}, {3.906297261638679*^9, 3.906297262375498*^9}, {
   3.9062974283745317`*^9, 3.9062974301633463`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"1b746896-14c2-41be-b3fb-72002d856eb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Resources\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Get", "[", "filename", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "data"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelsP", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.905823471999531*^9, 3.905823472096312*^9}, 
   3.90582414475002*^9, 3.905825524183859*^9, {3.9058257636057587`*^9, 
   3.905825769590568*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"b3b2dfec-bd60-427e-b9a5-a57e9880b4f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Keys", " ", "are", " ", "strings"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"StringQ", "/@", 
     RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.89000889839254*^9, {3.890016339728188*^9, 3.890016342139681*^9}, 
   3.891251908164126*^9, {3.8930041333335657`*^9, 3.8930041384325933`*^9}, {
   3.9058240207360353`*^9, 3.905824074472884*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"7f003c0d-2fd8-42a8-88b0-600c7545f1ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"string", " ", "fields"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"StringQ", "/@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<name\>\"", "]"}], 
           ",", 
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<shortname\>\"", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<bibRef\>\"", "]"}], 
           ",", 
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<desc\>\"", "]"}], 
           ",", 
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<exogenousVars\>\"", 
            "]"}], ",", 
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<endogenousVars\>\"",
             "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.890008770382118*^9, 3.890008858894733*^9}, {
  3.890016345133547*^9, 3.8900163569166937`*^9}, {3.891251925999875*^9, 
  3.891251929267716*^9}, {3.89300415697269*^9, 3.893004157463492*^9}, {
  3.8930148354335337`*^9, 3.893014849329674*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"578c86b3-3cbc-43f5-bd89-cf5b41aaa40b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"parameters", " ", "evaluate", " ", "to", " ", "numbers"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"NumberQ", "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Association", "@", 
             RowBox[{
              RowBox[{"models", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
              "]"}]}], "//.", 
            RowBox[{
             RowBox[{"models", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
             "]"}]}], "//", "N"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Keys", "@", "models"}], ")"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"NumberQ", "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Association", "@", 
             RowBox[{
              RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
              "]"}]}], "//.", 
            RowBox[{
             RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<parameters\>\"", 
             "]"}]}], "//", "N"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Keys", "@", "modelsP"}], ")"}]}], "]"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890008965671461*^9, 3.8900089726778793`*^9}, {
   3.8900090147612762`*^9, 3.890009193827691*^9}, 3.8900101461421833`*^9, 
   3.890015540563738*^9, {3.8900156352184877`*^9, 3.89001567714233*^9}, 
   3.8912519303524723`*^9, {3.891640840825358*^9, 3.8916408678776903`*^9}, {
   3.89164090174683*^9, 3.8916409201814632`*^9}, 3.892974136542371*^9, {
   3.89300417575723*^9, 3.893004176318849*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"5059929b-7685-447e-9b4e-3b423f792d56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"can", " ", "find", " ", "some", " ", "models"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "models", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<BY\>\"", ",", "\"\<BKY\>\""}], "}"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "modelsP", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"Keys", "@", "modelsP"}], ")"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8900087062162313`*^9, 3.890008740193614*^9}, {
   3.89001637048425*^9, 3.890016372993977*^9}, 3.8912519320207787`*^9, {
   3.891640927230764*^9, 3.891640929613118*^9}, 3.892974170435498*^9, {
   3.893004184988491*^9, 3.8930041852126703`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"fcae8f4c-011f-473e-a2fe-e61298ac1c3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"models", ",", " ", 
    RowBox[{"modelsP", " ", "are", " ", "associations"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{"models", ",", "AssociationQ"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"modelsP", ",", "AssociationQ"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"each", " ", "model", " ", "inside", " ", "models"}], ",", " ", 
     RowBox[{
     "modelsP", " ", "are", " ", "themselves", " ", "an", " ", 
      "association"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"models", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "models", "]"}]}], ",", "AssociationQ"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"modelsP", "[", "#", "]"}], "&"}], "/@", 
      RowBox[{"Keys", "[", "modelsP", "]"}]}], ",", "AssociationQ"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8900086430073547`*^9, 3.890008684982678*^9}, {
  3.890010177349143*^9, 3.890010179091837*^9}, {3.8900163791247263`*^9, 
  3.890016449580503*^9}, {3.891251933188879*^9, 3.891251935189865*^9}, {
  3.891640937075639*^9, 3.891640945348556*^9}, {3.893004194158003*^9, 
  3.893004229582778*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"8a5ea691-7218-4a52-94f0-94177c0f9e6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "exogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\"\
"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<stateVars\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<modelAssumptions\>\"", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\"\
"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<modelAssumptions\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<exogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\"\
"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<exogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<endogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\"\
"}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893001201934902*^9, 3.893001214021667*^9}, {
   3.893001245798745*^9, 3.8930012743606873`*^9}, {3.893001352341578*^9, 
   3.893001386197197*^9}, {3.893001448430169*^9, 3.893001448726687*^9}, 
   3.8930026482885447`*^9, {3.8930042711283293`*^9, 3.8930042721384*^9}, {
   3.89301215129099*^9, 3.893012163688088*^9}, {3.893014370482971*^9, 
   3.893014438233089*^9}, {3.893014486322825*^9, 3.893014499135116*^9}, {
   3.893014551885273*^9, 3.893014565016636*^9}, 3.893016122561097*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"d5698ad4-bd08-4cb3-9a76-b08d972559e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "shocks", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], ")"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<stateVars\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                   "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<modelAssumptions\>\"", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], ")"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<modelAssumptions\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                   "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<exogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], ")"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<exogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                   "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<endogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], ")"}], 
              "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                   "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.893001499960679*^9, {3.893002667440094*^9, 3.89300269939427*^9}, {
   3.893003083367228*^9, 3.893003083692607*^9}, {3.8930042730060863`*^9, 
   3.893004273989354*^9}, {3.893012064247108*^9, 3.8930120867411222`*^9}, {
   3.893014419748905*^9, 3.893014445806767*^9}, {3.893014573318915*^9, 
   3.893014592005512*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"6db3c419-5581-4db9-851a-42b53a3dcdf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "parameters", " ", "are", " ", "in", " ", "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", "\"\<parameters\>\"", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
               ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<parameters\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
              ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
               ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<stateVars\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
              ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<modelAssumptions\>\"", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
               ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<modelAssumptions\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
              ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<exogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
               ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<exogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
              ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<endogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
               ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], ":>", "var"}], ",", "Infinity"}], "]"}]}], 
              ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.893001501399847*^9, {3.893002703969759*^9, 3.893002740019191*^9}, {
   3.893003056880762*^9, 3.893003109272599*^9}, {3.893003787588058*^9, 
   3.893003788104986*^9}, {3.893004274886281*^9, 3.893004277331174*^9}, {
   3.893012058196281*^9, 3.893012058639546*^9}, {3.8930144234979*^9, 
   3.8930144532880163`*^9}, {3.8930146005691023`*^9, 3.893014621517111*^9}, 
   3.893016128067835*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"f5129bf4-785e-4137-ae20-7fccf0e1612a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "all", " ", "endogenous", " ", "variables", " ", "are", " ", "in", " ", 
    "context", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\"\<modelAssumptions\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\
\""}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<modelAssumptions\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<endogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "#", "===", 
                "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\
\""}], ")"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Context", "/@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"var_Symbol", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                    ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", 
                 "Infinity"}], "]"}]}], ")"}]}], ")"}]}], ")"}], "&"}], "/@", 
        
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930122537493258`*^9, 3.893012300221422*^9}, {
  3.893014429011052*^9, 3.893014460982974*^9}, {3.893014634019079*^9, 
  3.893014636342099*^9}, {3.893014692448086*^9, 3.89301469383664*^9}, {
  3.893014770636636*^9, 3.893014779588964*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"ec58ea81-c598-4a61-a12d-5665b317eca6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"all", " ", "coefficients", " ", "of", " ", "wc"}], ",", " ", 
    "pd", ",", " ", 
    RowBox[{
    "bond", " ", "ratios", " ", "are", " ", "in", " ", "context", " ", 
     "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coefs", "=", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"SymbolName", "/@", 
       RowBox[{"{", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefwc", ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd"}], 
         ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb"}], 
         ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefnb"}]}], 
        "}"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "#", "===", 
         "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
        ")"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"modelsP", "[", "#", "]"}], "[", 
             "\"\<modelAssumptions\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"var_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", "coefs"}], 
                   "]"}], "&"}], ")"}]}], "|", 
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", "coefs"}], 
                    "]"}], "&"}], ")"}]}], "[", "__", "]"}]}], ")"}], ":>", 
             RowBox[{"Context", "[", "var", "]"}]}], ",", "Infinity"}], "]"}],
           "&"}], "/@", 
         RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.893012389695546*^9, 3.893012429793953*^9}, {
  3.893012999712995*^9, 3.893013013257292*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"6d0b9f7e-876a-4d1e-8417-687412c924f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "should", " ", "not", " ", "have", " ", "any", " ", "endogenous", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\"\<stateVars\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
              "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"var_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                 ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "\"\<exogenousEq\>\"", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<exogenousEq\>\"", 
              "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"var_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                 ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89300111387222*^9, 3.8930011727459707`*^9}, {
   3.893001247830225*^9, 3.893001299678648*^9}, {3.893001353751255*^9, 
   3.8930015072417727`*^9}, {3.893002707727394*^9, 3.893002708411419*^9}, {
   3.893002748062245*^9, 3.893002826831513*^9}, 3.89300297523416*^9, {
   3.893003086535989*^9, 3.893003086763905*^9}, {3.8930042788551702`*^9, 
   3.893004279626916*^9}, {3.8930147061742983`*^9, 3.8930147624521227`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"15a938b3-0a0d-4fea-9149-a3e1cc0ccccc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "keys", " ", "and", " ", "shortname", " ", "are", " ", "preserved"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{"Keys", "[", "models", "]"}], ",", 
       RowBox[{"Keys", "[", "modelsP", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"models", "[", "#", "]"}], "[", "\"\<shortname\>\"", "]"}], 
         "&"}], "/@", 
        RowBox[{"Keys", "[", "models", "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<shortname\>\"", "]"}],
          "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89301161589116*^9, 3.893011697195755*^9}, 
   3.893144709678164*^9, 3.893144758132229*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"47c96443-c209-4100-a538-1174c0df59ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "stateVars", " ", "are", " ", "functions", " ", "of", " ", "one", " ", 
    "variable", " ", 
    RowBox[{"(", "time", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"Function", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Head", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
               "]"}], ")"}], "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"List", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Head", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
                "]"}], "[", "t", "]"}], ")"}], "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"1", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"\"\<t\>\"", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SymbolName", "@@", 
             RowBox[{
              RowBox[{
               RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "evaluating", " ", "the", " ", "function", " ", "at", " ", 
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`t", " ", "gives",
        " ", "the", " ", "same", " ", "as", " ", "\"\<stateVars\>\"", " ", 
       "in", " ", "models"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<stateVars\>\"", 
            "]"}], "[", 
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`t", "]"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}], "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"models", "[", "#", "]"}], "[", "\"\<stateVars\>\"", "]"}],
           ")"}], "&"}], "/@", 
        RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893011149678734*^9, 3.893011151120873*^9}, {
   3.893011197672791*^9, 3.893011393092401*^9}, {3.8930114244175577`*^9, 
   3.893011594633165*^9}, {3.893011701053651*^9, 3.89301170872368*^9}, {
   3.8930117913212442`*^9, 3.893011831744893*^9}, 3.893013045538563*^9, 
   3.893144850494865*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"1f614b69-53cd-47e0-a77b-c773e4dc8716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"numStocks", " ", "is", " ", "a", " ", "number"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"NumberQ", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"modelsP", "[", "#", "]"}], "[", "\"\<numStocks\>\"", "]"}], 
        "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{"Keys", "@", "modelsP"}], ")"}]}], ")"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.893011853833601*^9, 3.893011940133402*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"c356aa0e-402d-40bd-8115-a52e3d793452"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compare", " ", "to", " ", "some", " ", "hand"}], "-", 
    RowBox[{
    "written", " ", "expressions", " ", "known", " ", "to", " ", "be", " ", 
     "correct"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"model", "=", 
     RowBox[{"modelsP", "[", "\"\<NRC\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pi", "[", "myContext`t", "]"}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<exogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "myContext`t"}], "]"}]}], ")"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "myContext`t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "myContext`t", "]"}]}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", "t", "]"}], "/.", 
         RowBox[{"model", "[", "\"\<exogenousEq\>\"", "]"}]}], ")"}], "===", 
       RowBox[{
        RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", "t", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<exogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`mud", "[", "i", "]"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], ")"}], " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Parameters`phidc", "[", "i", 
           "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
            "]"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "t"}], "]"}], " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Parameters`xid", "[", "i", "]"}], 
          " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
          "]"}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "1",
            "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "4",
            "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
             "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "5",
            "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg",
               "2"]}], "-", 
            FractionBox[
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phig", "2"], 
             RowBox[{"1", "-", 
              
              SuperscriptBox[
               "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", "2"]}]], 
            "+", 
            SuperscriptBox[
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
              "t", "]"}], "2"]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "3",
            "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "2",
            "]"}], " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", "i",
            "]"}], "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             "t", "]"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", 
            "i", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], 
            "+", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
             "t", "]"}]}], ")"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", 
            "i", "]"}], "[", "4", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg",
               "2"]}], "-", 
            FractionBox[
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phig", "2"], 
             RowBox[{"1", "-", 
              
              SuperscriptBox[
               "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", "2"]}]], 
            "+", 
            SuperscriptBox[
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
              "t", "]"}], "2"]}], ")"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", 
            "i", "]"}], "[", "5", "]"}]}], "+", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", 
            "i", "]"}], "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", 
            "i", "]"}], "[", "3", "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bondexcret", "[", 
          RowBox[{"t", ",", "i"}], "]"}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondret", "[", 
          RowBox[{"t", ",", "i", ",", "1"}], "]"}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", 
          "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}]}], ")"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"bondexcret", "[", 
           RowBox[{"t", ",", "i"}], "]"}], "/.", 
          RowBox[{"Normal", "@", 
           RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], "/.", 
         RowBox[{"Normal", "@", 
          RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bond", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bond", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bond", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "i"}]}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.893013112707829*^9, 3.8930131579451036`*^9}, {
   3.89301319949829*^9, 3.8930132312916937`*^9}, {3.893014937931109*^9, 
   3.893015014205209*^9}, {3.8930150778885803`*^9, 3.893015081667938*^9}, 
   3.8930161054031553`*^9, 3.893016326710898*^9, {3.893016391754463*^9, 
   3.893016409333332*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"c19a0cb6-24fb-4b5e-94fd-548db5daf0b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
    "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "no", " ", 
    "endogenous", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"wc", "[", "t", "]"}], "//.", 
              RowBox[{"Normal", "@", 
               RowBox[{
                RowBox[{"modelsP", "[", "#", "]"}], "[", 
                "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"var_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                 ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], 
       "\[IndentingNewLine]", ")"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "exogenous", 
       " ", "variables", " ", "that", " ", "are", " ", "all", " ", "in", " ", 
       "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", 
           "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"wc", "[", "t", "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"var_Symbol", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                   ")"}]}], "[", "__", "]"}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "parameters", 
       " ", "that", " ", "are", " ", "all", " ", "in", " ", "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"wc", "[", "t", "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                  ")"}]}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "shocks", " ", 
       "that", " ", "are", " ", "all", " ", "in", " ", "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"wc", "[", "t", "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                 "[", "__", "]"}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893013644050221*^9, 3.8930136594716587`*^9}, {
  3.893013788159135*^9, 3.8930139106431017`*^9}, {3.89301401209753*^9, 
  3.893014103933299*^9}, {3.893014148442313*^9, 3.8930142719501123`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"cbe70257-09e2-449b-949d-6d8e6378aee2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
    "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "no", " ", 
    "endogenous", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bondexcret", "[", 
               RowBox[{"t", ",", "i"}], "]"}], "//.", 
              RowBox[{"Normal", "@", 
               RowBox[{
                RowBox[{"modelsP", "[", "#", "]"}], "[", 
                "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"var_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`$\
endogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                 ")"}]}], "[", "__", "]"}], ":>", "var"}], ",", "Infinity"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], 
       "\[IndentingNewLine]", ")"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "exogenous", 
       " ", "variables", " ", "that", " ", "are", " ", "all", " ", "in", " ", 
       "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", 
           "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bondexcret", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"var_Symbol", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "&"}], "/@", 
                    "FernandoDuarte`LongRunRisk`Model`ExogenousEq`$\
exogenousVars"}], ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                   ")"}]}], "[", "__", "]"}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "parameters", 
       " ", "that", " ", "are", " ", "all", " ", "in", " ", "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Parameters`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bondexcret", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"var_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`Model`Parameters`$parameters",
                     ",", 
                    RowBox[{"SymbolName", "[", "#", "]"}]}], "]"}], "&"}], 
                  ")"}]}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "endogenous", " ", "variables", " ", "mapped", " ", "repeatedly", " ", 
       "using", " ", "\"\<endogenousEq\>\"", " ", "has", " ", "shocks", " ", 
       "that", " ", "are", " ", "all", " ", "in", " ", "context", " ", 
       "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Flatten", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bondexcret", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "//.", 
                RowBox[{"Normal", "@", 
                 RowBox[{
                  RowBox[{"modelsP", "[", "#", "]"}], "[", 
                  "\"\<endogenousEq\>\"", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"var_Symbol", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
                 "[", "__", "]"}], ":>", 
                RowBox[{"Context", "@", "var"}]}], ",", "Infinity"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], 
       ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893013644050221*^9, 3.8930136594716587`*^9}, {
  3.893013788159135*^9, 3.8930139106431017`*^9}, {3.89301401209753*^9, 
  3.893014103933299*^9}, {3.893014148442313*^9, 3.893014235255294*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"ea3a718b-93dd-4a18-9717-6b43c80bd7cd"],

Cell[BoxData[{
 RowBox[{"AllTrue", "[", 
  RowBox[{
   RowBox[{"Head", "/@", 
    RowBox[{"(", 
     RowBox[{"Keys", "@", 
      RowBox[{
       RowBox[{"modelsP", "[", "\"\<BKY\>\"", "]"}], "[", 
       "\"\<exogenousEq\>\"", "]"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{"#", ",", "PatternTest"}], "]"}], "&"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllTrue", "[", 
  RowBox[{
   RowBox[{"Head", "/@", 
    RowBox[{"(", 
     RowBox[{"Keys", "@", 
      RowBox[{
       RowBox[{"modelsP", "[", "\"\<BKY\>\"", "]"}], "[", 
       "\"\<endogenousEq\>\"", "]"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{"#", ",", "PatternTest"}], "]"}], "&"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.891157496969887*^9, 3.891157544107942*^9}, {
  3.8929829100824947`*^9, 3.89298291390197*^9}, {3.892982949507678*^9, 
  3.8929829531624527`*^9}, {3.893016267044709*^9, 3.8930162995723467`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"dc686102-e44e-4d86-a0b9-1116a29b43b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "exogenousEq", " ", "and", " ", "endogenousEq", " ", "evaluate", " ", 
    "expressions", " ", "that", " ", "are", " ", "exogenous", " ", "or", " ", 
    "endogenous", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"Not", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"dc", "[", "t", "]"}], "]"}], "===", 
             RowBox[{"Head", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dc", "[", "t", "]"}], "/.", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<exogenousEq\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
              "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"Not", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"dd", "[", 
               RowBox[{"t", ",", "i"}], "]"}], "]"}], "===", 
             RowBox[{"Head", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "/.", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<exogenousEq\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
              "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"Not", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"wc", "[", "t", "]"}], "]"}], "===", 
             RowBox[{"Head", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"wc", "[", "t", "]"}], "/.", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<exogenousEq\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
              "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"Not", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"sdf", "[", "t", "]"}], "]"}], "===", 
             RowBox[{"Head", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"sdf", "[", "t", "]"}], "/.", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<exogenousEq\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
              "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"Not", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"bondyield", "[", "t", "]"}], "]"}], "===", 
             RowBox[{"Head", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"bondyield", "[", "t", "]"}], "/.", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<exogenousEq\>\"", "]"}], ",", 
                   RowBox[{
                    RowBox[{"modelsP", "[", "#", "]"}], "[", 
                    "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
              "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89301559217407*^9, 3.893015822830755*^9}, {
   3.89301600860408*^9, 3.893016031968368*^9}, 3.893016149396062*^9, 
   3.8931449612563457`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"29094dd7-7a11-410b-8ece-1c02d940451f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "exogenousEq", " ", "and", " ", "endogenousEq", " ", "do", " ", "not", " ",
     "evaluate", " ", "expressions", " ", "that", " ", "are", " ", "neither", 
    " ", "exogenous", " ", "nor", " ", "endogenous", " ", "variables"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"notVar", "[", "t", "]"}], "]"}], "===", 
          RowBox[{"Head", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"notVar", "[", "t", "]"}], "/.", 
             RowBox[{"Normal", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"modelsP", "[", "#", "]"}], "[", 
                 "\"\<exogenousEq\>\"", "]"}], ",", 
                RowBox[{
                 RowBox[{"modelsP", "[", "#", "]"}], "[", 
                 "\"\<endogenousEq\>\"", "]"}]}], "]"}], "]"}]}], ")"}], 
           "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Keys", "[", "modelsP", "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893015849081943*^9, 3.8930158504172277`*^9}, 
   3.893016091706109*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"a19926c0-bbe6-4077-95cb-d4a926d41fa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "shortname", " ", "different", " ", "from", " ", "model", " ", "key"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"modelBY", "=", 
     RowBox[{"models", "[", "\"\<BY\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modelBKY", "=", 
     RowBox[{"models", "[", "\"\<BKY\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modelBKYP", "=", 
     RowBox[{"processModels", "[", 
      RowBox[{"<|", 
       RowBox[{"\"\<BKY\>\"", "->", "modelBKY"}], "|>"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"modelBYP", "=", 
     RowBox[{"processModels", "[", 
      RowBox[{"<|", 
       RowBox[{"\"\<BY\>\"", "->", "modelBY"}], "|>"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModels", "=", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<myModel\>\"", "->", "modelBKY"}], ",", 
       RowBox[{"\"\<BY\>\"", "->", "modelBY"}]}], "|>"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModelsSameName", "=", 
     RowBox[{"<|", 
      RowBox[{"\"\<BY\>\"", "->", "modelBY"}], "|>"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModelsRename", "=", 
     RowBox[{"<|", 
      RowBox[{"\"\<myModel\>\"", "->", "modelBY"}], "|>"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModelsP", "=", 
     RowBox[{"processModels", "[", "newModels", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModelsSameNameP", "=", 
     RowBox[{"processModels", "[", "newModelsSameName", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newModelsRenameP", "=", 
     RowBox[{"processModels", "[", "newModelsRename", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KeyDrop", "[", 
            RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}], "&"}], "@", 
          RowBox[{"newModelsP", "[", "\"\<myModel\>\"", "]"}]}], "===", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}]}], "&"}], "@", 
       RowBox[{"modelBKYP", "[", "\"\<BKY\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KeyDrop", "[", 
            RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}], "&"}], "@", 
          RowBox[{"newModelsP", "[", "\"\<BY\>\"", "]"}]}], "===", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}]}], "&"}], "@", 
       RowBox[{"modelBYP", "[", "\"\<BY\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KeyDrop", "[", 
            RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}], "&"}], "@", 
          RowBox[{"newModelsSameNameP", "[", "\"\<BY\>\"", "]"}]}], "===", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}]}], "&"}], "@", 
       RowBox[{"modelBYP", "[", "\"\<BY\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"KeyDrop", "[", 
            RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}], "&"}], "@", 
          RowBox[{"newModelsRenameP", "[", "\"\<myModel\>\"", "]"}]}], "===", 
         
         RowBox[{"KeyDrop", "[", 
          RowBox[{"#", ",", "\"\<coeffsSolution\>\""}], "]"}]}], "&"}], "@", 
       RowBox[{"modelBYP", "[", "\"\<BY\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8912512942103243`*^9, 3.8912513055502443`*^9}, {
   3.8912513517340593`*^9, 3.891251461543272*^9}, {3.891251500422112*^9, 
   3.891251525384585*^9}, 3.891251633145433*^9, {3.891251727184629*^9, 
   3.8912517398515368`*^9}, {3.89125184158985*^9, 3.891251848736774*^9}, {
   3.891252152348381*^9, 3.891252165553775*^9}, 3.892982996244417*^9, 
   3.893016163280417*^9, 3.893145167358938*^9, 3.893145254752489*^9, 
   3.89480217485483*^9, {3.8948027745066357`*^9, 3.894802832466658*^9}, {
   3.8948029030451307`*^9, 3.8948029093631897`*^9}, {3.894803218803307*^9, 
   3.8948032260346603`*^9}, {3.8948032639753523`*^9, 3.894803269943624*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"23ef9fb9-15b6-4d1c-a063-5c17bb0102f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "numeric", " ", "solution", " ", "for", " ", "coefficients", " ", "only", 
    " ", "has", " ", "numbers"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"And", "@@", 
         RowBox[{"(", 
          RowBox[{"NumberQ", "/@", 
           RowBox[{"(", 
            RowBox[{"Values", "@", 
             RowBox[{
              RowBox[{"modelsP", "[", "#", "]"}], "[", 
              "\"\<coeffsSolutionN\>\"", "]"}]}], ")"}]}], ")"}]}], ")"}], 
       "&"}], "/@", 
      RowBox[{"Keys", "[", "modelsP", "]"}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9059441975944653`*^9, 3.905944203055931*^9}, {
  3.905951953505707*^9, 3.905951989493725*^9}, {3.905953457264773*^9, 
  3.905953459094884*^9}, {3.905953644719407*^9, 3.9059536464374743`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"b96fbc69-95b0-4ed0-9306-21ae94444707"]
}, Closed]],

Cell[CellGroupData[{

Cell["Shocks", "Section",
 CellChangeTimes->{
  3.906296878624848*^9},ExpressionUUID->"867d15c2-15e2-4d7c-beaf-\
9ebf90f9c2a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.906297011929091*^9, 3.906297012936075*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"19622898-1a74-4509-8032-c365e84fc15a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"46cceb21-4c84-435f-85ad-386f84fcd722"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891313793187236*^9, 3.891313806196443*^9}, {
   3.8913138758190536`*^9, 3.8913138873897676`*^9}, 3.891313958162628*^9, 
   3.9062972630564623`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"89025b4e-caba-4fcf-8896-e8a8d2eea821"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Model\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Model`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.8913139456297817`*^9, 
   3.891313945811431*^9}, {3.891313975885231*^9, 3.8913139761850777`*^9}, {
   3.906297263739143*^9, 3.906297264422947*^9}, {3.9062974434761972`*^9, 
   3.9062974452337933`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"1ffd367a-4d31-4be3-897c-78faef1a515d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "zero"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
          RowBox[{"t", ",", "ii"}], "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889965468632722*^9, 3.889965535681717*^9}, {
  3.889965687921562*^9, 3.889965719041513*^9}, {3.8899657564745703`*^9, 
  3.8899657868805656`*^9}, {3.889965818275572*^9, 3.88996587402346*^9}, {
  3.8899660417909737`*^9, 3.889966042024665*^9}, {3.889967536877624*^9, 
  3.88996754071059*^9}, {3.8900165538878927`*^9, 3.89001658162351*^9}, {
  3.890016737000123*^9, 3.890016738407667*^9}, {3.890016800216386*^9, 
  3.890016807685783*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"07981d69-6089-469f-a400-ba42b8713930"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "one"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "^", "2"}], "/.", 
         
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"t", ",", "ii"}], "]"}], "^", "2"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889966121134981*^9, 3.889966129513671*^9}, {
  3.8899675430265427`*^9, 3.889967546703742*^9}, {3.890016583815317*^9, 
  3.890016592774984*^9}, {3.890016733215493*^9, 3.890016734665518*^9}, {
  3.890016813177075*^9, 3.890016818682664*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"25c6db30-5738-4326-ac2c-ce9b6721380e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "zero"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "^", "3"}], "/.", 
         
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"t", ",", "ii"}], "]"}], "^", "3"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889966137593294*^9, 3.889966157676291*^9}, {
  3.8899675483847713`*^9, 3.889967551583518*^9}, {3.890016598169224*^9, 
  3.890016599024119*^9}, {3.8900166398231497`*^9, 3.8900166447507772`*^9}, {
  3.890016728032583*^9, 3.8900167295430813`*^9}, {3.890016823054276*^9, 
  3.890016828517232*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"531dff8a-0605-41ff-98e0-b7e7bf065f7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "three"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"3", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "^", "4"}], "/.", 
         
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"3", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"t", ",", "ii"}], "]"}], "^", "4"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8899661404752703`*^9, 3.889966162544742*^9}, {
  3.88996755330625*^9, 3.8899675539045153`*^9}, {3.890016601009963*^9, 
  3.890016602175623*^9}, {3.890016647031019*^9, 3.890016654765329*^9}, {
  3.890016724631262*^9, 3.890016725648046*^9}, {3.890016832581925*^9, 
  3.8900168622944813`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"ef75f63b-c525-41bb-90f4-65662ea4c87a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "zero"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"f", "===", "g"}], ",", "0", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "*", 
             RowBox[{
              RowBox[{"eps", "[", "g", "]"}], "[", "t", "]"}]}], "/.", 
            RowBox[{"rulesE", "[", "t", "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
            "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
            "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
            "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
            "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
             RowBox[{"t", ",", "ii"}], "]"}], "*", 
            RowBox[{
             RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}]}], "/.", 
           RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<pi\>\"", ",", "\"\<pibar\>\"", ",", 
            "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", "\"\<sc\>\"", ",", 
            "\"\<sp\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889966171785048*^9, 3.889966259267709*^9}, {
   3.88996755849631*^9, 3.889967559615136*^9}, {3.890016604049556*^9, 
   3.890016605279772*^9}, {3.890016664063781*^9, 3.890016667093809*^9}, 
   3.890016719343944*^9, {3.89001688967313*^9, 3.890016972670947*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"201b6d1e-ec41-4a2a-bcb4-465366470487"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", 
    RowBox[{"taugd", "[", "ii", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<taugd[1]\>\"", ",", "\"\<taugd[i]\>\"", ",", "\"\<taugd[j]\>\""}], 
      "}"}], "===", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringDelete", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"\"\<FernandoDuarte\>\"", "|", "\"\<`\>\""}], "~~", "__", 
           "~~", "\"\<`\>\""}]}], "]"}], "&"}], "/@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
              RowBox[{"t", ",", "ii"}], "]"}], "*", 
             RowBox[{
              RowBox[{"eps", "[", "\"\<dc\>\"", "]"}], "[", "t", "]"}]}], "/.", 
            RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.889966276655841*^9, 3.889966329628468*^9}, 
   3.889966470569511*^9, {3.8899666206897087`*^9, 3.889966642167533*^9}, {
   3.8899666930281763`*^9, 3.889966714268526*^9}, {3.889966746437366*^9, 
   3.8899668192799807`*^9}, 3.889966968372637*^9, {3.890016685103952*^9, 
   3.890016706173997*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"474c715d-b435-44ec-b46f-c9699293e675"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "three"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"3", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "^", "4"}], "/.", 
         
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"3", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"t", ",", "ii"}], "]"}], "^", "4"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889966177455817*^9, 3.889966177853951*^9}, {
  3.889966992360574*^9, 3.889966992849523*^9}, {3.8899675664876623`*^9, 
  3.889967570401917*^9}, {3.890016610865726*^9, 3.890016612256692*^9}, {
  3.890016748169524*^9, 3.890016753197629*^9}, {3.890016979912045*^9, 
  3.890016985910692*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"319f7eda-d92d-4223-a19b-60da24026188"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "zero"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"f", "===", "g"}], ",", "0", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}], "^", "2"}], 
             "*", 
             RowBox[{
              RowBox[{"eps", "[", "g", "]"}], "[", "t", "]"}]}], "/.", 
            RowBox[{"rulesE", "[", "t", "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
            "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
            "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
            "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
            "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"(", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
              RowBox[{"t", ",", "ii"}], "]"}], "^", "2"}], "*", 
            RowBox[{
             RowBox[{"eps", "[", "f", "]"}], "[", "t", "]"}]}], "/.", 
           RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x\>\"", ",", "\"\<pi\>\"", ",", "\"\<pibar\>\"", ",", 
            "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", "\"\<sc\>\"", ",", 
            "\"\<sp\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8899675877972183`*^9, 3.889967602226403*^9}, {
  3.8900166143143044`*^9, 3.890016615313992*^9}, {3.8900167583453693`*^9, 
  3.8900167602455273`*^9}, {3.89001699365699*^9, 3.890017007454585*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4389ba29-7b46-4cf1-bb76-21be2313e7c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"should", " ", "all", " ", "return", " ", "true"}], ",", " ", 
    RowBox[{
    "confirming", " ", "that", " ", "rulesE", " ", "returns", " ", "same", 
     " ", "expression", " ", "unevaluated"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
              "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
              "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", 
            RowBox[{"ToExpression", "@", "f"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
              "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
              "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
          RowBox[{
           RowBox[{"eps", "[", "dd", "]"}], "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889965468632722*^9, 3.889965535681717*^9}, {
   3.889965687921562*^9, 3.889965748623394*^9}, {3.889965898517263*^9, 
   3.889965927180188*^9}, {3.8899670123313913`*^9, 3.889967110342752*^9}, {
   3.889967191054615*^9, 3.889967303783434*^9}, {3.89001661779342*^9, 
   3.890016621056472*^9}, 3.8900167671909723`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"c1b2f46c-fda7-4a13-8c67-b37fba32bf73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"should", " ", "all", " ", "return", " ", "true"}], ",", " ", 
    RowBox[{
    "confirming", " ", "that", " ", "rulesE", " ", "returns", " ", "same", 
     " ", "expression", " ", "unevaluated"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"eps", "[", "f", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
              "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
              "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", 
       RowBox[{"eps", "[", "\"\<dd\>\"", "]"}]}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889965945368053*^9, 3.889965955550915*^9}, 
   3.889967308405003*^9, {3.889967351208173*^9, 3.889967389985118*^9}, 
   3.890016622216301*^9, {3.8900167738332148`*^9, 3.890016774829447*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"67dd5b89-7890-4289-a545-7e21f56ef574"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"should", " ", "all", " ", "return", " ", "true"}], ",", " ", 
    RowBox[{
    "confirming", " ", "that", " ", "rulesE", " ", "returns", " ", "same", 
     " ", "expression", " ", "unevaluated"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"eps", "[", "f", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<xx\>\"", ",", "\"\<adc\>\"", ",", "\"\<p\>\"", ",", 
              "\"\<rhobar\>\"", ",", "\"\<ssg\>\"", ",", "\"\<ssx\>\"", ",", 
              "\"\<sdc\>\"", ",", "\"\<spi\>\""}], "}"}]}], "}"}]}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"eps", "[", "\"\<ddd\>\"", "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", 
       RowBox[{"eps", "[", "\"\<ddd\>\"", "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.889966053895102*^9, 3.8899660943950768`*^9}, 
   3.88996731051445*^9, {3.889967405843053*^9, 3.88996742813382*^9}, {
   3.8900166244167767`*^9, 3.890016625279937*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"7f12cdca-914a-4225-91bf-90b1599fd221"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"should", " ", "all", " ", "return", " ", "true"}], ",", " ", 
    RowBox[{
    "confirming", " ", "that", " ", "rulesE", " ", "returns", " ", "same", 
     " ", "expression", " ", "unevaluated"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "f", "]"}], "[", "tt", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<xx\>\"", ",", "\"\<adc\>\"", ",", "\"\<p\>\"", ",", 
              "\"\<rhobar\>\"", ",", "\"\<ssg\>\"", ",", "\"\<ssx\>\"", ",", 
              "\"\<sdc\>\"", ",", "\"\<spi\>\""}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"tt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", 
              RowBox[{"t", "-", "1"}], ",", "s", ",", 
              RowBox[{"t", "+", "h"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"expr", "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}], "===", "expr"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"expr", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"tt", ",", "ii"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"tt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", 
              RowBox[{"t", "-", "1"}], ",", "s", ",", 
              RowBox[{"t", "+", "h"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.889965962245503*^9, 3.889966019800927*^9}, 
   3.889967313667658*^9, {3.889967436454067*^9, 3.889967519755422*^9}, {
   3.890016627163189*^9, 3.890016628977816*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a21e05e2-fe00-4d3c-8163-568ffaf7bd8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "zero"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"NewContext`eps", "[", "f", "]"}], "[", "t", "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"NewContext`eps", "[", "\"\<dd\>\"", "]"}], "[", 
          RowBox[{"t", ",", "ii"}], "]"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889965468632722*^9, 3.889965535681717*^9}, {
  3.889965687921562*^9, 3.889965719041513*^9}, {3.8899657564745703`*^9, 
  3.8899657868805656`*^9}, {3.889965818275572*^9, 3.88996587402346*^9}, {
  3.8899660417909737`*^9, 3.889966042024665*^9}, {3.889967536877624*^9, 
  3.88996754071059*^9}, {3.8900165538878927`*^9, 3.89001658162351*^9}, {
  3.890016737000123*^9, 3.890016738407667*^9}, {3.890016800216386*^9, 
  3.890016807685783*^9}, {3.8921231727183647`*^9, 3.8921231824244347`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"c6022f38-d54b-4a4d-921c-e75093dcc7ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "all", " ", "give", " ", "one"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`Private`eps", "[", "f", 
            "]"}], "[", "t", "]"}], "^", "2"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<x\>\"", ",", "\"\<dc\>\"", ",", "\"\<pi\>\"", ",", 
          "\"\<pibar\>\"", ",", "\"\<sg\>\"", ",", "\"\<sx\>\"", ",", 
          "\"\<sc\>\"", ",", "\"\<sp\>\""}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"1", "===", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`Private`eps", "[", 
            "\"\<dd\>\"", "]"}], "[", 
           RowBox[{"t", ",", "ii"}], "]"}], "^", "2"}], "/.", 
         RowBox[{"rulesE", "[", "t", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "i", ",", "j"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.889966121134981*^9, 3.889966129513671*^9}, {
  3.8899675430265427`*^9, 3.889967546703742*^9}, {3.890016583815317*^9, 
  3.890016592774984*^9}, {3.890016733215493*^9, 3.890016734665518*^9}, {
  3.890016813177075*^9, 3.890016818682664*^9}, {3.8921234241138163`*^9, 
  3.8921234389938107`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"acd1f56e-a963-4122-8cae-2f5224f3a528"]
}, Closed]],

Cell[CellGroupData[{

Cell["SolveEulerEq", "Section",
 CellChangeTimes->{{3.906299679029694*^9, 
  3.9062996804159527`*^9}},ExpressionUUID->"70c7c664-60a6-41f5-8594-\
88cb33edcaea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"f759d010-db1d-4beb-84a5-d81a14edfcdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9062989703565693`*^9, 3.9062989714060993`*^9}, {
  3.9062996895679913`*^9, 3.906299695986437*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9167c540-1ed2-47f1-8e0a-7f475843b6e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}, 3.893336453091833*^9, 3.8933472708044786`*^9, 
   3.906297265406946*^9, {3.906297454165967*^9, 3.906297457072887*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"0236ecf0-0a0d-477b-99d3-9b2b4e96a160"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
      ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\>\"", "<>", 
     "testName", "<>", "\"\<`\>\""}], ",", "packageFileName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", " ", "=", " ", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Prepend", "[", 
     RowBox[{
     "$ContextPath", ",", 
      "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`\>\""}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.8907107328284597`*^9, 
   3.890716596142606*^9, 3.8912441409010677`*^9, {3.891284064139113*^9, 
   3.891284078157*^9}, {3.89128451819068*^9, 3.8912845185051107`*^9}, {
   3.8913176074268427`*^9, 3.891317626509036*^9}, {3.8919141921795597`*^9, 
   3.891914193888651*^9}, 3.9026747447148247`*^9, {3.902674827715456*^9, 
   3.9026748330094213`*^9}, {3.9050647938688803`*^9, 3.905064824740706*^9}, {
   3.9062972662561817`*^9, 3.9062972670372753`*^9}, {3.906297459133255*^9, 
   3.906297461333879*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"66c4fee5-1fdd-48be-ad87-b31de6ba5ef0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"longTest", " ", "=", " ", "False"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"fast", " ", "and", " ", "partial", " ", "coverage", " ", 
    RowBox[{"(", "False", ")"}], " ", "or", " ", "slow", " ", "and", " ", 
    "full", " ", "coverage", " ", 
    RowBox[{"(", "True", ")"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9062990007961082`*^9, 3.906299025776042*^9}, {
  3.906299600206047*^9, 3.9062996032071447`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"c169ae17-d6c5-41d5-ae09-23ab741ceaec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "stop"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", "longTest"}], ",", 
     RowBox[{"Off", "[", 
      RowBox[{"FindRoot", "::", "cvmit"}], "]"}]}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Get", "@", 
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<FernandoDuarte/LongRunRisk\>\"", ",", "\"\<Models.wl\>\""}], 
       "}"}], "]"}], "]"}]}], " ", ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modBKY", "=", 
   RowBox[{"msp", "[", "\"\<BKY\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modNRCStochVol", "=", 
   RowBox[{"msp", "[", "\"\<NRCStochVol\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mods", "=", 
    RowBox[{"If", "[", 
     RowBox[{"longTest", ",", "\n", 
      RowBox[{"{", 
       RowBox[{
       "modBY", ",", "modBKY", ",", "modNRC", ",", "modDES", ",", 
        "modNRCStochVol"}], "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"modBKY", ",", "modDES"}], "}"}]}], "\n", "]"}]}], ";"}], "\n",
   "\n", 
  RowBox[{"(*", 
   RowBox[{"testing", " ", "functions"}], "*)"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "returns", " ", "True", " ", "if", " ", "coefficients", " ", "have", " ", 
    "expected", " ", "form"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coeffsQ", "[", 
     RowBox[{"sol_", ",", "coeffName_", ",", "numStateVars_", ",", 
      RowBox[{"numAssets_", ":", "0"}], ",", 
      RowBox[{"bond_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"numAssets", "==", "0"}], ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"wc", " ", 
            RowBox[{"ratio", ":", " ", 
             RowBox[{
             "coefficients", " ", "are", " ", "indexed", " ", "by", " ", 
              "0"}]}]}], ",", " ", "1", ",", " ", 
           RowBox[{"2", "..."}]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Sort", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Keys", "/@", "sol"}], ",", 
              RowBox[{
               RowBox[{"coeffName", "[", "i_Integer", "]"}], ":>", "i"}]}], 
             "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"numStateVars", "+", "1"}], "]"}], "-", "1"}], ")"}]}], 
         ",", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"pd", " ", "ratio", " ", "or", " ", "bond", " ", 
            RowBox[{"prices", ":", " ", 
             RowBox[{
             "coefficients", " ", "are", " ", "indexed", " ", "by", " ", 
              "two", " ", "integers"}]}]}], ",", " ", 
           RowBox[{
           "first", " ", "one", " ", "indexes", " ", "stock", " ", "number", 
            " ", "or", " ", "maturity", " ", "of", " ", "bond"}], ",", " ", 
           RowBox[{
           "second", " ", "one", " ", "indexes", " ", "state", " ", 
            "variables"}]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Sort", "@", 
            RowBox[{"Tuples", "[", "\n", 
             RowBox[{"{", "\n", 
              RowBox[{
               RowBox[{
                RowBox[{"Range", "[", "numAssets", "]"}], "-", "bond"}], ",", 
               "\n", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"numStateVars", "+", "1"}], "]"}], "-", "1"}]}], 
              "\n", "}"}], "\n", "]"}]}], ")"}], "==", 
          RowBox[{"(", 
           RowBox[{"Sort", "@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Keys", "/@", "sol"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"coeffName", "[", "i_Integer", "]"}], "[", 
                "j_Integer", "]"}], ":>", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}]}], "]"}]}], ")"}]}]}], "\n", 
        "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{"names", " ", "match", " ", "coeffName"}], "*)"}], "\n", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"#", ",", "coeffName"}], "]"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Keys", "/@", "sol"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_", "[", "i_Integer", "]"}], "[", "j_Integer", 
              "]"}], ":>", "var"}]}], "]"}]}], ")"}]}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "context", " ", "is", " ", "same", " ", "as", " ", "context", " ", 
         "of", " ", "coeffName"}], "*)"}], "\n", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "coeffName", "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Keys", "/@", "sol"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"var_", "[", "i_Integer", "]"}], "[", "j_Integer", 
              "]"}], ":>", 
             RowBox[{"Context", "[", "var", "]"}]}]}], "]"}]}], ")"}]}], ",", 
       "\n", 
       RowBox[{"(*", 
        RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], "\n", 
       RowBox[{"And", "@@", 
        RowBox[{"(", 
         RowBox[{"NumberQ", "/@", 
          RowBox[{"(", 
           RowBox[{"Values", "/@", "sol"}], ")"}]}], ")"}]}]}], "\n", 
      "}"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"list", " ", "with", " ", "different", " ", "options"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"opts", "=", 
    RowBox[{"{", "\n", 
     RowBox[{"(*", 
      RowBox[{"single", " ", "option"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4.6", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], "}"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{"updateCoeffsSol", " ", "option"}], "*)"}], "\n", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"checks", " ", "option"}], "*)"}], "\n", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"FindRoot", " ", "option"}], "*)"}], "\n", " ", 
      RowBox[{"{", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], "}"}], ",", 
      " ", 
      RowBox[{"(*", 
       RowBox[{
       "FindRoot", " ", "option", " ", "via", " ", "updateCoeffsSol", " ", 
        "options"}], "*)"}], "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"more", " ", "than", " ", "one", " ", "option"}], "*)"}], "\n",
       " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}]}], "}"}], ",", 
      "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}]}], "}"}], ",", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}]}], "}"}], ",", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}]}], "}"}], ",", "\n", 
      "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}]}], 
       "}"}], ",", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}]}], 
       "}"}], ",", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Ewc\>\"", "->", 
            RowBox[{"{", "4.6", "}"}]}], ",", 
           RowBox[{"\"\<Epd\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}]}], 
       "}"}], ",", "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}]}], 
       "}"}]}], "\n", "}"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "same", " ", "FindRootOptions", " ", "and", " ", "options", " ", "to", " ",
     "FindRoot"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"optsRepeated", " ", "=", "\n", 
   RowBox[{"{", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4.6", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}], 
       ",", 
       RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4.6", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}], 
       ",", 
       RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}], ",", 
     "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4.6", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "5.6", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}], 
       ",", 
       RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}], ",", 
     "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}], "}"}]}], 
       ",", 
       RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}], ",", 
     "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<MaxIterations\>\"", "->", "5"}], "}"}]}]}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MaxIterations\>\"", "->", "5"}], ",", 
           RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], 
          "}"}]}]}], "}"}], ";", "\n", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}], ",", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<FindRootOptions\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MaxIterations\>\"", "->", "5"}], ",", 
           RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}]}],
         ",", 
        RowBox[{"WorkingPrecision", "->", "$MachinePrecision"}]}], "}"}]}]}], 
    "\n", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"longTest", ",", "\n", 
     RowBox[{
      RowBox[{"optsMany", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"opts", "[", 
          RowBox[{"[", 
           RowBox[{"5", ";;", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "optsRepeated"}], 
        "]"}]}], ";"}], "\n", ",", "\n", 
     RowBox[{
      RowBox[{"optsMany", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"opts", "[", 
          RowBox[{"[", 
           RowBox[{"5", ";;", "6"}], "]"}], "]"}], ",", 
         RowBox[{"optsRepeated", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "\n", 
    "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"**", "**", "**", "**"}], "*", "set", " ", "up", " ", "useful", 
      " ", "variables", " ", "used", " ", "throughout", " ", "loop"}], 
     "**********)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"ind", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"counter", " ", "for", " ", "Do", " ", "loop"}], "*)"}], "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{
       "convenience", " ", "functions", " ", "for", " ", "different", " ", 
        "coefficients"}], "*)"}], "\n", 
      RowBox[{"numStateVars", "=", 
       RowBox[{"Length", "[", 
        RowBox[{
         RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"numStocks", "=", 
       RowBox[{"model", "[", "\"\<numStocks\>\"", "]"}]}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"coeffsQWc", "[", "sol_", "]"}], ":=", 
       RowBox[{"coeffsQ", "[", 
        RowBox[{
        "sol", ",", 
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefwc", ",", 
         "numStateVars"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"coeffsQPd", "[", "sol_", "]"}], ":=", 
       RowBox[{"coeffsQ", "[", 
        RowBox[{"sol", ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd"}], 
         ",", "numStateVars", ",", "numStocks"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"coeffsQBond", "[", 
        RowBox[{"sol_", ",", "maxMaturity_"}], "]"}], ":=", 
       RowBox[{"coeffsQ", "[", 
        RowBox[{"sol", ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb"}], 
         ",", "numStateVars", ",", 
         RowBox[{"maxMaturity", "+", "1"}], ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"coeffsQNomBond", "[", 
        RowBox[{"sol_", ",", "maxMaturity_"}], "]"}], ":=", 
       RowBox[{"coeffsQ", "[", 
        RowBox[{"sol", ",", 
         RowBox[{
         "Head", "@", 
          "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefnb"}], 
         ",", "numStateVars", ",", 
         RowBox[{"maxMaturity", "+", "1"}], ",", "1"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", "testing", " ", "starts", " ", 
        "here"}], "**********)"}], "\n", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tests`ComputationalEngine`SolveEulerEq`\
updateCoeffs", "=", 
       "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
updateCoeffs"}], ";", "\n", "\n", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tests`ComputationalEngine`SolveEulerEq`\
updateCoeffsSol", "=", 
       "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`Private`\
updateCoeffsSol"}], ";", "\n", "\n", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tests`ComputationalEngine`SolveEulerEq`\
updateCoeffsWc", "=", 
       "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`Private`\
updateCoeffsWc"}], ";", "\n", "\n", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tests`ComputationalEngine`SolveEulerEq`\
updateCoeffsPd", "=", 
       "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`Private`\
updateCoeffsPd"}], ";", "\n", "\n", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tests`ComputationalEngine`SolveEulerEq`\
updateCoeffsBond", "=", 
       "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`Private`\
updateCoeffsBond"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{
        "passing", " ", "arguments", " ", "works", " ", "as", " ", 
         "intended"}]}], "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
       "parse", " ", "positional", " ", "arguments", " ", "correctly"}], 
       "*)"}], "\n", 
      RowBox[{"newParameters", "=", 
       RowBox[{"{", 
        RowBox[{"delta", "->", "0.99"}], "}"}]}], ";", "\n", 
      RowBox[{"guessCoeffsSolution", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "[", "0", "]"}], "->", "4.6"}], "}"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"updateCoeffs", "[", "model", "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffsSol", "[", 
               RowBox[{"model", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", "newParameters"}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", "newParameters", ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{"model", ",", "newParameters", ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffsSol", "[", 
               RowBox[{"model", ",", "newParameters", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"updateCoeffs", "[", 
               RowBox[{
               "model", ",", "newParameters", ",", " ", 
                "guessCoeffsSolution"}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{
               "model", ",", "newParameters", ",", " ", 
                "guessCoeffsSolution"}], "]"}], "==", 
              RowBox[{"updateCoeffs", "[", 
               RowBox[{
               "model", ",", "newParameters", ",", " ", "guessCoeffsSolution",
                 ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], "==", 
              RowBox[{"updateCoeffsSol", "[", 
               RowBox[{
               "model", ",", "newParameters", ",", " ", 
                "guessCoeffsSolution"}], "]"}]}]}], "\n", "}"}]}]}], ";", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "separates", " ", "positional", " ", "arguments", " ", "and", " ", 
        "optional", " ", "arguments", " ", "correctly"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"Quiet", "[", "\n", 
           RowBox[{"And", "@@", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\n", 
              RowBox[{
               RowBox[{"Map", "[", "\n", 
                RowBox[{"coeffsQWc", ",", "\n", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "\n", 
                    RowBox[{
                    RowBox[{"updateCoeffsSol", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Sequence", "@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"Sequence", "@@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"{", "}"}], ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "@", 
                    RowBox[{"{", "}"}]}], ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", "}"}]}], ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "@@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"Last", "@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "[", 
                    RowBox[{"Most", "@", "#"}], "]"}], ",", 
                    RowBox[{"Last", "@", "#"}]}], "]"}]}], "\n", "}"}], "&"}],
                   "/@", 
                  RowBox[{"opts", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", "\n", 
                 RowBox[{"{", "2", "}"}]}], "\n", "]"}], ",", "\n", "\n", 
               RowBox[{"(*", 
                RowBox[{
                "different", " ", "ways", " ", "to", " ", "pass", " ", "more",
                  " ", "than", " ", "one", " ", "option", " ", "are", " ", 
                 "equivalent"}], "*)"}], "\n", 
               RowBox[{"Map", "[", "\n", 
                RowBox[{"coeffsQWc", ",", "\n", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "\n", 
                    RowBox[{
                    RowBox[{"updateCoeffsSol", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", "#"}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"First", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"First", "@", "#"}], ",", 
                    RowBox[{"Sequence", "[", 
                    RowBox[{"Rest", "@", "#"}], "]"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Sequence", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "#"}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "]"}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"Most", "@", "#"}], ",", 
                    RowBox[{"List", "@", 
                    RowBox[{"Last", "@", "#"}]}]}], "]"}], ",", "\n", 
                    RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", 
                    RowBox[{"List", "@", 
                    RowBox[{"First", "@", "#"}]}], ",", 
                    RowBox[{"Rest", "@", "#"}]}], "]"}]}], "\n", "}"}], "&"}],
                   "/@", "optsMany"}], ",", "\n", 
                 RowBox[{"{", "2", "}"}]}], "\n", "]"}]}], "\n", "}"}]}]}], 
           "\n", "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", "tests", " ", "for", " ", 
        "wealth", " ", "consumption", " ", "ratio", " ", "coefficients"}], 
       "**********)"}], "\n", 
      RowBox[{"optsWc", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<MaxIterations\>\"", "->", "100"}], "}"}]}], ";", "\n", 
      RowBox[{"solWc", "=", 
       RowBox[{"updateCoeffs", "[", 
        RowBox[{"model", ",", "optsWc"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{
        "wrapper", " ", "functions", " ", "updateCoeffsSol", " ", "and", " ", 
         "updateCoeffs", " ", "give", " ", "same", " ", "answer", " ", "as", 
         " ", "updateCoeffsWc"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"(", 
        RowBox[{"solWc", "==", 
         RowBox[{"updateCoeffsSol", "[", 
          RowBox[{"model", ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}], ",", "optsWc"}], "]"}], "==", 
         RowBox[{"updateCoeffsWc", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
            "\"\<wc\>\"", "]"}], ",", 
           RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
           RowBox[{"{", "}"}], ",", "optsWc"}], "]"}]}], ")"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "options"}], " ", "work", " ", "as", " ", 
        "intended"}], "*******)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"test", ":", " ", 
          RowBox[{"one", " ", "iteration", " ", 
           RowBox[{"doesn", "'"}], "t", " ", "get", " ", "far", " ", "from", 
           " ", "initial", " ", "guess"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"solWc1", "=", 
          RowBox[{"updateCoeffs", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
            RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"\"\<Ewc\>\"", "->", 
               RowBox[{"{", "3", "}"}]}], "|>"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{"solWc2", "=", 
          RowBox[{"updateCoeffs", "[", 
           RowBox[{"model", ",", " ", 
            RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
            RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"\"\<Ewc\>\"", "->", 
               RowBox[{"{", "1", "}"}]}], "|>"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", 
               "0", "]"}], "/.", "solWc1"}], ")"}], " ", ">", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", 
               "0", "]"}], "/.", "solWc2"}], ")"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"solWc1", "=", 
          RowBox[{"updateCoeffs", "[", 
           RowBox[{"model", ",", 
            RowBox[{"\"\<FindRootOptions\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], ",", 
            RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"\"\<Ewc\>\"", "->", 
               RowBox[{"{", "3", "}"}]}], "|>"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{"solWc2", "=", 
          RowBox[{"updateCoeffs", "[", 
           RowBox[{"model", ",", 
            RowBox[{"\"\<FindRootOptions\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], ",", 
            RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"\"\<Ewc\>\"", "->", 
               RowBox[{"{", "1", "}"}]}], "|>"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", 
               "0", "]"}], "/.", "solWc1"}], ")"}], " ", ">", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", 
               "0", "]"}], "/.", "solWc2"}], ")"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"MaxIterations", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "one", " ", "iteration", " ", "passing", " ", "FindRoot", " ", 
            "option"}]}], "*)"}], "\n", 
         RowBox[{"m1", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "three", " ", "iterations", " ", "passing", " ", "FindRoot", " ", 
            "option"}]}], "*)"}], "\n", 
         RowBox[{"m2", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "one", " ", "iteration", " ", "passing", " ", "updateCoeffsSol", 
            " ", "option"}]}], "*)"}], "\n", 
         RowBox[{"m3", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "three", " ", "iterations", " ", "passing", " ", "updateCoeffsSol",
             " ", "option"}]}], "*)"}], "\n", 
         RowBox[{"m4", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m1"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "1", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m2"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "3", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m3"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "1", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m4"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "3", "}"}], "}"}]}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "when", " ", "passing", " ", "same", " ", "FindRoot", " ", "and", 
             " ", "updateCoeffsSol", " ", "options"}]}], ",", " ", 
           RowBox[{"FindRoot", " ", "option", " ", "is", " ", "used"}]}], 
          "*)"}], "\n", 
         RowBox[{"m1", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"m2", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"m3", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{"m4", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<FindRootOptions\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxIterations\>\"", "->", "3"}], "}"}]}], 
                   ",", 
                   RowBox[{"\"\<MaxIterations\>\"", "->", "1"}], ",", 
                   RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                    RowBox[{"<|", 
                    RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], ";"}]}], 
               "]"}], ";", "$MessageList"}], "]"}]}], "\n", "]"}]}], ";", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m1"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "3", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m2"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "3", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m3"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "1", "}"}], "}"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"ReleaseHold", "@", 
               RowBox[{"Last", "@", "m4"}]}], "==", 
              RowBox[{"{", 
               RowBox[{"{", "1", "}"}], "}"}]}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"PrintResidualsNorm", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{"do", " ", "not", " ", "print", " ", "residual"}]}], 
          "*)"}], "\n", 
         RowBox[{"m1", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}]}], 
                  "]"}], ";"}]}], "]"}], ";", "$MessageList"}], "]"}]}], "\n",
            "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{"print", " ", "residual"}]}], "*)"}], "\n", 
         RowBox[{"m2", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "True"}]}], 
                  "]"}], ";"}]}], "]"}], ";", "$MessageList"}], "]"}]}], "\n",
            "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "check", " ", "m1", " ", "did", " ", "not", " ", "print"}]}], ",",
            " ", 
           RowBox[{"m2", " ", "printed", " ", "correct", " ", "message"}]}], 
          "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReleaseHold", "@", "m1"}], "==", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "@", "m2"}], "==", 
            RowBox[{"{", 
             RowBox[{"HoldForm", "@", 
              RowBox[{"(", 
               RowBox[{
               "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "norm"}], ")"}]}], "}"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"NumberQ", "@", 
           RowBox[{"(", 
            RowBox[{"ReleaseHold", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Last", "@", "m2"}]}]}]}], ")"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"CheckResiduals", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "do", " ", "not", " ", "check", " ", "if", " ", "root", " ", 
            "finding", " ", "residual", " ", 
            RowBox[{"(", "error", ")"}], " ", "is", " ", "small"}]}], "*)"}], 
         "\n", 
         RowBox[{"c1", "=", 
          RowBox[{"Not", "@", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"CheckAbort", "[", 
             RowBox[{
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<CheckResiduals\>\"", "->", "False"}]}], "]"}], 
                ",", 
                RowBox[{"Abort", "[", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
            "]"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "check", " ", "if", " ", "root", " ", "finding", " ", "residual", 
             " ", 
             RowBox[{"(", "error", ")"}], " ", "is", " ", "small"}]}], ",", 
           " ", 
           RowBox[{
           "abort", " ", "if", " ", "error", " ", "above", " ", 
            "tolerance"}]}], "*)"}], "\n", 
         RowBox[{"c2", "=", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"CheckAbort", "[", 
            RowBox[{
             RowBox[{"Check", "[", 
              RowBox[{
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}]}], "]"}], 
               ",", 
               RowBox[{"Abort", "[", "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"Tol", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{"big", " ", "tolerance"}]}], ",", " ", 
           RowBox[{"computation", " ", "does", " ", "not", " ", "abort"}]}], 
          "*)"}], "\n", 
         RowBox[{"c1", "=", 
          RowBox[{"Not", "@", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"CheckAbort", "[", 
             RowBox[{
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<Tol\>\"", "->", "1"}]}], "]"}], ",", 
                RowBox[{"Abort", "[", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
            "]"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{"low", " ", "tolerance"}]}], ",", " ", 
           RowBox[{"computation", " ", "aborts"}]}], "*)"}], "\n", 
         RowBox[{"c2", "=", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"CheckAbort", "[", 
            RowBox[{
             RowBox[{"Check", "[", 
              RowBox[{
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
                 RowBox[{"\"\<Tol\>\"", "->", 
                  RowBox[{"10.", "^", 
                   RowBox[{"-", "20"}]}]}]}], "]"}], ",", 
               RowBox[{"Abort", "[", "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"ReturnPd", " ", "works"}], "*)"}], "\n", 
      RowBox[{"Ewc0", "=", "4.6"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{
        "do", " ", "not", " ", "return", " ", "pd", " ", "coefficients"}]}], 
       "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"coeffsQWc", "[", 
        RowBox[{"updateCoeffs", "[", 
         RowBox[{"model", ",", 
          RowBox[{"\"\<UpdatePd\>\"", "->", "False"}], ",", 
          RowBox[{"\"\<initialGuess\>\"", " ", "->", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<Ewc\>\"", "->", 
              RowBox[{"{", "Ewc0", "}"}]}], ",", 
             RowBox[{"\"\<Epd\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"{", "5.5", "}"}], "}"}]}]}], "|>"}]}]}], "]"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"ind", "=", "ind"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{"return", " ", "pd", " ", "coefficients"}]}], "*)"}], "\n", 
      RowBox[{"coeffsWcPd", "=", 
       RowBox[{"updateCoeffs", "[", 
        RowBox[{"model", ",", 
         RowBox[{"\"\<UpdatePd\>\"", "->", "True"}], ",", 
         RowBox[{"\"\<initialGuess\>\"", " ", "->", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Ewc\>\"", "->", 
             RowBox[{"{", "Ewc0", "}"}]}], ",", 
            RowBox[{"\"\<Epd\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"{", "5.5", "}"}], "}"}]}]}], "|>"}]}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{
        "separate", " ", "wc", " ", "and", " ", "pd", " ", "coefficients"}]}],
        "*)"}], "\n", 
      RowBox[{"coeffsWc", "=", 
       RowBox[{"FilterRules", "[", 
        RowBox[{"coeffsWcPd", ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefwc", "[", 
          "_Integer", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"coeffsPd", "=", 
       RowBox[{"FilterRules", "[", 
        RowBox[{"coeffsWcPd", ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefpd", "[", 
          "_Integer", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{
        "check", " ", "coefficients", " ", "have", " ", "expected", " ", 
         "form"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"coeffsQWc", "[", "coeffsWc", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"coeffsQPd", "[", "coeffsPd", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"test", ":", " ", 
          RowBox[{
          "wc", " ", "coefficients", " ", "are", " ", "the", " ", "same", " ",
            "when", " ", "pd", " ", "coefficients", " ", "are", " ", "or", 
           " ", "are", " ", "not", " ", "returned"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "Ewc0", "}"}]}], "|>"}]}]}], "]"}], "==", 
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<UpdatePd\>\"", "->", "False"}], ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<Ewc\>\"", "->", 
                  RowBox[{"{", "Ewc0", "}"}]}], ",", 
                 RowBox[{"\"\<Epd\>\"", "->", 
                  RowBox[{"{", 
                   RowBox[{"{", "5.5", "}"}], "}"}]}]}], "|>"}]}]}], "]"}]}], 
           ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "updateCoeff", " ", "inherits", " ", "options", " ", "from", " ", 
             "updateCoeffsSol"}]}], ",", " ", "checks"}], "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{"SubsetQ", "[", 
              RowBox[{
               RowBox[{"Options", "[", "updateCoeffs", "]"}], ",", 
               RowBox[{
               "Options", "[", 
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsSol", "]"}]}], "]"}], ",", "\n", 
             RowBox[{"SubsetQ", "[", 
              RowBox[{
               RowBox[{"Options", "[", "updateCoeffs", "]"}], ",", 
               RowBox[{
               "Options", "[", 
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "]"}]}], "]"}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "pass", " ", "initial", " ", "guess", " ", "in", " ", 
            "updateCoeffs"}], ",", " ", "updateCoeffsSol", ",", " ", 
           "updateCoeffsWc"}], "*)"}], "\n", 
         RowBox[{"oldOptions", "=", 
          RowBox[{"Options", "[", "updateCoeffs", "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "save", " ", "options", " ", "to", " ", "restore", " ", "later"}], 
          "*)"}], "\n", 
         RowBox[{"oldOptionsSol", "=", 
          RowBox[{
          "Options", "[", 
           "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsSol", "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "save", " ", "options", " ", "to", " ", "restore", " ", "later"}], 
          "*)"}], "\n", 
         RowBox[{"oldOptionsWc", "=", 
          RowBox[{
          "Options", "[", 
           "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsWc", "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "save", " ", "options", " ", "to", " ", "restore", " ", "later"}], 
          "*)"}], "\n", 
         RowBox[{"ig", "=", "1"}], ";", 
         RowBox[{"(*", 
          RowBox[{"new", " ", "initial", " ", "guess"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{"initial", " ", "guess", " ", "as", " ", "argument"}]}], 
          "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], "==", 
            RowBox[{"updateCoeffsSol", "[", 
             RowBox[{"model", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], "==", "\n", 
            RowBox[{"updateCoeffsWc", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
               "\"\<wc\>\"", "]"}], ",", 
              RowBox[{"model", "[", "\"\<parameters\>\"", "]"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"\"\<Ewc0\>\"", "->", "ig"}]}], "]"}]}], ")"}]}], ";", 
         "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "initial", " ", "guess", " ", "as", " ", "default", " ", "in", " ", 
           "options"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "default", " ", "arguments", " ", "of", " ", "updateCoeffs"}]}], 
          "*)"}], 
         RowBox[{"SetOptions", "[", 
          RowBox[{"updateCoeffs", ",", 
           RowBox[{"\"\<initialGuess\>\"", " ", "->", 
            RowBox[{"<|", 
             RowBox[{"\"\<Ewc\>\"", "->", 
              RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], "==", 
            RowBox[{"updateCoeffs", "[", "model", "]"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"Options", "[", "updateCoeffs", "]"}], "=", "oldOptions"}], 
         ";", 
         RowBox[{"(*", 
          RowBox[{"restore", " ", "options"}], "*)"}], "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "default", " ", "arguments", " ", "of", " ", "updateCoeffsSol"}]}],
           "*)"}], "\n", 
         RowBox[{"SetOptions", "[", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsSol", ",", 
           RowBox[{"\"\<initialGuess\>\"", " ", "->", 
            RowBox[{"<|", 
             RowBox[{"\"\<Ewc\>\"", "->", 
              RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"updateCoeffsSol", "[", 
             RowBox[{"model", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}], "==", 
            RowBox[{"updateCoeffsSol", "[", 
             RowBox[{"model", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}], "==", 
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}]}], ")"}]}], 
         ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{"Not", "@", 
            RowBox[{"TrueQ", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"updateCoeffsSol", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"MaxIterations", "->", "1"}]}], "]"}], "==", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"MaxIterations", "->", "1"}]}], "]"}]}], ")"}]}]}], 
           ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
          "Options", "[", 
           "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsSol", "]"}], "=", "oldOptionsSol"}], ";", 
         RowBox[{"(*", 
          RowBox[{"restore", " ", "options"}], "*)"}], "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "default", " ", "arguments", " ", "of", " ", "updateCoeffsWc"}]}], 
          "*)"}], "\n", 
         RowBox[{"SetOptions", "[", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsWc", ",", 
           RowBox[{"\"\<Ewc0\>\"", " ", "->", " ", "ig"}]}], "]"}], ";", " ", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"updateCoeffsWc", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
               "\"\<wc\>\"", "]"}], ",", 
              RowBox[{"model", "[", "\"\<parameters\>\"", "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}], "==", 
            RowBox[{"updateCoeffsWc", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
               "\"\<wc\>\"", "]"}], ",", 
              RowBox[{"model", "[", "\"\<parameters\>\"", "]"}], ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"\"\<Ewc0\>\"", " ", "->", " ", "ig"}]}], "]"}], "==", 
            RowBox[{"updateCoeffs", "[", 
             RowBox[{"model", ",", 
              RowBox[{"\"\<initialGuess\>\"", " ", "->", 
               RowBox[{"<|", 
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "ig", "}"}]}], "|>"}]}]}], "]"}]}], ")"}]}], 
         ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{"Not", "@", 
            RowBox[{"TrueQ", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"updateCoeffsWc", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
                  "\"\<wc\>\"", "]"}], ",", 
                 RowBox[{"model", "[", "\"\<parameters\>\"", "]"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"MaxIterations", "->", "1"}]}], "]"}], "==", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"MaxIterations", "->", "1"}]}], "]"}]}], ")"}]}]}], 
           ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
          "Options", "[", 
           "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`updateCoeffsWc", "]"}], "=", "oldOptionsWc"}], ";", 
         RowBox[{"(*", 
          RowBox[{"restore", " ", "options"}], "*)"}], "\n", "\n", 
         RowBox[{"oldOptions", "=", 
          RowBox[{"Options", "[", "updateCoeffs", "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "save", " ", "options", " ", "to", " ", "restore", " ", "later"}], 
          "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "use", " ", "defaults", " ", "for", " ", "updateCoeffs", " ", 
             "for", " ", "any", " ", "options", " ", "inherited", " ", "from",
              " ", "updateCoeffsSol"}]}], ",", " ", "check"}], "*)"}], "\n", 
         RowBox[{"optsUpdateCoeff", "=", 
          RowBox[{"{", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<Ewc\>\"", "->", 
                 RowBox[{"{", "4.6", "}"}]}], ",", 
                RowBox[{"\"\<Epd\>\"", "->", 
                 RowBox[{"{", 
                  RowBox[{"{", "4.6", "}"}], "}"}]}]}], "|>"}]}], "}"}], ",", 
            
            RowBox[{"(*", 
             RowBox[{"updateCoeffsSol", " ", "option"}], "*)"}], "\n", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "True"}], "}"}]}], 
           RowBox[{"(*", 
            RowBox[{"checks", " ", "option"}], "*)"}], "\n", "}"}]}], ";", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "\n", 
                RowBox[{
                 RowBox[{"SetOptions", "[", 
                  RowBox[{"updateCoeffs", ",", "#"}], "]"}], ";", "\n", 
                 RowBox[{"out", "=", 
                  RowBox[{
                   RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", "#"}], "]"}], "==", 
                   RowBox[{"updateCoeffs", "[", "model", "]"}]}]}], ";", "\n", 
                 RowBox[{
                  RowBox[{"Options", "[", "updateCoeffs", "]"}], "=", 
                  "oldOptions"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"restore", " ", "options"}], "*)"}], "\n", "out"}], 
                "\n", "}"}], "&"}], "/@", "optsUpdateCoeff"}], ")"}]}]}]}], 
         ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
            RowBox[{"can", "'"}], "t", " ", "set", " ", "defaults", " ", 
            "for", " ", "updateCoeffs", " ", "for", " ", "FindRoot", " ", 
            "options", " ", "since", " ", "they", " ", "are", " ", "not", " ",
             "inherited"}]}], "*)"}], "\n", 
         RowBox[{"optsBad", "=", 
          RowBox[{"{", "\n", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"MaxIterations", "->", "100"}], "}"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"FindRoot", " ", "option"}], "*)"}], "\n", " ", 
            RowBox[{"{", 
             RowBox[{"PrecisionGoal", "->", "$MachinePrecision"}], "}"}]}], 
           RowBox[{"(*", 
            RowBox[{"FindRoot", " ", "option"}], "*)"}], "\n", "}"}]}], ";", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "\n", 
                RowBox[{
                 RowBox[{"m", "=", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
                    RowBox[{"$MessageList", "=", 
                    RowBox[{"{", "}"}]}]}], "}"}], ",", 
                    RowBox[{"Reap", "[", "\n", 
                    RowBox[{
                    RowBox[{"Module", "[", "\n", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", "\n", 
                    RowBox[{"SetOptions", "[", 
                    RowBox[{"updateCoeffs", ",", "#"}], "]"}]}], "\n", "]"}], 
                    ";", "\n", "$MessageList"}], "\n", "]"}]}], "\n", "]"}]}],
                  ";", "\n", 
                 RowBox[{
                  RowBox[{"Options", "[", "updateCoeffs", "]"}], "=", 
                  "oldOptions"}], ";", "\n", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"First", "@", "m"}]}], "==", 
                  RowBox[{"HoldForm", "@", 
                   RowBox[{"SetOptions", "::", "optnf"}]}]}]}], "\n", "}"}], 
               "&"}], "/@", "optsBad"}], ")"}]}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "can", " ", "set", " ", "defaults", " ", "using", " ", "the", " ", 
           "option", " ", "\"\<FindRootOptions\>\"", " ", "inherited", " ", 
           "from", " ", "updateCoeffsSol"}], "*)"}], "\n", 
         RowBox[{"optsFindRoot", "=", 
          RowBox[{"{", "\n", 
           RowBox[{
            RowBox[{"\"\<FindRootOptions\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"MaxIterations", "->", "1"}], "}"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "has", " ", "a", " ", "default", " ", "in", " ", 
              "\"\<FindRootOptions\>\""}], "*)"}], "\n", 
            RowBox[{"\"\<FindRootOptions\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"AccuracyGoal", "->", "2"}], "}"}]}]}], 
           RowBox[{"(*", 
            RowBox[{
            "does", " ", "not", " ", "have", " ", "a", " ", "default", " ", 
             "in", " ", "\"\<FindRootOptions\>\""}], "*)"}], "\n", "}"}]}], 
         ";", 
         RowBox[{"(*", 
          RowBox[{
          "can", " ", "set", " ", "defaults", " ", "using", " ", "the", " ", 
           "default", " ", "options", " ", "from", " ", "FindRoot", " ", 
           "only", " ", "for", " ", "options", " ", "without", " ", "a", " ", 
           "default", " ", "in", " ", "\"\<FindRootOptions\>\""}], "*)"}], 
         "\n", 
         RowBox[{"oldFindRootOpts", " ", "=", " ", 
          RowBox[{"Options", "[", "FindRoot", "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "save", " ", "options", " ", "to", " ", "restore", " ", "at", " ", 
           "the", " ", "end"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{
          "find", " ", "options", " ", "with", " ", "a", " ", "default", " ", 
           "value", " ", "in", " ", "\"\<FindRootOptions\>\"", " ", "option", 
           " ", "in", " ", "updateCoeffs"}], "*)"}], "\n", 
         RowBox[{"withFindRootOptionDefault", "=", 
          RowBox[{"Keys", "@", 
           RowBox[{"(", 
            RowBox[{"\"\<FindRootOptions\>\"", "/.", 
             RowBox[{"Options", "[", "updateCoeffs", "]"}]}], ")"}]}]}], ";", 
         "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "\n", 
                RowBox[{
                 RowBox[{"SetOptions", "[", 
                  RowBox[{"updateCoeffs", ",", "#"}], "]"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"test", ":", " ", 
                   RowBox[{
                   "change", " ", "default", " ", "option", " ", 
                    "\"\<FindRootOptions\>\"", " ", "in", " ", 
                    "updateCoeffs"}]}], "*)"}], "\n", 
                 RowBox[{"out1", "=", 
                  RowBox[{
                   RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", "#"}], "]"}], "==", 
                   RowBox[{"updateCoeffs", "[", "model", "]"}]}]}], ";", "\n", 
                 RowBox[{
                  RowBox[{"Options", "[", "updateCoeffs", "]"}], "=", 
                  "oldOptions"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"restore", " ", "options"}], "*)"}], "\n", 
                 RowBox[{"Unprotect", "[", "FindRoot", "]"}], ";", "\n", 
                 RowBox[{"SetOptions", "[", 
                  RowBox[{"FindRoot", ",", 
                   RowBox[{"Last", "@", "#"}]}], "]"}], ";", 
                 RowBox[{"(*", 
                  RowBox[{
                  "change", " ", "default", " ", "option", " ", "in", " ", 
                   "FindRoot"}], "*)"}], "\n", 
                 RowBox[{"out2", "=", 
                  RowBox[{
                   RowBox[{"updateCoeffs", "[", 
                    RowBox[{"model", ",", "#"}], "]"}], "==", 
                   RowBox[{"updateCoeffs", "[", "model", "]"}]}]}], ";", "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"test", ":", " ", 
                    RowBox[{
                    "if", " ", "option", " ", "has", " ", "a", " ", "default",
                     " ", "in", " ", "\"\<FindRootOptions\>\""}]}], ",", " ", 
                   
                   RowBox[{
                   "FindRoot", " ", "option", " ", "does", " ", "not", " ", 
                    "override", " ", "it"}]}], "*)"}], "\n", 
                 RowBox[{"out2", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"withFindRootOptionDefault", ",", 
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", 
                    RowBox[{"Last", "@", "#"}]}]}]}], "]"}], ",", 
                    RowBox[{"Not", "@", 
                    RowBox[{"TrueQ", "@", "out2"}]}], ",", "out2"}], "]"}]}], 
                 ";", "\n", 
                 RowBox[{
                  RowBox[{"Options", "[", "FindRoot", "]"}], "=", 
                  "oldFindRootOpts"}], ";", "\n", 
                 RowBox[{"Protect", "[", "FindRoot", "]"}], ";", "\n", 
                 RowBox[{"{", 
                  RowBox[{"out1", ",", "out2"}], "}"}]}], "\n", "}"}], "&"}], 
              "/@", "optsFindRoot"}], ")"}]}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "pass", " ", "interval", " ", "as", " ", "initial", " ", "guess", 
            " ", "works"}]}], "*)"}], "\n", 
         RowBox[{
          RowBox[{"coeffsQWc", "[", 
           RowBox[{"updateCoeffs", "[", 
            RowBox[{"model", ",", 
             RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
              RowBox[{"<|", 
               RowBox[{"\"\<Ewc\>\"", "->", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "8"}], "}"}]}], "|>"}]}]}], "]"}], "]"}], 
          ",", "\n", 
          RowBox[{"(*", 
           RowBox[{"test", ":", " ", 
            RowBox[{
            "pass", " ", "interval", " ", "interval", " ", "and", " ", 
             "initial", " ", "guess", " ", "works"}]}], "*)"}], "\n", 
          RowBox[{"coeffsQWc", "[", 
           RowBox[{"updateCoeffs", "[", 
            RowBox[{"model", ",", 
             RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
              RowBox[{"<|", 
               RowBox[{"\"\<Ewc\>\"", "->", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "1", ",", "8"}], "}"}]}], "|>"}]}]}], 
            "]"}], "]"}]}], "\n", "}"}]}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"test", ":", " ", 
          RowBox[{
          "pass", " ", "approximate", " ", "or", " ", "exact", " ", 
           "numbers"}]}], "*)"}], "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4.", "}"}]}], "|>"}]}]}], "]"}], "]"}], "==", 
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", "4", "}"}]}], "|>"}]}]}], "]"}], "]"}]}], 
             ",", "\n", 
             RowBox[{
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"1.", ",", "8."}], "}"}]}], "|>"}]}]}], "]"}], 
               "]"}], "==", 
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}]}], "|>"}]}]}], "]"}], 
               "]"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"4.", ",", "1.", ",", "8."}], "}"}]}], "|>"}]}]}],
                 "]"}], "]"}], "==", 
              RowBox[{"coeffsQWc", "[", 
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
                  RowBox[{"<|", 
                   RowBox[{"\"\<Ewc\>\"", "->", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1", ",", "8"}], "}"}]}], "|>"}]}]}], 
                "]"}], "]"}]}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", "tests", " ", "for", " ", 
        "bond", " ", "coefficients"}], "**********)"}], "\n", 
      RowBox[{"(*", "updateCoeffsBond", "*)"}], "\n", 
      RowBox[{"maxMaturity", "=", "12"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{"coefficients", " ", "have", " ", "expected", " ", "form"}]}],
        "*)"}], "\n", 
      RowBox[{"solBond", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<bond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
         RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], "]"}]}], ";",
       "\n", 
      RowBox[{"solNomBond", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<nombond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
         RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], "]"}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"coeffsQBond", "[", 
           RowBox[{"solBond", ",", "maxMaturity"}], "]"}], ",", "\n", 
          RowBox[{"coeffsQNomBond", "[", 
           RowBox[{"solNomBond", ",", "maxMaturity"}], "]"}]}], "\n", 
         "}"}]}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"(*", "newParameters", "*)"}], "\n", 
      RowBox[{"newBondParams", "=", 
       RowBox[{"{", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`psi", "->", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "0.1", "+", "FernandoDuarte`LongRunRisk`Model`Parameters`psi"}], "/.", 
           RowBox[{"model", "[", "\"\<params\>\"", "]"}]}], ")"}]}], "}"}]}], 
      ";", "\n", 
      RowBox[{"solWcNewBondParams", "=", 
       RowBox[{"updateCoeffs", "[", 
        RowBox[{"model", ",", "newBondParams", ",", "optsWc"}], "]"}]}], ";", 
      "\n", 
      RowBox[{"solBondNew", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<bond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", "newBondParams", 
         ",", "maxMaturity", ",", "solWcNewBondParams"}], "]"}]}], ";", "\n", 
      
      RowBox[{"solNomBondNew", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<nombond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", "newBondParams", 
         ",", "maxMaturity", ",", "solWcNewBondParams"}], "]"}]}], ";", "\n", 
      
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"coeffsQBond", "[", 
           RowBox[{"solBondNew", ",", "maxMaturity"}], "]"}], ",", "\n", 
          RowBox[{"coeffsQNomBond", "[", 
           RowBox[{"solNomBondNew", ",", "maxMaturity"}], "]"}], ",", "\n", 
          RowBox[{"Not", "[", 
           RowBox[{"solBond", "===", "solBondNew"}], "]"}], ",", "\n", 
          RowBox[{"Not", "[", 
           RowBox[{"solNomBond", "===", "solNomBondNew"}], "]"}]}], "\n", 
         "}"}]}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
      RowBox[{"(*", "maxMaturity", "*)"}], "\n", 
      RowBox[{"oldMaxMaturity", "=", "maxMaturity"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"save", " ", "to", " ", "restore", " ", "later"}], "*)"}], 
      "\n", 
      RowBox[{"maxMaturity", "=", "2"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{"coefficients", " ", "have", " ", "expected", " ", "form"}]}],
        "*)"}], "\n", 
      RowBox[{"solBond", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<bond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
         RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], "]"}]}], ";",
       "\n", 
      RowBox[{"solNomBond", "=", 
       RowBox[{"updateCoeffsBond", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
          "\"\<nombond\>\"", "]"}], ",", 
         RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
         RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], "]"}]}], ";",
       "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"coeffsQBond", "[", 
           RowBox[{"solBond", ",", "maxMaturity"}], "]"}], ",", "\n", 
          RowBox[{"coeffsQNomBond", "[", 
           RowBox[{"solNomBond", ",", "maxMaturity"}], "]"}], ",", "\n", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "maxMaturity"}], "]"}], "==", 
           RowBox[{"(", 
            RowBox[{"Sort", "@", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Keys", "@", "solBond"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x_", "[", "i_", "]"}], "[", "j_", "]"}], ":>", 
                 "i"}]}], "]"}]}]}], ")"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "maxMaturity"}], "]"}], "==", 
           RowBox[{"(", 
            RowBox[{"Sort", "@", 
             RowBox[{"DeleteDuplicates", "@", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Keys", "@", "solNomBond"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x_", "[", "i_", "]"}], "[", "j_", "]"}], ":>", 
                 "i"}]}], "]"}]}]}], ")"}]}]}], "\n", "}"}]}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Echo", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ind", ",", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}], 
        ";"}], "*)"}], "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", 
      RowBox[{"maxMaturity", "=", "oldMaxMaturity"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"restore", " ", "original", " ", "value"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"test", ":", " ", 
          RowBox[{
          "pass", " ", "options", " ", "for", " ", "RecurrenceTable"}]}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"solBond", "=", 
          RowBox[{"updateCoeffsBond", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
             "\"\<bond\>\"", "]"}], ",", 
            RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
            RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc", ",", 
            RowBox[{"\"\<Method\>\"", "->", "Automatic"}], ",", 
            RowBox[{"\"\<Precision\>\"", "->", "1"}]}], "]"}]}], ";", "\n", 
         RowBox[{"solNomBond", "=", 
          RowBox[{"updateCoeffsBond", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
             "\"\<nombond\>\"", "]"}], ",", 
            RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
            RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc", ",", 
            RowBox[{"\"\<Method\>\"", "->", "Automatic"}], ",", 
            RowBox[{"\"\<Precision\>\"", "->", "1"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{"coeffsQBond", "[", 
              RowBox[{"solBond", ",", "maxMaturity"}], "]"}], ",", "\n", 
             RowBox[{"coeffsQNomBond", "[", 
              RowBox[{"solNomBond", ",", "maxMaturity"}], "]"}]}], "\n", 
            "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", "updateCoeffs", "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "updateCoeffs", " ", "matches", " ", "updateCoeffsBond"}]}], 
          "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<MaxMaturity\>\"", "->", "maxMaturity"}]}], 
                 "]"}], ",", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`coefb",
                  "[", "_", "]"}]}], "]"}], "===", "\n", 
              RowBox[{"updateCoeffsBond", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
                 "\"\<bond\>\"", "]"}], ",", 
                RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
                RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], 
               "]"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<UpdateNomBond\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<MaxMaturity\>\"", "->", "maxMaturity"}]}], 
                 "]"}], ",", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
coefnb", "[", "_", "]"}]}], "]"}], "===", "\n", 
              RowBox[{"updateCoeffsBond", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], "[", 
                 "\"\<nombond\>\"", "]"}], ",", 
                RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
                RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], 
               "]"}]}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{"Sort", "@", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<UpdateBonds\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<MaxMaturity\>\"", "->", "maxMaturity"}]}], 
                 "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
coefb", "[", "_", "]"}], "|", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\
coefnb", "[", "_", "]"}]}]}], "]"}]}], "===", 
             RowBox[{"Sort", "@", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"updateCoeffsBond", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], 
                   "[", "\"\<bond\>\"", "]"}], ",", 
                  RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
                  RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], 
                 "]"}], ",", 
                RowBox[{"updateCoeffsBond", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"model", "[", "\"\<coeffsSolution\>\"", "]"}], 
                   "[", "\"\<nombond\>\"", "]"}], ",", 
                  RowBox[{"model", "[", "\"\<params\>\"", "]"}], ",", 
                  RowBox[{"{", "}"}], ",", "maxMaturity", ",", "solWc"}], 
                 "]"}]}], "]"}]}]}], "\n", "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"PrintResidualsNorm", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{"do", " ", "not", " ", "print", " ", "residual"}]}], 
          "*)"}], "\n", 
         RowBox[{"m1", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                   RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "False"}]}], 
                  "]"}], ";"}]}], "]"}], ";", "$MessageList"}], "]"}]}], "\n",
            "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{"print", " ", "residual"}]}], "*)"}], "\n", 
         RowBox[{"m2", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
              RowBox[{"$MessageList", "=", 
               RowBox[{"{", "}"}]}]}], "}"}], ",", 
            RowBox[{"Reap", "[", 
             RowBox[{
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", "}"}], ",", 
                RowBox[{
                 RowBox[{"updateCoeffs", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                   RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "True"}]}], 
                  "]"}], ";"}]}], "]"}], ";", "$MessageList"}], "]"}]}], "\n",
            "]"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "check", " ", "m1", " ", "did", " ", "not", " ", "print"}]}], ",",
            " ", 
           RowBox[{"m2", " ", "printed", " ", "correct", " ", "message"}]}], 
          "*)"}], "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ReleaseHold", "@", "m1"}], "==", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"(", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"ReleaseHold", "@", 
              RowBox[{"First", "@", "m2"}]}], ",", 
             RowBox[{
             "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "norm"}]}], " ", "]"}], ")"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"NumberQ", "@", 
           RowBox[{"(", 
            RowBox[{"ReleaseHold", "@", 
             RowBox[{"First", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Last", "@", "m2"}]}]}]}], ")"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"CheckResiduals", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{"test", ":", " ", 
           RowBox[{
           "do", " ", "not", " ", "check", " ", "if", " ", "root", " ", 
            "finding", " ", "residual", " ", 
            RowBox[{"(", "error", ")"}], " ", "is", " ", "small"}]}], "*)"}], 
         "\n", 
         RowBox[{"c1", "=", 
          RowBox[{"Not", "@", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"CheckAbort", "[", 
             RowBox[{
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<CheckResiduals\>\"", "->", "False"}]}], "]"}], 
                ",", 
                RowBox[{"Abort", "[", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
            "]"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{
            "check", " ", "if", " ", "root", " ", "finding", " ", "residual", 
             " ", 
             RowBox[{"(", "error", ")"}], " ", "is", " ", "small"}]}], ",", 
           " ", 
           RowBox[{
           "abort", " ", "if", " ", "error", " ", "above", " ", 
            "tolerance"}]}], "*)"}], "\n", 
         RowBox[{"c2", "=", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"CheckAbort", "[", 
            RowBox[{
             RowBox[{"Check", "[", 
              RowBox[{
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                 RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}]}], "]"}], 
               ",", 
               RowBox[{"Abort", "[", "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\n", "\n", 
         RowBox[{"(*", 
          RowBox[{"Tol", " ", "works"}], "*)"}], "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{"big", " ", "tolerance"}]}], ",", " ", 
           RowBox[{"computation", " ", "does", " ", "not", " ", "abort"}]}], 
          "*)"}], "\n", 
         RowBox[{"c1", "=", 
          RowBox[{"Not", "@", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"CheckAbort", "[", 
             RowBox[{
              RowBox[{"Check", "[", 
               RowBox[{
                RowBox[{"updateCoeffs", "[", 
                 RowBox[{"model", ",", 
                  RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
                  RowBox[{"\"\<Tol\>\"", "->", "1"}]}], "]"}], ",", 
                RowBox[{"Abort", "[", "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
            "]"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"test", ":", " ", 
            RowBox[{"low", " ", "tolerance"}]}], ",", " ", 
           RowBox[{"computation", " ", "aborts"}]}], "*)"}], "\n", 
         RowBox[{"c2", "=", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"CheckAbort", "[", 
            RowBox[{
             RowBox[{"Check", "[", 
              RowBox[{
               RowBox[{"updateCoeffs", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"\"\<UpdateBond\>\"", "->", "True"}], ",", 
                 RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
                 RowBox[{"\"\<Tol\>\"", "->", 
                  RowBox[{"10.", "^", 
                   RowBox[{"-", "20"}]}]}]}], "]"}], ",", 
               RowBox[{"Abort", "[", "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\
Private`checks", "::", "largeresid"}], ")"}]}], "]"}], ",", "True"}], "]"}], 
           "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "c2"}], "}"}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Echo", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ind", ",", 
               RowBox[{
                RowBox[{"outTests", "[", 
                 RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[",
                 "ind", "]"}]}], "}"}], ",", "\"\<ind, outTests\>\""}], "]"}],
            ";"}], "*)"}], "\n", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\n", "]"}], ";"}], "\n", ",",
      "\n", 
     RowBox[{"{", 
      RowBox[{"model", ",", "mods"}], "}"}]}], "\n", "]"}], ";"}], 
  RowBox[{"(*", "Do", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"noMissingTest", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"testNumber", "=", "\n", 
       RowBox[{"Sort", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Keys", "@", 
           RowBox[{"SubValues", "@", "outTests"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "i_Integer", "]"}], "]"}], ":>", "i"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"noMissingTest", ",", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Max", "[", "testNumber", "]"}]}], "]"}], "==", 
         "testNumber"}]}], "]"}], ";"}], "\n", ",", "\n", 
     RowBox[{"{", 
      RowBox[{"model", ",", "mods"}], "}"}]}], "\n", "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{"And", "@@", "noMissingTest"}], ",", "\n", 
      RowBox[{"And", "@@", 
       RowBox[{"Values", "@", 
        RowBox[{"SubValues", "@", "outTests"}]}]}]}], "\n", "}"}]}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{"out", ",", "\"\<out\>\""}], "]"}], ";", "\n", 
    RowBox[{"Unprotect", "[", "$MessageList", "]"}], ";", "\n", 
    RowBox[{"$MessageList", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"Protect", "[", "$MessageList", "]"}], ";", "\n", 
    RowBox[{"Echo", "[", 
     RowBox[{"$MessageList", ",", "\"\<message list\>\""}], "]"}], ";"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"General", "::", "stop"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"FindRoot", "::", "cvmit"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.906299000816691*^9, {3.906299123705739*^9, 3.906299141428466*^9}, 
   3.9063014587290077`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"b0894a49-bf3f-4533-bf13-f1a578d04ae3"]
}, Closed]],

Cell[CellGroupData[{

Cell["TimeAggregation", "Section",
 CellChangeTimes->{{3.906296881234215*^9, 
  3.906296881415927*^9}},ExpressionUUID->"a8617bb6-ddb7-4466-b25a-\
5e10c2d4d028"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"30434243-6866-4a09-b7cd-7dc19b6ae0cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"616e66b2-f827-46e2-8212-bdbe51d6a58f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, 3.905131460208308*^9, 3.906297268124083*^9, {
   3.9062974701355457`*^9, 3.9062974728439703`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"426e909c-77b1-4f9f-b893-e44b93d370ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<Tools\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Tools`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, 
   3.89001596275924*^9, 3.890101011094161*^9, {3.890125139775529*^9, 
   3.890125142574856*^9}, {3.89015867604501*^9, 3.890158680365151*^9}, {
   3.905131546914009*^9, 3.9051315925267*^9}, {3.906297268905542*^9, 
   3.9062972697723293`*^9}, {3.906297474764103*^9, 3.906297475604519*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"be6d791b-b682-4e25-946d-7a8b738438a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"tests", " ", "Growth"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "dc", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"tent", "-", 
    RowBox[{"shaped", " ", "coefficients"}]}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t"}], "]"}], "==", 
      RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}]}], "]"}], "==", 
      RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}]}], "]"}], "==", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"dc", "[", "t", "]"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}]}], "]"}], "==", 
      RowBox[{
       FractionBox["1", "12"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "22"}], "+", "t"}], "]"}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "21"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "20"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "19"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "18"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "17"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "16"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"8", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "15"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"9", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "14"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "13"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"11", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "12"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"12", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "11"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"11", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "10"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"10", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "9"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"9", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "8"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"8", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "7"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"7", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "6"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "5"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"4", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"dc", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"dc", "[", "t", "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.905133500556025*^9, 3.905133500806592*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"7c6b034d-9cd2-49e7-b1f9-bfa037448cfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"expanssion", " ", "around", " ", "v0"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"constant", " ", "v0"}], ",", " ", 
    RowBox[{
    "v0", " ", "has", " ", "different", " ", "number", " ", "of", " ", 
     "arguments"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
            "}"}], ",", "0.0015"}], "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",",
            "0.0015"}], "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j", ",", "h", ",", "k"}], "}"}], ",", 
           "0.0015"}], "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j", ",", "h"}], "}"}], ",", "0.0015"}], 
          "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"constant", " ", "v0"}], ",", " ", 
       RowBox[{"different", " ", "symbols", " ", "as", " ", "arguments"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j"}], "}"}], ",", "0.0015"}], "]"}]}]}], "]"}],
       "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "t", "}"}], ",", "0.0015"}], "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "0.0015"}], "]"}]}]}], "]"}], "==", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3328334585207629`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.6661665418542368`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
       RowBox[{"0.6671665414792372`", " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
       RowBox[{"0.33383345814576315`", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890397132800043*^9, 3.890397245124961*^9}, {
  3.890402620539359*^9, 3.890402620835738*^9}, {3.8905909075478067`*^9, 
  3.89059090865847*^9}, {3.905132355704953*^9, 3.905132365625505*^9}, {
  3.905133511930475*^9, 3.905133513798511*^9}, {3.905133695362563*^9, 
  3.905133695602569*^9}, {3.9051338238575153`*^9, 3.905133833621661*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ab84bc1b-aedf-4050-a58e-3d9d8ea45575"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"v0", " ", "as", " ", "a", " ", "function", " ", "of", " ", "t"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Simplify", "@", 
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
        RowBox[{"\"\<v0\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
            "}"}], ",", "t"}], "]"}]}]}], "]"}]}], "==", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "t"], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "t"}]]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", "t"]}], ")"}], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "t"], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "t"}]], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "t"], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "t"}]], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "t"}]], " ", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890188230618291*^9, 3.89018826221737*^9}, {
   3.8901960603832684`*^9, 3.890196060384165*^9}, 3.8903633949009027`*^9, {
   3.89038254616477*^9, 3.890382546165432*^9}, {3.890382638645205*^9, 
   3.89038268764703*^9}, {3.890382718668954*^9, 3.890383019692555*^9}, {
   3.890383063629991*^9, 3.890383067543963*^9}, {3.890396495869184*^9, 
   3.890396499637044*^9}, {3.890402316707736*^9, 3.8904023552940407`*^9}, 
   3.890590908857563*^9, {3.905132375508904*^9, 3.905132381918507*^9}, {
   3.905133522889653*^9, 3.9051335231154833`*^9}, {3.905133698038678*^9, 
   3.905133698266244*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"51d7b9c1-9fb7-4b8d-8044-8cb2058c4b27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"v0", " ", "as", " ", "a", " ", "function", " ", "of", " ", "h"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"growth", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<v0\>\"", "->", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}],
              "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"h", "==", "12"}], ",", "h12", ",", "hnot12"}], "]"}]}],
            "]"}]}]}], "]"}], ",", "h12"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"growth", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<v0\>\"", "->", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}],
              "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"h", "==", "12"}], ",", "h12", ",", "hnot12"}], "]"}]}],
            "]"}]}]}], "]"}], ",", "hnot12"}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890188230618291*^9, 3.89018826221737*^9}, {
   3.8901960603832684`*^9, 3.890196060384165*^9}, 3.8903633949009027`*^9, {
   3.89038254616477*^9, 3.890382546165432*^9}, {3.890382638645205*^9, 
   3.89038268764703*^9}, {3.890382718668954*^9, 3.890383019692555*^9}, {
   3.890383063629991*^9, 3.890383067543963*^9}, {3.890396495869184*^9, 
   3.890396499637044*^9}, {3.890402316707736*^9, 3.8904023552940407`*^9}, {
   3.8905909091964283`*^9, 3.890590909476776*^9}, {3.890591000348248*^9, 
   3.890591030600806*^9}, {3.905133525249123*^9, 3.9051335254956703`*^9}, {
   3.905133700662964*^9, 3.905133700921669*^9}, 3.905133840102029*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"2c745b5c-4ba3-445a-ab77-179e7028f8c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "v0", " ", "independent", " ", "of", " ", "j"}], ",", 
    " ", 
    RowBox[{
    "constant", " ", "term", " ", "in", " ", "expansion", " ", "should", " ", 
     "be", " ", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"0", "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"growth", "[", 
            RowBox[{"dc", ",", "t", ",", 
             RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
             RowBox[{"\"\<v0\>\"", "->", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                 "}"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"h", "+", "1"}], ")"}]}]}], "]"}]}]}], "]"}], "/.", 
           
           RowBox[{
            RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
          "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"growth", "[", 
            RowBox[{"dc", ",", "t", ",", 
             RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<v0\>\"", "->", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                 "}"}], ",", 
                RowBox[{"h", "^", "2"}]}], "]"}]}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
          "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"growth", "[", 
            RowBox[{"dc", ",", "t", ",", 
             RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
             RowBox[{"\"\<v0\>\"", "->", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                 "}"}], ",", "im"}], "]"}]}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
          "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"growth", "[", 
            RowBox[{"dc", ",", "t", ",", 
             RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<v0\>\"", "->", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                 "}"}], ",", "v"}], "]"}]}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
          "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coefficient", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"growth", "[", 
            RowBox[{"dd", ",", "t", ",", "i", ",", 
             RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
             RowBox[{"\"\<v0\>\"", "->", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                 "}"}], ",", "im"}], "]"}]}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dd", "[", 
             RowBox[{"__", ",", "i"}], "]"}], "->", "ddX"}]}], ",", "ddX", 
          ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890384749988565*^9, 3.8903848671079073`*^9}, {
   3.890385086577386*^9, 3.890385132765119*^9}, {3.8903851882869177`*^9, 
   3.890385211185302*^9}, {3.890385645996904*^9, 3.890385670244089*^9}, {
   3.890385842455722*^9, 3.890385936794145*^9}, {3.8903859905439873`*^9, 
   3.890385999357443*^9}, {3.890392502148799*^9, 3.890392502486706*^9}, {
   3.89039650846305*^9, 3.8903965159334*^9}, 3.890402287469048*^9, {
   3.890402629564251*^9, 3.8904026351157513`*^9}, {3.890407259759863*^9, 
   3.89040726389555*^9}, {3.8905909096771193`*^9, 3.890590911247868*^9}, {
   3.890591349401698*^9, 3.890591358117527*^9}, {3.9051335280180407`*^9, 
   3.905133528246677*^9}, {3.9051337032625*^9, 3.9051337034809647`*^9}, {
   3.9051338441504517`*^9, 3.905133852704021*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8add8115-f200-481a-af7e-fbd5146eedba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "v0", 
     RowBox[{"(", 
      RowBox[{"t", ",", "h", ",", "j"}], ")"}], " ", "independent", " ", "of",
      " ", "j"}], ",", " ", 
    RowBox[{
    "constant", " ", "term", " ", "in", " ", "expansion", " ", "should", " ", 
     "be", " ", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"arbitraryFun1", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{"Sqrt", "[", "h", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arbitraryFun2", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", "==", "dd"}], ",", 
         RowBox[{"Sqrt", "[", "h", "]"}], ",", 
         RowBox[{"Cos", "[", "h", "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arbitraryFun3", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{"-", "h"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arbitraryFun4", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "h", "]"}], "t"}], " ", "-", 
        RowBox[{"k", "^", "2"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arbitraryFun5", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", "==", "dd"}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "h", "]"}], 
          RowBox[{"Sqrt", "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Exp", "[", "t", "]"}], 
          RowBox[{"Cos", "[", "h", "]"}]}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"arbitraryFun6", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v"}], "}"}], ",", 
       RowBox[{
        RowBox[{"-", "h"}], "*", "t", "*", "k"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun1"}]}], "//", "N"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun2"}]}], "//", "N"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun3"}]}], "//", "N"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun4"}]}], "//", "N"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun5"}]}], "//", "N"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"growth", "[", 
               RowBox[{"dc", ",", "t", ",", 
                RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
                RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
                RowBox[{"\"\<v0\>\"", "->", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                    "}"}], ",", 
                   RowBox[{"F", "[", 
                    RowBox[{"h", ",", "v", ",", "im"}], "]"}]}], "]"}]}]}], 
               "]"}], "/.", 
              RowBox[{
               RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", 
             ",", "0"}], "]"}], "//", "FullSimplify"}], ")"}]}], "/.", 
        RowBox[{"F", "->", "arbitraryFun6"}]}], "//", "N"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890384749988565*^9, 3.8903848671079073`*^9}, {
   3.890385086577386*^9, 3.890385132765119*^9}, {3.8903851882869177`*^9, 
   3.890385211185302*^9}, {3.890385645996904*^9, 3.890385670244089*^9}, {
   3.890385842455722*^9, 3.890385936794145*^9}, 3.890385978222056*^9, {
   3.8903861480636463`*^9, 3.890386183253318*^9}, {3.890396522542078*^9, 
   3.890396526851598*^9}, {3.8904022814019737`*^9, 3.890402284719747*^9}, {
   3.890402373224584*^9, 3.8904024058293343`*^9}, {3.890402436809697*^9, 
   3.890402505325487*^9}, {3.890402656401352*^9, 3.890402663821278*^9}, {
   3.89059091223176*^9, 3.8905909132612534`*^9}, 3.890591364980472*^9, {
   3.905133531763711*^9, 3.90513353206312*^9}, {3.905133711614859*^9, 
   3.9051337200020237`*^9}, {3.905133860291556*^9, 3.905133871355505*^9}, 
   3.9051363434434032`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"1e041e26-de65-417d-b537-14855004dc7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "dependence", " ", "on", " ", "j", " ", "implies", " ", "constant", " ", 
    "term", " ", "in", " ", "expansion", " ", "is", " ", "not", " ", 
    "necessarily", " ", "0"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"Not", "[", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"growth", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "3"}], ",", 
            RowBox[{"\"\<v0\>\"", "->", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                "}"}], ",", "j"}], "]"}]}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
         "0"}], "]"}]}], "//", "N"}], "]"}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890384749988565*^9, 3.89038485124676*^9}, {
   3.890384994127694*^9, 3.89038503141006*^9}, {3.8903850922920303`*^9, 
   3.890385181129077*^9}, 3.890396600232943*^9, {3.890402515366212*^9, 
   3.890402515971282*^9}, 3.890590913478216*^9, {3.9051335358973503`*^9, 
   3.905133536123393*^9}, {3.905133728479306*^9, 3.905133728761042*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"038d4056-c78d-4e10-ac4a-aa5ef87e6d40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"v0", " ", "as", " ", "a", " ", "function", " ", "of", " ", "j"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"growth", "[", 
      RowBox[{"dc", ",", "t", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
       RowBox[{"\"\<v0\>\"", "->", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "j"}], "}"}], ",", "j"}], "]"}]}]}], "]"}], "==", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"-", "7"}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["\[ExponentialE]", "4"]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "4"], " ", 
         RowBox[{"dc", "[", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], "]"}]}]}], 
       RowBox[{"1", "+", 
        SuperscriptBox["\[ExponentialE]", "4"], "+", 
        SuperscriptBox["\[ExponentialE]", "7"]}]], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}], "+", 
      FractionBox[
       RowBox[{"1", "-", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "-", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"\[ExponentialE]", " ", 
         RowBox[{"dc", "[", "t", "]"}]}]}], 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "\[ExponentialE]"}]}]], "-", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", 
        FractionBox["1", 
         SuperscriptBox["\[ExponentialE]", "7"]], "+", 
        FractionBox["1", 
         SuperscriptBox["\[ExponentialE]", "3"]]}], "]"}], "+", 
      RowBox[{"Log", "[", 
       RowBox[{"2", "+", 
        FractionBox["1", "\[ExponentialE]"]}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890188230618291*^9, 3.89018826221737*^9}, {
   3.8901960603832684`*^9, 3.890196060384165*^9}, 3.8903633949009027`*^9, {
   3.89038254616477*^9, 3.890382546165432*^9}, {3.890382638645205*^9, 
   3.89038268764703*^9}, {3.890382718668954*^9, 3.890383019692555*^9}, {
   3.890383053934743*^9, 3.8903830569041767`*^9}, {3.890383090604886*^9, 
   3.8903830994737673`*^9}, {3.890396605286977*^9, 3.8903966193629932`*^9}, {
   3.890396692666997*^9, 3.890396707758502*^9}, 3.890396747842326*^9, {
   3.8903967874492273`*^9, 3.890396787615608*^9}, 3.89059091373112*^9, {
   3.905132396038013*^9, 3.905132396806686*^9}, {3.905133538000011*^9, 
   3.905133538259054*^9}, {3.905133730773085*^9, 3.905133731047802*^9}, 
   3.9063016290056677`*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"63af4e00-5b63-4bbd-a66d-023379aedcf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"v0", " ", "as", " ", "a", " ", "function", " ", "of", " ", "v"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"growth", "[", 
         RowBox[{"dc", ",", "t", ",", 
          RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
          RowBox[{"\"\<v0\>\"", "->", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], "}"}],
              ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"v", "===", "dc"}], ",", "Edc", ",", "0"}], "]"}]}], 
            "]"}]}]}], "]"}], ",", "Edc"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"growth", "[", 
        RowBox[{"pi", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<v0\>\"", "->", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}],
              "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"v", "===", "dc"}], ",", "Edc", ",", "0"}], "]"}]}], 
           "]"}]}]}], "]"}], ",", "Edc"}], "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"growth", "[", 
         RowBox[{"dd", ",", "t", ",", "i", ",", 
          RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
          RowBox[{"\"\<v0\>\"", "->", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], "}"}],
              ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"v", "===", "dd"}], ",", "Edd", ",", "0"}], "]"}]}], 
            "]"}]}]}], "]"}], ",", "Edd"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"growth", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<v0\>\"", "->", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}],
              "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"v", "===", "dd"}], ",", "Edd", ",", "0"}], "]"}]}], 
           "]"}]}]}], "]"}], ",", "Edd"}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890188230618291*^9, 3.89018826221737*^9}, {
   3.8901960603832684`*^9, 3.890196060384165*^9}, 3.8903633949009027`*^9, {
   3.89038254616477*^9, 3.890382546165432*^9}, {3.890382638645205*^9, 
   3.89038268764703*^9}, {3.890382718668954*^9, 3.890383019692555*^9}, {
   3.890383053934743*^9, 3.8903830569041767`*^9}, 3.890383090604886*^9, {
   3.890396606235301*^9, 3.890396607738501*^9}, {3.8905909142008133`*^9, 
   3.890590914880876*^9}, {3.89059141138151*^9, 3.890591470495411*^9}, {
   3.9051335405082083`*^9, 3.905133540756462*^9}, {3.905133733159277*^9, 
   3.905133733427733*^9}, {3.905133878581242*^9, 3.905133880046126*^9}, {
   3.905136349291803*^9, 3.905136364778743*^9}, 3.906301629005802*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"7c6610cc-e429-4cfc-ab21-3c3e69dc2327"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "v0", " ", "given", " ", "by", " ", "unconditional", " ", "moments"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"growth", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
         RowBox[{"\"\<v0\>\"", "->", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}],
              "}"}], ",", 
            RowBox[{"Evaluate", "@", 
             RowBox[{"uncondE", "[", 
              RowBox[{"dc", "[", "t", "]"}], "]"}]}]}], "]"}]}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"uncondE", "[", 
         RowBox[{"dc", "[", "t", "]"}], "]"}], "->", "0"}]}], ")"}], "==", 
     RowBox[{"(", 
      RowBox[{"growth", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "1"}]}], "]"}], ")"}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890188230618291*^9, 3.89018826221737*^9}, {
   3.8901960603832684`*^9, 3.890196060384165*^9}, 3.8903633949009027`*^9, {
   3.89038254616477*^9, 3.890382546165432*^9}, {3.890382638645205*^9, 
   3.89038268764703*^9}, {3.890382718668954*^9, 3.890382961460165*^9}, {
   3.890396608520708*^9, 3.890396609023325*^9}, {3.890590915063204*^9, 
   3.890590915479714*^9}, {3.8905914964638453`*^9, 3.8905914966703653`*^9}, {
   3.9051335435378103`*^9, 3.905133543922841*^9}, {3.905133736006527*^9, 
   3.905133736288653*^9}, 3.906301629005891*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"d7ccc5d1-7703-4b92-838b-5241841c25df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"v0", 
      RowBox[{"(", 
       RowBox[{"t", ",", "i"}], ")"}]}], "=", " ", 
     RowBox[{
      RowBox[{"v0", 
       RowBox[{"(", 
        RowBox[{"t", ",", 
         RowBox[{"kh", "+", "i"}]}], ")"}], " ", "for", " ", "i"}], "=", 
      "0"}]}], ",", "1", ",", "...", ",", 
    RowBox[{"h", "-", "2"}], ",", " ", 
    RowBox[{
    "constant", " ", "term", " ", "in", " ", "expansion", " ", "should", " ", 
     "be", " ", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "1"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "===", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"growth", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", 
            RowBox[{"\"\<v0\>\"", "->", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                "}"}], ",", 
               RowBox[{"F", "[", "t", "]"}]}], "]"}]}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
         "0"}], "]"}]}], "//", "Simplify"}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890402894534086*^9, 3.890403056502503*^9}, {
   3.890403106126875*^9, 3.890403163304315*^9}, {3.890403209187562*^9, 
   3.890403247505231*^9}, {3.890403378719262*^9, 3.8904034073321753`*^9}, {
   3.890403458564847*^9, 3.89040346182211*^9}, {3.890403497753498*^9, 
   3.8904035198822823`*^9}, {3.890403605784066*^9, 3.890403658758933*^9}, {
   3.890403710893354*^9, 3.890403713940164*^9}, 3.890403910953129*^9, {
   3.890404525747285*^9, 3.890404527300988*^9}, {3.8905909156814938`*^9, 
   3.890590916364067*^9}, {3.89059151163885*^9, 3.890591520161364*^9}, {
   3.905133547042287*^9, 3.905133568021709*^9}, {3.9051337386064653`*^9, 
   3.905133738849175*^9}, 3.906301629005981*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"fb413dae-3287-4b3d-a4b7-cc41db7a8cb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "2"}], ";", 
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulej", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", "i", "]"}], "->", 
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"h", "*", "k"}], "+", "i"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"h", "-", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"0", "===", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"growth", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", 
           RowBox[{"\"\<v0\>\"", "->", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
               "}"}], ",", 
              RowBox[{"F", "[", "j", "]"}]}], "]"}]}]}], "]"}], "/.", 
         "rulej"}], "/.", 
        RowBox[{
         RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
       "0"}], "]"}]}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.890402894534086*^9, 3.890403056502503*^9}, {
   3.890403106126875*^9, 3.890403163304315*^9}, {3.890403209187562*^9, 
   3.890403247505231*^9}, {3.890403378719262*^9, 3.8904034073321753`*^9}, {
   3.890403458564847*^9, 3.89040346182211*^9}, {3.890403497753498*^9, 
   3.8904035198822823`*^9}, {3.890403605784066*^9, 3.890403658758933*^9}, {
   3.890403710893354*^9, 3.890403713940164*^9}, 3.890403910953129*^9, {
   3.890404525747285*^9, 3.890404527300988*^9}, {3.8905909156814938`*^9, 
   3.890590916364067*^9}, {3.89059151163885*^9, 3.890591520161364*^9}, {
   3.905133547042287*^9, 3.905133581723422*^9}, {3.905133741006398*^9, 
   3.9051337412281523`*^9}, {3.9051338967521563`*^9, 3.9051339002003317`*^9}, 
   3.905136320490988*^9, 3.906301629006065*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"a29939a8-63b0-455b-9274-a109e4e3dc06"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "3"}], ";", 
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulej", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", "i", "]"}], "->", 
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"h", "*", "k"}], "+", "i"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"h", "-", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"0", "===", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"growth", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", 
           RowBox[{"\"\<v0\>\"", "->", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
               "}"}], ",", 
              RowBox[{"F", "[", "j", "]"}]}], "]"}]}]}], "]"}], "/.", 
         "rulej"}], "/.", 
        RowBox[{
         RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
       "0"}], "]"}]}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.890402894534086*^9, 3.890403056502503*^9}, {
   3.890403106126875*^9, 3.890403163304315*^9}, {3.890403209187562*^9, 
   3.890403247505231*^9}, {3.890403378719262*^9, 3.8904034073321753`*^9}, {
   3.890403458564847*^9, 3.89040346182211*^9}, {3.890403497753498*^9, 
   3.8904035198822823`*^9}, {3.890403605784066*^9, 3.890403658758933*^9}, {
   3.890403710893354*^9, 3.890403713940164*^9}, 3.890403910953129*^9, {
   3.890404525747285*^9, 3.890404527300988*^9}, {3.8905909156814938`*^9, 
   3.890590916364067*^9}, {3.89059151163885*^9, 3.890591520161364*^9}, {
   3.905133547042287*^9, 3.905133583961022*^9}, {3.905133743142974*^9, 
   3.9051337433615828`*^9}, {3.905133907161641*^9, 3.905133909483446*^9}, 
   3.9063016290061502`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"1451d0d2-f18f-43d4-8282-d349f944ce6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "4"}], ";", 
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rulej", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"F", "[", "i", "]"}], "->", 
      RowBox[{"F", "[", 
       RowBox[{
        RowBox[{"h", "*", "k"}], "+", "i"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"h", "-", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"0", "===", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"growth", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", 
            RowBox[{"\"\<v0\>\"", "->", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "t", ",", "j", ",", "h", ",", "k", ",", "v", ",", "im"}], 
                "}"}], ",", 
               RowBox[{"F", "[", "j", "]"}]}], "]"}]}]}], "]"}], ")"}], "/.", 
         "rulej"}], "/.", 
        RowBox[{
         RowBox[{"dc", "[", "__", "]"}], "->", "dcX"}]}], ",", "dcX", ",", 
       "0"}], "]"}]}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.890402894534086*^9, 3.890403056502503*^9}, {
   3.890403106126875*^9, 3.890403163304315*^9}, {3.890403209187562*^9, 
   3.890403247505231*^9}, {3.890403378719262*^9, 3.8904034073321753`*^9}, {
   3.890403458564847*^9, 3.89040346182211*^9}, {3.890403497753498*^9, 
   3.8904035198822823`*^9}, {3.890403605784066*^9, 3.890403658758933*^9}, {
   3.890403710893354*^9, 3.890403713940164*^9}, 3.890403910953129*^9, {
   3.890404525747285*^9, 3.890404527300988*^9}, {3.8905909156814938`*^9, 
   3.890590916364067*^9}, {3.89059151163885*^9, 3.890591520161364*^9}, {
   3.905133547042287*^9, 3.905133586110395*^9}, {3.905133744718692*^9, 
   3.9051337449693747`*^9}, {3.905133913564341*^9, 3.9051339168687267`*^9}, 
   3.9063016290062313`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"ed9cda80-ce67-4e52-85f1-715294f8cbf4"],

Cell[BoxData[
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"Expand", "@", 
        RowBox[{"growth", "[", 
         RowBox[{"dc", ",", "t", ",", 
          RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
          RowBox[{"\"\<Order\>\"", "->", "0"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"coef_.", " ", 
         SuperscriptBox[
          RowBox[{"dc", "[", "__", "]"}], "p_."]}], ":>", "p"}]}], "]"}], "===", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Expand", "@", 
         RowBox[{"growth", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
           RowBox[{"\"\<Order\>\"", "->", "1"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"coef_.", " ", 
          SuperscriptBox[
           RowBox[{"dc", "[", "__", "]"}], "p_."]}], ":>", "p"}]}], "]"}]}], "===",
      "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Expand", "@", 
         RowBox[{"growth", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
           RowBox[{"\"\<Order\>\"", "->", "2"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"coef_.", " ", 
          SuperscriptBox[
           RowBox[{"dc", "[", "__", "]"}], "p_."]}], ":>", "p"}]}], "]"}]}], "===",
      "2"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Expand", "@", 
         RowBox[{"growth", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
           RowBox[{"\"\<Order\>\"", "->", "3"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"coef_.", " ", 
          SuperscriptBox[
           RowBox[{"dc", "[", "__", "]"}], "p_."]}], ":>", "p"}]}], "]"}]}], "===",
      "3"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.8901882726262293`*^9, 3.890188293345408*^9}, {
   3.890196060398212*^9, 3.890196060400828*^9}, 3.890363394901119*^9, {
   3.8905909165812387`*^9, 3.8905909174315653`*^9}, {3.890591533014565*^9, 
   3.8905916929688272`*^9}, {3.905132467247383*^9, 3.905132467248948*^9}, {
   3.905133589108143*^9, 3.905133589301656*^9}, {3.905133747446377*^9, 
   3.905133747731835*^9}, {3.9051339341500053`*^9, 3.905133935386661*^9}, 
   3.9063016290063267`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"70473bc0-aa2d-4677-9f07-e48179d1d41f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Expand", "@", 
         RowBox[{"growth", "[", 
          RowBox[{"dd", ",", "t", ",", "i", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
           RowBox[{"\"\<Order\>\"", "->", "0"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"coef_.", " ", 
          SuperscriptBox[
           RowBox[{"dd", "[", 
            RowBox[{"__", ",", "i"}], "]"}], "p_."]}], ":>", "p"}]}], "]"}], "===", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Expand", "@", 
          RowBox[{"growth", "[", 
           RowBox[{"dd", ",", "t", ",", "i", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
            RowBox[{"\"\<Order\>\"", "->", "1"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"coef_.", " ", 
           SuperscriptBox[
            RowBox[{"dd", "[", 
             RowBox[{"__", ",", "i"}], "]"}], "p_."]}], ":>", "p"}]}], 
        "]"}]}], "===", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Expand", "@", 
          RowBox[{"growth", "[", 
           RowBox[{"dd", ",", "t", ",", "i", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
            RowBox[{"\"\<Order\>\"", "->", "2"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"coef_.", " ", 
           SuperscriptBox[
            RowBox[{"dd", "[", 
             RowBox[{"__", ",", "i"}], "]"}], "p_."]}], ":>", "p"}]}], 
        "]"}]}], "===", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Expand", "@", 
          RowBox[{"growth", "[", 
           RowBox[{"dd", ",", "t", ",", "i", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "1"}], ",", 
            RowBox[{"\"\<Order\>\"", "->", "3"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"coef_.", " ", 
           SuperscriptBox[
            RowBox[{"dd", "[", 
             RowBox[{"__", ",", "i"}], "]"}], "p_."]}], ":>", "p"}]}], 
        "]"}]}], "===", "3"}]}], "\[IndentingNewLine]", "}"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8901883116558*^9, 3.8901883252736263`*^9}, {
   3.890196060415234*^9, 3.890196060417364*^9}, 3.8903633949014187`*^9, {
   3.8905909176312428`*^9, 3.890590918316225*^9}, {3.890591699812582*^9, 
   3.890591736901132*^9}, {3.905132467253483*^9, 3.905132467254978*^9}, {
   3.905133591814699*^9, 3.9051335920151463`*^9}, {3.905133750006571*^9, 
   3.905133750248026*^9}, {3.9051339377340393`*^9, 3.9051339391968117`*^9}, 
   3.90630162900642*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"741ee58e-5ebe-4f99-a15e-9f4fd5647b4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "f", "=", "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`f"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "g", "=", "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "s", "=", "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`s"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "timeSeriesVector", "=", 
   "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`\
timeSeriesVector"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "gt", "=", "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`gt"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.890324214710425*^9, 3.890324291626787*^9}, {
   3.890557726208962*^9, 3.8905577330232363`*^9}, {3.890590899317346*^9, 
   3.890590899457222*^9}, {3.905132536173502*^9, 3.905132555573162*^9}, 
   3.906301629006489*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"7272905b-ec72-4fca-864a-ef1eedcfa039"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"tests", " ", "gt"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dc", ",", "t"}], "]"}], "==", 
       RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], "==", 
       
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "7"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "6"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "6"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "7"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "6"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "6"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dd", ",", "t", ",", "i", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], "==", 
       
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "7"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dd", ",", "t", ",", "i", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "7"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dd", ",", "t", ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], "==", 
       
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "5"}], "+", "t"}], ",", "1"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "1"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "7"}], "+", "t"}], ",", "1"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "1"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "1"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "1"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "1"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gt", "[", 
        RowBox[{"dd", ",", "t", ",", "2", ",", 
         RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "5"}], "+", "t"}], ",", "2"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "+", "t"}], ",", "2"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], "+", "t"}], ",", "2"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "2"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "2"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "2"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "7"}], "+", "t"}], ",", "2"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "2"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "6"}], "+", "t"}], ",", "2"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "2"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "2"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "2"}], "]"}]}]]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890180790288171*^9, 3.89018090596798*^9}, {
   3.890195412403283*^9, 3.890195414110985*^9}, {3.890195786875156*^9, 
   3.890195808972714*^9}, {3.89019606045087*^9, 3.890196060454335*^9}, 
   3.8903633949018908`*^9, {3.9051332233317833`*^9, 3.90513325960448*^9}, {
   3.905133596330532*^9, 3.905133596564281*^9}, {3.905133756758236*^9, 
   3.905133757029606*^9}, {3.905133945499896*^9, 3.905133954636455*^9}, 
   3.9063016290066977`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"b5ca4a67-1dea-4eec-be33-108db1551d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "3"}], ";", 
  RowBox[{"k", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t"}], "]"}], "==", 
     RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<numPeriods\>\"", "->", "k"}], "}"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}], "}"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "2", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.890197273875286*^9, 3.890197294899378*^9}, 
   3.890363394902141*^9, {3.905133153189486*^9, 3.905133178916025*^9}, {
   3.90513321252802*^9, 3.905133212988543*^9}, {3.9051336023048573`*^9, 
   3.9051336024675837`*^9}, {3.90513376046955*^9, 3.905133760692553*^9}, {
   3.90513396234122*^9, 3.905133969820135*^9}, 3.905136381547068*^9, 
   3.906301629006796*^9, {3.909011338457251*^9, 3.9090113384596863`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"68d55122-fe2f-4a46-99eb-1c83ba444ed4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "3"}], ";", 
  RowBox[{"k", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t"}], "]"}], "==", 
     RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "5"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dc", ",", "t", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "5"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "4"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gt", "[", 
      RowBox[{"dd", ",", "t", ",", "2", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "k"}], ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "5"}], "+", "t"}], ",", "2"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "+", "t"}], ",", "2"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "+", "t"}], ",", "2"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "+", "t"}], ",", "2"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], ",", "2"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.8901972418340797`*^9, 3.890197267323588*^9}, 
   3.890363394902462*^9, {3.905133045526786*^9, 3.90513314489176*^9}, {
   3.9051336098492947`*^9, 3.905133614733652*^9}, {3.905133763085433*^9, 
   3.905133763288706*^9}, {3.9051339727076263`*^9, 3.905133977340766*^9}, {
   3.905134225658861*^9, 3.905134236417222*^9}, {3.905134311221683*^9, 
   3.9051343407336597`*^9}, 3.906301629006948*^9, {3.9090113384605017`*^9, 
   3.909011338463125*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"689a6e68-6032-4bf5-938f-ae44feb6f90e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"tests", " ", 
    RowBox[{"g", "[", "timeSeriesVector", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], ",", 
         "h"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
         "k"}], "]"}], "==", 
       RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], ",",
          "h", ",", "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "h", ",", 
         "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8901720531736927`*^9, 3.8901721635258904`*^9}, {
   3.890179904157103*^9, 3.890179924111239*^9}, {3.890180004340312*^9, 
   3.890180028753381*^9}, {3.8901801807801247`*^9, 3.890180246889792*^9}, {
   3.890185045383835*^9, 3.89018507800213*^9}, 3.890185360549662*^9, {
   3.890185418059861*^9, 3.890185418309677*^9}, {3.890195419832499*^9, 
   3.8901954226019363`*^9}, {3.890195490048667*^9, 3.8901954913676*^9}, {
   3.8901960604641733`*^9, 3.890196060465534*^9}, 3.890363394902726*^9, {
   3.890404606481097*^9, 3.890404612989439*^9}, {3.890406202847101*^9, 
   3.890406203168273*^9}, {3.890406271250958*^9, 3.890406276098238*^9}, {
   3.905133022573615*^9, 3.90513304065716*^9}, {3.9051336267053432`*^9, 
   3.9051336302967577`*^9}, {3.9051337663589363`*^9, 
   3.9051337665614767`*^9}, {3.905133983700873*^9, 3.905133988085473*^9}, 
   3.9063016290070887`*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"349ed783-a7ab-475d-9439-b06befe63255"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "return", " ", "unevaluated"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "wrong", " ", "length", " ", "for", " ", "first", " ", "argument", " ", 
    "of", " ", "g"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t"}], "]"}], ",", "h"}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dc", "[", "t", "]"}], "}"}], ",", "3"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "h"}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "1", ",", "k"}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "1", ",", "1"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
              RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "h", ",", "k"}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3", ",", 
         "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "h", ",", "k"}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3", ",", 
         "1"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890190589143209*^9, 3.890190638588849*^9}, {
   3.890196060471004*^9, 3.890196060472418*^9}, 3.890363394903002*^9, {
   3.890406292664609*^9, 3.890406389608964*^9}, {3.905132987358062*^9, 
   3.9051330151743717`*^9}, {3.905133634095339*^9, 3.905133634395752*^9}, {
   3.90513376903858*^9, 3.905133769224579*^9}, {3.905133992293367*^9, 
   3.905133996652595*^9}, 3.906301629007207*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"678a39b3-e601-4bf7-ac16-5a33ef960d6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "TimeAggregation", " ", "aggregation", " ", "and", " ", "numPeriods", " ", 
    "for", " ", "flow", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], ",", "h", 
         ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Flow\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
         "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Flow\>\""}]}], "]"}], "==", 
       RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], ",",
          "h", ",", "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Flow\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "h", ",", 
         "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Flow\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "t"}], "]"}]}]]}], "]"}], "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dc", "[", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
            RowBox[{"dc", "[", "t", "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dc", "[", "t", "]"}]}]]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890190302026493*^9, 3.890190316677984*^9}, {
   3.890190372940201*^9, 3.890190378010035*^9}, {3.890190417141127*^9, 
   3.89019041796427*^9}, {3.8901960604780188`*^9, 3.890196060479423*^9}, 
   3.890363394903254*^9, 3.8904063618869658`*^9, {3.890406395154607*^9, 
   3.890406427363122*^9}, {3.905132967599986*^9, 3.905132982756688*^9}, {
   3.905133637665764*^9, 3.905133637899835*^9}, {3.905133772230812*^9, 
   3.905133772460923*^9}, {3.9051340040771027`*^9, 3.905134007157502*^9}, 
   3.906301629007352*^9, {3.909011371048655*^9, 3.909011371050975*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"51e4d03d-b791-4125-8659-77c4bfa1681f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "TimeAggregation", " ", "aggregation", " ", "and", " ", "numPeriods", " ", 
    "for", " ", "stock", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], ",", "h", 
         ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
         "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], ",",
          "h", ",", "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "h", ",", 
         "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
        RowBox[{"dc", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890190425865121*^9, 3.890190431513938*^9}, {
   3.890196060485079*^9, 3.890196060486471*^9}, 3.8903633949035063`*^9, {
   3.890406429507084*^9, 3.890406451889192*^9}, {3.905132946959127*^9, 
   3.905132962788682*^9}, {3.905133640520669*^9, 3.905133640699399*^9}, {
   3.905133774702096*^9, 3.905133774864623*^9}, {3.9051340130206842`*^9, 
   3.905134015516468*^9}, 3.906301629007449*^9, {3.909011338466576*^9, 
   3.909011338468053*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"734916cf-dfbe-4883-8dd9-11fa3e75b66e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"h", "=", "3"}], ";", 
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{"timeSeriesVector", "[", 
        RowBox[{"dc", ",", "t"}], "]"}], ",", "1", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"timeSeriesVector", "[", 
         RowBox[{"dc", ",", "t", ",", 
          RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"h", "*", "k"}]}], "]"}], "]"}], ",", "h", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{"timeSeriesVector", "[", 
        RowBox[{"dc", ",", "t", ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
       "k", ",", " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{"dc", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"timeSeriesVector", "[", 
         RowBox[{"dc", ",", "t", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], "[", 
        
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"h", "*", "k"}]}], "]"}], "]"}], ",", "h", ",", "k", ",", 
       " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"timeSeriesVector", "[", 
         RowBox[{"dc", ",", "t", ",", 
          RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"h", "*", "k"}]}], "]"}], "]"}], ",", "h", ",", "k", ",", 
       " ", 
       RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
     RowBox[{
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "t"}], "]"}], "+", 
      RowBox[{"dc", "[", "t", "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.890190462731379*^9, 3.890190476979701*^9}, {
   3.890190516041791*^9, 3.8901905382493*^9}, {3.890196060492339*^9, 
   3.890196060493836*^9}, 3.890363394903771*^9, {3.89059187204002*^9, 
   3.8905918723175907`*^9}, {3.90513292213623*^9, 3.905132941170207*^9}, {
   3.9051336429697847`*^9, 3.905133643174705*^9}, {3.905133777326174*^9, 
   3.905133777488515*^9}, {3.9051340189323597`*^9, 3.905134022068589*^9}, 
   3.906301629007551*^9, {3.9090113384703093`*^9, 3.909011338472241*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"702c0af1-4d05-4d41-96de-47a6c79b2a77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"should", " ", "return", " ", "unevaluated"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dc", ",", "t"}], "]"}], ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"dc", "[", "t", "]"}], "}"}], ",", 
         RowBox[{"\"\<Variable\>\"", "\[Rule]", "\"\<Stock\>\""}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"h", "*", "k"}], "+", "1"}]}], "]"}], "]"}], ",", "h", 
         ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3", ",", 
         RowBox[{"\"\<Variable\>\"", "\[Rule]", "\"\<Stock\>\""}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
              RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"h", "*", "k"}], "+", "1"}]}], "]"}], "]"}], ",", "h", 
         ",", "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3", ",", 
         "1", ",", 
         RowBox[{"\"\<Variable\>\"", "\[Rule]", "\"\<Stock\>\""}]}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"timeSeriesVector", "[", 
           RowBox[{"dc", ",", "t", ",", 
            RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
            RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"h", "*", "k"}], "+", "1"}]}], "]"}], "]"}], ",", "h", 
         ",", "k", ",", " ", 
         RowBox[{"\"\<Variable\>\"", "->", "\"\<Stock\>\""}]}], "]"}], "==", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`g", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
           RowBox[{"dc", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "t"}], "]"}]}], "}"}], ",", "3", ",", 
         "1", ",", 
         RowBox[{"\"\<Variable\>\"", "\[Rule]", "\"\<Stock\>\""}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.890190551568864*^9, 3.890190569801456*^9}, {
   3.8901960605035553`*^9, 3.890196060505065*^9}, 3.890363394904015*^9, {
   3.890406448912299*^9, 3.89040644913935*^9}, {3.9051328943255177`*^9, 
   3.905132916682325*^9}, {3.905133646506585*^9, 3.905133646716509*^9}, {
   3.905133779789558*^9, 3.905133779939404*^9}, {3.905134025189911*^9, 
   3.905134028245502*^9}, 3.9063016290076847`*^9, {3.909011338474677*^9, 
   3.909011338476294*^9}, {3.909011427440571*^9, 3.9090114274423227`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"f420e2f4-bce3-4a0e-8405-832bb5c79f18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "optional", " ", "values", " ", "in", " ", "lists", " ", "or", " ", "as", 
    " ", "separate", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dd", ",", "t", ",", "i"}], "]"}], ",", "1"}], "]"}], "==", 
       
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dd", ",", "t", ",", "i", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], ",", 
         "h"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dd", ",", "t", ",", "i", ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
         "k"}], "]"}], "==", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dd", ",", "t", ",", "i", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], ",",
          "h", ",", "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"dd", ",", "t", ",", "i", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "h", ",", 
         "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}]}], "-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}]]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8901720531736927`*^9, 3.8901721635258904`*^9}, {
   3.890179904157103*^9, 3.890179924111239*^9}, {3.890180004340312*^9, 
   3.890180028753381*^9}, {3.8901801807801247`*^9, 3.890180246889792*^9}, {
   3.890185045383835*^9, 3.890185047656562*^9}, {3.8901850872725763`*^9, 
   3.890185113017942*^9}, {3.890196060514386*^9, 3.890196060515778*^9}, 
   3.890363394904229*^9, {3.890406478649135*^9, 3.89040649121669*^9}, {
   3.8905918849071083`*^9, 3.890591885001882*^9}, {3.905132845663828*^9, 
   3.905132862891549*^9}, {3.905133649698393*^9, 3.905133649878684*^9}, {
   3.9051337821356907`*^9, 3.905133782273745*^9}, {3.905134031173457*^9, 
   3.905134034538186*^9}, 3.9063016290078373`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"65f3b784-cca1-40d5-878f-0a705ef3a602"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"bond", " ", "returns"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", "3"}], ";", 
    RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"bondret", ",", "t", ",", "m", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}]}], "]"}], ",", 
         "h"}], "]"}], "==", 
       RowBox[{
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"bondret", ",", "t", ",", "m", ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "1", ",", 
         "k"}], "]"}], "==", 
       RowBox[{"bondret", "[", 
        RowBox[{"t", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"bondret", ",", "t", ",", "m", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
             RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "}"}]}], "]"}], ",",
          "h", ",", "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{
         RowBox[{"timeSeriesVector", "[", 
          RowBox[{"bondret", ",", "t", ",", "m", ",", 
           RowBox[{"\"\<TimeAggregation\>\"", "->", "h"}], ",", 
           RowBox[{"\"\<numPeriods\>\"", "->", "k"}]}], "]"}], ",", "h", ",", 
         "k"}], "]"}], "==", 
       RowBox[{
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}], "+", 
        RowBox[{"bondret", "[", 
         RowBox[{"t", ",", "m"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], "+", "t"}], ",", "m"}], "]"}]}]]}], "]"}], 
        "+", 
        RowBox[{"Log", "[", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"bondret", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", "t"}], ",", "m"}], "]"}]}], "-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{"bondret", "[", 
             RowBox[{"t", ",", "m"}], "]"}]}]]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8901720531736927`*^9, 3.8901721635258904`*^9}, {
   3.890179904157103*^9, 3.890179924111239*^9}, {3.890180004340312*^9, 
   3.890180028753381*^9}, {3.8901801807801247`*^9, 3.890180246889792*^9}, {
   3.890185045383835*^9, 3.890185047656562*^9}, {3.890196060521418*^9, 
   3.8901960605227633`*^9}, 3.8903633949044743`*^9, {3.890406502744421*^9, 
   3.890406515178454*^9}, {3.9051328249518757`*^9, 3.905132841145595*^9}, {
   3.9051336527838793`*^9, 3.9051336530510674`*^9}, {3.905133785270789*^9, 
   3.905133785433055*^9}, {3.9051340375494432`*^9, 3.905134038588225*^9}, 
   3.905134361793556*^9, {3.9051344428486643`*^9, 3.905134443010805*^9}, 
   3.905136393547915*^9, 3.9063016290079823`*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"6669e5cf-b62b-4fa1-a421-89169441729e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"tests", " ", "timeSeriesVector"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "t"}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"dc", "[", "t", "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "t", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "6"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "t", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "}"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "t", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "t", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "t", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890171068020504*^9, 3.8901710810264053`*^9}, {
   3.890171371499096*^9, 3.8901714119542933`*^9}, {3.8901714813721037`*^9, 
   3.890171498297214*^9}, {3.890171555073202*^9, 3.890171561776828*^9}, {
   3.890171766081479*^9, 3.890171783357297*^9}, {3.8901718642454357`*^9, 
   3.8901718665105333`*^9}, 3.890171945514958*^9, {3.8901960605278063`*^9, 
   3.8901960605290613`*^9}, 3.890363394904688*^9, {3.9051328004639463`*^9, 
   3.905132820641307*^9}, {3.905133655512431*^9, 3.90513365574645*^9}, {
   3.9051337878630733`*^9, 3.9051337880337763`*^9}, {3.905134042347932*^9, 
   3.905134046052977*^9}, 3.906301629008204*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"c793e294-fcce-4f4b-9d1a-7602938e1e2c"],

Cell[BoxData[
 RowBox[{"And", "@@", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "i"}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "6"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "}"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], ",", "i"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "i", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], ",", "i"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "1"}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "1"}], "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "6"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "1"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
         RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "}"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], ",", "1"}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timeSeriesVector", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "]"}], "==", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "10"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "11"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "12"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "13"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "14"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "15"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "16"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "17"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "18"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "19"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "20"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "21"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "22"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "23"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "24"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "25"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "26"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "27"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "28"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "29"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "30"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "31"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "32"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "33"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "34"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "35"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "36"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "37"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "38"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "39"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "40"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "41"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "42"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "43"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "44"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "45"}], "+", "t"}], ",", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "46"}], "+", "t"}], ",", "1"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.89017195607129*^9, 3.890171988932729*^9}, {
   3.8901960605356627`*^9, 3.890196060539205*^9}, 3.890363394904916*^9, {
   3.905132708216536*^9, 3.905132793515432*^9}, {3.905133659812319*^9, 
   3.905133660049605*^9}, {3.9051337947606697`*^9, 3.905133794930244*^9}, {
   3.905134050703233*^9, 3.9051340661815557`*^9}, 3.906301629008665*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"15766eac-046f-4351-9e5f-f1f1050fde05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"tests", " ", 
     RowBox[{"numberQ", "[", "t", "]"}]}], "\[Implies]", 
    RowBox[{"t", ">=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"should", " ", "return", " ", "evaluated"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "0"}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"dc", "[", "0", "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "0", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "0", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "1"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "2"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "3"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "4"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "1"}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"dc", "[", "1", "]"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "3", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "3", "]"}], ",", 
        RowBox[{"dc", "[", "2", "]"}], ",", 
        RowBox[{"dc", "[", "1", "]"}], ",", 
        RowBox[{"dc", "[", "0", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "1"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "3", ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "6"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "3", "]"}], ",", 
        RowBox[{"dc", "[", "2", "]"}], ",", 
        RowBox[{"dc", "[", "1", "]"}], ",", 
        RowBox[{"dc", "[", "0", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "1"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "2"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "}"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "1", "]"}], ",", 
        RowBox[{"dc", "[", "0", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "1"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "2"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "3"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "4"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "5"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "6"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "7"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "8"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "9"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "10"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "11"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "12"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "13"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "14"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "15"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "16"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "17"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "18"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "19"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "20"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "21"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "22"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "23"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "24"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "25"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "26"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "27"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "28"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "29"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "30"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "31"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "32"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "33"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "34"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "35"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "36"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "37"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "38"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "39"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "40"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "41"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "42"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "43"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "44"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{"-", "45"}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", 
        RowBox[{"m", "-", "2"}], ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "6"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "7"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "8"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "9"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "10"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "11"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "12"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "13"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "14"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "15"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "16"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "17"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "18"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "19"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "20"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "21"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "22"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "23"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "24"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "25"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "26"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "27"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "28"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "29"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "30"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "31"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "32"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "33"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "34"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "35"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "36"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "37"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "38"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "39"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "40"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "41"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "42"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "43"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "44"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "45"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "46"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "47"}], "+", "m"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "48"}], "+", "m"}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", "Pi", ",", 
        RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dc", "[", "\[Pi]", "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "4"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "5"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "6"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "7"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "8"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "9"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "10"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "11"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "12"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "13"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "14"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "15"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "16"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "17"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "18"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "19"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "20"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "21"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "22"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "23"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "24"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "25"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "26"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "27"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "28"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "29"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "30"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "31"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "32"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "33"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "34"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "35"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "36"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "37"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "38"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "39"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "40"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "41"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "42"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "43"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "44"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "45"}], "+", "\[Pi]"}], "]"}], ",", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "46"}], "+", "\[Pi]"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8904065478873653`*^9, 3.890406570751514*^9}, {
   3.890406601009001*^9, 3.890406617574583*^9}, {3.890406652426482*^9, 
   3.890406705533577*^9}, {3.9051326511394997`*^9, 3.905132697501327*^9}, {
   3.905133672378325*^9, 3.9051336726310463`*^9}, {3.905133799327797*^9, 
   3.905133799471146*^9}, {3.9051340733095007`*^9, 3.9051340785329533`*^9}, 
   3.905134464124179*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"bacf6274-9611-4720-b4c5-d348d711f3e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"tests", " ", 
     RowBox[{"numberQ", "[", "t", "]"}]}], "\[Implies]", 
    RowBox[{"t", ">=", 
     RowBox[{"0", " ", "should", " ", "return", " ", "unevaluated"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "->", "6"}]}], "]"}], "==", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`\
timeSeriesVector", "[", 
       RowBox[{"dc", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"\"\<numPeriods\>\"", "\[Rule]", "6"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"timeSeriesVector", "[", 
       RowBox[{"dc", ",", 
        RowBox[{"-", "4"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<TimeAggregation\>\"", "->", "12"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "->", "3"}]}], "}"}]}], "]"}], "==", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Tools`TimeAggregation`Private`\
timeSeriesVector", "[", 
       RowBox[{"dc", ",", 
        RowBox[{"-", "4"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<TimeAggregation\>\"", "\[Rule]", "12"}], ",", 
          RowBox[{"\"\<numPeriods\>\"", "\[Rule]", "3"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.890406628410715*^9, 3.890406709283149*^9}, 
   3.890591916700327*^9, {3.905132634729501*^9, 3.9051326425770187`*^9}, {
   3.905133676863701*^9, 3.905133677161736*^9}, {3.90513380199774*^9, 
   3.9051338021764917`*^9}, 3.905134083947012*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"53fec7a5-f7fc-43c3-9da7-a28225e3d93a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToNumber", "Section",
 CellChangeTimes->{
  3.906296883734589*^9, {3.906301621242672*^9, 
   3.906301629008725*^9}},ExpressionUUID->"ceab56be-f97e-4ecb-b7f0-\
b407b2cbf947"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.890031566462019*^9, 3.890031568811056*^9}, 
   3.891753377415228*^9, {3.906301621242897*^9, 3.906301629008761*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"96f5f62c-b8d4-45ac-af0e-8025fbadeda5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.906301621243005*^9, 3.9063016290087976`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6d4b1699-144d-4208-a0cd-a3471905027e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891257888860939*^9, 3.8912578891768503`*^9}, 
   3.905170973360199*^9, 3.906297270586113*^9, 3.906297482145802*^9, {
   3.90630162124314*^9, 3.906301629008843*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"00c0f14f-18cc-4515-8f0c-81c0aa91f74f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}], ",", 
      "\"\<Kernel\>\"", ",", "\"\<Tools\>\"", ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`Tools`\>\"", "<>", "testName", "<>", 
     "\"\<`\>\""}], ",", "packageFileName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", " ", "=", " ", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Prepend", "[", 
     RowBox[{
     "$ContextPath", ",", 
      "\"\<FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\>\""}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.890825576987958*^9, {
   3.890987450098063*^9, 3.8909874502616673`*^9}, {3.891159388110983*^9, 
   3.891159388420541*^9}, {3.891159688056053*^9, 3.891159704172017*^9}, {
   3.891748927421254*^9, 3.8917489278823643`*^9}, {3.891749223961915*^9, 
   3.891749231277231*^9}, {3.891749519456523*^9, 3.891749519771348*^9}, {
   3.90515611186259*^9, 3.905156112130745*^9}, {3.90517426920163*^9, 
   3.905174278720889*^9}, {3.905177231954484*^9, 3.905177238052713*^9}, 
   3.905178173189879*^9, {3.906297271393265*^9, 3.906297272123796*^9}, {
   3.9062974860478373`*^9, 3.906297488825288*^9}, {3.90630162124328*^9, 
   3.906301629008889*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"65cf6e79-9ee8-4100-bf55-e65cbbf1ec77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk\>\"", ",", "\"\<Models.wl\>\""}], "}"}],
      "]"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBKY", "=", 
   RowBox[{"msp", "[", "\"\<BKY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRCStochVol", "=", 
   RowBox[{"msp", "[", "\"\<NRCStochVol\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mods", "=", 
   RowBox[{"{", 
    RowBox[{
    "modBY", ",", "modBKY", ",", "modNRC", ",", "modDES", ",", 
     "modNRCStochVol"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.905156041870823*^9, 3.905156053614505*^9}, {
   3.905156126678938*^9, 3.90515613250208*^9}, 3.9051568191108217`*^9, {
   3.905650879468988*^9, 3.905650887083211*^9}, 3.9056579671674843`*^9, {
   3.906301621243434*^9, 3.9063016290089397`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"1554e485-55db-4e2a-83a5-d4f1856c4d15"],

Cell[BoxData[
 RowBox[{"(*", "toNum", "*)"}]], "Input",
 CellChangeTimes->{
  3.905595629075601*^9, {3.906301621243535*^9, 3.906301629008972*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"fd265de4-bf65-49e6-8791-435f1837204d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Needs", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Needs", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeConditionalExpectations`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<FernandoDuarte`LongRunRisk`Tools`TimeAggregation`\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Needs", "[", 
    "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`SolveEulerEq`\>\"", 
    "]"}], ";"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "expressions", " ", "to", " ", "test"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expr", "[", 
    RowBox[{"t_", ",", "m_", ",", "i_", ",", "mu_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"wc", "[", "t", "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], ",", 
     RowBox[{"bond", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nombond", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"bondexcret", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"bondfw", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"bondfwspread", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"bondret", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"bondyield", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"excretc", "[", "t", "]"}], ",", 
     RowBox[{"excret", "[", 
      RowBox[{"t", ",", "i"}], "]"}], ",", 
     RowBox[{"kappa0", "[", "mu", "]"}], ",", 
     RowBox[{"kappa1", "[", "mu", "]"}], ",", 
     RowBox[{"nombondexcret", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nombondfw", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nombondfwspread", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nombondret", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nombondyield", "[", 
      RowBox[{"t", ",", "m"}], "]"}], ",", 
     RowBox[{"nomrf", "[", "t", "]"}], ",", 
     RowBox[{"nomsdf", "[", "t", "]"}], ",", 
     RowBox[{"retc", "[", "t", "]"}], ",", 
     RowBox[{"ret", "[", 
      RowBox[{"t", ",", "i"}], "]"}], ",", 
     RowBox[{"rf", "[", "t", "]"}], ",", 
     RowBox[{"sdf", "[", "t", "]"}], ",", 
     RowBox[{"pi", "[", "t", "]"}], ",", 
     RowBox[{"dc", "[", "t", "]"}], ",", 
     RowBox[{"growth", "[", 
      RowBox[{"dc", ",", "t", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "2"}], ",", 
       RowBox[{"\"\<numPeriods\>\"", "->", "1"}]}], "]"}], ",", 
     RowBox[{"growth", "[", 
      RowBox[{"dd", ",", "t", ",", "1", ",", 
       RowBox[{"\"\<TimeAggregation\>\"", "->", "2"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AA", " ", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "+", "1"}], "]"}], 
      RowBox[{"excret", "[", 
       RowBox[{"t", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"AA", " ", 
       RowBox[{"excret", "[", 
        RowBox[{"t", ",", "1"}], "]"}]}], "+", 
      RowBox[{"BB", " ", 
       RowBox[{"nombondyield", "[", 
        RowBox[{"t", ",", "2"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ee", "=", 
   RowBox[{"expr", "[", 
    RowBox[{"t", ",", "3", ",", "1", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e1", "=", 
    RowBox[{"ee", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
   "define", " ", "expression", " ", "e2", " ", "and", " ", "list", " ", 
    "opts", " ", "to", " ", "test", " ", "options"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", 
   RowBox[{"ee", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optsList", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"maxMaturity", "->", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<FindRootOptions\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"MaxIterations", "->", "100"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"MaxIterations", "->", "100"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Ewc\>\"", "->", 
          RowBox[{"{", "4", "}"}]}], ",", 
         RowBox[{"\"\<Epd\>\"", "->", 
          RowBox[{"{", 
           RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"MaxIterations", "->", "100"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"\"\<FindRootOptions\>\"", "->", 
        RowBox[{"{", 
         RowBox[{"MaxIterations", "->", "100"}], "}"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxMaturity", "->", "6"}], ",", 
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"MaxIterations", "->", "100"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "True"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
       RowBox[{"\"\<Tol\>\"", "->", "1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CheckResiduals\>\"", "->", "True"}], ",", 
       RowBox[{"\"\<Tol\>\"", "->", 
        RowBox[{"10.", "^", 
         RowBox[{"-", "20"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<PrintResidualsNorm\>\"", "->", "True"}], ",", 
       RowBox[{"maxMaturity", "->", "6"}], ",", 
       RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Ewc\>\"", "->", 
           RowBox[{"{", "4", "}"}]}], ",", 
          RowBox[{"\"\<Epd\>\"", "->", 
           RowBox[{"{", 
            RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], ",", 
       RowBox[{"MaxIterations", "->", "100"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<RecurrenceTableOptions\>\"", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<DependentVariables\>\"", "->", "Automatic"}], "}"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"DependentVariables", "->", "Automatic"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opts", "=", 
    RowBox[{"optsList", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "5"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"define", " ", "list", " ", "of", " ", "parameters"}], ",", " ", 
    "guess", ",", " ", "options", ",", " ", "expr", ",", " ", 
    RowBox[{
    "to", " ", "test", " ", "passing", " ", "new", " ", "parameters"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newParameters", "=", 
   RowBox[{"{", 
    RowBox[{"delta", "->", "0.99"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"guessCoeffsSolution", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "[", "0", "]"}], "\[Rule]", "4.6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"optNewParam", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<initialGuess\>\"", " ", "->", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Ewc\>\"", "->", 
         RowBox[{"{", "4", "}"}]}], ",", 
        RowBox[{"\"\<Epd\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"{", "4", "}"}], "}"}]}]}], "|>"}]}], ",", 
     RowBox[{"MaxIterations", "->", "100"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exprNewParam", " ", "=", " ", 
   RowBox[{"uncondE", "[", 
    RowBox[{"wc", "[", "t", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9052210457193117`*^9, 3.905221047999649*^9}, {
   3.905595785602545*^9, 3.90559579805087*^9}, {3.9055964001662703`*^9, 
   3.905596406363723*^9}, {3.905648341848996*^9, 3.9056483517439127`*^9}, 
   3.90565057211031*^9, {3.905650667703216*^9, 3.905650726293214*^9}, 
   3.905651033999597*^9, 3.905651469221281*^9, 3.905651925951015*^9, {
   3.905651962916114*^9, 3.905651970624977*^9}, {3.905674874479257*^9, 
   3.905674884855*^9}, {3.905676366461906*^9, 3.905676413740609*^9}, {
   3.905676893939445*^9, 3.905676901171914*^9}, {3.906301621244088*^9, 
   3.9063016290091457`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"cf2ad01f-550b-409d-94f8-77bcda42031c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AbortProtect", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"counter", " ", "for", " ", "Do", " ", "loop"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ind", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "rules", " ", "to", " ", "evaluate", " ", "numerically", " ", "at", 
         " ", "arbitrarily", " ", "chosen", " ", "values"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"stateVars", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "_", "]"}], "&"}], "/@", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Variables", "[", 
               RowBox[{
                RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", 
                "]"}], " ", "]"}], ",", 
              RowBox[{
               RowBox[{"x_", "[", "_", "]"}], ":>", "x"}]}], "]"}], ",", 
            "0"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numModel", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"stateVars", "->", "1."}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "_", "]"}], 
              "[", "_", "]"}], "->", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "_", "]"}], 
              "[", 
              RowBox[{"_", ",", "_"}], "]"}], "->", "1."}], ",", 
            RowBox[{"mu", "->", "2."}], ",", 
            RowBox[{"AA", "->", 
             RowBox[{"-", "1."}]}], ",", 
            RowBox[{"BB", "->", "3."}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**"}], "*", "toNum"}], "**********)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"toNum", "[", "model", "]"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tn", "=", 
        RowBox[{"toNum", "[", "model", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outTests", "[", 
          RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind",
          "]"}], "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"NumericQ", "/@", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"e1", "//", "tn"}], ")"}], "//.", "numModel"}], 
                   ")"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uncondE", "/@", "e1"}], ")"}], "//", "tn"}], 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uncondVar", "/@", "e1"}], ")"}], "//", "tn"}], 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], "//", 
                    "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], "//",
                     "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ")"}], "//", "tn"}], ")"}], "//.", "numModel"}], ")"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ")"}], "//", "tn"}], ")"}], "//.", "numModel"}], ")"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], "//", 
                    "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], "//",
                     "tn"}], ")"}], "//.", "numModel"}], ")"}]}], 
                 "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"toNum", "[", 
         RowBox[{"expression", ",", " ", "model"}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outTests", "[", 
          RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind",
          "]"}], "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"NumericQ", "/@", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{"e1", ",", "model"}], "]"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"uncondE", "/@", "e1"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"uncondVar", "/@", "e1"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], " ", 
                    ",", "model"}], "]"}], ")"}], "//.", "numModel"}], ")"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], ",", 
                    "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], 
                   ")"}]}], "\[IndentingNewLine]", "}"}]}], 
               "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
            "}"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"toNum", "[", 
         RowBox[{"\"\<Rules\>\"", ",", " ", "model"}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outTests", "[", 
          RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind",
          "]"}], "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"NumericQ", "/@", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{"e1", ",", "model"}], "]"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"uncondE", "/@", "e1"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"uncondVar", "/@", "e1"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], " ", 
                    ",", "model"}], "]"}], ")"}], "//.", "numModel"}], ")"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e1"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", 
                    RowBox[{"Reverse", "@", "e1"}]}], "}"}]}], "]"}], ",", 
                    "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], 
                    ")"}]}], "\[IndentingNewLine]", "}"}]}], "//.", 
                RowBox[{"toNum", "[", 
                 RowBox[{"\"\<Rules\>\"", ",", "model"}], "]"}]}], 
               "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
            "}"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", "**", "**", "**"}], "*", "options", " ", "for", " ", 
         "toNum"}], "**********)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"toNum", "[", "model", "]"}], "*)"}], "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"tn", "=", 
           RowBox[{"toNum", "[", 
            RowBox[{"model", ",", 
             RowBox[{"Sequence", "@@", "opt"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"outTests", "[", 
             RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
            "ind", "]"}], "=", 
           RowBox[{"And", "@@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"NumericQ", "/@", 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"e2", "//", "tn"}], ")"}], "//.", "numModel"}], 
                    ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uncondE", "/@", "e2"}], ")"}], "//", "tn"}], 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"uncondVar", "/@", "e2"}], ")"}], "//", "tn"}], 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], "//", 
                    "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], "//",
                     "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ")"}], "//", "tn"}], ")"}], "//.", "numModel"}], ")"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ")"}], "//", "tn"}], ")"}], "//.", "numModel"}], ")"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], "//", 
                    "tn"}], ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], "//",
                     "tn"}], ")"}], "//.", "numModel"}], ")"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                  ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
             "\[IndentingNewLine]", ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ind", "=", 
           RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"toNum", "[", 
            RowBox[{"expression", ",", " ", "model"}], "]"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"outTests", "[", 
             RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
            "ind", "]"}], "=", 
           RowBox[{"And", "@@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"NumericQ", "/@", 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{"e2", ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], " ", ")"}], "//.",
                     "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"uncondE", "/@", "e2"}], ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], ")"}], " ", 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"uncondVar", "/@", "e2"}], ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], ")"}], " ", 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], " ", 
                    ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], " ", ")"}], "//.",
                     "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], ")"}], " ", 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], ")"}], " ", 
                    ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], ",", 
                    "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], " ", ")"}], "//.",
                     "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toNum", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}], " ", ")"}], "//.",
                     "numModel"}], ")"}]}], "\[IndentingNewLine]", "}"}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               "}"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ind", "=", 
           RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"toNum", "[", 
            RowBox[{"\"\<Rules\>\"", ",", " ", "model"}], "]"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"outTests", "[", 
             RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
            "ind", "]"}], "=", 
           RowBox[{"And", "@@", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "@", "tn"}], "===", "Function"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"NumericQ", "/@", 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{"e2", ",", "model"}], "]"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"uncondE", "/@", "e2"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"uncondVar", "/@", "e2"}], ",", "model"}], "]"}], 
                    ")"}], " ", ")"}], "//.", "numModel"}], ")"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCov", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], " ", 
                    ",", "model"}], "]"}], ")"}], "//.", "numModel"}], ")"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"uncondCorr", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ev", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"var", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], "/@", "e2"}], 
                    ",", "model"}], "]"}], ")"}], " ", ")"}], "//.", 
                    "numModel"}], ")"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cov", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"e2", ",", 
                    RowBox[{"Reverse", "@", "e2"}]}], "}"}]}], "]"}], ",", 
                    "model"}], "]"}], " ", ")"}], "//.", "numModel"}], ")"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"toEquation", "[", 
                    RowBox[{
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"corr", "[", 
                    RowBox[{"#1", ",", "#2", ",", 
                    RowBox[{"t", "-", "1"}]}], "]"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"e2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
                     "model"}], "]"}], " ", ")"}], "//.", "numModel"}], 
                    ")"}]}], "\[IndentingNewLine]", "}"}]}], "//.", 
                   RowBox[{"toNum", "[", 
                    RowBox[{"\"\<Rules\>\"", ",", "model", ",", 
                    RowBox[{"Sequence", "@@", "opt"}]}], "]"}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               "}"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ind", "=", 
           RowBox[{"ind", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"opt", ",", "opts"}], "}"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "\"\<UpdatePd\>\"", ",", " ", "\"\<UpdateBond\>\"", ",", " ", 
         "\"\<UpdateNomBond\>\"", ",", " ", 
         RowBox[{"\"\<UpdateBonds\>\"", " ", "are", " ", "ignored"}], ",", 
         " ", 
         RowBox[{
          RowBox[{
          "toNum", " ", "always", " ", "uses", " ", "\"\<UpdatePd\>\""}], "->",
           "True"}], ",", 
         RowBox[{"\"\<UpdateBonds\>\"", "->", "True"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outTests", "[", 
          RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind",
          "]"}], "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"NumericQ", "/@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"pd", "[", 
                 RowBox[{"t", ",", "1"}], "]"}], "//", 
                RowBox[{
                 RowBox[{"toNum", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<UpdatePd\>\"", "->", "False"}]}], "]"}], "//.",
                  "numModel"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"toNum", "[", 
                 RowBox[{
                  RowBox[{"pd", "[", 
                   RowBox[{"t", ",", "1"}], "]"}], ",", "model", ",", 
                  RowBox[{"\"\<UpdatePd\>\"", "->", "False"}]}], "]"}], "//.",
                 "numModel"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"toEquation", "[", 
                  RowBox[{
                   RowBox[{"pd", "[", 
                    RowBox[{"t", ",", "1"}], "]"}], ",", "model"}], "]"}], "//.", 
                 RowBox[{"toNum", "[", 
                  RowBox[{"\"\<Rules\>\"", ",", "model", ",", 
                   RowBox[{"\"\<UpdatePd\>\"", "->", "False"}]}], "]"}]}], "//.",
                 "numModel"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"bondyield", "[", 
                   RowBox[{"t", ",", "2"}], "]"}], ",", 
                  RowBox[{"nombondyield", "[", 
                   RowBox[{"t", ",", "3"}], "]"}]}], "}"}], "//", 
                RowBox[{
                 RowBox[{"toNum", "[", 
                  RowBox[{"model", ",", 
                   RowBox[{"\"\<UpdateBonds\>\"", "->", "False"}]}], "]"}], "//.",
                  "numModel"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"toNum", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"bondyield", "[", 
                    RowBox[{"t", ",", "2"}], "]"}], ",", 
                    RowBox[{"nombondyield", "[", 
                    RowBox[{"t", ",", "3"}], "]"}]}], "}"}], ",", "model", 
                  ",", 
                  RowBox[{"\"\<UpdateBonds\>\"", "->", "False"}]}], "]"}], "//.",
                 "numModel"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"toEquation", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"bondyield", "[", 
                    RowBox[{"t", ",", "2"}], "]"}], ",", 
                    RowBox[{"nombondyield", "[", 
                    RowBox[{"t", ",", "3"}], "]"}]}], "}"}], ",", "model"}], 
                  "]"}], "//.", 
                 RowBox[{"toNum", "[", 
                  RowBox[{"\"\<Rules\>\"", ",", "model", ",", 
                   RowBox[{"\"\<UpdateBonds\>\"", "->", "False"}]}], "]"}]}], 
                "//.", "numModel"}]}], "\[IndentingNewLine]", "}"}]}], 
            "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"**", "**", "**", "**"}], "*", "new", " ", "parameters"}], 
         ",", " ", 
         RowBox[{"guess", " ", "for", " ", "toNum"}]}], "**********)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"outTests", "[", 
          RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind",
          "]"}], "=", 
        RowBox[{"And", "@@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"NumericQ", "/@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"pass", " ", "new", " ", "parameters"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{"model", ",", "newParameters"}], "]"}], "//.", 
               "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{"exprNewParam", ",", "model", ",", "newParameters"}], 
               "]"}], "//.", "numModel"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{"\"\<Rules\>\"", ",", "model", ",", "newParameters"}],
                 "]"}]}], "//.", "numModel"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"pass", " ", "guess"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"{", "}"}], ",", "guessCoeffsSolution"}], "]"}], "//.",
                "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{"exprNewParam", ",", "model", ",", 
                RowBox[{"{", "}"}], ",", "guessCoeffsSolution"}], "]"}], "//.",
               "numModel"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{"\"\<Rules\>\"", ",", "model", ",", 
                 RowBox[{"{", "}"}], ",", "guessCoeffsSolution"}], "]"}]}], "//.",
               "numModel"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "pass", " ", "new", " ", "parameters", " ", "and", " ", 
               "guess"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{
                "model", ",", "newParameters", ",", "guessCoeffsSolution"}], 
                "]"}], "//.", "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{
               "exprNewParam", ",", "model", ",", "newParameters", ",", 
                "guessCoeffsSolution"}], "]"}], "//.", "numModel"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{
                "\"\<Rules\>\"", ",", "model", ",", "newParameters", ",", 
                 "guessCoeffsSolution"}], "]"}]}], "//.", "numModel"}], ",", 
             "\n", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"new", " ", "parameters"}], ",", " ", "guess", ",", 
               " ", 
               RowBox[{"and", " ", "options"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{"model", ",", "newParameters", ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
               "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{
               "exprNewParam", ",", "model", ",", "newParameters", ",", 
                RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
              "numModel"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{
                "\"\<Rules\>\"", ",", "model", ",", "newParameters", ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}]}], "//.", 
              "numModel"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{"model", ",", 
                 RowBox[{"{", "}"}], ",", "guessCoeffsSolution", ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
               "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{"exprNewParam", ",", "model", ",", 
                RowBox[{"{", "}"}], ",", "guessCoeffsSolution", ",", 
                RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
              "numModel"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{"\"\<Rules\>\"", ",", "model", ",", 
                 RowBox[{"{", "}"}], ",", "guessCoeffsSolution", ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}]}], "//.", 
              "numModel"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"exprNewParam", "//", 
              RowBox[{
               RowBox[{"toNum", "[", 
                RowBox[{
                "model", ",", "newParameters", ",", "guessCoeffsSolution", 
                 ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
               "numModel"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"toNum", "[", 
               RowBox[{
               "exprNewParam", ",", "model", ",", "newParameters", ",", 
                "guessCoeffsSolution", ",", 
                RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}], "//.", 
              "numModel"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toEquation", "[", 
                RowBox[{"exprNewParam", ",", "model"}], "]"}], "//.", 
               RowBox[{"toNum", "[", 
                RowBox[{
                "\"\<Rules\>\"", ",", "model", ",", "newParameters", ",", 
                 "guessCoeffsSolution", ",", 
                 RowBox[{"Sequence", "@@", "optNewParam"}]}], "]"}]}], "//.", 
              "numModel"}]}], "\[IndentingNewLine]", "}"}]}], 
          "\[IndentingNewLine]", ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ind", "=", 
        RowBox[{"ind", "+", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"model", ",", "mods"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.905212313865467*^9, 3.905212325184925*^9}, 
   3.905212359867795*^9, {3.905212795217298*^9, 3.9052128737720337`*^9}, {
   3.905212983551852*^9, 3.905212995134842*^9}, {3.905213037353033*^9, 
   3.9052130416232862`*^9}, {3.9052151825321712`*^9, 3.905215183218441*^9}, {
   3.905219865402843*^9, 3.905219865551938*^9}, {3.905220153371327*^9, 
   3.905220164055006*^9}, 3.90522026953924*^9, 3.9052207482833567`*^9, {
   3.905220845004054*^9, 3.905220930271912*^9}, {3.905221061187875*^9, 
   3.90522106269077*^9}, {3.905221135086172*^9, 3.905221135143044*^9}, {
   3.905596348310378*^9, 3.905596359764402*^9}, {3.905644306729175*^9, 
   3.9056443712781763`*^9}, {3.90564443240147*^9, 3.9056444407745323`*^9}, 
   3.905644478775923*^9, {3.905644512176396*^9, 3.9056445205829363`*^9}, {
   3.9056445690177298`*^9, 3.905644572616569*^9}, {3.9056449095850077`*^9, 
   3.9056449111345387`*^9}, {3.9056505809035473`*^9, 
   3.9056506306788597`*^9}, {3.9056508278542624`*^9, 3.905650852614739*^9}, {
   3.9056509030875874`*^9, 3.90565098149644*^9}, 3.9056510639790373`*^9, {
   3.9056511830408373`*^9, 3.905651200218302*^9}, {3.905651234296702*^9, 
   3.905651234739759*^9}, {3.9056512691047707`*^9, 3.905651365749144*^9}, {
   3.905651433795464*^9, 3.905651600903537*^9}, {3.905673295038972*^9, 
   3.905673295284717*^9}, {3.9056735224124403`*^9, 3.905673556233472*^9}, {
   3.905674866122074*^9, 3.9056748698621483`*^9}, {3.906301621245772*^9, 
   3.906301629009758*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"4bf7ea26-9f3f-4ffc-acd5-d25f098ffc4c"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 1, 24999962235117932242, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9102346936103373`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"7be14e19-2dd9-479b-be3a-cf9342ad6c33"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 2, 24999962235117932242, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.910234693710631*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"d82733b1-109f-4fa2-a7b7-c03e0bd84169"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 35, 3, 24999962235117932242, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9102346938196573`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"5ea534b6-ed2d-4ff0-9798-c063b24d45cd"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \
\\\"::\\\", \\\"lstol\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 35, 4, 24999962235117932242, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.910234693880239*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"c91d66ed-93b4-4014-a932-44d4abb34169"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noMissingTest", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testNumber", "=", "\[IndentingNewLine]", 
      RowBox[{"Sort", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Keys", "@", 
          RowBox[{"SubValues", "@", "outTests"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
           RowBox[{
            RowBox[{"outTests", "[", 
             RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
            "i_Integer", "]"}], "]"}], ":>", "i"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"noMissingTest", ",", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Max", "[", "testNumber", "]"}]}], "]"}], "==", 
        "testNumber"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"model", ",", "mods"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"And", "@@", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", "noMissingTest"}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"Values", "@", 
        RowBox[{"SubValues", "@", "outTests"}]}]}]}], "\[IndentingNewLine]", 
     "}"}]}], "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{
  3.905651105702589*^9, {3.9056833437688427`*^9, 3.905683358148625*^9}, {
   3.906301621246296*^9, 3.906301629009966*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"ba597ba3-ffcc-4762-995b-86d197d691d2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235073995471*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"8ae041fa-f886-4a7f-a110-ced7ec9296ec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", "processNewParameters", "*)"}]], "Input",
 CellChangeTimes->{{3.906301621246478*^9, 3.9063016290100307`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"d4925b18-5246-43b6-8a36-15af46f4577e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"helper", " ", "functions"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "returns", " ", "True", " ", "if", " ", "evaluation", " ", "of", " ", 
    "expr", " ", "returns", " ", "$Aborted"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ClearAll", "[", "checkAbrt", "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"checkAbrt", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checkAbrt", "[", "expr_", "]"}], ":=", 
    RowBox[{"TrueQ", "@", 
     RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
      RowBox[{"AbortProtect", "[", "\[IndentingNewLine]", 
       RowBox[{"CheckAbort", "[", 
        RowBox[{"expr", ",", "True"}], "]"}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "returns", " ", "True", " ", "if", " ", "msg", " ", "issued", " ", "when",
      " ", "expr", " ", "is", " ", "evaluated"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "checkMsg", "]"}], "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"checkMsg", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"checkMsg", "[", 
     RowBox[{"expr_", ",", "msg_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AbortProtect", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"c", "=", 
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"expr", ";"}], ",", "True", ",", "msg"}], "]"}]}], 
           ";"}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TrueQ", "@", "c"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TrueQ", "@", "c"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.905210318908334*^9, 3.9052103787186623`*^9}, {
  3.9052113324825163`*^9, 3.905211334455784*^9}, {3.9063016212466307`*^9, 
  3.9063016290100937`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"47b59852-4d1b-49a3-90f9-542bfd3cb52d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "old", " ", "and", " ", "new", " ", "parameters", " ", "are", " ", 
    "equal"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"evaluate", " ", "all", " ", "parameters", " ", "numerically"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "p"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "p"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newPn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "newP"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "newP"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"process", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn1", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn2", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "symbolic", " ", "and", " ", "numeric", " ", "parameters", " ", "give", 
       " ", "same", " ", "answer"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "@", "procP"}], "===", 
       RowBox[{"Sort", "@", "procPn"}], "===", 
       RowBox[{"Sort", "@", "procPn1"}], "===", 
       RowBox[{"Sort", "@", "procPn2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "newP"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052065264110518`*^9, 3.9052065476889133`*^9}, {
   3.9052066574255877`*^9, 3.905206658715994*^9}, {3.905206741207562*^9, 
   3.905206779971458*^9}, {3.905206843480741*^9, 3.905206845213539*^9}, {
   3.905206932245037*^9, 3.905207128736129*^9}, {3.905207266985085*^9, 
   3.905207267387904*^9}, {3.905207320967823*^9, 3.905207321853704*^9}, {
   3.9052079618042088`*^9, 3.905208020358967*^9}, {3.9052080523865013`*^9, 
   3.905208069561117*^9}, {3.905210388717566*^9, 3.905210433263633*^9}, 
   3.9052110020297422`*^9, 3.90521133796375*^9, 3.905211602619338*^9, 
   3.9056520337251987`*^9, {3.90630162124697*^9, 3.9063016290102262`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"15753eef-6c59-4fe7-ad3c-0f279721598a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074059515*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"d42c5d44-f7a3-4e07-8a31-9269a79bb4d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "new", " ", "parameters", " ", "are", " ", "subset", " ", "of", " ", "old",
     " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.9"}], ",", 
       RowBox[{"Esx", "\[Rule]", "1"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"evaluate", " ", "all", " ", "parameters", " ", "numerically"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "p"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "p"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newPn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "newP"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "newP"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"process", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn1", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn2", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "symbolic", " ", "and", " ", "numeric", " ", "parameters", " ", "give", 
       " ", "same", " ", "answer"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "@", "procP"}], "===", 
       RowBox[{"Sort", "@", "procPn"}], "===", 
       RowBox[{"Sort", "@", "procPn1"}], "===", 
       RowBox[{"Sort", "@", "procPn2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "newP"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052072937293797`*^9, 3.9052073262691727`*^9}, {
   3.905207366359581*^9, 3.905207440401265*^9}, {3.905207674868387*^9, 
   3.905207727994254*^9}, {3.905207841331642*^9, 3.90520787000637*^9}, {
   3.9052079005633173`*^9, 3.905207933706068*^9}, 3.9052080289359903`*^9, {
   3.9052080743919086`*^9, 3.905208088377164*^9}, {3.905208130076997*^9, 
   3.9052081303221416`*^9}, 3.905210450716963*^9, {3.906301621247363*^9, 
   3.906301629010385*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"e839da32-fab7-4d5f-9086-e343852b181a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074073043*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"f527af2c-d79a-4bd7-a224-3de678341e3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"new", " ", "parameters", " ", "is", " ", "empty"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"evaluate", " ", "all", " ", "parameters", " ", "numerically"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "p"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "p"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newPn", "=", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#1", "->", 
          RowBox[{"(", 
           RowBox[{"#2", "/.", "newP"}], ")"}]}], ")"}], "&"}], ",", 
       RowBox[{"Association", "@", "newP"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"process", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn1", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "pn"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procPn2", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newPn", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "symbolic", " ", "and", " ", "numeric", " ", "parameters", " ", "give", 
       " ", "same", " ", "answer"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "@", "procP"}], "===", 
       RowBox[{"Sort", "@", "procPn"}], "===", 
       RowBox[{"Sort", "@", "procPn1"}], "===", 
       RowBox[{"Sort", "@", "procPn2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "newP"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052072937293797`*^9, 3.9052073262691727`*^9}, {
   3.905207366359581*^9, 3.905207440401265*^9}, {3.905207674868387*^9, 
   3.905207727994254*^9}, {3.905207841331642*^9, 3.90520787000637*^9}, {
   3.9052079005633173`*^9, 3.905207933706068*^9}, 3.9052080289359903`*^9, {
   3.9052080743919086`*^9, 3.905208109351399*^9}, 3.905210453621024*^9, 
   3.9056800561579847`*^9, 3.905680110172385*^9, {3.906301621247744*^9, 
   3.906301629010538*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"976ca983-fece-463e-9449-d6dc6bec921f"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074080003*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"9fa0bb90-a28a-46eb-975a-737432553882"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "new", " ", "parameters", " ", "are", " ", "not", " ", "a", " ", "subset", 
    " ", "of", " ", "old", " ", "parameters"}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.9"}], ",", 
       RowBox[{"Esx", "\[Rule]", "1"}], ",", 
       RowBox[{"phip", "->", "3"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", "aborts", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"checkAbrt", "[", 
       RowBox[{"processNewParameters", "[", 
        RowBox[{"newP", ",", "p"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"with", " ", "message", " ", "subsetparam"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"checkMsg", "[", 
       RowBox[{
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "subsetparam"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052072937293797`*^9, 3.9052073262691727`*^9}, {
   3.905207366359581*^9, 3.905207440401265*^9}, {3.905207674868387*^9, 
   3.905207727994254*^9}, {3.905207841331642*^9, 3.90520787000637*^9}, {
   3.9052079005633173`*^9, 3.905207933706068*^9}, 3.9052080289359903`*^9, {
   3.9052080743919086`*^9, 3.905208151886853*^9}, {3.9052082086682796`*^9, 
   3.905208262198208*^9}, {3.90520834237298*^9, 3.9052083484324503`*^9}, {
   3.905208390443688*^9, 3.9052084299683857`*^9}, {3.905208466203511*^9, 
   3.9052084750808153`*^9}, {3.905208511003985*^9, 3.905208554260667*^9}, {
   3.9052086518826437`*^9, 3.905208679920556*^9}, {3.905210464996544*^9, 
   3.905210502949132*^9}, {3.906301621248012*^9, 3.906301629010641*^9}, 
   3.9102346621469812`*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"bc496665-b4bc-496d-9caa-deadbee370bf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9102350741174507`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"1be44d74-be1b-4934-bf76-42d88ec254aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"psi", "=", 
    RowBox[{"1", " ", "in", " ", "new", " ", "parameters", " ", "aborts"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.9"}], ",", 
       RowBox[{"Esx", "\[Rule]", "1"}], ",", 
       RowBox[{"psi", "->", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", "aborts", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"checkAbrt", "[", 
       RowBox[{"processNewParameters", "[", 
        RowBox[{"newP", ",", "p"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"with", " ", "message", " ", "subsetparam"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"checkMsg", "[", 
       RowBox[{
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "psi"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.905210531451913*^9, 3.90521055828263*^9}, 
   3.9052105929669027`*^9, {3.905210702555273*^9, 3.905210704506366*^9}, {
   3.9063016212482452`*^9, 3.906301629010742*^9}, 3.910234663280958*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"7cf7a32b-94e1-4328-84f9-edb6c12084d9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9102350741242027`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"f2e35bfa-1f68-4dd9-a3a9-bced986ecbd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"psi", "=", 
    RowBox[{"1.", " ", "in", " ", "new", " ", "parameters", " ", "aborts"}]}],
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"define", " ", "old", " ", "and", " ", "new", " ", "parameters"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.9"}], ",", 
       RowBox[{"Esx", "\[Rule]", "1"}], ",", 
       RowBox[{"psi", "->", "1."}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", "aborts", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"checkAbrt", "[", 
       RowBox[{"processNewParameters", "[", 
        RowBox[{"newP", ",", "p"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"with", " ", "message", " ", "subsetparam"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"checkMsg", "[", 
       RowBox[{
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "psi"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.905210589361936*^9, 3.905210697276291*^9, {3.906301621248487*^9, 
   3.9063016290108423`*^9}, 3.9102346640319757`*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"06828b4b-2674-448e-804b-0ccd7f916182"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074134036*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"310fc20d-acc5-425c-90b6-af673119f701"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"gamma", ",", " ", "psi", ",", " ", 
    RowBox[{
     RowBox[{"theta", " ", "relate", " ", "by", " ", "theta"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "gamma"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "psi"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"when", " ", "gamma"}], ",", " ", "psi", ",", " ", 
    RowBox[{"theta", " ", "all", " ", "provided"}], ",", " ", 
    RowBox[{
    "ignore", " ", "theta", " ", "and", " ", "issue", " ", "message", " ", 
     "unless", " ", "theta", " ", "is", " ", "exactly", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "gamma"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "psi"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"case", ":", " ", 
    RowBox[{"theta", " ", "is", " ", "exactly", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "gamma"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "psi"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "newP"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
  3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
  3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
  3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
  3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
  3.9052116200136547`*^9, 3.905211692551268*^9}, {3.906301621248863*^9, 
  3.90630162901099*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"56e6c309-3743-4443-a3af-49d76fcef49e"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074142003*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"a5adf389-2b6a-405e-a397-512ace7844f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"case", ":", " ", 
    RowBox[{"theta", " ", "is", " ", "not", " ", "exactly", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "gamma"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"1", "/", "psi"}]}], ")"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"theta", "\[Rule]", "3.23`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"processNewParameters", "[", 
        RowBox[{"newP", ",", "p"}], "]"}], ",", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "param"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "newP"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"with", " ", "message", " ", "subsetparam"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"checkMsg", "[", 
       RowBox[{
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "param"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"theta", " ", "has", " ", "correct", " ", "value"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Chop", "@", 
        RowBox[{"RealAbs", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"theta", "/.", "procP"}], ")"}], "-", 
          RowBox[{"(", 
           RowBox[{"-", "27."}], ")"}]}], "]"}]}], "<", "$MachineEpsilon"}]}],
      "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
  3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
  3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
  3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
  3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
  3.9052116200136547`*^9, 3.905211783840501*^9}, {3.905211871032999*^9, 
  3.905211890826621*^9}, {3.906301621249181*^9, 3.9063016290111322`*^9}, {
  3.910234664931377*^9, 3.910234665449705*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"cb5cbc2c-d564-4255-87b6-71a2ff5bde36"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.9102350741517467`*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"3eae02bd-da92-4b31-8f33-9b50ad5a9cb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"when", " ", "2", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"gamma", ",", " ", "psi", ",", " ", "theta"}], "}"}], " ", 
     "are", " ", "provided"}], ",", " ", 
    RowBox[{
    "solve", " ", "for", " ", "the", " ", "third", " ", "and", " ", "add", 
     " ", "to", " ", "newParameters"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"psi", ",", " ", "theta"}], "}"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"psi", "\[Rule]", "2"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        RowBox[{"-", "3.`"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters", " ",
         "with", " ", "added", " ", "gamma"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "gamma", "}"}], ",", 
          RowBox[{"Keys", "@", "newP"}]}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"gamma", " ", "has", " ", "correct", " ", "value"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Chop", "@", 
        RowBox[{"RealAbs", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"gamma", "/.", "procP"}], ")"}], "-", 
          RowBox[{"(", "2.5", ")"}]}], "]"}]}], "<", "$MachineEpsilon"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
  3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
  3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
  3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
  3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
  3.9052116200136547`*^9, 3.90521170746982*^9}, {3.905211898915916*^9, 
  3.905211948448038*^9}, {3.905212014113267*^9, 3.9052120480050707`*^9}, {
  3.906301621249531*^9, 3.906301629011278*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"ba58d702-c5ea-4b8f-8a0d-af0a4189858c"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074156341*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"d8491f11-9d06-47c8-b2a8-b9bce20817db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"gamma", ",", " ", "psi"}], "}"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"psi", "\[Rule]", "2"}], ",", 
       RowBox[{"gamma", "\[Rule]", "2.5"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters", " ",
         "with", " ", "added", " ", "theta"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "theta", "}"}], ",", 
          RowBox[{"Keys", "@", "newP"}]}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"theta", " ", "has", " ", "correct", " ", "value"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RealAbs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"theta", "/.", "procP"}], ")"}], "-", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}], "]"}], "<", "$MachineEpsilon"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
  3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
  3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
  3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
  3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
  3.9052116200136547`*^9, 3.90521170746982*^9}, {3.905211898915916*^9, 
  3.90521191308664*^9}, {3.90521195726097*^9, 3.905212002051486*^9}, {
  3.905212034474784*^9, 3.905212062210293*^9}, {3.906301621249867*^9, 
  3.906301629011415*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"e5c8c32b-e7e0-4548-b6b1-7d7671fea92f"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074168124*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"a15d6512-5097-4674-a981-9c0fcada3ab3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{"gamma", ",", " ", "theta"}], "}"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gamma", "\[Rule]", "2.5"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        RowBox[{"-", "3.`"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"capture", " ", "messages"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msg", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"$MessagePrePrint", "=", "Sow"}], ",", 
         RowBox[{"$MessageList", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", 
       RowBox[{"Reap", "[", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{
            RowBox[{"processNewParameters", "[", 
             RowBox[{"newP", ",", "p"}], "]"}], ";"}]}], "]"}], ";", 
         "$MessageList"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"values", " ", "are", " ", "numbers"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"Values", "@", "procP"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "same", " ", "as", " ", "in", " ", "new", " ", "parameters", " ",
         "with", " ", "added", " ", "psi"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Keys", "@", "procP"}]}], "===", 
       RowBox[{"Sort", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "psi", "}"}], ",", 
          RowBox[{"Keys", "@", "newP"}]}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "parameters", " ", "in", " ", "processed", " ", "list", " ", "are", 
        " ", "subset", " ", "of", " ", "old", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"SubsetQ", "[", 
       RowBox[{
        RowBox[{"Keys", "@", "p"}], ",", 
        RowBox[{"Keys", "@", "procP"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"not", " ", "aborted"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"checkAbrt", "[", 
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"no", " ", "message", " ", "issued"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReleaseHold", "@", "msg"}], "==", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"psi", " ", "has", " ", "correct", " ", "value"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RealAbs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"psi", "/.", "procP"}], ")"}], "-", 
         RowBox[{"(", "2", ")"}]}], "]"}], "<", "$MachineEpsilon"}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
  3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
  3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
  3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
  3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
  3.9052116200136547`*^9, 3.90521170746982*^9}, {3.905211898915916*^9, 
  3.90521191308664*^9}, {3.90521195726097*^9, 3.905212002051486*^9}, {
  3.905212034474784*^9, 3.905212069446944*^9}, {3.906301621250193*^9, 
  3.906301629011549*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"6aa7b708-57be-45bb-91b1-65d58e1afa89"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074180605*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"6ff163d0-2d84-49a5-b56f-9c431d3f9b5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "if", " ", "theta", " ", "provided", " ", "without", " ", "gamma", " ", 
     "or", " ", "psi"}], ",", " ", "abort"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta", "\[Rule]", "0.9"}], ",", 
       RowBox[{"Esx", "\[Rule]", "1"}], ",", 
       RowBox[{"theta", "->", "1."}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", "aborts", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"checkAbrt", "[", 
       RowBox[{"processNewParameters", "[", 
        RowBox[{"newP", ",", "p"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"with", " ", "message", " ", "subsetparam"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"checkMsg", "[", 
       RowBox[{
        RowBox[{"processNewParameters", "[", 
         RowBox[{"newP", ",", "p"}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Tools`ToNumber`Private`\
processNewParameters", "::", "theta"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052107258404627`*^9, 3.9052108425395613`*^9}, {
   3.905210907537624*^9, 3.905210981638547*^9}, {3.905211023837717*^9, 
   3.905211103956017*^9}, {3.905211139614875*^9, 3.905211181398678*^9}, {
   3.905211213358252*^9, 3.905211304895089*^9}, {3.905211351077333*^9, 
   3.9052114098047*^9}, {3.9052114614239397`*^9, 3.905211562076316*^9}, {
   3.9052116200136547`*^9, 3.90521170746982*^9}, {3.905211898915916*^9, 
   3.90521191308664*^9}, {3.90521195726097*^9, 3.905212002051486*^9}, {
   3.905212034474784*^9, 3.905212084845602*^9}, {3.906301621250435*^9, 
   3.906301629011654*^9}, 3.910234666098439*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"fc2d65e2-1914-4534-a73b-992f011e410a"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074232643*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"ef029f64-670f-45f0-8f02-e7c385baa464"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "processNewParameters", " ", "preserves", " ", "contexts", " ", "of", " ", 
    "old", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"context1`delta", "\[Rule]", "0.998`"}], ",", 
       RowBox[{"context1`Esx", "\[Rule]", "0.0078`"}], ",", 
       RowBox[{"foo`gamma", "\[Rule]", "10"}], ",", 
       RowBox[{"muc", "\[Rule]", "0.0015`"}], ",", 
       RowBox[{"phisxs", "\[Rule]", "2.3`*^-6"}], ",", 
       RowBox[{"phix", "\[Rule]", "0.044`"}], ",", 
       RowBox[{"psi", "\[Rule]", "1.5`"}], ",", 
       RowBox[{"rhox", "\[Rule]", "0.979`"}], ",", 
       RowBox[{"theta", "\[Rule]", 
        FractionBox[
         RowBox[{"1", "-", "gamma"}], 
         RowBox[{"1", "-", 
          FractionBox["1", "psi"]}]]}], ",", 
       RowBox[{"vx", "\[Rule]", "0.987`"}], ",", 
       RowBox[{
        RowBox[{"mud", "[", "1", "]"}], "\[Rule]", "0.0015`"}], ",", 
       RowBox[{
        RowBox[{"phidxd", "[", "1", "]"}], "\[Rule]", "4.5`"}], ",", 
       RowBox[{
        RowBox[{"rhodx", "[", "1", "]"}], "\[Rule]", "3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newP", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"context2`delta", "\[Rule]", "0.9"}], ",", " ", 
       RowBox[{"Esx", "->", "1"}], ",", " ", 
       RowBox[{"bar`gamma", "->", "2"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procP", "=", 
     RowBox[{"processNewParameters", "[", 
      RowBox[{"newP", ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "contexts", " ", "of", " ", "newP", " ", "do", " ", "not", " ", "match",
        " ", "those", " ", "in", " ", "old", " ", "parameters", " ", "in", 
       " ", "p"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"KeyTake", "[", 
        RowBox[{"p", ",", 
         RowBox[{"Keys", "@", "newP"}]}], "]"}], "===", 
       RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "contexts", " ", "of", " ", "procP", " ", "match", " ", "those", " ", 
        "in", " ", "old", " ", "parameters", " ", "in", " ", "p"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Context", "/@", 
         RowBox[{"Keys", "@", "procP"}]}], ")"}], "===", 
       RowBox[{"Context", "/@", 
        RowBox[{"(", 
         RowBox[{"Keys", "@", 
          RowBox[{"KeyTake", "[", 
           RowBox[{"p", ",", 
            RowBox[{"Keys", "@", "procP"}]}], "]"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9052203250147943`*^9, 3.905220561424608*^9}, {
  3.905220598853331*^9, 3.905220734209539*^9}, {3.906301621250703*^9, 
  3.9063016290117693`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"2649fff4-e91f-4af8-8407-e5da21abc3b0"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.910235074240774*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"eaff3bec-226a-4f3b-8896-7628819f57b3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["CreateMomentsDatabase", "Section",
 CellChangeTimes->{{3.906299679029694*^9, 3.9062996804159527`*^9}, 
   3.910219877783269*^9},ExpressionUUID->"8dd176dd-6099-4f24-8361-\
5a51d8cca43f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"c73d7a34-3093-49d1-9ec9-5dc227d4d7c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testName", " ", "=", " ", 
   RowBox[{"First", "@", 
    RowBox[{"NotebookRead", "[", 
     RowBox[{"PreviousCell", "[", 
      RowBox[{"CellStyle", " ", "->", " ", "\"\<Section\>\""}], "]"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9062989703565693`*^9, 3.9062989714060993`*^9}, {
  3.9062996895679913`*^9, 3.906299695986437*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"fc26a6cc-e50f-40cc-a992-11cd33680359"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DirectoryName", "[", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
      RowBox[{"testName", "<>", "\"\<.wlt\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"testFileName", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testContextBase", "=", 
   RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"$ContextPath", ",", 
     RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}, 3.893336453091833*^9, 3.8933472708044786`*^9, 
   3.906297265406946*^9, {3.906297454165967*^9, 3.906297457072887*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"ede85fcf-d7f2-4d4a-a321-7baf7b3c2210"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageFileName", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
      ",", 
      RowBox[{"testName", "<>", "\"\<.wl\>\""}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", 
   RowBox[{
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\>\"", "<>", 
     "testName", "<>", "\"\<`\>\""}], ",", "packageFileName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ContextPath", " ", "=", " ", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Prepend", "[", 
     RowBox[{
     "$ContextPath", ",", 
      "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
CreateMomentsDatabase`Private`\>\""}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.889968360919714*^9, 3.889968361169221*^9}, {
   3.889998753242611*^9, 3.8899987613556004`*^9}, 3.8907107328284597`*^9, 
   3.890716596142606*^9, 3.8912441409010677`*^9, {3.891284064139113*^9, 
   3.891284078157*^9}, {3.89128451819068*^9, 3.8912845185051107`*^9}, {
   3.8913176074268427`*^9, 3.891317626509036*^9}, {3.8919141921795597`*^9, 
   3.891914193888651*^9}, 3.9026747447148247`*^9, {3.902674827715456*^9, 
   3.9026748330094213`*^9}, {3.9050647938688803`*^9, 3.905064824740706*^9}, {
   3.9062972662561817`*^9, 3.9062972670372753`*^9}, {3.906297459133255*^9, 
   3.906297461333879*^9}, 3.910220038909897*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"d93a6300-9ab0-44e1-9a4c-2a0422adbaee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"longTest", " ", "=", " ", "False"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"fast", " ", "and", " ", "partial", " ", "coverage", " ", 
    RowBox[{"(", "False", ")"}], " ", "or", " ", "slow", " ", "and", " ", 
    "full", " ", "coverage", " ", 
    RowBox[{"(", "True", ")"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.9062990007961082`*^9, 3.906299025776042*^9}, {
  3.906299600206047*^9, 3.9062996032071447`*^9}, {3.91022055801149*^9, 
  3.910220558511942*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"53248738-0bd2-4602-b9c5-151f7323beea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "stop"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", "longTest"}], ",", 
    RowBox[{"Off", "[", 
     RowBox[{"FindRoot", "::", "cvmit"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk\>\"", ",", "\"\<Models.wl\>\""}], "}"}],
      "]"}], "]"}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk/MomentsLookupTables\>\"", ",", 
       "\"\<covLongBKY.wl\>\""}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk/MomentsLookupTables\>\"", ",", 
       "\"\<covLongDES.wl\>\""}], "}"}], "]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk/MomentsLookupTables\>\"", ",", 
       "\"\<covLongNRC.wl\>\""}], "}"}], "]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<FernandoDuarte/LongRunRisk/MomentsLookupTables\>\"", ",", 
       "\"\<covLongNRCStochVol.wl\>\""}], "}"}], "]"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modBKY", "=", 
   RowBox[{"msp", "[", "\"\<BKY\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"modNRCStochVol", "=", 
   RowBox[{"msp", "[", "\"\<NRCStochVol\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mods", "=", 
    RowBox[{"If", "[", 
     RowBox[{"longTest", ",", "\n", 
      RowBox[{"{", 
       RowBox[{
       "modBKY", ",", "modNRC", ",", "modDES", ",", "modNRCStochVol"}], "}"}],
       ",", "\n", 
      RowBox[{"{", 
       RowBox[{"modBKY", ",", "modDES"}], "}"}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"**", "**", "**", "**"}], "*", "set", " ", "up", " ", "useful", 
      " ", "variables", " ", "used", " ", "throughout", " ", "loop"}], 
     "**********)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"ind", "=", "0"}], ";", 
      RowBox[{"(*", 
       RowBox[{"counter", " ", "for", " ", "Do", " ", "loop"}], "*)"}], "\n", 
      
      RowBox[{"covLong", " ", "=", " ", 
       RowBox[{"Symbol", "[", 
        RowBox[{
        "\"\<FernandoDuarte`LongRunRisk`covLong\>\"", " ", "<>", " ", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"(*", 
       RowBox[{"test", ":", " ", 
        RowBox[{"computed", " ", "moments", " ", "are", " ", "numbers"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "without", " ", "stocks"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"testMoments", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"covLong", ",", 
         RowBox[{"Outer", "[", 
          RowBox[{"Append", ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{"exo", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "8"}], ",", "8"}], "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMomentsN", "=", 
       RowBox[{"testMoments", "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "with", " ", "one", " ", "stock"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"testMomentsOneStock", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"#", ",", "j"}], "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"Inactive", "[", "covLong", "]"}], ",", 
           RowBox[{"Outer", "[", 
            RowBox[{"Append", ",", 
             RowBox[{"Tuples", "[", 
              RowBox[{"{", 
               RowBox[{"exo", ",", "exoStocks"}], "}"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"-", "8"}], ",", "8"}], "]"}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"{", "2", "}"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMomentsOneStockN", "=", 
       RowBox[{
        RowBox[{"Activate", "[", 
         RowBox[{"testMomentsOneStock", "/.", 
          RowBox[{"j", "->", "1"}]}], "]"}], "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "with", " ", "two", " ", "stocks"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"testMomentsTwoStocks", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "&"}], ",", 
         RowBox[{"Outer", "[", 
          RowBox[{"Append", ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{"exoStocks", ",", "exoStocks"}], "}"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "8"}], ",", "8"}], "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMomentsTwoStocksN", " ", "=", " ", 
       RowBox[{
        RowBox[{"testMomentsTwoStocks", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Thread", "@", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], ",", "#"}], " ", "]"}]}], 
             ")"}], "&"}], ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "@", 
              RowBox[{"model", "[", "\"\<numStocks\>\"", "]"}]}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}], " ", "without", 
        " ", "stocks"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"testMoments3", "=", 
       RowBox[{"MapApply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"##", ",", "0", ",", "0"}], "]"}], "&"}], ",", 
         RowBox[{"Groupings", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"exo", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", "2"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"testMoments3N", "=", 
       RowBox[{"testMoments3", "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", " ", "v2"}], ",", " ", 
          RowBox[{"v3", " ", "v4"}]}], "]"}], " ", "without", " ", "stocks"}],
        "*)"}], "\n", 
      RowBox[{"testMoments4", "=", 
       RowBox[{"MapApply", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"##", ",", "0", ",", "0", ",", "0"}], "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"exo", ",", 
            RowBox[{"{", "4", "}"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"testMoments4N", "=", 
       RowBox[{"testMoments4", "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}], " ", "with", 
        " ", "only", " ", "stocks"}], "*)"}], "\n", 
      RowBox[{"testMomentsStocks3", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "i", ",", "j", ",", "k"}], "}"}]}], 
            "]"}]}], "&"}], ",", 
         RowBox[{"Groupings", "[", 
          RowBox[{
           RowBox[{"Tuples", "[", 
            RowBox[{"exoStocks", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMomentsStocks3N", "=", 
       RowBox[{
        RowBox[{"testMomentsStocks3", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Thread", "@", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", "#"}], " ", 
               "]"}]}], ")"}], "&"}], ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "@", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"model", "[", "\"\<numStocks\>\"", "]"}], ",", "2"}], 
               "]"}]}], ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}]}], "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", " ", "v2"}], ",", " ", 
          RowBox[{"v3", " ", "v4"}]}], "]"}], " ", "with", " ", "only", " ", 
        "stocks"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"testMomentsStocks4", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "i", ",", "j", ",", "k", ",", 
               "m"}], "}"}]}], "]"}]}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"exoStocks", ",", 
            RowBox[{"{", "4", "}"}]}], "]"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testMomentsStocks4N", "=", 
       RowBox[{
        RowBox[{"testMomentsStocks4", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Thread", "@", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "m"}], "}"}], ",", 
                "#"}], " ", "]"}]}], ")"}], "&"}], ",", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "@", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"model", "[", "\"\<numStocks\>\"", "]"}], ",", "2"}], 
               "]"}]}], ",", 
             RowBox[{"{", "4", "}"}]}], "]"}]}], "]"}]}], "//.", 
        RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"outTests", "[", 
         RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", "ind", 
        "]"}], "=", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMomentsN"}], ")"}]}], ")"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMomentsOneStockN"}], ")"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMomentsTwoStocksN"}], ")"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMoments3N"}], ")"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMoments4N"}], ")"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMomentsStocks3N"}], ")"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", 
             RowBox[{"(", 
              RowBox[{"Flatten", "@", "testMomentsStocks4N"}], ")"}]}], 
            ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", "\n", 
      RowBox[{"ind", "=", 
       RowBox[{"ind", "+", "1"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"longTest", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tuples3q", "=", 
          RowBox[{"Groupings", "[", 
           RowBox[{
            RowBox[{"Tuples", "[", 
             RowBox[{"exo", ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ntest", "=", "15"}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "can", " ", "increase", " ", "for", " ", "more", " ", "thorough", 
           " ", "testing"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"toEval3q", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"tuples3q", ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{
                RowBox[{"Length", "[", "tuples3q", "]"}], ",", "ntest"}], 
               "]"}], "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"testMoments3q", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MapApply", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{
                 RowBox[{"Sequence", "[", "##", "]"}], ",", "q1", ",", "q2"}],
                 "]"}], "&"}], ",", " ", "toEval3q"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"q1", ",", 
              RowBox[{"-", "4"}], ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"q2", ",", "4", ",", "4"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"testMoments3qN", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "@", "testMoments3q"}], ")"}], "//.", 
           RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", "testMoments3qN"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"tuples4q", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{"exo", ",", 
             RowBox[{"{", "4", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ntest", "=", "15"}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "can", " ", "increase", " ", "for", " ", "more", " ", "thorough", 
           " ", "testing"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"toEval4q", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"tuples4q", ",", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{
                RowBox[{"Length", "[", "tuples4q", "]"}], ",", "ntest"}], 
               "]"}], "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"testMoments4q", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MapApply", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{
                 RowBox[{"Sequence", "[", "##", "]"}], ",", "q1", ",", "q2", 
                 ",", " ", "q3"}], "]"}], "&"}], ",", " ", "toEval4q"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"q1", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"q2", ",", "3", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"q3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"testMoments4qN", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "@", "testMoments4q"}], ")"}], "//.", 
           RowBox[{"model", "[", "\"\<params\>\"", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"outTests", "[", 
            RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
           "ind", "]"}], "=", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{"NumberQ", "/@", "testMoments4qN"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}], "\n", ",", "\n", 
     RowBox[{"{", 
      RowBox[{"model", ",", "mods"}], "}"}]}], "\n", "]"}], ";"}], 
  RowBox[{"(*", "Do", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"noMissingTest", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"testNumber", "=", "\n", 
       RowBox[{"Sort", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Keys", "@", 
           RowBox[{"SubValues", "@", "outTests"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
            RowBox[{
             RowBox[{"outTests", "[", 
              RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "]"}], "[", 
             "i_Integer", "]"}], "]"}], ":>", "i"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"noMissingTest", ",", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"Max", "[", "testNumber", "]"}]}], "]"}], "==", 
         "testNumber"}]}], "]"}], ";"}], "\n", ",", "\n", 
     RowBox[{"{", 
      RowBox[{"model", ",", "mods"}], "}"}]}], "\n", "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{"And", "@@", "noMissingTest"}], ",", "\n", 
      RowBox[{"And", "@@", 
       RowBox[{"Values", "@", 
        RowBox[{"SubValues", "@", "outTests"}]}]}]}], "\n", "}"}]}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Echo", "[", 
     RowBox[{"out", ",", "\"\<out\>\""}], "]"}], ";", "\n", 
    RowBox[{"Unprotect", "[", "$MessageList", "]"}], ";", "\n", 
    RowBox[{"$MessageList", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"Protect", "[", "$MessageList", "]"}], ";", "\n", 
    RowBox[{"Echo", "[", 
     RowBox[{"$MessageList", ",", "\"\<message list\>\""}], "]"}], ";"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"General", "::", "stop"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"FindRoot", "::", "cvmit"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.906299000816691*^9, {3.906299123705739*^9, 3.906299141428466*^9}, 
   3.9063014587290077`*^9, 3.910220054650477*^9, {3.910220097588994*^9, 
   3.9102201308494387`*^9}, {3.910220173037633*^9, 3.910220216077392*^9}, {
   3.910220269193655*^9, 3.9102203015049143`*^9}, {3.910220355051355*^9, 
   3.910220356014851*^9}, {3.910220414604512*^9, 3.910220415000374*^9}, {
   3.9102204603039427`*^9, 3.910220460476925*^9}, {3.91022051212313*^9, 
   3.9102205132085667`*^9}},
 CellLabel->"",ExpressionUUID->"91c51dcf-975f-4acc-9490-9e2d22e5d1ef"]
}, Closed]],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEnd", ",", " ", 
   RowBox[{
   "\"\<ClearEvaluationQueueOnKernelQuit\>\"", " ", "->", " ", "True"}]}], 
  "]"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"c744d157-d805-4ab4-bea7-1161d5775e16"]
},
CellGrouping->Manual,
WindowSize->{1258, 831},
WindowMargins->{{182, Automatic}, {Automatic, 52}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"905b6788-fd16-4e6b-81f0-f7e9e9132bb3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 267, 7, 37, "Input",ExpressionUUID->"d7471f33-46e7-4d7e-b07b-17407cb1fb64"],
Cell[850, 31, 217, 4, 37, "Input",ExpressionUUID->"463cf0d1-60b9-43e6-87cd-bb9bd9569e3f"],
Cell[1070, 37, 1137, 29, 142, "Input",ExpressionUUID->"e29a71cc-2a46-412d-903e-7389bc2b352e"]
}, Closed]],
Cell[CellGroupData[{
Cell[2244, 71, 128, 3, 65, "Section",ExpressionUUID->"24d8431e-89a7-41b2-8075-95f8985b90c9"],
Cell[2375, 76, 148, 3, 37, "Input",ExpressionUUID->"aa28dca4-9d13-4fc9-8219-9f5c1ccb4e5a"],
Cell[2526, 81, 458, 11, 37, "Input",ExpressionUUID->"3db88f77-f9fc-45a2-9130-a352f3076129"],
Cell[2987, 94, 1966, 41, 142, "Input",ExpressionUUID->"b53e2382-cadd-402b-bb88-9a68821c32c4"],
Cell[4956, 137, 874, 20, 64, "Input",ExpressionUUID->"0cd0595a-d93f-4afc-b0af-1bb84c846cde"],
Cell[5833, 159, 479, 12, 64, "Input",ExpressionUUID->"633303b2-0ff3-4c63-a8fa-47f0ca61811c"],
Cell[6315, 173, 1111, 30, 116, "Input",ExpressionUUID->"e4e0c400-759e-42fa-bd29-fefc22b8b1e2"],
Cell[7429, 205, 949, 25, 64, "Input",ExpressionUUID->"cb0ace6d-d6ed-4085-b883-a5bba8ac3a04"],
Cell[8381, 232, 681, 19, 64, "Input",ExpressionUUID->"e429a653-6ec5-4a83-a773-17648bbde990"],
Cell[9065, 253, 938, 22, 116, "Input",ExpressionUUID->"2244a6f7-49f2-4384-8733-fd7551766553"],
Cell[10006, 277, 1977, 51, 168, "Input",ExpressionUUID->"c44e9ffe-0fc3-4e47-b1bf-d23b7cac6ded"],
Cell[11986, 330, 1671, 44, 168, "Input",ExpressionUUID->"1d9dbe3d-5af4-49fd-8375-18289d763ad9"],
Cell[13660, 376, 3058, 81, 376, "Input",ExpressionUUID->"9a046d71-541d-4fc3-b16f-5e530fc212c9"],
Cell[16721, 459, 1824, 45, 194, "Input",ExpressionUUID->"1514c1cf-7fe2-4195-bfb6-e4ab6ab2a224"],
Cell[18548, 506, 840, 21, 116, "Input",ExpressionUUID->"d5b835a2-ce19-4542-828e-1a210e6e8a13"],
Cell[19391, 529, 552, 12, 64, "Input",ExpressionUUID->"b65bd1d1-5e8f-458b-af2f-953d92e580d9"],
Cell[19946, 543, 2856, 64, 454, "Input",ExpressionUUID->"8c499e00-7829-4cf9-94df-42cd4c259f51"]
}, Closed]],
Cell[CellGroupData[{
Cell[22839, 612, 153, 3, 65, "Section",ExpressionUUID->"6db5d835-4bf0-46ac-85fb-c9b0b479b4f7"],
Cell[22995, 617, 217, 4, 37, "Input",ExpressionUUID->"4157ec9c-33d2-4fc8-9718-e1821f036f77"],
Cell[23215, 623, 339, 8, 37, "Input",ExpressionUUID->"70a27cf4-7b46-490f-8395-488640c81674"],
Cell[23557, 633, 1959, 41, 142, "Input",ExpressionUUID->"dfcfd47b-ae99-4af8-9eb7-aa8c0e1564b8"],
Cell[25519, 676, 234, 5, 37, "Input",ExpressionUUID->"7d6e309c-f5cf-44a8-b2eb-e5340360e795"],
Cell[25756, 683, 718, 19, 116, "Input",ExpressionUUID->"d4a039fe-51d1-49b8-aed9-aecfb837d993"],
Cell[26477, 704, 680, 15, 116, "Input",ExpressionUUID->"cd7b3474-8bec-4544-aac6-5285230212d8"],
Cell[27160, 721, 3322, 94, 246, "Input",ExpressionUUID->"80b13e85-33f0-418b-82ba-3e2fc29b6899"],
Cell[30485, 817, 2155, 58, 211, "Input",ExpressionUUID->"90d7d504-7006-4ea4-b002-a3cf0f813f79"],
Cell[32643, 877, 1579, 44, 124, "Input",ExpressionUUID->"09aa0254-54c0-420e-b689-66d6afd54189"],
Cell[34225, 923, 2447, 69, 199, "Input",ExpressionUUID->"b4d54d26-3b7e-430f-a1ca-6c612f18cd19"],
Cell[36675, 994, 4771, 140, 350, "Input",ExpressionUUID->"177bb1dd-38eb-406a-b5cf-c6ba9e48ea66"],
Cell[41449, 1136, 6700, 186, 605, "Input",ExpressionUUID->"bbbaa3c8-dc87-4f73-a183-05e355b89fe1"],
Cell[48152, 1324, 5134, 152, 359, "Input",ExpressionUUID->"55dab54c-227a-476f-a534-47ce6741df58"],
Cell[53289, 1478, 2957, 91, 142, "Input",ExpressionUUID->"38a6a259-7fe1-423f-bfe1-82ea23f9601f"],
Cell[56249, 1571, 4456, 131, 205, "Input",ExpressionUUID->"63053f2f-5948-482a-8699-307324b33641"],
Cell[60708, 1704, 2327, 72, 156, "Input",ExpressionUUID->"11f8cb0c-9265-4d3a-8c76-fa19b548c740"],
Cell[63038, 1778, 3413, 102, 215, "Input",ExpressionUUID->"e0347b8d-10cc-4019-a448-61b6931c62fe"],
Cell[66454, 1882, 2008, 61, 142, "Input",ExpressionUUID->"4ee46528-3c9d-4b7b-8c56-2f806295e5f0"],
Cell[68465, 1945, 2007, 56, 147, "Input",ExpressionUUID->"438a32ba-0736-4f2d-88b7-d530594bedf6"],
Cell[70475, 2003, 6033, 172, 454, "Input",ExpressionUUID->"6861b402-f75c-4667-b501-8011a1172c3d"],
Cell[76511, 2177, 2958, 78, 200, "Input",ExpressionUUID->"b672071e-8a56-48d5-bbd2-462a17413a2b"],
Cell[79472, 2257, 4186, 119, 257, "Input",ExpressionUUID->"577ca75c-f1e8-4c5f-b81a-69ed4611682a"],
Cell[83661, 2378, 4191, 125, 298, "Input",ExpressionUUID->"98b96f48-2371-42ce-b6f3-c2d3ec419b9f"],
Cell[87855, 2505, 3554, 105, 142, "Input",ExpressionUUID->"669bbbeb-79e0-407e-97e7-78ed6ce747ec"],
Cell[91412, 2612, 2805, 82, 142, "Input",ExpressionUUID->"d74dec9d-a539-4d0e-ab60-d5b9bbfddc6a"],
Cell[94220, 2696, 2805, 82, 142, "Input",ExpressionUUID->"421a78a2-5444-47c1-96bb-d5d4aec3db4d"],
Cell[97028, 2780, 3880, 117, 252, "Input",ExpressionUUID->"3bc7bdb3-c874-4a81-95db-6125de48aace"],
Cell[100911, 2899, 3833, 112, 194, "Input",ExpressionUUID->"22a40649-4fc1-4479-a1e7-36a98819de83"],
Cell[104747, 3013, 3669, 110, 208, "Input",ExpressionUUID->"da941f2b-6e55-4088-b4a9-7e8406525328"],
Cell[108419, 3125, 2357, 71, 153, "Input",ExpressionUUID->"cff362b6-e8dd-4205-886c-7091dd42a87f"],
Cell[110779, 3198, 3200, 93, 194, "Input",ExpressionUUID->"bd52b2bc-0a39-41ad-97ed-32a2bf43ef42"],
Cell[113982, 3293, 3737, 115, 266, "Input",ExpressionUUID->"b9d5ba71-434d-43b0-8b41-c2fa077df7da"],
Cell[117722, 3410, 1806, 58, 127, "Input",ExpressionUUID->"93e936c8-b32b-476d-9d65-b8bc48c1f8f1"],
Cell[119531, 3470, 5725, 171, 275, "Input",ExpressionUUID->"7a18e4a4-576a-4c5d-9e28-f38346f43cb8"],
Cell[125259, 3643, 9129, 274, 393, "Input",ExpressionUUID->"cf4d0f5b-8869-43de-96d7-64386c5b43a0"],
Cell[134391, 3919, 17748, 529, 1783, "Input",ExpressionUUID->"c2e55eec-6ab2-4679-bcfa-91260fc9a7b4"],
Cell[152142, 4450, 3713, 93, 350, "Input",ExpressionUUID->"d7b1dc2e-1816-4181-8ff0-31fa1e5c77aa"],
Cell[155858, 4545, 3971, 95, 506, "Input",ExpressionUUID->"4c8ea0b5-37e5-453b-b0b1-9b25654e2a26"],
Cell[159832, 4642, 727, 21, 90, "Input",ExpressionUUID->"b26e257d-ce09-4aad-b16a-47832fc4d8d4"],
Cell[160562, 4665, 585, 13, 37, "Input",ExpressionUUID->"3b327004-c342-4209-9481-98e7951cabc7"],
Cell[161150, 4680, 1666, 42, 220, "Input",ExpressionUUID->"12eb5878-e473-43c6-9629-7e938e3f4969"],
Cell[162819, 4724, 719, 15, 37, "Input",ExpressionUUID->"5aca4785-9f39-4919-b7a9-140ddad15717"],
Cell[163541, 4741, 893, 20, 37, "Input",ExpressionUUID->"215c8466-99e7-41b2-980f-077548b87937"],
Cell[164437, 4763, 898, 24, 90, "Input",ExpressionUUID->"5a63533e-2bf7-4e75-9f29-26af82526760"],
Cell[165338, 4789, 1134, 31, 90, "Input",ExpressionUUID->"73309b2c-3fb5-4403-bf1c-ed0d88627b36"],
Cell[166475, 4822, 4516, 122, 460, "Input",ExpressionUUID->"83143a82-aa32-43be-b8a2-b64dafc20560"],
Cell[170994, 4946, 246, 5, 37, "Input",ExpressionUUID->"a0d59c9d-d376-4f94-aa50-8a45943a9f47"]
}, Closed]],
Cell[CellGroupData[{
Cell[171277, 4956, 153, 3, 65, "Section",ExpressionUUID->"7a850a41-9f5f-44ec-a4c4-a3dfe09a3c8f"],
Cell[171433, 4961, 219, 5, 37, "Input",ExpressionUUID->"0aedab66-c3e2-436e-863d-bd1bb5fc43fa"],
Cell[171655, 4968, 339, 8, 37, "Input",ExpressionUUID->"58d095b6-e5e2-40a6-990a-ede4ca6c1c5b"],
Cell[171997, 4978, 2010, 42, 142, "Input",ExpressionUUID->"fb7e68bf-ffbf-4b07-afb1-c682e1ec0f22"],
Cell[174010, 5022, 1426, 33, 168, "Input",ExpressionUUID->"45da648f-bd4d-4d77-8f98-d461e6af33eb"],
Cell[175439, 5057, 1100, 27, 220, "Input",ExpressionUUID->"c81a04de-5053-4fdb-8765-926d66d5aa6f"],
Cell[176542, 5086, 7611, 195, 1494, "Input",ExpressionUUID->"0638bbd9-e365-4810-9cca-432e93d39f32"],
Cell[184156, 5283, 3674, 86, 623, "Input",ExpressionUUID->"dd6f4633-90a0-4275-8e19-d01855868830"],
Cell[187833, 5371, 3553, 89, 629, "Input",ExpressionUUID->"037d02e6-aa35-4628-92e8-8a4cbf27be8b"],
Cell[191389, 5462, 1703, 45, 188, "Input",ExpressionUUID->"0288c96c-f688-4c73-9231-150d87b0ffaf"],
Cell[193095, 5509, 683, 14, 84, "Input",ExpressionUUID->"cc07390d-6b1b-4646-bd91-f304aa81244a"],
Cell[193781, 5525, 11600, 292, 1687, "Input",ExpressionUUID->"3e2e7b8d-5ebf-4922-96b1-7028cd202689"],
Cell[205384, 5819, 5151, 131, 448, "Input",ExpressionUUID->"720a71e5-0b69-4c2d-aebc-d1b85444a226"],
Cell[210538, 5952, 6079, 163, 396, "Input",ExpressionUUID->"d252d2f6-149d-4228-ac95-bde4316d2de0"],
Cell[216620, 6117, 2361, 59, 214, "Input",ExpressionUUID->"3c4cb1b8-fcbb-4e8e-a542-93eadba29cdc"],
Cell[218984, 6178, 2319, 56, 344, "Input",ExpressionUUID->"fb6fd815-6e1a-4a5b-bf15-e38f61fe224d"],
Cell[221306, 6236, 10212, 274, 656, "Input",ExpressionUUID->"94d07d91-10d7-4b58-994c-471477f43722"],
Cell[231521, 6512, 10760, 278, 1150, "Input",ExpressionUUID->"9922d2b8-d120-4b0b-8b63-7a1e04956b59"],
Cell[242284, 6792, 12213, 314, 1432, "Input",ExpressionUUID->"de064c0b-2f7e-429a-a559-fa4ce3277769"]
}, Closed]],
Cell[CellGroupData[{
Cell[254534, 7111, 136, 3, 65, "Section",ExpressionUUID->"4f434e64-db78-42bd-974f-702d1060937b"],
Cell[254673, 7116, 215, 4, 37, "Input",ExpressionUUID->"e6ee2ce0-feeb-4731-928c-026daec974d8"],
Cell[254891, 7122, 339, 8, 37, "Input",ExpressionUUID->"34b19a21-345e-4878-82c2-fdc5db7c8a7f"],
Cell[255233, 7132, 2054, 42, 142, "Input",ExpressionUUID->"81887a07-96cb-4d21-9e3d-887065dfdece"],
Cell[257290, 7176, 1084, 28, 168, "Input",ExpressionUUID->"95c71336-cb73-4767-b51c-706cc01b35e3"],
Cell[258377, 7206, 209, 4, 37, "Input",ExpressionUUID->"56512aa3-c598-475d-8467-eab2c8a7fc00"],
Cell[258589, 7212, 1416, 36, 90, "Input",ExpressionUUID->"12e4b726-83ab-4548-86f9-73383a574081"],
Cell[260008, 7250, 2791, 75, 324, "Input",ExpressionUUID->"cfe19a41-1b3c-4c04-8ee6-d0fb814e5ec4"],
Cell[262802, 7327, 277, 6, 37, "Input",ExpressionUUID->"96e03bc1-7fe7-4523-9241-77c0b8957d6d"],
Cell[263082, 7335, 3162, 76, 260, "Input",ExpressionUUID->"382933e8-a18a-43b2-9bd5-7cd322f719ba"],
Cell[266247, 7413, 3714, 94, 194, "Input",ExpressionUUID->"3e0ea8d1-c496-4ab2-9b48-2100f0fd1a3c"],
Cell[269964, 7509, 223, 4, 37, "Input",ExpressionUUID->"759b42d4-5a5d-48a8-8f3d-f6255631a3fd"],
Cell[270190, 7515, 4402, 111, 324, "Input",ExpressionUUID->"b6d3d70b-281f-40ca-9d06-9022cedaaae9"],
Cell[274595, 7628, 2190, 53, 194, "Input",ExpressionUUID->"1bb9219a-8c4a-4795-ac91-25e355770c51"],
Cell[276788, 7683, 3371, 89, 220, "Input",ExpressionUUID->"b13b2f38-c952-467d-89a3-8ebfd83d4590"],
Cell[280162, 7774, 3858, 102, 272, "Input",ExpressionUUID->"1cb2d04d-5b93-41dd-910f-7b1f79b34941"],
Cell[284023, 7878, 4076, 107, 402, "Input",ExpressionUUID->"7f4d9f49-59de-4b52-93fb-2963531a2a58"]
}, Closed]],
Cell[CellGroupData[{
Cell[288136, 7990, 135, 3, 65, "Section",ExpressionUUID->"21973bd9-2870-465f-928a-5174622faf9b"],
Cell[288274, 7995, 215, 4, 37, "Input",ExpressionUUID->"7bd62628-134f-44df-ad26-b268d1ea37f0"],
Cell[288492, 8001, 339, 8, 37, "Input",ExpressionUUID->"93bc7d74-96e6-4bf7-a6a2-9cd98ba5dc42"],
Cell[288834, 8011, 1864, 40, 142, "Input",ExpressionUUID->"ab92f4ac-3142-49e7-9ec3-8424356db416"],
Cell[290701, 8053, 1027, 23, 64, "Input",ExpressionUUID->"0f0fc4e3-dfb6-4834-b000-8b711318309d"],
Cell[291731, 8078, 1805, 49, 142, "Input",ExpressionUUID->"2c09420c-adc0-40d7-8fe2-6605a99cd947"],
Cell[293539, 8129, 1355, 39, 142, "Input",ExpressionUUID->"4455a14b-dc84-444d-9c64-628b94338030"],
Cell[294897, 8170, 1344, 39, 168, "Input",ExpressionUUID->"575159dc-85e4-48ba-80a3-c0a122cee928"],
Cell[296244, 8211, 1719, 48, 116, "Input",ExpressionUUID->"c5a7804e-3dd4-4dee-8cc6-54cf9a8017c5"],
Cell[297966, 8261, 1921, 51, 246, "Input",ExpressionUUID->"29f2ab77-a993-4266-9069-ae7c9416be9b"],
Cell[299890, 8314, 1645, 43, 220, "Input",ExpressionUUID->"4aebe6ea-d52a-476c-a84c-de249413bcc1"],
Cell[301538, 8359, 1383, 35, 246, "Input",ExpressionUUID->"d4ba8c28-d5d1-48cd-a2c8-bfbb6fb006db"],
Cell[302924, 8396, 14485, 338, 2872, "Input",ExpressionUUID->"3a7c45d4-f1e8-414c-bdd2-aac1165dcdc1"]
}, Closed]],
Cell[CellGroupData[{
Cell[317446, 8739, 132, 3, 65, "Section",ExpressionUUID->"72f815b2-92e8-409c-8877-47727967fe66"],
Cell[317581, 8744, 149, 3, 37, "Input",ExpressionUUID->"4b72e8c2-0160-440e-80a5-ddbab454ca83"],
Cell[317733, 8749, 339, 8, 37, "Input",ExpressionUUID->"b1d6208d-e706-4f69-955f-fab32850c035"],
Cell[318075, 8759, 1862, 40, 142, "Input",ExpressionUUID->"f6449add-421e-430b-a4f5-074001e539c5"],
Cell[319940, 8801, 1027, 23, 64, "Input",ExpressionUUID->"2f93a02f-5072-47c5-9d08-1ee32c875012"],
Cell[320970, 8826, 1002, 26, 90, "Input",ExpressionUUID->"07421a8f-e067-4a05-b93d-c59daeefef95"],
Cell[321975, 8854, 9213, 238, 1052, "Input",ExpressionUUID->"2bef80d4-5ef3-4b10-a7bb-170fd312b4a6"],
Cell[331191, 9094, 1688, 46, 116, "Input",ExpressionUUID->"11c255cf-0c0a-4d2c-866c-43c4308d6aa1"],
Cell[332882, 9142, 1400, 39, 168, "Input",ExpressionUUID->"7f31c5b5-2247-46eb-92a2-81b3f9080ec8"],
Cell[334285, 9183, 1524, 40, 168, "Input",ExpressionUUID->"4b183f66-06c6-45ad-bd71-195f71608574"],
Cell[335812, 9225, 1611, 42, 246, "Input",ExpressionUUID->"a5f29822-1961-4f0e-831b-9f8af176406e"]
}, Closed]],
Cell[CellGroupData[{
Cell[337460, 9272, 133, 3, 65, "Section",ExpressionUUID->"3a441f08-3e3d-4ee9-8df1-48bee4dea4eb"],
Cell[337596, 9277, 241, 5, 37, "Input",ExpressionUUID->"2c3104c9-1884-4521-ad68-63f2a0fd365c"],
Cell[337840, 9284, 339, 8, 37, "Input",ExpressionUUID->"16569ed3-8654-4c01-aade-36aabd33e66e"],
Cell[338182, 9294, 1910, 40, 142, "Input",ExpressionUUID->"0bf10123-fcfe-4836-a02e-5e528450bf4f"],
Cell[340095, 9336, 1599, 36, 90, "Input",ExpressionUUID->"8e7093f9-b516-42c8-a9be-e4c4ac7696ff"],
Cell[341697, 9374, 1620, 42, 220, "Input",ExpressionUUID->"5a17a0d1-7ec2-4a6e-9714-76caf4bd7d0f"],
Cell[343320, 9418, 934, 17, 90, "Input",ExpressionUUID->"0c8d1477-2b65-41f1-b1b9-7f0e982928c5"],
Cell[344257, 9437, 1204, 32, 168, "Input",ExpressionUUID->"9b077381-d8a6-4f86-8e7f-50c90f388e07"],
Cell[345464, 9471, 2964, 67, 350, "Input",ExpressionUUID->"63401f51-56f1-42cb-ac75-23c0fbe5d378"],
Cell[348431, 9540, 2393, 65, 324, "Input",ExpressionUUID->"302d4994-ac1d-47da-8e55-989ad27c80b4"],
Cell[350827, 9607, 3647, 88, 480, "Input",ExpressionUUID->"9b010e72-103d-4fa7-b565-7edf57e0dc08"],
Cell[354477, 9697, 706, 16, 90, "Input",ExpressionUUID->"801c549f-d3e7-4678-bee2-ad76e7dfc2c8"],
Cell[355186, 9715, 2130, 52, 272, "Input",ExpressionUUID->"223aafce-507b-4087-b6c5-b0395bf3b7ff"]
}, Closed]],
Cell[CellGroupData[{
Cell[357353, 9772, 139, 3, 65, "Section",ExpressionUUID->"6d43ddcd-4ed6-4620-b72b-de6fa980e917"],
Cell[357495, 9777, 216, 4, 37, "Input",ExpressionUUID->"d89d5200-0648-40a9-9593-014a08095b7c"],
Cell[357714, 9783, 339, 8, 37, "Input",ExpressionUUID->"b0f31637-bcb3-403e-bfad-c8ba62fffaeb"],
Cell[358056, 9793, 2150, 46, 168, "Input",ExpressionUUID->"beb7f168-b42d-4416-b21e-add08d9f9ff5"],
Cell[360209, 9841, 1485, 38, 194, "Input",ExpressionUUID->"f474afed-0994-4ca2-ae59-537ae10d7ed5"]
}, Closed]],
Cell[CellGroupData[{
Cell[361731, 9884, 134, 3, 65, "Section",ExpressionUUID->"cde8fab6-703e-4254-b629-56792769bb50"],
Cell[361868, 9889, 215, 4, 37, "Input",ExpressionUUID->"72a93bfa-45e8-420f-91e8-5d40326b626b"],
Cell[362086, 9895, 339, 8, 37, "Input",ExpressionUUID->"4d9229d9-a8d3-4e2c-92c6-71d1d40264cd"],
Cell[362428, 9905, 1866, 40, 142, "Input",ExpressionUUID->"c3423b85-109b-49fa-a3df-675d9709f55c"],
Cell[364297, 9947, 1163, 28, 90, "Input",ExpressionUUID->"1b746896-14c2-41be-b3fb-72002d856eb7"],
Cell[365463, 9977, 1042, 27, 142, "Input",ExpressionUUID->"b3b2dfec-bd60-427e-b9a5-a57e9880b4f6"],
Cell[366508, 10006, 559, 13, 64, "Input",ExpressionUUID->"7f003c0d-2fd8-42a8-88b0-600c7545f1ff"],
Cell[367070, 10021, 1463, 37, 162, "Input",ExpressionUUID->"578c86b3-3cbc-43f5-bd89-cf5b41aaa40b"],
Cell[368536, 10060, 1952, 50, 188, "Input",ExpressionUUID->"5059929b-7685-447e-9b4e-3b423f792d56"],
Cell[370491, 10112, 1104, 29, 84, "Input",ExpressionUUID->"fcae8f4c-011f-473e-a2fe-e61298ac1c3c"],
Cell[371598, 10143, 1475, 36, 162, "Input",ExpressionUUID->"8a5ea691-7218-4a52-94f0-94177c0f9e6c"],
Cell[373076, 10181, 7397, 187, 890, "Input",ExpressionUUID->"d5698ad4-bd08-4cb3-9a76-b08d972559e3"],
Cell[380476, 10370, 6293, 161, 682, "Input",ExpressionUUID->"6db3c419-5581-4db9-851a-42b53a3dcdf0"],
Cell[386772, 10533, 7644, 193, 968, "Input",ExpressionUUID->"f5129bf4-785e-4137-ae20-7fccf0e1612a"],
Cell[394419, 10728, 3942, 99, 500, "Input",ExpressionUUID->"ec58ea81-c598-4a61-a12d-5665b317eca6"],
Cell[398364, 10829, 2652, 72, 345, "Input",ExpressionUUID->"6d0b9f7e-876a-4d1e-8417-687412c924f4"],
Cell[401019, 10903, 3494, 85, 474, "Input",ExpressionUUID->"15a938b3-0a0d-4fea-9149-a3e1cc0ccccc"],
Cell[404516, 10990, 1154, 31, 162, "Input",ExpressionUUID->"47c96443-c209-4100-a538-1174c0df59ad"],
Cell[405673, 11023, 4206, 114, 292, "Input",ExpressionUUID->"1f614b69-53cd-47e0-a77b-c773e4dc8716"],
Cell[409882, 11139, 628, 18, 58, "Input",ExpressionUUID->"c356aa0e-402d-40bd-8115-a52e3d793452"],
Cell[410513, 11159, 12224, 315, 2083, "Input",ExpressionUUID->"c19a0cb6-24fb-4b5e-94fd-548db5daf0b0"],
Cell[422740, 11476, 7572, 186, 864, "Input",ExpressionUUID->"cbe70257-09e2-449b-949d-6d8e6378aee2"],
Cell[430315, 11664, 7752, 190, 864, "Input",ExpressionUUID->"ea3a718b-93dd-4a18-9717-6b43c80bd7cd"],
Cell[438070, 11856, 1025, 27, 58, "Input",ExpressionUUID->"dc686102-e44e-4d86-a0b9-1116a29b43b2"],
Cell[439098, 11885, 5736, 145, 786, "Input",ExpressionUUID->"29094dd7-7a11-410b-8ece-1c02d940451f"],
Cell[444837, 12032, 1437, 36, 188, "Input",ExpressionUUID->"a19926c0-bbe6-4077-95cb-d4a926d41fa3"],
Cell[446277, 12070, 4628, 117, 500, "Input",ExpressionUUID->"23ef9fb9-15b6-4d1c-a063-5c17bb0102f4"],
Cell[450908, 12189, 1056, 26, 116, "Input",ExpressionUUID->"b96fbc69-95b0-4ed0-9306-21ae94444707"]
}, Closed]],
Cell[CellGroupData[{
Cell[452001, 12220, 127, 3, 65, "Section",ExpressionUUID->"867d15c2-15e2-4d7c-beaf-9ebf90f9c2a7"],
Cell[452131, 12225, 215, 4, 37, "Input",ExpressionUUID->"19622898-1a74-4509-8032-c365e84fc15a"],
Cell[452349, 12231, 339, 8, 37, "Input",ExpressionUUID->"46cceb21-4c84-435f-85ad-386f84fcd722"],
Cell[452691, 12241, 1942, 41, 142, "Input",ExpressionUUID->"89025b4e-caba-4fcf-8896-e8a8d2eea821"],
Cell[454636, 12284, 1083, 24, 64, "Input",ExpressionUUID->"1ffd367a-4d31-4be3-897c-78faef1a515d"],
Cell[455722, 12310, 1912, 47, 246, "Input",ExpressionUUID->"07981d69-6089-469f-a400-ba42b8713930"],
Cell[457637, 12359, 1791, 47, 246, "Input",ExpressionUUID->"25c6db30-5738-4326-ac2c-ce9b6721380e"],
Cell[459431, 12408, 1847, 48, 246, "Input",ExpressionUUID->"531dff8a-0605-41ff-98e0-b7e7bf065f7d"],
Cell[461281, 12458, 1845, 48, 246, "Input",ExpressionUUID->"ef75f63b-c525-41bb-90f4-65662ea4c87a"],
Cell[463129, 12508, 2882, 72, 298, "Input",ExpressionUUID->"201b6d1e-ec41-4a2a-bcb4-465366470487"],
Cell[466014, 12582, 1736, 43, 143, "Input",ExpressionUUID->"474c715d-b435-44ec-b46f-c9699293e675"],
Cell[467753, 12627, 1842, 48, 246, "Input",ExpressionUUID->"319f7eda-d92d-4223-a19b-60da24026188"],
Cell[469598, 12677, 2903, 74, 298, "Input",ExpressionUUID->"4389ba29-7b46-4cf1-bb76-21be2313e7c8"],
Cell[472504, 12753, 3175, 80, 350, "Input",ExpressionUUID->"c1b2f46c-fda7-4a13-8c67-b37fba32bf73"],
Cell[475682, 12835, 1931, 48, 246, "Input",ExpressionUUID->"67dd5b89-7890-4289-a545-7e21f56ef574"],
Cell[477616, 12885, 1933, 47, 272, "Input",ExpressionUUID->"7f12cdca-914a-4225-91bf-90b1599fd221"],
Cell[479552, 12934, 2680, 68, 298, "Input",ExpressionUUID->"a21e05e2-fe00-4d3c-8163-568ffaf7bd8e"],
Cell[482235, 13004, 1985, 47, 246, "Input",ExpressionUUID->"c6022f38-d54b-4a4d-921c-e75093dcc7ec"],
Cell[484223, 13053, 1980, 51, 246, "Input",ExpressionUUID->"acd1f56e-a963-4122-8cae-2f5224f3a528"]
}, Closed]],
Cell[CellGroupData[{
Cell[486240, 13109, 159, 3, 65, "Section",ExpressionUUID->"70c7c664-60a6-41f5-8594-88cb33edcaea"],
Cell[486402, 13114, 149, 3, 37, "Input",ExpressionUUID->"f759d010-db1d-4beb-84a5-d81a14edfcdd"],
Cell[486554, 13119, 460, 10, 37, "Input",ExpressionUUID->"9167c540-1ed2-47f1-8e0a-7f475843b6e0"],
Cell[487017, 13131, 2054, 42, 142, "Input",ExpressionUUID->"0236ecf0-0a0d-477b-99d3-9b2b4e96a160"],
Cell[489074, 13175, 1524, 34, 116, "Input",ExpressionUUID->"66c4fee5-1fdd-48be-ad87-b31de6ba5ef0"],
Cell[490601, 13211, 545, 11, 37, "Input",ExpressionUUID->"c169ae17-d6c5-41d5-ae09-23ab741ceaec"],
Cell[491149, 13224, 127892, 3128, 16991, "Input",ExpressionUUID->"b0894a49-bf3f-4533-bf13-f1a578d04ae3"]
}, Closed]],
Cell[CellGroupData[{
Cell[619078, 16357, 160, 3, 65, "Section",ExpressionUUID->"a8617bb6-ddb7-4466-b25a-5e10c2d4d028"],
Cell[619241, 16362, 215, 4, 37, "Input",ExpressionUUID->"30434243-6866-4a09-b7cd-7dc19b6ae0cd"],
Cell[619459, 16368, 339, 8, 37, "Input",ExpressionUUID->"616e66b2-f827-46e2-8212-bdbe51d6a58f"],
Cell[619801, 16378, 1890, 40, 142, "Input",ExpressionUUID->"426e909c-77b1-4f9f-b893-e44b93d370ac"],
Cell[621694, 16420, 925, 19, 64, "Input",ExpressionUUID->"be6d791b-b682-4e25-946d-7a8b738438a7"],
Cell[622622, 16441, 5251, 147, 411, "Input",ExpressionUUID->"7c6b034d-9cd2-49e7-b1f9-bfa037448cfd"],
Cell[627876, 16590, 8915, 224, 688, "Input",ExpressionUUID->"ab84bc1b-aedf-4050-a58e-3d9d8ea45575"],
Cell[636794, 16816, 3047, 76, 212, "Input",ExpressionUUID->"51d7b9c1-9fb7-4b8d-8044-8cb2058c4b27"],
Cell[639844, 16894, 2335, 50, 194, "Input",ExpressionUUID->"2c745b5c-4ba3-445a-ab77-179e7028f8c3"],
Cell[642182, 16946, 5646, 135, 480, "Input",ExpressionUUID->"8add8115-f200-481a-af7e-fbd5146eedba"],
Cell[647831, 17083, 10177, 251, 870, "Input",ExpressionUUID->"1e041e26-de65-417d-b537-14855004dc7c"],
Cell[658011, 17336, 1585, 35, 168, "Input",ExpressionUUID->"038d4056-c78d-4e10-ac4a-aa5ef87e6d40"],
Cell[659599, 17373, 3099, 75, 239, "Input",ExpressionUUID->"63af4e00-5b63-4bbd-a66d-023379aedcf6"],
Cell[662701, 17450, 3876, 90, 298, "Input",ExpressionUUID->"7c6610cc-e429-4cfc-ab21-3c3e69dc2327"],
Cell[666580, 17542, 1875, 41, 168, "Input",ExpressionUUID->"d7ccc5d1-7703-4b92-838b-5241841c25df"],
Cell[668458, 17585, 2354, 55, 168, "Input",ExpressionUUID->"fb413dae-3287-4b3d-a4b7-cc41db7a8cb5"],
Cell[670815, 17642, 2264, 53, 168, "Input",ExpressionUUID->"a29939a8-63b0-455b-9274-a109e4e3dc06"],
Cell[673082, 17697, 2240, 53, 168, "Input",ExpressionUUID->"1451d0d2-f18f-43d4-8282-d349f944ce6d"],
Cell[675325, 17752, 2284, 54, 194, "Input",ExpressionUUID->"ed9cda80-ce67-4e52-85f1-715294f8cbf4"],
Cell[677612, 17808, 2952, 70, 185, "Input",ExpressionUUID->"70473bc0-aa2d-4677-9f07-e48179d1d41f"],
Cell[680567, 17880, 3230, 76, 290, "Input",ExpressionUUID->"741ee58e-5ebe-4f99-a15e-9f4fd5647b4a"],
Cell[683800, 17958, 942, 26, 142, "Input",ExpressionUUID->"7272905b-ec72-4fca-864a-ef1eedcfa039"],
Cell[684745, 17986, 13967, 389, 691, "Input",ExpressionUUID->"b5ca4a67-1dea-4eec-be33-108db1551d28"],
Cell[698715, 18377, 3260, 80, 324, "Input",ExpressionUUID->"68d55122-fe2f-4a46-99eb-1c83ba444ed4"],
Cell[701978, 18459, 6851, 189, 480, "Input",ExpressionUUID->"689a6e68-6032-4bf5-938f-ae44feb6f90e"],
Cell[708832, 18650, 6555, 170, 312, "Input",ExpressionUUID->"349ed783-a7ab-475d-9439-b06befe63255"],
Cell[715390, 18822, 5056, 131, 376, "Input",ExpressionUUID->"678a39b3-e601-4bf7-ac16-5a33ef960d6f"],
Cell[720449, 18955, 6591, 169, 312, "Input",ExpressionUUID->"51e4d03d-b791-4125-8659-77c4bfa1681f"],
Cell[727043, 19126, 3385, 82, 272, "Input",ExpressionUUID->"734916cf-dfbe-4883-8dd9-11fa3e75b66e"],
Cell[730431, 19210, 3756, 95, 298, "Input",ExpressionUUID->"702c0af1-4d05-4d41-96de-47a6c79b2a77"],
Cell[734190, 19307, 5155, 129, 402, "Input",ExpressionUUID->"f420e2f4-bce3-4a0e-8405-832bb5c79f18"],
Cell[739348, 19438, 7737, 206, 338, "Input",ExpressionUUID->"65f3b784-cca1-40d5-878f-0a705ef3a602"],
Cell[747088, 19646, 7524, 196, 399, "Input",ExpressionUUID->"6669e5cf-b62b-4fa1-a421-89169441729e"],
Cell[754615, 19844, 12709, 361, 532, "Input",ExpressionUUID->"c793e294-fcce-4f4b-9d1a-7602938e1e2c"],
Cell[767327, 20207, 30070, 909, 1286, "Input",ExpressionUUID->"15766eac-046f-4351-9e5f-f1f1050fde05"],
Cell[797400, 21118, 16804, 468, 766, "Input",ExpressionUUID->"bacf6274-9611-4720-b4c5-d348d711f3e8"],
Cell[814207, 21588, 1848, 46, 220, "Input",ExpressionUUID->"53fec7a5-f7fc-43c3-9da7-a28225e3d93a"]
}, Closed]],
Cell[CellGroupData[{
Cell[816092, 21639, 179, 4, 65, "Section",ExpressionUUID->"ceab56be-f97e-4ecb-b7f0-b407b2cbf947"],
Cell[816274, 21645, 291, 6, 37, "Input",ExpressionUUID->"96f5f62c-b8d4-45ac-af0e-8025fbadeda5"],
Cell[816568, 21653, 407, 9, 37, "Input",ExpressionUUID->"6d4b1699-144d-4208-a0cd-a3471905027e"],
Cell[816978, 21664, 1959, 41, 142, "Input",ExpressionUUID->"00c0f14f-18cc-4515-8f0c-81c0aa91f74f"],
Cell[818940, 21707, 1720, 38, 90, "Input",ExpressionUUID->"65cf6e79-9ee8-4100-bf55-e65cbbf1ec77"],
Cell[820663, 21747, 1492, 38, 220, "Input",ExpressionUUID->"1554e485-55db-4e2a-83a5-d4f1856c4d15"],
Cell[822158, 21787, 225, 4, 37, "Input",ExpressionUUID->"fd265de4-bf65-49e6-8791-435f1837204d"],
Cell[822386, 21793, 10156, 273, 1104, "Input",ExpressionUUID->"cf2ad01f-550b-409d-94f8-77bcda42031c"],
Cell[CellGroupData[{
Cell[832567, 22070, 56525, 1275, 5342, "Input",ExpressionUUID->"4bf7ea26-9f3f-4ffc-acd5-d25f098ffc4c"],
Cell[889095, 23347, 598, 12, 57, "Message",ExpressionUUID->"7be14e19-2dd9-479b-be3a-cf9342ad6c33"],
Cell[889696, 23361, 596, 12, 57, "Message",ExpressionUUID->"d82733b1-109f-4fa2-a7b7-c03e0bd84169"],
Cell[890295, 23375, 598, 12, 57, "Message",ExpressionUUID->"5ea534b6-ed2d-4ff0-9798-c063b24d45cd"],
Cell[890896, 23389, 453, 10, 35, "Message",ExpressionUUID->"c91d66ed-93b4-4014-a932-44d4abb34169"]
}, Open  ]],
Cell[CellGroupData[{
Cell[891386, 23404, 1819, 46, 376, "Input",ExpressionUUID->"ba597ba3-ffcc-4762-995b-86d197d691d2"],
Cell[893208, 23452, 152, 2, 42, "Output",ExpressionUUID->"8ae041fa-f886-4a7f-a110-ced7ec9296ec"]
}, Open  ]],
Cell[893375, 23457, 217, 3, 37, "Input",ExpressionUUID->"d4925b18-5246-43b6-8a36-15af46f4577e"],
Cell[893595, 23462, 2339, 53, 636, "Input",ExpressionUUID->"47b59852-4d1b-49a3-90f9-542bfd3cb52d"],
Cell[CellGroupData[{
Cell[895959, 23519, 7607, 189, 1020, "Input",ExpressionUUID->"15753eef-6c59-4fe7-ad3c-0f279721598a"],
Cell[903569, 23710, 152, 2, 42, "Output",ExpressionUUID->"d42c5d44-f7a3-4e07-8a31-9269a79bb4d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[903758, 23717, 6666, 170, 971, "Input",ExpressionUUID->"e839da32-fab7-4d5f-9086-e343852b181a"],
Cell[910427, 23889, 152, 2, 42, "Output",ExpressionUUID->"f527af2c-d79a-4bd7-a224-3de678341e3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[910616, 23896, 6499, 164, 971, "Input",ExpressionUUID->"976ca983-fece-463e-9449-d6dc6bec921f"],
Cell[917118, 24062, 152, 2, 42, "Output",ExpressionUUID->"9fa0bb90-a28a-46eb-975a-737432553882"]
}, Open  ]],
Cell[CellGroupData[{
Cell[917307, 24069, 3254, 74, 425, "Input",ExpressionUUID->"bc496665-b4bc-496d-9caa-deadbee370bf"],
Cell[920564, 24145, 154, 2, 42, "Output",ExpressionUUID->"1be44d74-be1b-4934-bf76-42d88ec254aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[920755, 24152, 2654, 65, 425, "Input",ExpressionUUID->"7cf7a32b-94e1-4328-84f9-edb6c12084d9"],
Cell[923412, 24219, 154, 2, 42, "Output",ExpressionUUID->"f2e35bfa-1f68-4dd9-a3a9-bced986ecbd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[923603, 24226, 2586, 65, 425, "Input",ExpressionUUID->"06828b4b-2674-448e-804b-0ccd7f916182"],
Cell[926192, 24293, 152, 2, 42, "Output",ExpressionUUID->"310fc20d-acc5-425c-90b6-af673119f701"]
}, Open  ]],
Cell[CellGroupData[{
Cell[926381, 24300, 5833, 152, 724, "Input",ExpressionUUID->"56e6c309-3743-4443-a3af-49d76fcef49e"],
Cell[932217, 24454, 152, 2, 42, "Output",ExpressionUUID->"a5adf389-2b6a-405e-a397-512ace7844f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[932406, 24461, 4961, 123, 633, "Input",ExpressionUUID->"cb5cbc2c-d564-4255-87b6-71a2ff5bde36"],
Cell[937370, 24586, 154, 2, 42, "Output",ExpressionUUID->"3eae02bd-da92-4b31-8f33-9b50ad5a9cb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[937561, 24593, 5654, 143, 685, "Input",ExpressionUUID->"ba58d702-c5ea-4b8f-8a0d-af0a4189858c"],
Cell[943218, 24738, 152, 2, 42, "Output",ExpressionUUID->"d8491f11-9d06-47c8-b2a8-b9bce20817db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[943407, 24745, 5293, 135, 659, "Input",ExpressionUUID->"e5c8c32b-e7e0-4548-b6b1-7d7671fea92f"],
Cell[948703, 24882, 156, 3, 42, "Output",ExpressionUUID->"a15d6512-5097-4674-a981-9c0fcada3ab3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[948896, 24890, 5282, 134, 659, "Input",ExpressionUUID->"6aa7b708-57be-45bb-91b1-65d58e1afa89"],
Cell[954181, 25026, 156, 3, 42, "Output",ExpressionUUID->"6ff163d0-2d84-49a5-b56f-9c431d3f9b5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[954374, 25034, 2940, 69, 347, "Input",ExpressionUUID->"fc2d65e2-1914-4534-a73b-992f011e410a"],
Cell[957317, 25105, 156, 3, 42, "Output",ExpressionUUID->"ef029f64-670f-45f0-8f02-e7c385baa464"]
}, Open  ]],
Cell[CellGroupData[{
Cell[957510, 25113, 3062, 78, 408, "Input",ExpressionUUID->"2649fff4-e91f-4af8-8407-e5da21abc3b0"],
Cell[960575, 25193, 156, 3, 62, "Output",ExpressionUUID->"eaff3bec-226a-4f3b-8896-7628819f57b3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[960780, 25202, 191, 3, 65, "Section",ExpressionUUID->"8dd176dd-6099-4f24-8361-5a51d8cca43f"],
Cell[960974, 25207, 149, 3, 37, "Input",ExpressionUUID->"c73d7a34-3093-49d1-9ec9-5dc227d4d7c9"],
Cell[961126, 25212, 460, 10, 37, "Input",ExpressionUUID->"fc26a6cc-e50f-40cc-a992-11cd33680359"],
Cell[961589, 25224, 2054, 42, 142, "Input",ExpressionUUID->"ede85fcf-d7f2-4d4a-a321-7baf7b3c2210"],
Cell[963646, 25268, 1555, 34, 142, "Input",ExpressionUUID->"d93a6300-9ab0-44e1-9a4c-2a0422adbaee"],
Cell[965204, 25304, 593, 12, 37, "Input",ExpressionUUID->"53248738-0bd2-4602-b9c5-151f7323beea"],
Cell[965800, 25318, 21996, 570, 2742, "Input",ExpressionUUID->"91c51dcf-975f-4acc-9490-9e2d22e5d1ef"]
}, Closed]],
Cell[987811, 25891, 262, 6, 31, "Input",ExpressionUUID->"c744d157-d805-4ab4-bea7-1161d5775e16"]
}
]
*)

