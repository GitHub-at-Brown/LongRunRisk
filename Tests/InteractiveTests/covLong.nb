(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    342439,       9244]
NotebookOptionsPosition[    317896,       8759]
NotebookOutlinePosition[    334397,       9101]
CellTagsIndexPosition[    334354,       9098]
WindowTitle->Automatic
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Load", "Section",
 CellChangeTimes->{{3.895715698844183*^9, 3.895715700449379*^9}},
 CellID->1569917085,ExpressionUUID->"61a2a9a5-6e2f-403b-95f1-35de97157c46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelShortName", "=", "\"\<NRCStochVol\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"filenameModels", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729862870124*^9}, 3.8957309499046583`*^9, 3.89574066689703*^9, {
   3.895741404896933*^9, 3.895741413505719*^9}, {3.895746033224846*^9, 
   3.895746033564424*^9}, {3.895761720317889*^9, 3.895761720603722*^9}, {
   3.9082045986811857`*^9, 3.908204600399857*^9}, 3.9082200397158957`*^9},
 CellLabel->"In[1]:=",
 CellID->733614014,ExpressionUUID->"27c686eb-a1eb-415c-806c-8ebb2b92ca61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLongFilename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{
      "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<.wl\>\""}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLongFilenameSave", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
       RowBox[{
       "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<Save.wl\>\""}]}],
       "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{"\"\<CreateMomentsDatabase\>\"", "<>", "\"\<.wl\>\""}]}], "}"}], 
   "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeUnconditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], 
    "}"}], "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeConditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], "}"}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Parameters`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Shocks`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"PrependTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"PrependTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729862870124*^9}, 3.8957309499046583`*^9, 3.89574066689703*^9, {
   3.895741404896933*^9, 3.895741413505719*^9}, {3.895746033224846*^9, 
   3.895746033564424*^9}, {3.895761720317889*^9, 3.895761720603722*^9}, {
   3.9082045986811857`*^9, 3.908204600399857*^9}, 3.9082200397158957`*^9},
 CellLabel->"In[6]:=",
 CellID->2078682862,ExpressionUUID->"cb79919f-49cf-462d-a200-b3bf07f388e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataModels", "=", 
   RowBox[{"Get", "[", "filenameModels", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "dataModels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`Models", "[", "modelShortName", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895741485834608*^9, 3.895741488514476*^9}, {
  3.8958166137874327`*^9, 3.895816646552721*^9}},
 CellLabel->"In[17]:=",
 CellID->2074660696,ExpressionUUID->"96d943bb-6732-45f0-ae4b-0265036585cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataCovLong", "=", 
   RowBox[{"Get", "[", "covLongFilename", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "dataCovLong"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895741506174138*^9, 3.895741507626904*^9}, {
  3.895816649129527*^9, 3.8958166561438293`*^9}},
 CellLabel->"In[20]:=",
 CellID->1712451525,ExpressionUUID->"aa531f0f-c536-4eb1-9076-eb9eac1542d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DownValues", "[", 
  "\"\<FernandoDuarte`LongRunRisk`covLongNRCStochVol\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.908568009419284*^9, 3.908568030020503*^9}, {
  3.908710867074152*^9, 3.908710889507162*^9}},
 CellLabel->"In[27]:=",
 CellID->45429000,ExpressionUUID->"36fb5d7d-b42b-46db-b134-7023d5596133"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
           RowBox[{"HoldPattern", "[", 
             RowBox[{"FernandoDuarte`LongRunRisk`covLongNRCStochVol", "[", 
               RowBox[{"dc", ",", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"rhocp", " ", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox["Esp", "2"], " ", 
                    SuperscriptBox["phipbarpb", "2"], " ", "rhocp", " ", 
                    SuperscriptBox["rhopbar", "2"], " ", 
                    SuperscriptBox["rhoppbar", "2"]}], 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["rhopbar", "2"]}]]}], "+", 
                 RowBox[{"phicp", " ", "xip"}]}], ")"}]}]}], ",", 
         TemplateBox[{"6447"}, "OutputSizeLimit`Skeleton"], ",", 
         RowBox[{
           RowBox[{"HoldPattern", "[", 
             RowBox[{"FernandoDuarte`LongRunRisk`covLongNRCStochVol", "[", 
               RowBox[{
                 RowBox[{"eps", "[", "\"sp\"", "]"}], ",", "nomrf", ",", 
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`\
CreateMomentsDatabase`Private`q$_Integer", ",", 
                 "FernandoDuarte`LongRunRisk`ComputationalEngine`\
CreateMomentsDatabase`Private`n$_Integer"}], "]"}], "]"}], "\[RuleDelayed]", 
           RowBox[{"FernandoDuarte`LongRunRisk`covLongNRCStochVol", "[", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "]"}]}]}], "}"}],
      Short[#, 8]& ], "line" -> 27, "sessionID" -> 24989975608892934629, 
   "byteCount" -> 44138528, "size" -> 8, "stored" -> False, "expr" -> 
   Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.908710855725802*^9, 3.908710890755986*^9}},
 CellLabel->"Out[27]=",
 CellID->1734972790,ExpressionUUID->"f6e2b70d-50f5-4ead-8e50-c2dfa5e8bb1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Names", "[", "\"\<FernandoDuarte`LongRunRisk`*\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8958167018748913`*^9, 3.8958167078976183`*^9}},
 CellLabel->"In[24]:=",
 CellID->1404874192,ExpressionUUID->"7998b3f8-a765-426c-9a43-8825cbf1061a"],

Cell[BoxData[
 RowBox[{"{", "\<\"Global`next\"\>", "}"}]], "Output",
 CellChangeTimes->{3.908701692218322*^9, 3.908710877758304*^9},
 CellLabel->"Out[24]=",
 CellID->1842216980,ExpressionUUID->"aa83f0e0-1071-4d25-af49-8dcee425f7b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"FernandoDuarte`LongRunRisk`covLongNRCStochVol\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Epd0\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Ewc0\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`FindRootOptions\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Models\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`RecurrenceTableOptions\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.908701692218322*^9, 3.908710877765716*^9},
 CellLabel->"Out[25]=",
 CellID->1869044061,ExpressionUUID->"89f48b4b-10e7-40ca-8931-5f696a483103"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv", "=", 
   RowBox[{
   "DownValues", "@", "FernandoDuarte`LongRunRisk`covLongNRCStochVol"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9082057244458227`*^9, 3.90820572694166*^9}},
 CellLabel->"In[28]:=",
 CellID->56683262,ExpressionUUID->"2b23cb50-00da-45b8-a52a-bc8c4b074449"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"#", ",", "FindSequenceFunction"}], "]"}], "]"}], "&"}], "/@", 
    "dv"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posF", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"hasF", ",", "True"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908205730421935*^9, 3.908205735382915*^9}, {
  3.908205769177747*^9, 3.908205857006237*^9}, {3.908205891909947*^9, 
  3.908205903235866*^9}, {3.908206113434532*^9, 3.908206118117119*^9}, {
  3.9082089611679573`*^9, 3.908208969028214*^9}, {3.908209160749939*^9, 
  3.908209163638774*^9}},
 CellLabel->"In[30]:=",
 CellID->132995452,ExpressionUUID->"a0a3f1a9-f0eb-4d3a-a62b-88890394cde5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Values", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dv", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"key", "=", 
   RowBox[{"Keys", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dv", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posF"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9082064787625647`*^9, 3.908206479926114*^9}, {
  3.9082077408349733`*^9, 3.908207743426217*^9}, {3.9082081439765873`*^9, 
  3.9082081513731003`*^9}, {3.9082091689212933`*^9, 3.908209171061174*^9}},
 CellLabel->"In[32]:=",
 CellID->1587735617,ExpressionUUID->"7c8ef76c-f32b-40d4-a6ef-4961d6f60d0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"#", ",", "FindSequenceFunction"}], "]"}], "]"}], "&"}], "/@", 
    "val"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posFF", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"hasFF", ",", "True"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908209050908308*^9, 3.9082090551014833`*^9}, {
  3.908209185141099*^9, 3.9082091905518293`*^9}},
 CellLabel->"In[34]:=",
 CellID->539510809,ExpressionUUID->"e80921b6-f693-4b7d-88bd-1332686e60c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"val", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posFF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keyFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"key", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posFF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.908209097712267*^9, {3.908209195918708*^9, 3.908209233503007*^9}},
 CellLabel->"In[36]:=",
 CellID->974302512,ExpressionUUID->"c4852883-f0ba-46cd-a81b-13b004200519"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "valFF", " ", "and", " ", "keyFF", " ", "are", " ", "empty", " ", "if", 
    " ", "FindSequenceFunction", " ", "not", " ", "found", " ", "in", " ", 
    "downvalues"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{
       "DownValues", "@", "FernandoDuarte`LongRunRisk`covLongNRCStochVol"}], 
       "]"}], ">", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"valFF", ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"keyFF", ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9087107772134047`*^9, 3.908710835712017*^9}, {
  3.908710941804006*^9, 3.908710950742898*^9}},
 CellLabel->"In[39]:=",
 CellID->711996362,ExpressionUUID->"3d283022-894a-4630-a262-f98da98baf9e"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.908710935263072*^9, 3.90871095334208*^9}},
 CellLabel->"Out[39]=",
 CellID->108005672,ExpressionUUID->"e682eab7-093b-4a6c-94a4-e313f7c52f45"]
}, Open  ]],

Cell["Test moments computed using covLong", "Section",
 CellChangeTimes->{{3.8882416316078577`*^9, 3.888241636927971*^9}, {
  3.888476235734561*^9, 3.888476239568863*^9}},
 CellID->1245172077,ExpressionUUID->"a766fa8e-3cd4-492a-a3c8-aaa5cda85d93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "=", 
   RowBox[{"Symbol", "[", 
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`covLong\>\"", "<>", "modelShortName"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondE", "[", "x_", "]"}], ":=", 
   RowBox[{"uncondE", "[", 
    RowBox[{"x", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVar", "[", "x_", "]"}], ":=", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"x", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{"x", ",", "y", ",", "model"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toExogenous", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"fun", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondVarLongExo", "[", 
   RowBox[{"toExogenous", ",", "x", ",", "fun"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCovLong", "[", 
    RowBox[{"x_", ",", "y_", ",", 
     RowBox[{"fun", ":", "covLong"}]}], "]"}], ":=", 
   RowBox[{"uncondCovLongExo", "[", 
    RowBox[{"toExogenous", ",", "x", ",", "y", ",", "fun"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`CreateEulerEq`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bondRecursion", " ", "=", " ", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateEulerEq`\
findBondRecursion", "[", 
    RowBox[{"t", ",", "n", ",", "model"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"systemEqBond", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"bondRecursion", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"bondRecursion", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}], "]"}], "/.", 
    RowBox[{"Ewc", "->", 
     RowBox[{"uncondE", "[", 
      RowBox[{"wc", "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"systemEqNomBond", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "]"}], "]"}], "/.", 
     RowBox[{"Ewc", "->", 
      RowBox[{"uncondE", "[", 
       RowBox[{"wc", "[", "t", "]"}], "]"}]}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "convenience", " ", "variable", " ", "to", " ", "convert", " ", "bond", 
    " ", "coefficients", " ", "into", " ", "wc", " ", "coefficients"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"systemEqBond", "/.", 
       RowBox[{"n", "->", "1"}]}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"Equal", "->", "Rule"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"systemEqBond", "/.", 
       RowBox[{"n", "->", "1"}]}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toA", " ", "=", 
    RowBox[{"Join", "[", " ", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Symbol", "/@", 
         RowBox[{
         "Names", "[", 
          "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
CreateMomentsDatabase`Private`n*\>\"", "]"}]}], "->", "1"}], "]"}], ",", 
      "toA"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Time", " ", "Aggregated", " ", "Processes"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Conssumption", " ", "and", " ", "Dividend", " ", "Growth"}], " ", 
   "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "/", "h"}], ")"}], " ", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", 
         RowBox[{"2", "h"}], "+", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2", ",", "h"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j", "+", "1"}], ")"}], "/", "h"}], ")"}], " ", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "h", "+", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ddagApproxeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "/", "h"}], ")"}], " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", 
           RowBox[{"2", "h"}], "+", "j"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "h"}], "}"}]}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"h", "-", "j", "+", "1"}], ")"}], "/", "h"}], ")"}], " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"wealth", "-", 
    RowBox[{"consumption", " ", "and", " ", "price"}], "-", 
    RowBox[{"dividend", " ", "ratios"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"avepsC", "[", "h_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"0.0015", "*", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{"0.0015", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"h", "-", "k"}]}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}], " ", "/", "  ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"epsC", "[", 
     RowBox[{"h_", ",", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Sum", "[", 
          RowBox[{"0.0015", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", 
         RowBox[{"h", "-", "k", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"aveps", "[", 
    RowBox[{"h_", ",", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", "+", " ", 
    
    RowBox[{
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{"0.0015", "*", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", " ", 
             RowBox[{"0.0015", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"12", "-", "k"}]}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}], " ", "/", "  ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps", "[", 
    RowBox[{"h_", ",", "k_", ",", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"Sum", "[", 
         RowBox[{"0.0015", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "1", ",", 
        RowBox[{"12", "-", "k", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pdAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], "   ", "-", " ", 
     RowBox[{"aveps", "[", 
      RowBox[{"12", ",", "i"}], "]"}], "  ", "+", " ", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", 
         RowBox[{"12", ",", "q", ",", "i"}], "]"}], " ", "*", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "q"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "0", ",", 
         RowBox[{"12", "-", "2"}]}], "}"}]}], "]"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wcAGeq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"wc", "[", "t", "]"}], "   ", "-", " ", 
     RowBox[{"aveps", "[", "h", "]"}], "  ", "+", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", 
         RowBox[{"h", ",", "q"}], "]"}], " ", "*", " ", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", " ", "q"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "0", ",", 
         RowBox[{"h", "-", "2"}]}], "}"}]}], "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
    "Time", " ", "Aggregation", " ", "Formulae", " ", "for", " ", "any", " ", 
     "variables", " ", "that", " ", "are", " ", "just", " ", "summed", " ", 
     RowBox[{"(", 
      RowBox[{"Annual", " ", "=", " ", 
       RowBox[{"Sum", 
        RowBox[{"(", 
         RowBox[{"monthly", " ", "variables"}], ")"}]}]}], ")"}], " ", "such",
      " ", "as", " ", "rf", " ", "or", " ", "ret"}], ")"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", "Returns", " ", "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"retcageq", "[", 
    RowBox[{"t_", ",", "h_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"retc", "[", 
      RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"retageq", "[", 
    RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rfageq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"rf", "[", 
       RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"excreteq", "[", 
    RowBox[{"t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ret", "[", 
     RowBox[{"t", ",", "i"}], "]"}], "-", 
    RowBox[{"bondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"excretageq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"excreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"piageq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bondretAGeq", "[", 
    RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"bondret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"excbondreteq", "[", 
    RowBox[{"t_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"bondret", "[", 
     RowBox[{"t", ",", "n"}], "]"}], " ", "-", " ", 
    RowBox[{"bondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"excbondretAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"excbondreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nomBondretAGeq", "[", 
    RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"nombondret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nomExcbondreteq", "[", 
    RowBox[{"t_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"nombondret", "[", 
     RowBox[{"t", ",", "n"}], "]"}], " ", "-", " ", 
    RowBox[{"nombondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nomExcbondretAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"nomExcbondreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", "Variance", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"h", "*", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"x", "[", "t", "]"}], "]"}]}], "+", " ", 
    RowBox[{"2", "*", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "j"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarAGieq", "[", 
     RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"h", "*", 
      RowBox[{"uncondVar", "[", 
       RowBox[{"x", "[", 
        RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "+", " ", 
     RowBox[{"2", "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", ",", "i"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"t", "+", "j"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";"}], "\n", "\n", 
  
  RowBox[{"(*", " ", "Correlations", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCovarAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"h", "*", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"t", "+", "h"}], "]"}]}], "]"}]}], "+", " ", 
    RowBox[{"2", "*", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "h", "+", "j"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovarAGieq", "[", 
     RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"h", "*", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"t", ",", "i"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{
          RowBox[{"t", "+", "h"}], ",", "i"}], "]"}]}], "]"}]}], "+", " ", 
     RowBox[{"2", "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", ",", "i"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"t", "+", "h", "+", "j"}], ",", "i"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], " ", ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCorrAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"uncondCovarAGeq", "[", 
     RowBox[{"x", ",", "t", ",", "h"}], "]"}], "/", 
    RowBox[{"uncondVarAGeq", "[", 
     RowBox[{"x", ",", "t", ",", "h"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCorrAGieq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"uncondCovarAGieq", "[", 
     RowBox[{"x", ",", "t", ",", "h", ",", "i"}], "]"}], "/", 
    RowBox[{"uncondVarAGieq", "[", 
     RowBox[{"x", ",", "t", ",", "h", ",", "i"}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8958168210104513`*^9, 3.89581682762383*^9}, {
   3.8958173702555733`*^9, 3.895817468444346*^9}, {3.895817531539584*^9, 
   3.895817628511847*^9}, {3.895817691797708*^9, 3.895817697322554*^9}, {
   3.895826878420919*^9, 3.895826884309168*^9}, 3.9087109587895107`*^9},
 CellID->86110327,ExpressionUUID->"8e46033a-47e2-4014-932f-72f4a9ac8c26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", "t", "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", "t", "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "3"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", "t", "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"aa", " ", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{"bb", " ", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"aa", " ", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "+", 
       RowBox[{"bb", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.8957546278413677`*^9, 
   3.8957546760990753`*^9}, {3.895754771434485*^9, 3.895754785380404*^9}, {
   3.8958167756216*^9, 3.895816783041016*^9}},
 CellLabel->"In[61]:=",
 CellID->1319307510,ExpressionUUID->"4789936a-5c37-4d9e-bb8b-8eafa33f338e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390072508*^9},
 CellLabel->"Out[61]=",
 CellID->87860823,ExpressionUUID->"681c0703-2fa9-45d1-8bf3-9913a3eb2368"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390114274*^9},
 CellLabel->"Out[62]=",
 CellID->1355586672,ExpressionUUID->"23ca6209-fac2-495b-9d82-16a7f6281c0a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390156558*^9},
 CellLabel->"Out[63]=",
 CellID->691185281,ExpressionUUID->"487c89a0-fda2-48f5-9f37-1b94a8a3f968"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390197515*^9},
 CellLabel->"Out[64]=",
 CellID->1011971144,ExpressionUUID->"fa2aa0de-78a2-46f4-8993-420cf32c2aea"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390346648*^9},
 CellLabel->"Out[65]=",
 CellID->128532968,ExpressionUUID->"aa42ed08-812b-4552-aab8-e0f054e64212"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.90870639050082*^9},
 CellLabel->"Out[66]=",
 CellID->2032527941,ExpressionUUID->"0b138d99-3aec-4598-94b7-5fb1b0d5087d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390542818*^9},
 CellLabel->"Out[67]=",
 CellID->674731558,ExpressionUUID->"41333a27-aba1-4a05-b8d8-cf749f5745e6"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9087063905848*^9},
 CellLabel->"Out[68]=",
 CellID->1499639146,ExpressionUUID->"36a45c1d-9233-48fd-b454-4555ebec08c2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390626836*^9},
 CellLabel->"Out[69]=",
 CellID->1567045630,ExpressionUUID->"2b2b6512-ae13-4034-8af7-81617974bae9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9087063906679707`*^9},
 CellLabel->"Out[70]=",
 CellID->596456602,ExpressionUUID->"881ce572-b1f1-4cfc-a88c-de52f4b8d5dc"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9087063908205976`*^9},
 CellLabel->"Out[71]=",
 CellID->192445618,ExpressionUUID->"6236c9fc-9d31-423a-9691-ce6fadcbe5b4"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706390972063*^9},
 CellLabel->"Out[72]=",
 CellID->323129344,ExpressionUUID->"3e7aab08-baab-40d6-8fef-91243c72b6bc"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706391715513*^9},
 CellLabel->"Out[73]=",
 CellID->1996224992,ExpressionUUID->"075f64dd-3720-4275-8c42-87ca93a77f5b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9087063925256968`*^9},
 CellLabel->"Out[74]=",
 CellID->416423463,ExpressionUUID->"564c9fd6-e5dd-4d5a-bea1-618a6574a64a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dc3", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc3", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc3", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc4", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc4", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc4", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc5", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc5", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5fw", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{"dc5lag", "+", "dc5fw"}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dc5lag", "+", "dc5fw"}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc12", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "12"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc12", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc12", "]"}]}], "//", "Simplify"}], "\n", 
 RowBox[{
  RowBox[{"dc12lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc12lag", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc12lag", "]"}]}], "//", "Simplify"}], "\n", 
 RowBox[{
  RowBox[{"dc12fw", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc12fw", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc12fw", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"4", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"4", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"k2", " ", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd3", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd3", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd3", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd4", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "4", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd4", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd4", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "5", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd5", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd5", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5lag", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "5", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5fw", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "5", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{"dd5lag", "+", "dd5fw"}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dd5lag", "+", "dd5fw"}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "12", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12lag", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "12", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12lag", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12fw", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "12", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12fw", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12fw", "]"}]}], "//", "Simplify"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], " ", "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "0", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "1", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "2", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "3", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "x", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
   "Simplify"}], "\n", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "0", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "1", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "2", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "3", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "sx", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
   "Simplify"}], "\n", 
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\n", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\n", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                  RowBox[{
                   RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                   RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                RowBox[{
                 RowBox[{"Simplify", "\[IndentingNewLine]", 
                  RowBox[{"covLong", "[", 
                   RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                 RowBox[{"uncondCov", "[", 
                  RowBox[{
                   RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", " ", 
                   RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                  "]"}]}]}], "//", "Expand"}], "//", 
              RowBox[{
               RowBox[{"Simplify", "\[IndentingNewLine]", 
                RowBox[{"covLong", "[", 
                 RowBox[{"ret", ",", "eps", ",", "0"}], "]"}]}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", " ", 
                 RowBox[{
                  SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                "]"}]}]}], "//", "Expand"}], "//", 
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"ret", ",", "eps", ",", "1"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", " ", 
               RowBox[{
                SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
              "]"}]}]}], "//", "Expand"}], "//", 
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"ret", ",", "eps", ",", "2"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", " ", 
             RowBox[{
              SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
            "]"}]}]}], "//", "Expand"}], "//", 
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"ret", ",", "eps", ",", "3"}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", " ", 
           RowBox[{
            SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
          "]"}]}]}], "//", "Expand"}], "//", 
      RowBox[{
       RowBox[{"Simplify", "\[IndentingNewLine]", 
        RowBox[{"covLong", "[", 
         RowBox[{"ret", ",", "eps", ",", "4"}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}]}]}], 
     "//", "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", "\n", 
   "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}]}], "Input",\

 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.8957546278413677`*^9, 
   3.8957546760990753`*^9}, {3.895754771434485*^9, 3.895754785380404*^9}, 
   3.8958167756216*^9},
 CellLabel->"In[75]:=",
 CellID->537762824,ExpressionUUID->"304f2442-f638-4eb6-aa14-52471393d424"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.908706396044415*^9},
 CellLabel->"Out[76]=",
 CellID->2096198871,ExpressionUUID->"5e4ed45f-7d2a-4f51-9267-91ec747d8d18"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9087064010042763`*^9},
 CellLabel->"Out[78]=",
 CellID->1345195862,ExpressionUUID->"32806328-aaa9-406c-9028-afdf7dfb5c00"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.90870642074657*^9},
 CellLabel->"Out[80]=",
 CellID->2146500665,ExpressionUUID->"5f3ae8ed-243e-42a1-b3c4-c55fe8590e0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "4"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], " ", "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "3"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "2"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "1"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "0"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "1"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "2"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "3"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "4"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "4"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "3"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "2"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "1"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "0"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "1"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "2"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "3"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "4"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "pd", ",", 
                 RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"pd", "[", 
                  RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"br", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                  RowBox[{"n", "->", "1"}]}], "/.", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
                RowBox[{"Equal", "->", "Rule"}]}], ")"}]}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"Simplify", "\[IndentingNewLine]", 
                RowBox[{"covLong", "[", 
                 RowBox[{"retrf", ",", "pd", ",", 
                  RowBox[{"-", "3"}], ",", "i"}], "]"}]}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"pd", "[", 
                  RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"br", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                  RowBox[{"n", "->", "1"}]}], "/.", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
                RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{"Simplify", "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "pd", ",", 
                 RowBox[{"-", "2"}], ",", "i"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}]}], ",", 
                RowBox[{"pd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"br", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                 RowBox[{"n", "->", "1"}]}], "/.", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
               RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"retrf", ",", "pd", ",", 
                RowBox[{"-", "1"}], ",", "i"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "1"}], "]"}]}], ",", 
               RowBox[{"pd", "[", 
                RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"br", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                RowBox[{"n", "->", "1"}]}], "/.", 
               RowBox[{
                RowBox[{
                 SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
              RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "\[IndentingNewLine]", 
             RowBox[{"covLong", "[", 
              RowBox[{"retrf", ",", "pd", ",", "0", ",", "i"}], "]"}]}], "-", 
            
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "1"}], "]"}]}], ",", 
              RowBox[{"pd", "[", 
               RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"br", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", 
                  RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
               RowBox[{"n", "->", "1"}]}], "/.", 
              RowBox[{
               RowBox[{
                SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
             
             RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"retrf", ",", "pd", ",", "1", ",", "i"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{
                RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "+", "1"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"br", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
              RowBox[{"n", "->", "1"}]}], "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
            RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "\[IndentingNewLine]", 
           RowBox[{"covLong", "[", 
            RowBox[{"retrf", ",", "pd", ",", "2", ",", "i"}], "]"}]}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "1"}], "]"}]}], ",", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"br", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
             RowBox[{"n", "->", "1"}]}], "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
           RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"retrf", ",", "pd", ",", "3", ",", "i"}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{
              RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "+", "3"}], ",", "1"}], "]"}]}], ",", 
           RowBox[{"pd", "[", 
            RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"br", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", 
               RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
            RowBox[{"n", "->", "1"}]}], "/.", 
           RowBox[{
            RowBox[{
             SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
          RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "\[IndentingNewLine]", 
         RowBox[{"covLong", "[", 
          RowBox[{"retrf", ",", "pd", ",", "4", ",", "i"}], "]"}]}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "+", "4"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{"pd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"br", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
           RowBox[{"n", "->", "1"}]}], "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
         RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", "Simplify"}], 
    "*)"}], "\n", "\n", "\n", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"rf", ",", "pibar", ",", "4"}], "]"}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "3"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "0"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "2"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "3"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "4"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "4"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "3"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "0"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "2"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "3"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "4"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg2", ",", "4"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}], "//", 
             RowBox[{
              RowBox[{"Simplify", "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg2", ",", "3"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"rf", ",", "sg2", ",", "2"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
               RowBox[{
                RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
           
           RowBox[{
            RowBox[{"Simplify", "\[IndentingNewLine]", 
             RowBox[{"covLong", "[", 
              RowBox[{"rf", ",", "sg2", ",", "1"}], "]"}]}], "-", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
              RowBox[{
               RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"rf", ",", "sg2", ",", "0"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
         RowBox[{
          RowBox[{"Simplify", "\[IndentingNewLine]", 
           RowBox[{"covLong", "[", 
            RowBox[{"rf", ",", "sg2", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "sg2", ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
       RowBox[{
        RowBox[{"Simplify", "\[IndentingNewLine]", 
         RowBox[{"covLong", "[", 
          RowBox[{"rf", ",", "sg2", ",", 
           RowBox[{"-", "3"}]}], "]"}]}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"bondyield", "[", 
           RowBox[{
            RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
      RowBox[{
       RowBox[{"Simplify", "\[IndentingNewLine]", 
        RowBox[{"covLong", "[", 
         RowBox[{"rf", ",", "sg2", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
     RowBox[{
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "4"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "0"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "2"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "4"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "4"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "0"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "2"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "4"}]}], "]"}]}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}]}]}], 
    "*)"}], "\n", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", "testing", "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"dc", ",", "dc", ",", "0"}], "]"}], "==", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dc", "[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"dd", ",", "dd", ",", "0", ",", "i"}], "]"}], "==", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "check", " ", "that", " ", "all", " ", "that", " ", "matters", " ", "is",
       " ", "difference", " ", "in", " ", "t"}], ",", " ", 
     RowBox[{"not", " ", "absolute", " ", "distance"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "hh", "-", "qq"}], "]"}], ",", 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "hh"}], ",", "i"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"hh", ",", 
           RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "hh"}], "]"}], ",", 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "hh", "-", "qq"}], ",", "i"}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"hh", ",", 
           RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "qq"}], ",", "i"}], "]"}]}], "]"}]}], " ", "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"pd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"pd", "[", 
          RowBox[{
           RowBox[{"t", "+", "qq"}], ",", "i"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "qq"}], ",", "i"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "4"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "0"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "4"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "4"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "0"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "4"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", "t", "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k1", " ", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"k2", " ", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"k1", " ", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"k2", " ", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd3", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd3", ",", "dd3", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd3", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "4", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd4", ",", "dd4", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd4", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd5", ",", "dd5", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd5", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "12"}], ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5fw", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "+", "12"}], ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd5lag", "+", "dd5fw"}], ",", 
       RowBox[{"dd5lag", "+", "dd5fw"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd5lag", "+", "dd5fw"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12", ",", "dd12", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "12"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12lag", ",", "dd12lag", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12lag", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12fw", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "+", "12"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12fw", ",", "dd12fw", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12fw", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd3lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd3lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd4lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "pd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "pd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd4lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "pd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "pd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd3lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "dd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "dd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd3lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "dd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "dd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "dd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "dd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "dd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "dd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\n", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.895743277469316*^9, 
   3.8957432775878143`*^9}, 3.895743497762248*^9, 3.895743647941506*^9},
 CellLabel->"In[148]:=",
 CellID->1739871239,ExpressionUUID->"01323ad2-a4f2-4692-9a6a-05804ea0c7bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.8957432775903263`*^9, 3.895743277595463*^9}},
 CellLabel->"In[277]:=",
 CellID->171046095,ExpressionUUID->"305c0ee0-17c4-4377-8c58-a80c58d8c753"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ret2", "=", 
   RowBox[{"retageq", "[", 
    RowBox[{"t", ",", "2", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"rf2", " ", "=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"bondyield", "[", 
       RowBox[{
        RowBox[{"t", "-", "i"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"retrf2", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"retrf", "[", 
        RowBox[{"t", "-", "kk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pd2lag", "=", 
   RowBox[{"pdAGeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "2"}], ",", "2", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "2"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd2", "=", 
    RowBox[{"ddagApproxeq", "[", 
     RowBox[{"t", ",", "2", ",", "i"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc2", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc2", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc2", ",", "dc2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc2", ",", "dc2lag"}], "]"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{"retrf2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret2", "-", "rf2"}], ",", "pd2lag"}], "]"}]}], "//.", 
      "toA"}], "//", "FullSimplify"}], "//", "Chop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc2", ",", "pd2lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dd2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dd2", ",", "pd2lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "Chop"}], "\n", 
 RowBox[{
  RowBox[{"ret3", "=", 
   RowBox[{"retageq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rf3", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"bondyield", "[", 
      RowBox[{
       RowBox[{"t", "-", "i"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pd3lag", "=", 
   RowBox[{"pdAGeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc3", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc3lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "3"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd3", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc3", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc3", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc3", ",", "dc3lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc3", ",", "dc3lag"}], "]"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{"retrf3", ",", "pd3lag", ",", "covLong"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret3", "-", "rf3"}], ",", "pd3lag"}], "]"}]}], " ", "//.", 
      "toA"}], "//", "FullSimplify"}], "//", "Chop"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"uncondCovLong", "[", 
         RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], "]"}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
      RowBox[{
       RowBox[{"Chop", "\[IndentingNewLine]", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{"dd3", ",", "pd3lag", ",", "covLong"}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{"dd3", ",", "pd3lag"}], "]"}]}]}], "//", "FullSimplify"}], "//",
     "Chop"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "testing", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"am4", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"retrf", ",", "retrf", ",", 
          RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "-", "4"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{"t", ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
      RowBox[{"Simplify", "\[IndentingNewLine]", "am3"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"retrf", ",", "retrf", ",", 
           RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{
              RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "-", "3"}], ",", "1"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"t", ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
       RowBox[{"Simplify", "\[IndentingNewLine]", "am2"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"retrf", ",", "retrf", ",", 
            RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "-", "2"}], ",", "1"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{"t", ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
        RowBox[{"Simplify", "\[IndentingNewLine]", "am1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"retrf", ",", "retrf", ",", 
             RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{"t", ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
         RowBox[{"Simplify", "\[IndentingNewLine]", "a0"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"retrf", ",", "retrf", ",", 
              RowBox[{"-", "0"}], ",", "i"}], "]"}], "-", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "1"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{"t", ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
          RowBox[{"Simplify", "\[IndentingNewLine]", "a1"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"retrf", ",", "retrf", ",", "1", ",", "i"}], "]"}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{
                  RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "+", "1"}], ",", "1"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], 
           "//", 
           RowBox[{"Simplify", "\[IndentingNewLine]", "a2"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"retrf", ",", "retrf", ",", "2", ",", "i"}], "]"}], 
              "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}],
             "//", 
            RowBox[{"Simplify", "\[IndentingNewLine]", "a3"}]}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "retrf", ",", "3", ",", "i"}], "]"}], 
               "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{"t", ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", 
              "toA"}], "//", 
             RowBox[{"Simplify", "\[IndentingNewLine]", "a4"}]}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "retrf", ",", "4", ",", "i"}], "]"}], 
               "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{"t", ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", 
              "toA"}], "//", "Simplify"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895743277597159*^9, 3.895743277604294*^9}},
 CellLabel->"In[286]:=",
 CellID->799257596,ExpressionUUID->"e98cc1a3-180d-4a06-a9cb-15ac15611263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdc1"}], "=", 
   "\"\<covLong[{`1`,`2`}, `3`, q, r] does not match \
uncondCov[`1`[t]*`2`[t+q], `3`[t+r]] for some q,r\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdc2"}], "=", 
   "\"\<covLong[`1`, {`2`,`3`}, q, r] does not match uncondCov[`1`[t], \
`2`[t+q]*`3`[t+r]] for some q,r\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdd1"}], "=", 
   "\"\<covLong[{v1,v2},v3, q, r] does not match uncondCov[v1[t]*v2[t+q], \
v3[t+r]] for some q,r, and some {v1,v2,v3} where two elements come from `1` \
and one element comes from `2` \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdd2"}], "=", 
   "\"\<covLong[v1,{v2,v3}, q, r] does not match \
uncondCov[v1[t],v2[t+q]*v3[t+r]] for some q,r, and some {v1,v2,v3} where two \
elements come from `1` and one element comes from `2` \>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868430617213367*^9, 3.868430624135852*^9}, {
  3.868430709822543*^9, 3.868430796505639*^9}, {3.868430839031724*^9, 
  3.868430839454426*^9}, {3.868430994563813*^9, 3.86843101498873*^9}},
 CellLabel->"In[304]:=",
 CellID->1496354362,ExpressionUUID->"7cc70058-0f88-4fdd-bc82-3427853c894e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"testing", " ", 
    RowBox[{"(", 
     RowBox[{"can", " ", "take", " ", "a", " ", "long", " ", "time"}], 
     ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maxLag", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "dc", ",", "pi", ",", "pibar"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList", "=", 
     RowBox[{"Permutations", "[", "list", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testListd", "=", 
     RowBox[{"Permutations", "[", 
      RowBox[{"list", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"all", " ", "length"}], "-", 
     RowBox[{"2", " ", "permutations", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"sx", ",", "x", ",", "dc", ",", "dd"}], "}"}], " ", "that", 
      " ", "contain", " ", "dd"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.868183290740081*^9, 3.868183322969268*^9}, {
   3.868183381714491*^9, 3.868183555451178*^9}, {3.868183979015998*^9, 
   3.868184143536919*^9}, {3.868184205160576*^9, 3.8681842432022867`*^9}, {
   3.868184364242258*^9, 3.86818440339872*^9}, {3.868184470693329*^9, 
   3.8681845579705057`*^9}, {3.868184733290329*^9, 3.8681847336338882`*^9}, {
   3.868184781905233*^9, 3.868184792905096*^9}, {3.8681850426787987`*^9, 
   3.868185132222588*^9}, {3.868185248545433*^9, 3.868185248762332*^9}, {
   3.868199582572283*^9, 3.868199603851144*^9}, {3.868199657653294*^9, 
   3.8681996578430967`*^9}, {3.868199812613455*^9, 3.868199822582457*^9}, {
   3.868200175760764*^9, 3.868200180769318*^9}, {3.868200258501315*^9, 
   3.8682003102398033`*^9}, 3.868200352941801*^9, {3.868217374130706*^9, 
   3.868217391901312*^9}, {3.868217422600671*^9, 3.868217432763451*^9}, {
   3.868217619476942*^9, 3.8682176457308083`*^9}, {3.868218215887637*^9, 
   3.868218243215564*^9}, 3.868380394899704*^9, 3.868430276347712*^9, 
   3.868430307659354*^9, {3.8684303390804996`*^9, 3.868430344950329*^9}, {
   3.868431040444603*^9, 3.868431052518409*^9}, {3.8687037969302053`*^9, 
   3.868703815953435*^9}, {3.8687042306188507`*^9, 3.86870425640793*^9}, {
   3.86870430443965*^9, 3.8687043053310013`*^9}, 3.8687047653808193`*^9, 
   3.868718660035314*^9, {3.8687192412827797`*^9, 3.868719248588983*^9}, 
   3.8687192987901297`*^9, 3.8687349064590282`*^9, {3.873075661582253*^9, 
   3.8730756659569674`*^9}},
 CellLabel->"In[308]:=",
 CellID->1874572404,ExpressionUUID->"13ad996b-df0a-46b4-aed4-d4f0c640ef20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "q", ",", "r"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testList"}], "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdc1"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8682174344804277`*^9, 3.868217615985887*^9}, {
   3.8682176980259457`*^9, 3.868217704857314*^9}, 3.8682177659547*^9, {
   3.868218149135633*^9, 3.868218181387199*^9}, {3.868218224666708*^9, 
   3.8682182273951473`*^9}, {3.868218279642826*^9, 3.86821828008319*^9}, {
   3.868380298916513*^9, 3.868380305282085*^9}, {3.868430340797443*^9, 
   3.868430354456196*^9}, {3.868430486141069*^9, 3.868430531860894*^9}, {
   3.8684310394667597`*^9, 3.8684310433442373`*^9}},
 CellLabel->"In[312]:=",
 CellID->1989471160,ExpressionUUID->"4855ff25-b8b5-492b-80f3-f82c0d254490"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"vars", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "q", ",", "r"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testList"}], "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdc2"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684303958241243`*^9, 3.868430429151132*^9}, {
  3.868430547948758*^9, 3.8684305489035397`*^9}},
 CellLabel->"In[314]:=",
 CellID->432055528,ExpressionUUID->"80548acb-a45d-4b8c-b985-bdaa0487b0a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"dd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd1"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t2d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dd", ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t3d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "dd"}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t3d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t4d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"dd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t4d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t5d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "dd", ",", "q", 
            ",", "r", ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{"t", "+", "r"}], ",", "i"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t5d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684302788280888`*^9, 3.868430300141458*^9}, {
   3.868430370375915*^9, 3.8684303779666*^9}, {3.8684305755597687`*^9, 
   3.8684306017278147`*^9}, {3.868430675094701*^9, 3.868430691310279*^9}, {
   3.868430803588604*^9, 3.868430832143063*^9}, {3.8684309402859*^9, 
   3.868430982746119*^9}, {3.868431049574254*^9, 3.868431103113779*^9}, {
   3.8687192773373833`*^9, 3.868719292495607*^9}, {3.868719448718773*^9, 
   3.868719451047024*^9}, 3.86871982807099*^9, {3.8687200865274057`*^9, 
   3.868720108834371*^9}, 3.8687349396008863`*^9, {3.868735395161248*^9, 
   3.868735410518011*^9}, {3.868735461245483*^9, 3.8687354737154408`*^9}, {
   3.868735666973319*^9, 3.868735667128256*^9}},
 CellLabel->"In[316]:=",
 CellID->160108917,ExpressionUUID->"543f6144-c7ca-4dbc-8b1e-a87f724a8c97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd1"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t2pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pd", ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t3pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "pd"}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{"pd", "[", 
              RowBox[{
               RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t3pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t4pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t4pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t5pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "pd", ",", "q", 
            ",", "r", ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{"pd", "[", 
             RowBox[{
              RowBox[{"t", "+", "r"}], ",", "i"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t5pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684302788280888`*^9, 3.868430300141458*^9}, {
   3.868430370375915*^9, 3.8684303779666*^9}, {3.8684305755597687`*^9, 
   3.8684306017278147`*^9}, {3.868430675094701*^9, 3.868430691310279*^9}, {
   3.868430803588604*^9, 3.868430832143063*^9}, {3.8684309402859*^9, 
   3.868430982746119*^9}, {3.868431049574254*^9, 3.868431103113779*^9}, {
   3.8687192773373833`*^9, 3.868719292495607*^9}, {3.868719448718773*^9, 
   3.868719451047024*^9}, 3.86871982807099*^9, {3.8687200865274057`*^9, 
   3.868720108834371*^9}, {3.8687349396008863`*^9, 3.8687350778754377`*^9}, {
   3.868735542725609*^9, 3.868735592837367*^9}, 3.8687356967617817`*^9, 
   3.8687357401462317`*^9},
 CellLabel->"In[326]:=",
 CellID->1021365996,ExpressionUUID->"70656be0-aa1e-414c-a53a-bc03466f5910"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellLabel->"In[401]:=",
 CellID->997759263,ExpressionUUID->"9e4cd370-846c-4007-833e-02dd8d608cba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "j"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "j"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.868561751493519*^9, 3.868561754859425*^9}},
 CellLabel->"In[402]:=",
 CellID->1294489255,ExpressionUUID->"8becfc8d-44f5-40f0-b77f-0c4197dce588"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"pd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"pd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.868561763395924*^9, 3.868561772542441*^9}},
 CellLabel->"In[429]:=",
 CellID->1255539483,ExpressionUUID->"7666f660-9f31-41dd-a482-70be20b1bc95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"sx", "[", "t", "]"}], 
      RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"sx", "[", "t", "]"}], 
      RowBox[{"x", "[", "t", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"",
 CellID->387215999,ExpressionUUID->"e8be9159-73e8-4bc9-9613-41805008b746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.86864871445879*^9, 3.8686487421037683`*^9}, {
  3.8687047775690327`*^9, 3.868704784100897*^9}},
 CellID->309605539,ExpressionUUID->"3c2ea379-0fba-4592-88dc-c8131b98ece8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "sx"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}],
   "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], 
     RowBox[{"sx", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], 
     RowBox[{"sx", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}], 
  "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}], 
  "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.868649444323964*^9, 3.868649444578911*^9}},
 CellLabel->"In[301]:=",
 CellID->1741115415,ExpressionUUID->"42f96ecf-84c6-4726-80eb-7e07960443c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"test", " ", "totCov"}], ",", " ", "totCov2", ",", " ", 
    "totCovLong"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"totCov", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totCov2", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"x", "*", "y"}], ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], "]"}], 
       RowBox[{"uncondE", "[", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList1", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList2", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCovLong", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCov2", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"t1", "==", "t2", "==", "t3", "==", "t4", "==", "t5"}], ",", 
     "modelAssumptions"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8686497805231123`*^9, 3.868649812397028*^9}, {
   3.868649910876871*^9, 3.8686499175762*^9}, {3.868649969848742*^9, 
   3.868649972195404*^9}, {3.868650045635866*^9, 3.8686500522514353`*^9}, {
   3.868650083517132*^9, 3.8686501256458807`*^9}, 3.868650157866232*^9, {
   3.868650526693671*^9, 3.868650537224121*^9}, {3.868650580377983*^9, 
   3.868650617676289*^9}, {3.8730757546041117`*^9, 3.873075760773357*^9}},
 CellID->369571884,ExpressionUUID->"6389e088-8cb6-4969-a513-c7a1cac2846b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", "dc", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList2", "=", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868650459451703*^9, 3.868650486728876*^9}, {
  3.87307576416591*^9, 3.873075765981423*^9}},
 CellLabel->"In[554]:=",
 CellID->340783995,ExpressionUUID->"fd124a6b-ea34-4b7e-aea8-48989acbfea6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", "t", "]"}], 
        RowBox[{"v3", "[", "t", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", "t", "]"}], 
         RowBox[{"v3", "[", "t", "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868650554036792*^9, 3.86865056809198*^9}, {
   3.868650630488484*^9, 3.86865073824118*^9}, 3.868650786599669*^9, {
   3.868650860753031*^9, 3.8686509020681677`*^9}, 3.8686513001513968`*^9, {
   3.8686513319283113`*^9, 3.868651332124798*^9}, {3.873075775766135*^9, 
   3.873075777781489*^9}},
 CellID->538633863,ExpressionUUID->"d9145aec-21ec-4dd2-b903-59f7a2e7d6f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}], 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868651327352656*^9, 3.868651364722836*^9}, 
   3.868653325262486*^9, {3.8730757813256683`*^9, 3.873075783717208*^9}},
 CellID->1073921610,ExpressionUUID->"bf7f73c0-51b0-4a7a-8d55-96d194f6244d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8686533386180897`*^9, 3.8686533527307243`*^9}, {
  3.873075787166266*^9, 3.873075788677038*^9}},
 CellID->1914543127,ExpressionUUID->"2fda6806-18a8-46b9-9b15-15a6c25cbb7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"dc", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "dc"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"dc", ",", 
    RowBox[{"{", 
     RowBox[{"dc", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dc", ",", "sx"}], "}"}], ",", "dc", ",", "0", ",", "0"}], "]"}],
   "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "dc"}], "}"}], ",", "dc", ",", "0", ",", "0"}], 
   "]"}]}]}], "Input",
 CellID->425500841,ExpressionUUID->"b085671d-90de-4e0a-9423-fd686494c5d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList3", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList4", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q3"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], 
         RowBox[{"v4", "[", 
          RowBox[{"t", "+", "q3"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.873075808947585*^9, 3.8730758713320103`*^9}},
 CellID->1922088329,ExpressionUUID->"bf4209fd-6826-45a3-aa6a-51ad8a3006ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.868564162034954*^9, 3.868564233092915*^9}, {
  3.868564312031789*^9, 3.868564314407172*^9}, {3.8686535310981293`*^9, 
  3.8686535389565687`*^9}, {3.868653578368771*^9, 3.868653690043038*^9}},
 CellLabel->"In[255]:=",
 CellID->1888953057,ExpressionUUID->"39c24a7e-be69-4df8-b81c-d5f8bc4f45f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "s"}], "]"}], 
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "q"}], "]"}]}], ",", 
    RowBox[{"dc", "[", 
     RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "s"}], "]"}], 
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "q"}], "]"}]}], ",", 
    RowBox[{"dc", "[", 
     RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8686908444509983`*^9, 3.8686908478989153`*^9}, 
   3.8686909213270607`*^9, 3.868690986892284*^9},
 CellID->1824051709,ExpressionUUID->"2427736b-eb0b-4eef-9d63-fa7646701adc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.86869088394128*^9, 3.86869095944561*^9}, {
  3.868690990326233*^9, 3.86869112102425*^9}, {3.868691381611908*^9, 
  3.8686913833701353`*^9}, {3.868691713564088*^9, 3.868691715370327*^9}},
 CellLabel->"In[254]:=",
 CellID->1934616487,ExpressionUUID->"26920505-3a3e-478c-bdd5-9e65a60b5faa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q3"}], "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868703925769659*^9, 3.868703939416643*^9}},
 CellID->773307292,ExpressionUUID->"16ff98aa-39ad-4244-9a4f-3b9d4e1bcc5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", 
        RowBox[{"t", "+", "q3"}], "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}], "*", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], "*", 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868703960713661*^9, 3.868703969849883*^9}},
 CellID->1176812697,ExpressionUUID->"57648cb4-e9ad-4cab-9afe-5b7e928b97f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList3", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList4", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", "t", "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", "t", "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873075918451975*^9, 3.8730759353809547`*^9}},
 CellID->1173427227,ExpressionUUID->"c10d6709-23e5-4a37-8340-fa4d9a102d76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"excbondret3m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret6m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret12m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret24m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "24"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret60m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "60"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"excbondret120m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "120"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret240m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "240"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"excbondret360m", " ", "=", " ", 
    RowBox[{"excbondretAGeq", "[", 
     RowBox[{"t", ",", "12", ",", "360"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "6"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "12"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "6"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "12"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.868704481420594*^9, 3.868704569868958*^9}, {
  3.868704612638925*^9, 3.8687046685586033`*^9}},
 CellID->1048670426,ExpressionUUID->"d45b1289-5e74-46ad-a167-5e9dcd76c656"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uncondVar", "[", "pd1", "]"}], "-", 
       RowBox[{"uncondVarLong", "[", "pd1", "]"}]}], ")"}], "//", 
     "ExpandAll"}], ",", "modelAssumptions"}], "]"}], "//", "Chop"}]], "Input",\

 CellID->1523198083,ExpressionUUID->"5d16d098-dfa1-45c9-a819-af32568d12de"]
},
CellGrouping->Manual,
WindowSize->{1594, 879},
WindowMargins->{{Automatic, -1823}, {Automatic, 0}},
WindowTitle->Automatic,
DockedCells->Cell[
  BoxData[
   PanelBox[
    PaneBox[
     TagBox[
      GridBox[{{
         StyleBox[
          DynamicBox[
           FEPrivate`FrontEndResource[
           "MUnitStrings", "TestingNotebook-Title"], 
           ImageSizeCache -> {100., {3., 9.}}], StripOnInput -> False, 
          FontSize -> 12, FontColor -> GrayLevel[0.4]], "\[SpanFromLeft]", 
         "\[SpanFromLeft]", "\[SpanFromLeft]", "\[SpanFromLeft]", 
         "\[SpanFromLeft]"}, {
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "New"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "New-Label"], 
                    ImageSizeCache -> {26., {0., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteInsertTest[
                  InputNotebook[], "Test"]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource["MUnitStrings", "New-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource["MUnitStrings", "New-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {68., {11., 17.}}], DynamicModuleValues :> {}], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ConvertSelection"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ConvertSelectiontoTest-Label"], 
                    ImageSizeCache -> {99., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; 
                MUnit`buttonConvertCellGroup[
                  InputNotebook[]]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource[
              "MUnitStrings", "ConvertSelectiontoTest-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource[
               "MUnitStrings", "ConvertSelectiontoTest-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {141., {11., 17.}}], DynamicModuleValues :> {}], 
         
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "Run"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "Run-Label"], 
                    ImageSizeCache -> {22., {0., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.3}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteRun[
                  InputNotebook[]]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource["MUnitStrings", "Run-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource["MUnitStrings", "Run-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {63., {11., 17.}}], DynamicModuleValues :> {}], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           ActionMenuBox[
            ButtonBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  StyleBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "More-Label"], 
                    ImageSizeCache -> {30., {0., 9.}}], "ButtonText", 
                   StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]], 
                  PaneSelectorBox[{True -> DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "Arrow-Hover"], 
                    ImageSizeCache -> {9., {2., 7.}}], False -> DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "Arrow-Off"], 
                    ImageSizeCache -> {9., {2., 7.}}]}, 
                   Dynamic[$CellContext`hover$$], 
                   BaselinePosition -> (Center -> Scaled[0.5])]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{0.5}}, "Rows" -> {{Automatic}}}], "Grid"], 
              ImageMargins -> {{0, 0}, {0, 0}}], Appearance -> 
             FEPrivate`FrontEndResource[
              "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> {}, 
             ContentPadding -> True, Evaluator -> None, 
             FrameMargins -> {{10, 10}, {0, 0}}, ImageSize -> {Automatic, 28},
              Method -> "Preemptive"], {TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "AssignTestIDs"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "AssignTestIDs-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteAddTestIDs[
                 InputNotebook[]]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "SaveAsDotwlt"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "SaveAsDotwlt-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteSaveAs[
                 InputNotebook[]]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "NewEnvironCell"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "NewEnvironCell-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteInsertTest[
                 InputNotebook[], "Environ"]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "Help"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "Help-Label"]]}}, AutoDelete -> False, 
                GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             SystemOpen["paclet:tutorial/UsingTheTestingFramework"]}, 
            Appearance -> None, Method -> "Queued"], $CellContext`hover$$ = 
           CurrentValue["MouseOver"], ImageSizeCache -> {67., {10., 18.}}], 
          DynamicModuleValues :> {}], 
         ItemBox["\"\"", ItemSize -> Fit, StripOnInput -> False], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             PaneSelectorBox[{True -> ButtonBox[
                 TagBox[
                  GridBox[{{
                    PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ClearTestResults-on"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                    StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ClearTestResults-Label"], 
                    ImageSizeCache -> {96., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                   AutoDelete -> False, 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                   GridBoxSpacings -> {
                    "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
                 Appearance -> 
                 FEPrivate`FrontEndResource[
                  "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
                 Block[{$ContextPath}, Needs["MUnit`"]; 
                   MUnit`clearTestResults[]], Evaluator -> Automatic, 
                 FrameMargins -> {{10, 10}, {0, 0}}, 
                 ImageSize -> {Automatic, 28}, Method -> "Queued"], False -> 
               ButtonBox[
                 TagBox[
                  GridBox[{{
                    PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ClearTestResults-off"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                    StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ClearTestResults-Label"], 
                    ImageSizeCache -> {96., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, LineColor -> GrayLevel[0.7], 
                    FrontFaceColor -> GrayLevel[0.7], BackFaceColor -> 
                    GrayLevel[0.7], GraphicsColor -> GrayLevel[0.7], 
                    FontColor -> GrayLevel[0.7]]}}, AutoDelete -> False, 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                   GridBoxSpacings -> {
                    "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
                 Appearance -> 
                 FEPrivate`FrontEndResource[
                  "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
                 Null, Enabled -> False, Evaluator -> Automatic, 
                 FrameMargins -> {{10, 10}, {0, 0}}, 
                 ImageSize -> {Automatic, 28}, Method -> "Queued"]}, 
              Dynamic[CurrentValue[
                 ButtonNotebook[], {TaggingRules, "$testsRun"}, False] === 
               True]], 
             DynamicBox[
              FEPrivate`FrontEndResource[
              "MUnitStrings", "ClearTestResults-Tooltip"]], TooltipDelay -> 
             0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource[
               "MUnitStrings", "ClearTestResults-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {138., {10., 18.}}], 
          DynamicModuleValues :> {}]}}, AutoDelete -> False, 
       BaseStyle -> {
        "DialogStyle", Bold, FontColor -> 
         RGBColor[
          0.33333333333333337`, 0.33333333333333337`, 0.33333333333333337`]}, 
       GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Bottom}}}, 
       GridBoxDividers -> {"Columns" -> {{False}}}, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
       GridBoxSpacings -> {"Columns" -> {{Automatic}}, "Rows" -> {{1}}}], 
      "Grid"], ImageMargins -> {{5, 5}, {Automatic, Automatic}}], Appearance -> 
    FEPrivate`FrontEndResource["MUnitExpressions", "StaticToolbarNinePatch"], 
    FrameMargins -> {{26, 12}, {8, 12}}, ImageMargins -> -1]], "DockedCell", 
  CellFrameMargins -> 0, ShowCellTags -> False, CellTags -> 
  "MUnitStaticToolbar"],
TaggingRules-><|"$testsRun" -> False, "TryRealOnly" -> False|>,
CellContext->Notebook,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->FrontEnd`FileName[{"MUnit"}, "MUnit.nb", CharacterEncoding -> 
  "UTF-8"],
ExpressionUUID->"b9ea1237-83e0-4088-831a-59753d2dc05b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[581, 21, 165, 2, 101, "Section",ExpressionUUID->"61a2a9a5-6e2f-403b-95f1-35de97157c46",
 CellID->1569917085],
Cell[749, 25, 1601, 36, 163, "Input",ExpressionUUID->"27c686eb-a1eb-415c-806c-8ebb2b92ca61",
 CellID->733614014],
Cell[2353, 63, 3149, 80, 388, "Input",ExpressionUUID->"cb79919f-49cf-462d-a200-b3bf07f388e8",
 CellID->2078682862],
Cell[5505, 145, 574, 15, 109, "Input",ExpressionUUID->"96d943bb-6732-45f0-ae4b-0265036585cd",
 CellID->2074660696],
Cell[6082, 162, 424, 10, 78, "Input",ExpressionUUID->"aa531f0f-c536-4eb1-9076-eb9eac1542d0",
 CellID->1712451525],
Cell[CellGroupData[{
Cell[6531, 176, 331, 6, 46, "Input",ExpressionUUID->"36fb5d7d-b42b-46db-b134-7023d5596133",
 CellID->45429000],
Cell[6865, 184, 2096, 41, 201, "Output",ExpressionUUID->"f6e2b70d-50f5-4ead-8e50-c2dfa5e8bb1d",
 CellID->1734972790]
}, Open  ]],
Cell[CellGroupData[{
Cell[8998, 230, 342, 6, 78, "Input",ExpressionUUID->"7998b3f8-a765-426c-9a43-8825cbf1061a",
 CellID->1404874192],
Cell[9343, 238, 232, 4, 52, "Output",ExpressionUUID->"aa83f0e0-1071-4d25-af49-8dcee425f7b0",
 CellID->1842216980],
Cell[9578, 244, 573, 11, 115, "Output",ExpressionUUID->"89f48b4b-10e7-40ca-8931-5f696a483103",
 CellID->1869044061]
}, Open  ]],
Cell[10166, 258, 317, 8, 46, "Input",ExpressionUUID->"2b23cb50-00da-45b8-a52a-bc8c4b074449",
 CellID->56683262],
Cell[10486, 268, 786, 19, 78, "Input",ExpressionUUID->"a0a3f1a9-f0eb-4d3a-a62b-88890394cde5",
 CellID->132995452],
Cell[11275, 289, 755, 21, 78, "Input",ExpressionUUID->"7c8ef76c-f32b-40d4-a6ef-4961d6f60d0d",
 CellID->1587735617],
Cell[12033, 312, 599, 16, 78, "Input",ExpressionUUID->"e80921b6-f693-4b7d-88bd-1332686e60c5",
 CellID->539510809],
Cell[12635, 330, 559, 18, 78, "Input",ExpressionUUID->"c4852883-f0ba-46cd-a81b-13b004200519",
 CellID->974302512],
Cell[CellGroupData[{
Cell[13219, 352, 1033, 25, 233, "Input",ExpressionUUID->"3d283022-894a-4630-a262-f98da98baf9e",
 CellID->711996362],
Cell[14255, 379, 195, 3, 52, "Output",ExpressionUUID->"e682eab7-093b-4a6c-94a4-e313f7c52f45",
 CellID->108005672]
}, Open  ]],
Cell[14465, 385, 247, 3, 101, "Section",ExpressionUUID->"a766fa8e-3cd4-492a-a3c8-aaa5cda85d93",
 CellID->1245172077],
Cell[14715, 390, 22633, 680, 2116, "Input",ExpressionUUID->"8e46033a-47e2-4014-932f-72f4a9ac8c26",
 CellID->86110327],
Cell[CellGroupData[{
Cell[37373, 1074, 9403, 246, 543, "Input",ExpressionUUID->"4789936a-5c37-4d9e-bb8b-8eafa33f338e",
 CellID->1319307510],
Cell[46779, 1322, 168, 3, 52, "Output",ExpressionUUID->"681c0703-2fa9-45d1-8bf3-9913a3eb2368",
 CellID->87860823],
Cell[46950, 1327, 170, 3, 52, "Output",ExpressionUUID->"23ca6209-fac2-495b-9d82-16a7f6281c0a",
 CellID->1355586672],
Cell[47123, 1332, 169, 3, 52, "Output",ExpressionUUID->"487c89a0-fda2-48f5-9f37-1b94a8a3f968",
 CellID->691185281],
Cell[47295, 1337, 170, 3, 52, "Output",ExpressionUUID->"fa2aa0de-78a2-46f4-8993-420cf32c2aea",
 CellID->1011971144],
Cell[47468, 1342, 169, 3, 52, "Output",ExpressionUUID->"aa42ed08-812b-4552-aab8-e0f054e64212",
 CellID->128532968],
Cell[47640, 1347, 169, 3, 52, "Output",ExpressionUUID->"0b138d99-3aec-4598-94b7-5fb1b0d5087d",
 CellID->2032527941],
Cell[47812, 1352, 169, 3, 52, "Output",ExpressionUUID->"41333a27-aba1-4a05-b8d8-cf749f5745e6",
 CellID->674731558],
Cell[47984, 1357, 168, 3, 52, "Output",ExpressionUUID->"36a45c1d-9233-48fd-b454-4555ebec08c2",
 CellID->1499639146],
Cell[48155, 1362, 170, 3, 52, "Output",ExpressionUUID->"2b2b6512-ae13-4034-8af7-81617974bae9",
 CellID->1567045630],
Cell[48328, 1367, 171, 3, 52, "Output",ExpressionUUID->"881ce572-b1f1-4cfc-a88c-de52f4b8d5dc",
 CellID->596456602],
Cell[48502, 1372, 171, 3, 52, "Output",ExpressionUUID->"6236c9fc-9d31-423a-9691-ce6fadcbe5b4",
 CellID->192445618],
Cell[48676, 1377, 169, 3, 52, "Output",ExpressionUUID->"3e7aab08-baab-40d6-8fef-91243c72b6bc",
 CellID->323129344],
Cell[48848, 1382, 170, 3, 52, "Output",ExpressionUUID->"075f64dd-3720-4275-8c42-87ca93a77f5b",
 CellID->1996224992],
Cell[49021, 1387, 171, 3, 52, "Output",ExpressionUUID->"564c9fd6-e5dd-4d5a-bea1-618a6574a64a",
 CellID->416423463],
Cell[CellGroupData[{
Cell[49217, 1394, 56864, 1487, 5059, "Input",ExpressionUUID->"304f2442-f638-4eb6-aa14-52471393d424",
 CellID->537762824],
Cell[106084, 2883, 170, 3, 52, "Output",ExpressionUUID->"5e4ed45f-7d2a-4f51-9267-91ec747d8d18",
 CellID->2096198871],
Cell[106257, 2888, 172, 3, 52, "Output",ExpressionUUID->"32806328-aaa9-406c-9028-afdf7dfb5c00",
 CellID->1345195862],
Cell[106432, 2893, 169, 3, 52, "Output",ExpressionUUID->"5f3ae8ed-243e-42a1-b3c4-c55fe8590e0e",
 CellID->2146500665]
}, Open  ]],
Cell[106616, 2899, 89612, 2505, 7552, "Input",ExpressionUUID->"01323ad2-a4f2-4692-9a6a-05804ea0c7bf",
 CellID->1739871239],
Cell[196231, 5406, 6721, 159, 326, "Input",ExpressionUUID->"305c0ee0-17c4-4377-8c58-a80c58d8c753",
 CellID->171046095]
}, Open  ]],
Cell[202967, 5568, 15865, 405, 1194, "Input",ExpressionUUID->"e98cc1a3-180d-4a06-a9cb-15ac15611263",
 CellID->799257596],
Cell[218835, 5975, 1338, 29, 264, "Input",ExpressionUUID->"7cc70058-0f88-4fdd-bc82-3427853c894e",
 CellID->1496354362],
Cell[220176, 6006, 2634, 53, 202, "Input",ExpressionUUID->"13ad996b-df0a-46b4-aed4-d4f0c640ef20",
 CellID->1874572404],
Cell[222813, 6061, 2985, 72, 357, "Input",ExpressionUUID->"4855ff25-b8b5-492b-80f3-f82c0d254490",
 CellID->1989471160],
Cell[225801, 6135, 2629, 68, 357, "Input",ExpressionUUID->"80548acb-a45d-4b8c-b985-bdaa0487b0a1",
 CellID->432055528],
Cell[228433, 6205, 11477, 297, 1721, "Input",ExpressionUUID->"543f6144-c7ca-4dbc-8b1e-a87f724a8c97",
 CellID->160108917],
Cell[239913, 6504, 11468, 297, 1721, "Input",ExpressionUUID->"70656be0-aa1e-414c-a53a-bc03466f5910",
 CellID->1021365996],
Cell[251384, 6803, 834, 27, 46, "Input",ExpressionUUID->"9e4cd370-846c-4007-833e-02dd8d608cba",
 CellID->997759263],
Cell[252221, 6832, 901, 28, 46, "Input",ExpressionUUID->"8becfc8d-44f5-40f0-b77f-0c4197dce588",
 CellID->1294489255],
Cell[253125, 6862, 901, 28, 46, "Input",ExpressionUUID->"7666f660-9f31-41dd-a482-70be20b1bc95",
 CellID->1255539483],
Cell[254029, 6892, 3147, 100, 309, "Input",ExpressionUUID->"e8be9159-73e8-4bc9-9613-41805008b746",
 CellID->387215999],
Cell[257179, 6994, 3340, 95, 326, "Input",ExpressionUUID->"3c2ea379-0fba-4592-88dc-c8131b98ece8",
 CellID->309605539],
Cell[260522, 7091, 4771, 146, 341, "Input",ExpressionUUID->"42f96ecf-84c6-4726-80eb-7e07960443c8",
 CellID->1741115415],
Cell[265296, 7239, 6971, 196, 636, "Input",ExpressionUUID->"6389e088-8cb6-4969-a513-c7a1cac2846b",
 CellID->369571884],
Cell[272270, 7437, 1985, 58, 233, "Input",ExpressionUUID->"fd124a6b-ea34-4b7e-aea8-48989acbfea6",
 CellID->340783995],
Cell[274258, 7497, 2135, 60, 264, "Input",ExpressionUUID->"d9145aec-21ec-4dd2-b903-59f7a2e7d6f9",
 CellID->538633863],
Cell[276396, 7559, 2604, 75, 357, "Input",ExpressionUUID->"bf7f73c0-51b0-4a7a-8d55-96d194f6244d",
 CellID->1073921610],
Cell[279003, 7636, 2581, 75, 357, "Input",ExpressionUUID->"2fda6806-18a8-46b9-9b15-15a6c25cbb7c",
 CellID->1914543127],
Cell[281587, 7713, 1281, 38, 78, "Input",ExpressionUUID->"b085671d-90de-4e0a-9423-fd686494c5d5",
 CellID->425500841],
Cell[282871, 7753, 3236, 95, 388, "Input",ExpressionUUID->"bf4209fd-6826-45a3-aa6a-51ad8a3006ba",
 CellID->1922088329],
Cell[286110, 7850, 13702, 397, 1194, "Input",ExpressionUUID->"39c24a7e-be69-4df8-b81c-d5f8bc4f45f7",
 CellID->1888953057],
Cell[299815, 8249, 759, 22, 46, "Input",ExpressionUUID->"2427736b-eb0b-4eef-9d63-fa7646701adc",
 CellID->1824051709],
Cell[300577, 8273, 2795, 77, 233, "Input",ExpressionUUID->"26920505-3a3e-478c-bdd5-9e65a60b5faa",
 CellID->1934616487],
Cell[303375, 8352, 2730, 80, 357, "Input",ExpressionUUID->"16ff98aa-39ad-4244-9a4f-3b9d4e1bcc5b",
 CellID->773307292],
Cell[306108, 8434, 2741, 80, 357, "Input",ExpressionUUID->"57648cb4-e9ad-4cab-9afe-5b7e928b97f2",
 CellID->1176812697],
Cell[308852, 8516, 3038, 91, 326, "Input",ExpressionUUID->"c10d6709-23e5-4a37-8340-fa4d9a102d76",
 CellID->1173427227],
Cell[311893, 8609, 5604, 135, 791, "Input",ExpressionUUID->"d45b1289-5e74-46ad-a167-5e9dcd76c656",
 CellID->1048670426],
Cell[317500, 8746, 392, 11, 46, "Input",ExpressionUUID->"5d16d098-dfa1-45c9-a819-af32568d12de",
 CellID->1523198083]
}
]
*)

