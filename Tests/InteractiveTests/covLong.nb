(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    478451,      12943]
NotebookOptionsPosition[    445922,      12318]
NotebookOutlinePosition[    462424,      12660]
CellTagsIndexPosition[    462381,      12657]
WindowTitle->Automatic
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Load", "Section",
 CellChangeTimes->{{3.895715698844183*^9, 3.895715700449379*^9}},
 CellID->1569917085,ExpressionUUID->"61a2a9a5-6e2f-403b-95f1-35de97157c46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelShortName", "=", "\"\<NRCStochVol\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"filenameModels", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729862870124*^9}, 3.8957309499046583`*^9, 3.89574066689703*^9, {
   3.895741404896933*^9, 3.895741413505719*^9}, {3.895746033224846*^9, 
   3.895746033564424*^9}, {3.895761720317889*^9, 3.895761720603722*^9}, {
   3.9082045986811857`*^9, 3.908204600399857*^9}, 3.9082200397158957`*^9},
 CellLabel->"In[1]:=",
 CellID->733614014,ExpressionUUID->"27c686eb-a1eb-415c-806c-8ebb2b92ca61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLongFilename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{
      "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<.wl\>\""}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLongFilenameSave", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
       RowBox[{
       "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<Save.wl\>\""}]}],
       "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{"\"\<CreateMomentsDatabase\>\"", "<>", "\"\<.wl\>\""}]}], "}"}], 
   "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeUnconditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], 
    "}"}], "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeConditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], "}"}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Parameters`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Shocks`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"PrependTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"PrependTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729862870124*^9}, 3.8957309499046583`*^9, 3.89574066689703*^9, {
   3.895741404896933*^9, 3.895741413505719*^9}, {3.895746033224846*^9, 
   3.895746033564424*^9}, {3.895761720317889*^9, 3.895761720603722*^9}, {
   3.9082045986811857`*^9, 3.908204600399857*^9}, 3.9082200397158957`*^9},
 CellLabel->"In[6]:=",
 CellID->2078682862,ExpressionUUID->"cb79919f-49cf-462d-a200-b3bf07f388e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataModels", "=", 
   RowBox[{"Get", "[", "filenameModels", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "dataModels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`Models", "[", "modelShortName", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895741485834608*^9, 3.895741488514476*^9}, {
  3.8958166137874327`*^9, 3.895816646552721*^9}},
 CellLabel->"In[17]:=",
 CellID->2074660696,ExpressionUUID->"96d943bb-6732-45f0-ae4b-0265036585cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataCovLong", "=", 
   RowBox[{"Get", "[", "covLongFilename", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "dataCovLong"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895741506174138*^9, 3.895741507626904*^9}, {
  3.895816649129527*^9, 3.8958166561438293`*^9}},
 CellLabel->"In[20]:=",
 CellID->1712451525,ExpressionUUID->"aa531f0f-c536-4eb1-9076-eb9eac1542d0"],

Cell[BoxData[
 RowBox[{"DownValues", "[", "covLongNRC", "]"}]], "Input",
 CellChangeTimes->{{3.908568009419284*^9, 3.908568030020503*^9}},
 CellID->45429000,ExpressionUUID->"36fb5d7d-b42b-46db-b134-7023d5596133"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Names", "[", "\"\<FernandoDuarte`LongRunRisk`*\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8958167018748913`*^9, 3.8958167078976183`*^9}},
 CellLabel->"In[22]:=",
 CellID->1404874192,ExpressionUUID->"7998b3f8-a765-426c-9a43-8825cbf1061a"],

Cell[BoxData[
 RowBox[{"{", "\<\"Global`next\"\>", "}"}]], "Output",
 CellChangeTimes->{3.9082056834396067`*^9, 3.908286802614314*^9, 
  3.908295634328086*^9, 3.9085473501911993`*^9, 3.9085643935061283`*^9},
 CellLabel->"Out[22]=",
 CellID->1747855584,ExpressionUUID->"98318cb1-fe75-45f1-98a7-3c3f369ea736"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"FernandoDuarte`LongRunRisk`covLongNRCStochVol\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Epd0\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Ewc0\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`FindRootOptions\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`Models\"\>", 
   ",", "\<\"FernandoDuarte`LongRunRisk`RecurrenceTableOptions\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9082056834396067`*^9, 3.908286802614314*^9, 
  3.908295634328086*^9, 3.9085473501911993`*^9, 3.9085643935184107`*^9},
 CellLabel->"Out[23]=",
 CellID->779992975,ExpressionUUID->"63483dc0-2af1-4134-93f1-4e7b44015310"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv", "=", 
   RowBox[{
   "DownValues", "@", "FernandoDuarte`LongRunRisk`covLongNRCStochVol"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9082057244458227`*^9, 3.90820572694166*^9}},
 CellLabel->"In[24]:=",
 CellID->56683262,ExpressionUUID->"2b23cb50-00da-45b8-a52a-bc8c4b074449"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{
  "DownValues", "@", "FernandoDuarte`LongRunRisk`covLongNRCStochVol"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.908205696967383*^9, 3.908205706266307*^9}},
 CellLabel->"In[30]:=",
 CellID->1209522482,ExpressionUUID->"d80b83dc-6c73-4a24-97e9-e36565a8e323"],

Cell[BoxData["6409"], "Output",
 CellChangeTimes->{3.908205706849484*^9, 3.908286813485683*^9},
 CellLabel->"Out[30]=",
 CellID->2020522930,ExpressionUUID->"e70918ca-09ae-4391-8fee-d6b1fc025f93"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"#", ",", "FindSequenceFunction"}], "]"}], "]"}], "&"}], "/@", 
    "dv"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posF", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"hasF", ",", "True"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908205730421935*^9, 3.908205735382915*^9}, {
  3.908205769177747*^9, 3.908205857006237*^9}, {3.908205891909947*^9, 
  3.908205903235866*^9}, {3.908206113434532*^9, 3.908206118117119*^9}, {
  3.9082089611679573`*^9, 3.908208969028214*^9}, {3.908209160749939*^9, 
  3.908209163638774*^9}},
 CellLabel->"In[31]:=",
 CellID->132995452,ExpressionUUID->"a0a3f1a9-f0eb-4d3a-a62b-88890394cde5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"val", "=", 
   RowBox[{"Values", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dv", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posF"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"key", "=", 
   RowBox[{"Keys", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dv", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posF"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9082064787625647`*^9, 3.908206479926114*^9}, {
  3.9082077408349733`*^9, 3.908207743426217*^9}, {3.9082081439765873`*^9, 
  3.9082081513731003`*^9}, {3.9082091689212933`*^9, 3.908209171061174*^9}},
 CellLabel->"In[33]:=",
 CellID->1587735617,ExpressionUUID->"7c8ef76c-f32b-40d4-a6ef-4961d6f60d0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hasFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"FreeQ", "[", 
       RowBox[{"#", ",", "FindSequenceFunction"}], "]"}], "]"}], "&"}], "/@", 
    "val"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posFF", "=", 
   RowBox[{"Position", "[", 
    RowBox[{"hasFF", ",", "True"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.908209050908308*^9, 3.9082090551014833`*^9}, {
  3.908209185141099*^9, 3.9082091905518293`*^9}},
 CellLabel->"In[35]:=",
 CellID->539510809,ExpressionUUID->"e80921b6-f693-4b7d-88bd-1332686e60c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"valFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"val", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posFF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"keyFF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"key", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posFF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.908209097712267*^9, {3.908209195918708*^9, 3.908209233503007*^9}},
 CellLabel->"In[37]:=",
 CellID->974302512,ExpressionUUID->"c4852883-f0ba-46cd-a81b-13b004200519"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dc", "[", "t", "]"}], ",", 
  RowBox[{"sp", "[", 
   RowBox[{"t", "+", "3"}], "]"}], ",", "\[IndentingNewLine]", 
  RowBox[{"pi", "[", "t", "]"}], ",", 
  RowBox[{"sp", "[", 
   RowBox[{"t", "+", "3"}], "]"}], ",", "\[IndentingNewLine]", 
  RowBox[{"pibar", "[", "t", "]"}], ",", 
  RowBox[{"sp", "[", 
   RowBox[{"t", "+", "3"}], "]"}], ",", "\[IndentingNewLine]", 
  RowBox[{"sp", "[", "t", "]"}], ",", 
  RowBox[{"sp", "[", 
   RowBox[{"t", "+", "3"}], "]"}], ",", "\[IndentingNewLine]", 
  RowBox[{"sp", "[", "t", "]"}], ",", 
  RowBox[{"sp", "[", 
   RowBox[{"t", "-", "3"}], "]"}], ",", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.908286893923862*^9, 3.908286977457932*^9}},
 CellID->185913993,ExpressionUUID->"1e3f4971-7c4e-432d-ab0a-8abffcd57e31"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9082084010892353`*^9, 3.908208430045693*^9}, {
   3.908208519583907*^9, 3.908208541248156*^9}, {3.9082094459639177`*^9, 
   3.908209448610074*^9}, {3.90821052312895*^9, 3.9082105243079777`*^9}, {
   3.908210810241499*^9, 3.9082108108514757`*^9}, 3.908211486945744*^9, {
   3.9082116287405987`*^9, 3.908211630499941*^9}, {3.908211690289187*^9, 
   3.908211694009222*^9}, {3.9082191354064693`*^9, 3.908219146881366*^9}, {
   3.908219179575403*^9, 3.9082191889835052`*^9}, {3.908286990373794*^9, 
   3.9082869972730217`*^9}, {3.9085663433937883`*^9, 3.908566354456685*^9}},
 CellID->1932220874,ExpressionUUID->"2bee451d-7244-42e5-a208-2d63e952c17e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7WHw5W6A3FvHIzf5H4BoYZ67n0H0gbLsLyD6zKPC
fyA6ZWcsYyCQ3lYWzQGiy5a0g2n5lqdKIFrsVrAKiF4c6VEHoi2+TATTl6Of
vgTRm3O2vgLRexonMwSBaJU7YPqThQkHiD40KwhMX351nRdEe4ks5wPRBxTF
0kC0zw6mTLD4lon1IFqi+U8TiD6yybsbRIs5fQbTLesmTQfRKxdyzAfRJpu2
SYQB6QuFvyVB9IaWNiUQnbbstjqIvnGNwaUcSG+ZxesKokNmmBZXA+mwMOFy
EN1VVLDiP5CuaTwGpgF1vIuk
  "],
 CellID->1044897727,ExpressionUUID->"5d2f8890-9cca-432c-92a2-de869f8f8c0e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9082083676308937`*^9, 3.9082083844953327`*^9}, {
   3.908208542907724*^9, 3.908208547358246*^9}, {3.908208627558935*^9, 
   3.9082086509288807`*^9}, {3.908208706858241*^9, 3.908208708238826*^9}, {
   3.908208919172378*^9, 3.908208930620372*^9}, {3.908209650260942*^9, 
   3.908209652561062*^9}, {3.908210511167459*^9, 3.908210517669519*^9}, {
   3.9082106926095867`*^9, 3.908210694879484*^9}, {3.9082107536319513`*^9, 
   3.9082107545813913`*^9}, {3.908210798747415*^9, 3.9082108052212267`*^9}, {
   3.90821150469162*^9, 3.908211528084997*^9}, {3.908211708553258*^9, 
   3.9082117358910027`*^9}, {3.908211802365572*^9, 3.908211807601817*^9}, {
   3.908211900583803*^9, 3.908211960269734*^9}, {3.9082190777092533`*^9, 
   3.908219087857643*^9}, {3.908219156203697*^9, 3.9082191988640623`*^9}, {
   3.908287008026226*^9, 3.9082870164251347`*^9}, {3.9082955776748447`*^9, 
   3.908295608604289*^9}, {3.908295840317431*^9, 3.908295840403038*^9}, 
   3.908565030124654*^9, 3.9085650674552507`*^9, {3.908565188216782*^9, 
   3.908565208596946*^9}, 3.9085663375881166`*^9},
 CellID->1860891942,ExpressionUUID->"13094034-fa4d-4258-b21b-5d14292f5416"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "moment", " ", "by", " ", 
    RowBox[{"presence", "/", "absence"}], " ", "of", " ", "certain", " ", 
    "parameters"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"partitionBy", "[", "expr_", "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"Inactive", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "rhopbar"}], "]"}]}]}], " ", "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "vp"}], "]"}]}], "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "phispw"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "rhopbar"}], "]"}]}], "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "phipbarpb"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "rhopbar"}], "]"}]}], "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "phispw"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "rhopbar"}], "]"}]}], "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"Not", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "vp"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "rhopbar"}], "]"}]}], "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"Not", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "phispw"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"Inactive", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "rhopbar"}], "]"}]}]}], " ", "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr", ",", "Esp"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Not", "@", 
          RowBox[{"Inactive", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "rhopbar"}], "]"}]}]}], " ", "&&", " ", 
         RowBox[{"Inactive", "@", 
          RowBox[{"Not", "@", 
           RowBox[{"FreeQ", "[", 
            RowBox[{"expr", ",", "Esp"}], "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Inactive", "@", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"expr", ",", "vppbar"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numCond", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Dimensions", "@", 
        RowBox[{"Values", "@", 
         RowBox[{"DownValues", "@", "partitionBy"}]}]}], ")"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dv", "=", 
     RowBox[{"DownValues", "@", "partitionBy"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partitionWithValue", "=", 
     RowBox[{"Values", "@", 
      RowBox[{"First", "@", 
       RowBox[{"Fold", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Insert", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "#2"}], "]"}], "&"}], ",", 
         "dv", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "n", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1", ",", "numCond"}], "}"}]}], "]"}]}], 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"categorize", "[", "expr_", "]"}], ":=", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"partitionWithValue", ",", 
        RowBox[{"-", "99"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", "categorize", "]"}], "=", 
     RowBox[{"Activate", "@", 
      RowBox[{"DownValues", "@", "categorize"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.908563931002532*^9, 3.908563931514079*^9}, {
  3.908565848187764*^9, 3.908565848487595*^9}},
 CellLabel->"In[44]:=",
 CellID->974728071,ExpressionUUID->"b630a2db-f33f-44e9-84bb-b69529523181"],

Cell[BoxData[
 RowBox[{
  RowBox[{"splitAndFindSequenceFunction", "[", 
   RowBox[{"expr_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "denTempPos", ",", "\[IndentingNewLine]", "numTempPos", ",", 
      "\[IndentingNewLine]", "categorizedTempPos", ",", "\[IndentingNewLine]",
       "tempPosSeqFun", ",", "\[IndentingNewLine]", "out", ",", 
      "\[IndentingNewLine]", "pos"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"denTempPos", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Denominator", ",", 
        RowBox[{"Together", "@", "expr"}], ",", 
        RowBox[{"{", 
         RowBox[{";;", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numTempPos", "=", 
      RowBox[{"Numerator", "@", 
       RowBox[{"Together", "@", "expr"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"categorizedTempPos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GroupBy", "[", 
         RowBox[{
          RowBox[{"List", "@@", 
           RowBox[{"numTempPos", "[", 
            RowBox[{"[", 
             RowBox[{"kk", ",", "2"}], "]"}], "]"}]}], ",", "categorize", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "+", "kk"}], ",", 
             RowBox[{"Simplify", "[", 
              RowBox[{"Plus", "@@", "#"}], "]"}]}], "}"}], "&"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "numTempPos", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"tempPosSeqFun", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "n", "]"}], "&"}], "/@", "categorizedTempPos"}],
           ",", "q"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Range", "[", "numCond", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"-", "99"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempPosSeqFun", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tempPosSeqFun", ",", 
        RowBox[{"Missing", "[", "__", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"denTempPos", "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"denTempPos", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"pos", "=", 
      RowBox[{"PositionIndex", "[", 
       RowBox[{"expr", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Plus", "@@", "tempPosSeqFun"}], ")"}], "/", 
      "denTempPos"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.90856383905271*^9, 3.908563881469428*^9}, {
   3.908563967420328*^9, 3.908564019697761*^9}, {3.908564053523045*^9, 
   3.908564085173691*^9}, {3.9085641792239428`*^9, 3.908564184535748*^9}, {
   3.9085642307772284`*^9, 3.9085642599803333`*^9}, {3.908564313598825*^9, 
   3.9085643644573107`*^9}, {3.908564607339326*^9, 3.9085646081921043`*^9}, {
   3.908564803290539*^9, 3.90856482967402*^9}, {3.9085651126845293`*^9, 
   3.908565148316759*^9}, {3.908565423099642*^9, 3.908565459874695*^9}, {
   3.9085655043913116`*^9, 3.9085655056158733`*^9}, 3.908565564514201*^9, {
   3.908565621389727*^9, 3.908565626541935*^9}, {3.908566252152266*^9, 
   3.908566257985592*^9}, {3.908566312895817*^9, 3.9085663131331987`*^9}, 
   3.90856970099152*^9},
 CellID->1525518535,ExpressionUUID->"a8614cb3-82c4-4f55-84ce-4c855d04c4ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"splitAndFindSequenceFunction", "[", 
    RowBox[{"tempPos", ",", "q"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.908564198285509*^9, 3.908564227564166*^9}, 
   3.908564286206108*^9, {3.908564316506041*^9, 3.908564318124713*^9}, {
   3.908564368436441*^9, 3.9085643685942783`*^9}, {3.9085647890222483`*^9, 
   3.9085647893685303`*^9}, {3.908564833492771*^9, 3.908564846240919*^9}, 
   3.908565048916485*^9, 3.9085650849243937`*^9, {3.908565151388412*^9, 
   3.908565161365292*^9}, {3.9085652422268476`*^9, 3.908565243196024*^9}, 
   3.908565602173995*^9, {3.908566270194013*^9, 3.908566270261448*^9}},
 CellLabel->"In[65]:=",
 CellID->1308266627,ExpressionUUID->"4af02e96-2f8e-49ff-9bbb-3298dac12917"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["Esp", "2"]}], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhopbar", " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"rhoppbar", " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", "vpp", " ", 
        "vppbar"}], "+", 
       RowBox[{"rhopbar", " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["rhoppbar", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"rhoppbar", " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{"rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"rhopbar", "-", "vp"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["Esp", "2"]}], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", "q"], " ", 
        SuperscriptBox["vpp", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vpp", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}]], " ", "rhoppbar", " ", "vp", " ", 
        "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", "rhoppbar", " ", "vp", " ", "vpp", 
        " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"2", "+", "q"}]], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", "rhoppbar", 
        " ", 
        SuperscriptBox["vp", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "q"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", "rhoppbar", 
        " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", 
         RowBox[{"2", "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", "vp", " ", 
        SuperscriptBox["vppbar", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vppbar", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", 
        SuperscriptBox["vp", "q"], " ", 
        SuperscriptBox["vppbar", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phispw", "2"], " ", "vp"}], "+", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vpp", "2"], " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}], "-", 
    RowBox[{"rhopbar", " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "rhopbar"}], "-", "vp", "+", 
       RowBox[{
        SuperscriptBox["rhopbar", "2"], " ", "vp"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phispw", "2"], " ", "vp"}], "+", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vpp", "2"], " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.908564214450889*^9, 3.9085642328989277`*^9}, {
   3.9085642824059067`*^9, 3.90856428684182*^9}, 3.908564318821351*^9, 
   3.908564369179887*^9, 3.908564588186955*^9, 3.9085647506722193`*^9, 
   3.9085647986182756`*^9, 3.908564989060124*^9, {3.9085650356554213`*^9, 
   3.9085650860279493`*^9}, {3.908565157055071*^9, 3.908565162509572*^9}, 
   3.908565198102742*^9, {3.908565231057309*^9, 3.908565258681696*^9}, 
   3.9085655234315367`*^9, {3.908565598440477*^9, 3.9085656443243437`*^9}, 
   3.9085662852792873`*^9},
 CellLabel->"Out[65]=",
 CellID->2043697083,ExpressionUUID->"910ab496-0864-4076-808b-a857e46e62bc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLag", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seqStart", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v1", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v2", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempNeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{
        RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
       RowBox[{"-", "seqStart"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempPos", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", "seqStart", ",", " ", 
       RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9085684649290323`*^9, 3.908568482514043*^9}, 
   3.908569406004183*^9},
 CellID->956735078,ExpressionUUID->"83c292d1-080d-4674-a781-8ecf6ab45da9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seqfun", "[", 
   RowBox[{"list_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"sf", "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"list", ",", "q"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FreeQ", "[", 
       RowBox[{"sf", ",", "FindSequenceFunction"}], "]"}], ",", 
      "\[IndentingNewLine]", "sf", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"ssf", "=", 
          RowBox[{"splitAndFindSequenceFunction", "[", 
           RowBox[{"list", ",", "q"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"ssf", ",", "FindSequenceFunction"}], "]"}], ",", 
          "\[IndentingNewLine]", "ssf", ",", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"createDatabase", "::", "seqfun"}], ",", 
             RowBox[{"ToString", "@", "v1"}], ",", 
             RowBox[{"ToString", "@", "v2"}]}], "]"}], ";", " ", 
           RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.908568663369425*^9, 3.908568790338278*^9}, {
  3.90856884534753*^9, 3.9085688630508013`*^9}, {3.908568966924037*^9, 
  3.908568969000143*^9}, {3.908569041359366*^9, 3.908569044370408*^9}, {
  3.908569215843432*^9, 3.908569242974472*^9}},
 CellLabel->"In[77]:=",
 CellID->612713686,ExpressionUUID->"29139246-942d-4c07-8a61-6f46ede13776"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLag", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seqStart", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v1", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v2", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempNeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"-", "maxLag"}], ",", 
       RowBox[{"-", "seqStart"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tempPos", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", "[", "t", "]"}], ",", 
          RowBox[{"v2", "[", 
           RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "seqStart", ",", " ", "maxLag"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", "<=", " ", 
      RowBox[{"(", 
       RowBox[{"-", "seqStart"}], ")"}]}]}]}], "]"}], "=", 
  RowBox[{"FindSequenceFunction", "[", 
   RowBox[{"tempNeg", ",", "q"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", ">=", " ", "seqStart"}]}]}], "]"}], "=", 
  RowBox[{"splitAndFindSequenceFunction", "[", 
   RowBox[{"tempPos", ",", "q"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.908566396961686*^9, 3.908566516367506*^9}, {
  3.90856789965169*^9, 3.908567907032095*^9}, {3.908567981354271*^9, 
  3.908567983065824*^9}},
 CellLabel->"In[62]:=",
 CellID->807971430,ExpressionUUID->"f26c85ae-6a2f-43ec-a4c3-93a709e3d580"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["phispw", "2"]}], " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]]}], "+", 
    RowBox[{
     SuperscriptBox["phispw", "2"], " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]]}], "+", 
    RowBox[{
     SuperscriptBox["phispw", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]]}], "-", 
    RowBox[{
     SuperscriptBox["phispw", "2"], " ", 
     SuperscriptBox["rhopbar", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]]}], "-", 
    RowBox[{
     SuperscriptBox["phispw", "2"], " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"]}], "+", 
    RowBox[{
     SuperscriptBox["phispw", "2"], " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["rhoppbar", "2"], " ", 
     SuperscriptBox["vpp", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", 
     SuperscriptBox["rhopbar", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhoppbar", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", "2"], " ", 
     SuperscriptBox["rhoppbar", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["phip", "2"], " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["rhoppbar", "2"], " ", 
     SuperscriptBox["vp", "2"], " ", 
     SuperscriptBox["vpp", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "rhoppbar", " ", "vpp", " ", 
     "vppbar"}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], "q"], " ", "rhoppbar", " ", "vpp", 
     " ", "vppbar"}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", "rhoppbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp", " ", "vppbar"}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", "rhoppbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", "vpp", " ", "vppbar"}], "-", 
    
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", "vpp", " ", "vppbar"}], "+", 
    
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "rhoppbar", " ", 
     SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], "q"], " ", "rhoppbar", " ", 
     SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vppbar", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vppbar", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vppbar", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "rhopbar"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vp", "2"], " ", 
     SuperscriptBox["vppbar", "2"]}], "-", 
    RowBox[{"phip", " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "3"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
    RowBox[{"phip", " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "3"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
    RowBox[{"phip", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "-", 
    RowBox[{"phip", " ", 
     SuperscriptBox["rhopbar", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "-", 
    RowBox[{"2", " ", "phip", " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
    RowBox[{"2", " ", "phip", " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
    RowBox[{"phip", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "-", 
    RowBox[{"phip", " ", 
     SuperscriptBox["rhopbar", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "-", 
    RowBox[{"phip", " ", "rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{"1", "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
    RowBox[{"phip", " ", 
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{"1", "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", "xip"}], "-", 
    RowBox[{"rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["rhopbar", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}], "-", 
    RowBox[{"rhopbar", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["rhopbar", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["1", "vp"], ")"}], "q"], " ", 
     SuperscriptBox["vpp", "2"], " ", 
     SuperscriptBox["xip", "2"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"rhopbar", "-", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9085666238232193`*^9, 3.908567942897616*^9, 
  3.908568615845922*^9},
 CellLabel->"Out[68]=",
 CellID->137615520,ExpressionUUID->"947a13a1-2188-4563-a5e5-a74f08d329a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["Esp", "2"]}], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhopbar", " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"rhoppbar", " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", "vpp", " ", 
        "vppbar"}], "+", 
       RowBox[{"rhopbar", " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["rhoppbar", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"rhoppbar", " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{"rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"rhopbar", "-", "vp"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["Esp", "2"]}], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", "q"], " ", 
        SuperscriptBox["vpp", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["rhoppbar", "2"], " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vpp", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}]], " ", "rhoppbar", " ", "vp", " ", 
        "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", "rhoppbar", " ", "vp", " ", "vpp", 
        " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"2", "+", "q"}]], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", "rhoppbar", 
        " ", 
        SuperscriptBox["vp", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", "q"], " ", "vpp", " ", "vppbar"}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", "rhoppbar", 
        " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
        SuperscriptBox["vp", 
         RowBox[{"2", "+", "q"}]], " ", "vpp", " ", "vppbar"}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "q"], " ", "vp", " ", 
        SuperscriptBox["vppbar", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vppbar", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", 
        SuperscriptBox["vp", "q"], " ", 
        SuperscriptBox["vppbar", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["Esp", "2"], " ", 
        SuperscriptBox["phipbarpb", "2"], " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", 
         RowBox[{"1", "+", "q"}]], " ", 
        SuperscriptBox["vppbar", "2"]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phispw", "2"], " ", "vp"}], "+", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vpp", "2"], " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}], "-", 
    RowBox[{"rhopbar", " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "rhopbar"}], "-", "vp", "+", 
       RowBox[{
        SuperscriptBox["rhopbar", "2"], " ", "vp"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phispw", "2"], " ", "vp"}], "+", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp", " ", 
        SuperscriptBox["vpp", "2"]}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", 
        SuperscriptBox["vpp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["vpp", "2"], " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "vp"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9085666238232193`*^9, 3.908567942897616*^9, 
  3.908568631562244*^9},
 CellLabel->"Out[69]=",
 CellID->64156821,ExpressionUUID->"4d0ef6dd-91f5-4418-9b68-052f51127053"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "v1", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pibar"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v2", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempNeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"-", "maxLag"}], ",", 
       RowBox[{"-", "seqStart"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tempPos", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", "[", "t", "]"}], ",", 
          RowBox[{"v2", "[", 
           RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "seqStart", ",", " ", "maxLag"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", "<=", " ", 
      RowBox[{"(", 
       RowBox[{"-", "seqStart"}], ")"}]}]}]}], "]"}], "=", 
  RowBox[{"FindSequenceFunction", "[", 
   RowBox[{"tempNeg", ",", "q"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", ">=", " ", "seqStart"}]}]}], "]"}], "=", 
  RowBox[{"splitAndFindSequenceFunction", "[", 
   RowBox[{"tempPos", ",", "q"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9085665533985577`*^9, 3.908566560162801*^9}},
 CellLabel->"In[74]:=",
 CellID->498799314,ExpressionUUID->"85e16388-291d-4678-8980-0dc0a7231ab0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["Esp", "2"], " ", 
   SuperscriptBox["phipbarpb", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "rhopbar"], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "q"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"rhopbar", " ", "rhoppbar", " ", "vpp"}], "+", "vppbar"}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.908566650066863*^9},
 CellLabel->"Out[78]=",
 CellID->906142558,ExpressionUUID->"dd3a0924-b83a-456b-8b9b-6e2e28f3de2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"rhopbar", " ", "vppbar"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"vp", " ", "vppbar"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"rhopbar", "-", "vp"}]], 
     RowBox[{
      SuperscriptBox["Esp", "2"], " ", 
      SuperscriptBox["phipbarpb", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["rhopbar", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "q"}]]}], " ", "rhoppbar", " ", "vp", 
         " ", "vpp"}], "+", 
        RowBox[{
         SuperscriptBox["rhopbar", "q"], " ", "rhoppbar", " ", "vp", " ", 
         "vpp"}], "+", 
        RowBox[{"rhopbar", " ", "rhoppbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp"}], "-", 
        RowBox[{
         SuperscriptBox["rhopbar", "2"], " ", "rhoppbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vpp"}], "-", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vp", " ", "vppbar"}], "+", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{"1", "+", "q"}]], " ", "vp", " ", "vppbar"}], "+", 
        RowBox[{"rhopbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vppbar"}], "-", 
        RowBox[{
         SuperscriptBox["rhopbar", "2"], " ", 
         SuperscriptBox["vp", "q"], " ", "vppbar"}]}], ")"}]}]}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9085666608008842`*^9},
 CellLabel->"Out[79]=",
 CellID->1731431429,ExpressionUUID->"d0a73fe7-b92d-46d5-8fa7-e77314f95244"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "v1", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v2", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempNeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"-", "maxLag"}], ",", 
       RowBox[{"-", "seqStart"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tempPos", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", "[", "t", "]"}], ",", 
          RowBox[{"v2", "[", 
           RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "seqStart", ",", " ", "maxLag"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", "<=", " ", 
      RowBox[{"(", 
       RowBox[{"-", "seqStart"}], ")"}]}]}]}], "]"}], "=", 
  RowBox[{"FindSequenceFunction", "[", 
   RowBox[{"tempNeg", ",", "q"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", ">=", " ", "seqStart"}]}]}], "]"}], "=", 
  RowBox[{"splitAndFindSequenceFunction", "[", 
   RowBox[{"tempPos", ",", "q"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.908566566427814*^9, 3.908566567652762*^9}},
 CellLabel->"In[80]:=",
 CellID->1691396157,ExpressionUUID->"b764cb6d-25ea-4db3-8d60-d3d4bc75e58f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["Esp", "2"], " ", 
   SuperscriptBox["phipbarpb", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "rhopbar"], ")"}], "q"], " ", "rhoppbar", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"rhopbar", " ", "rhoppbar", " ", "vpp"}], "+", "vppbar"}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.9085666698920794`*^9},
 CellLabel->"Out[84]=",
 CellID->1764610353,ExpressionUUID->"9da88888-e259-41cc-be19-5d6661ba7b5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", 
     SuperscriptBox["rhopbar", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", "rhoppbar", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"rhopbar", " ", "vppbar"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", "rhoppbar", " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"vp", " ", "vppbar"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"rhopbar", "-", "vp"}]], 
     RowBox[{
      SuperscriptBox["Esp", "2"], " ", 
      SuperscriptBox["phipbarpb", "2"], " ", "rhopbar", " ", "rhoppbar", " ", 
      "vp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["rhopbar", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "q"}]]}], " ", "rhoppbar", " ", "vpp"}], 
        "+", 
        RowBox[{
         SuperscriptBox["rhopbar", "q"], " ", "rhoppbar", " ", "vpp"}], "+", 
        RowBox[{"rhoppbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp"}], "-", 
        RowBox[{"rhopbar", " ", "rhoppbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vpp"}], "-", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vppbar"}], "+", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{"1", "+", "q"}]], " ", "vppbar"}], "+", 
        RowBox[{
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vppbar"}], "-", 
        RowBox[{"rhopbar", " ", 
         SuperscriptBox["vp", "q"], " ", "vppbar"}]}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp"}], "+", 
       RowBox[{"phip", " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}], "+", 
    RowBox[{"rhopbar", " ", 
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "rhopbar"}], "-", "vp", "+", 
       RowBox[{
        SuperscriptBox["rhopbar", "2"], " ", "vp"}]}], ")"}], " ", "vpp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "vp"}], "+", 
       RowBox[{"phip", " ", "xip"}], "+", 
       RowBox[{"phip", " ", 
        SuperscriptBox["vp", "2"], " ", "xip"}], "+", 
       RowBox[{"vp", " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.9085666826456327`*^9},
 CellLabel->"Out[85]=",
 CellID->1057037801,ExpressionUUID->"fc9bafc7-b5d6-4fd5-b595-b12c87dea158"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "v1", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "v2", "=", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempNeg", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"T", ",", 
       RowBox[{"-", "maxLag"}], ",", 
       RowBox[{"-", "seqStart"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tempPos", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", "[", "t", "]"}], ",", 
          RowBox[{"v2", "[", 
           RowBox[{"t", "+", "T"}], "]"}], ",", " ", "model"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "seqStart", ",", " ", "maxLag"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", "<=", " ", 
      RowBox[{"(", 
       RowBox[{"-", "seqStart"}], ")"}]}]}]}], "]"}], "=", 
  RowBox[{"FindSequenceFunction", "[", 
   RowBox[{"tempNeg", ",", "q"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"v1", ",", "v2", ",", 
    RowBox[{"q_", "/;", 
     RowBox[{"q", " ", ">=", " ", "seqStart"}]}]}], "]"}], "=", 
  RowBox[{"splitAndFindSequenceFunction", "[", 
   RowBox[{"tempPos", ",", "q"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.908566572449876*^9, 3.9085665739028587`*^9}},
 CellLabel->"In[86]:=",
 CellID->1054175360,ExpressionUUID->"ac0d2cbc-366c-4406-bcbc-48ef7d244ebb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["Esp", "2"], " ", 
   SuperscriptBox["phipbarpb", "2"], " ", "rhocp", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", "rhopbar"], ")"}], 
    RowBox[{"1", "+", "q"}]], " ", "rhoppbar", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"rhopbar", " ", "rhoppbar", " ", "vpp"}], "+", "vppbar"}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.908566746624058*^9},
 CellLabel->"Out[90]=",
 CellID->1649593423,ExpressionUUID->"f822d9b5-284b-4aff-995b-2666aa7b3c6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", "rhocp", " ", 
     SuperscriptBox["rhopbar", "q"], " ", "rhoppbar", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"rhopbar", " ", "vppbar"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["Esp", "2"], " ", 
     SuperscriptBox["phipbarpb", "2"], " ", "rhocp", " ", "rhoppbar", " ", 
     SuperscriptBox["vp", "q"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rhoppbar", " ", "vpp"}], "+", 
       RowBox[{"vp", " ", "vppbar"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"rhopbar", "-", "vp"}]], 
     RowBox[{
      SuperscriptBox["Esp", "2"], " ", 
      SuperscriptBox["phipbarpb", "2"], " ", "rhocp", " ", "rhopbar", " ", 
      "rhoppbar", " ", "vp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["rhopbar", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "q"}]]}], " ", "rhoppbar", " ", "vpp"}], 
        "+", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{"1", "+", "q"}]], " ", "rhoppbar", " ", "vpp"}], "+", 
        RowBox[{"rhoppbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "q"}]], " ", "vpp"}], "-", 
        RowBox[{"rhopbar", " ", "rhoppbar", " ", 
         SuperscriptBox["vp", "q"], " ", "vpp"}], "-", 
        RowBox[{
         SuperscriptBox["rhopbar", "q"], " ", "vppbar"}], "+", 
        RowBox[{
         SuperscriptBox["rhopbar", 
          RowBox[{"2", "+", "q"}]], " ", "vppbar"}], "+", 
        RowBox[{
         SuperscriptBox["vp", "q"], " ", "vppbar"}], "-", 
        RowBox[{"rhopbar", " ", 
         SuperscriptBox["vp", 
          RowBox[{"1", "+", "q"}]], " ", "vppbar"}]}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", "vpp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"phip", " ", "vp"}], "+", "xip"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"phicp", "+", 
       RowBox[{"phip", " ", "rhocp", " ", "vp"}], "+", 
       RowBox[{"Esg", " ", "vp", " ", "xic"}], "+", 
       RowBox[{"rhocp", " ", 
        SuperscriptBox["vp", "2"], " ", "xip"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["vp", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "q"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "phicp"}], " ", "phip", " ", 
        SuperscriptBox["rhopbar", "2"], " ", "vp", " ", "vpp"}], "-", 
       RowBox[{"phicp", " ", "phip", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp"}], "-", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp"}], "+", 
       RowBox[{"phicp", " ", "phip", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp"}], "-", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "rhocp", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "3"], " ", "vpp"}], "+", 
       RowBox[{
        SuperscriptBox["phip", "2"], " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "3"], " ", "vpp"}], "-", 
       RowBox[{"Esg", " ", "phip", " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "xic"}], "-", 
       RowBox[{"Esg", " ", "phip", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "3"], " ", "vpp", " ", "xic"}], "+", 
       RowBox[{"Esg", " ", "phip", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "3"], " ", "vpp", " ", "xic"}], "-", 
       RowBox[{"phicp", " ", 
        SuperscriptBox["rhopbar", "2"], " ", "vpp", " ", "xip"}], "-", 
       RowBox[{"phicp", " ", "rhopbar", " ", "vp", " ", "vpp", " ", "xip"}], 
       "-", 
       RowBox[{"phip", " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "2"], " ", "vp", " ", "vpp", " ", "xip"}], 
       "+", 
       RowBox[{"phicp", " ", 
        SuperscriptBox["rhopbar", "3"], " ", "vp", " ", "vpp", " ", "xip"}], 
       "-", 
       RowBox[{"phip", " ", "rhocp", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "xip"}], "+", 
       RowBox[{"phip", " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "xip"}], "-", 
       RowBox[{"phip", " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", "3"], " ", "vpp", " ", "xip"}], "-", 
       RowBox[{"phip", " ", "rhocp", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "4"], " ", "vpp", " ", "xip"}], "+", 
       RowBox[{"phip", " ", "rhocp", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "4"], " ", "vpp", " ", "xip"}], "-", 
       RowBox[{"Esg", " ", 
        SuperscriptBox["rhopbar", "2"], " ", "vp", " ", "vpp", " ", "xic", 
        " ", "xip"}], "-", 
       RowBox[{"Esg", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "xic", " ", "xip"}], "+", 
       
       RowBox[{"Esg", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", "xic", " ", "xip"}], "-", 
       
       RowBox[{"rhocp", " ", 
        SuperscriptBox["rhopbar", "2"], " ", 
        SuperscriptBox["vp", "2"], " ", "vpp", " ", 
        SuperscriptBox["xip", "2"]}], "-", 
       RowBox[{"rhocp", " ", "rhopbar", " ", 
        SuperscriptBox["vp", "3"], " ", "vpp", " ", 
        SuperscriptBox["xip", "2"]}], "+", 
       RowBox[{"rhocp", " ", 
        SuperscriptBox["rhopbar", "3"], " ", 
        SuperscriptBox["vp", "3"], " ", "vpp", " ", 
        SuperscriptBox["xip", "2"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "rhopbar"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"rhopbar", " ", "vp"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.908566769705611*^9},
 CellLabel->"Out[91]=",
 CellID->702777591,ExpressionUUID->"c70bcbab-a0ee-40f1-842f-827897c7969c"]
}, Open  ]],

Cell["Test moments computed using covLong", "Section",
 CellChangeTimes->{{3.8882416316078577`*^9, 3.888241636927971*^9}, {
  3.888476235734561*^9, 3.888476239568863*^9}},
 CellID->1245172077,ExpressionUUID->"a766fa8e-3cd4-492a-a3c8-aaa5cda85d93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "=", 
   RowBox[{"Symbol", "[", 
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`covLong\>\"", "<>", "modelShortName"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondE", "[", "x_", "]"}], ":=", 
   RowBox[{"uncondE", "[", 
    RowBox[{"x", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVar", "[", "x_", "]"}], ":=", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"x", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{"x", ",", "y", ",", "model"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toExogenous", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"x_", ",", 
    RowBox[{"fun", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondVarLongExo", "[", 
   RowBox[{"toExogenous", ",", "x", ",", "fun"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCovLong", "[", 
    RowBox[{"x_", ",", "y_", ",", 
     RowBox[{"fun", ":", "covLong"}]}], "]"}], ":=", 
   RowBox[{"uncondCovLongExo", "[", 
    RowBox[{"toExogenous", ",", "x", ",", "y", ",", "fun"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`CreateEulerEq`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bondRecursion", " ", "=", " ", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`ComputationalEngine`CreateEulerEq`\
findBondRecursion", "[", 
    RowBox[{"t", ",", "n", ",", "model"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"systemEqBond", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"bondRecursion", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"bondRecursion", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "]"}], "]"}], "/.", 
    RowBox[{"Ewc", "->", 
     RowBox[{"uncondE", "[", 
      RowBox[{"wc", "[", "t", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"systemEqNomBond", "=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "]"}], "]"}], "/.", 
     RowBox[{"Ewc", "->", 
      RowBox[{"uncondE", "[", 
       RowBox[{"wc", "[", "t", "]"}], "]"}]}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "convenience", " ", "variable", " ", "to", " ", "convert", " ", "bond", 
    " ", "coefficients", " ", "into", " ", "wc", " ", "coefficients"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toA", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"systemEqBond", "/.", 
       RowBox[{"n", "->", "1"}]}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"Equal", "->", "Rule"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"systemEqBond", "/.", 
       RowBox[{"n", "->", "1"}]}], "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"bondRecursion", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", 
        RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toA", " ", "=", 
    RowBox[{"Join", "[", " ", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Symbol", "/@", 
         RowBox[{
         "Names", "[", 
          "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
CreateMomentsDatabase`Private`n*\>\"", "]"}]}], "->", "1"}], "]"}], ",", 
      "toA"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Time", " ", "Aggregated", " ", "Processes"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Conssumption", " ", "and", " ", "Dividend", " ", "Growth"}], " ", 
   "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"j", "-", "1"}], ")"}], "/", "h"}], ")"}], " ", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", 
         RowBox[{"2", "h"}], "+", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2", ",", "h"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j", "+", "1"}], ")"}], "/", "h"}], ")"}], " ", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "h", "+", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ddagApproxeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"j", "-", "1"}], ")"}], "/", "h"}], ")"}], " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", 
           RowBox[{"2", "h"}], "+", "j"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2", ",", "h"}], "}"}]}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"h", "-", "j", "+", "1"}], ")"}], "/", "h"}], ")"}], " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"wealth", "-", 
    RowBox[{"consumption", " ", "and", " ", "price"}], "-", 
    RowBox[{"dividend", " ", "ratios"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"avepsC", "[", "h_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"0.0015", "*", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{"0.0015", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"h", "-", "k"}]}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}], " ", "/", "  ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"epsC", "[", 
     RowBox[{"h_", ",", "k_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         RowBox[{"Sum", "[", 
          RowBox[{"0.0015", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", 
         RowBox[{"h", "-", "k", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"h", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"aveps", "[", 
    RowBox[{"h_", ",", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], " ", "+", " ", 
    
    RowBox[{
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{"0.0015", "*", 
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", " ", 
             RowBox[{"0.0015", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", 
            RowBox[{"12", "-", "k"}]}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}], " ", "/", "  ", 
     RowBox[{"(", 
      RowBox[{"1", " ", "+", " ", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{"0.0015", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "1", ",", 
           RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps", "[", 
    RowBox[{"h_", ",", "k_", ",", "i_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", " ", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{"Sum", "[", 
         RowBox[{"0.0015", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "1", ",", 
        RowBox[{"12", "-", "k", "-", "1"}]}], "}"}]}], "]"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"Sum", "[", 
           RowBox[{"0.0015", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"12", "-", "q"}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"12", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pdAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], "   ", "-", " ", 
     RowBox[{"aveps", "[", 
      RowBox[{"12", ",", "i"}], "]"}], "  ", "+", " ", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", 
         RowBox[{"12", ",", "q", ",", "i"}], "]"}], " ", "*", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "q"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "0", ",", 
         RowBox[{"12", "-", "2"}]}], "}"}]}], "]"}]}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wcAGeq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"wc", "[", "t", "]"}], "   ", "-", " ", 
     RowBox[{"aveps", "[", "h", "]"}], "  ", "+", 
     RowBox[{"Sum", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", "[", 
         RowBox[{"h", ",", "q"}], "]"}], " ", "*", " ", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", " ", "q"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "0", ",", 
         RowBox[{"h", "-", "2"}]}], "}"}]}], "]"}]}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
    "Time", " ", "Aggregation", " ", "Formulae", " ", "for", " ", "any", " ", 
     "variables", " ", "that", " ", "are", " ", "just", " ", "summed", " ", 
     RowBox[{"(", 
      RowBox[{"Annual", " ", "=", " ", 
       RowBox[{"Sum", 
        RowBox[{"(", 
         RowBox[{"monthly", " ", "variables"}], ")"}]}]}], ")"}], " ", "such",
      " ", "as", " ", "rf", " ", "or", " ", "ret"}], ")"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", "Returns", " ", "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"retcageq", "[", 
    RowBox[{"t_", ",", "h_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"retc", "[", 
      RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"retageq", "[", 
    RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rfageq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"rf", "[", 
       RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"excreteq", "[", 
    RowBox[{"t_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ret", "[", 
     RowBox[{"t", ",", "i"}], "]"}], "-", 
    RowBox[{"bondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"excretageq", "[", 
     RowBox[{"t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"excreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"piageq", "[", 
     RowBox[{"t_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"pi", "[", 
       RowBox[{"t", "-", "h", "+", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bondretAGeq", "[", 
    RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"bondret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"excbondreteq", "[", 
    RowBox[{"t_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"bondret", "[", 
     RowBox[{"t", ",", "n"}], "]"}], " ", "-", " ", 
    RowBox[{"bondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"excbondretAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"excbondreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nomBondretAGeq", "[", 
    RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"nombondret", "[", 
      RowBox[{
       RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nomExcbondreteq", "[", 
    RowBox[{"t_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"nombondret", "[", 
     RowBox[{"t", ",", "n"}], "]"}], " ", "-", " ", 
    RowBox[{"nombondyield", "[", 
     RowBox[{"t", ",", "1"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nomExcbondretAGeq", "[", 
     RowBox[{"t_", ",", "h_", ",", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"nomExcbondreteq", "[", 
       RowBox[{
        RowBox[{"t", "-", "h", "+", "j"}], ",", "n"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "h"}], "}"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", "Variance", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"h", "*", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"x", "[", "t", "]"}], "]"}]}], "+", " ", 
    RowBox[{"2", "*", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "j"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarAGieq", "[", 
     RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"h", "*", 
      RowBox[{"uncondVar", "[", 
       RowBox[{"x", "[", 
        RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "+", " ", 
     RowBox[{"2", "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", ",", "i"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"t", "+", "j"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], ";"}], "\n", "\n", 
  
  RowBox[{"(*", " ", "Correlations", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCovarAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"h", "*", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"t", "+", "h"}], "]"}]}], "]"}]}], "+", " ", 
    RowBox[{"2", "*", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "h", "+", "j"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovarAGieq", "[", 
     RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"h", "*", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"t", ",", "i"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{
          RowBox[{"t", "+", "h"}], ",", "i"}], "]"}]}], "]"}]}], "+", " ", 
     RowBox[{"2", "*", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"h", "-", "j"}], ")"}], "*", " ", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", ",", "i"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"t", "+", "h", "+", "j"}], ",", "i"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"h", "-", "1"}]}], "}"}]}], "]"}]}]}]}], " ", ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCorrAGeq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"uncondCovarAGeq", "[", 
     RowBox[{"x", ",", "t", ",", "h"}], "]"}], "/", 
    RowBox[{"uncondVarAGeq", "[", 
     RowBox[{"x", ",", "t", ",", "h"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCorrAGieq", "[", 
    RowBox[{"x_", ",", "t_", ",", "h_", ",", "i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"uncondCovarAGieq", "[", 
     RowBox[{"x", ",", "t", ",", "h", ",", "i"}], "]"}], "/", 
    RowBox[{"uncondVarAGieq", "[", 
     RowBox[{"x", ",", "t", ",", "h", ",", "i"}], "]"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.8958168210104513`*^9, 3.89581682762383*^9}, {
  3.8958173702555733`*^9, 3.895817468444346*^9}, {3.895817531539584*^9, 
  3.895817628511847*^9}, {3.895817691797708*^9, 3.895817697322554*^9}, {
  3.895826878420919*^9, 3.895826884309168*^9}},
 CellLabel->"In[24]:=",
 CellID->86110327,ExpressionUUID->"8e46033a-47e2-4014-932f-72f4a9ac8c26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", "t", "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "+", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", "t", "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "2"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", 
       RowBox[{"t", "-", "3"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dc", "[", "t", "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], "+", 
       RowBox[{"3", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondVarLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"aa", " ", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "+", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "2"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dc", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "+", 
        RowBox[{"bb", " ", 
         RowBox[{"dc", "[", "t", "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"aa", " ", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "+", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dc", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "+", 
       RowBox[{"bb", " ", 
        RowBox[{"dc", "[", "t", "]"}]}]}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.8957546278413677`*^9, 
   3.8957546760990753`*^9}, {3.895754771434485*^9, 3.895754785380404*^9}, {
   3.8958167756216*^9, 3.895816783041016*^9}},
 CellLabel->"In[63]:=",
 CellID->1319307510,ExpressionUUID->"4789936a-5c37-4d9e-bb8b-8eafa33f338e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dc3", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc3", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc3", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc4", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc4", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc4", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc5", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc5", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc5fw", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{"dc5lag", "+", "dc5fw"}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dc5lag", "+", "dc5fw"}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc12", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "12"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc12", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc12", "]"}]}], "//", "Simplify"}], "\n", 
 RowBox[{
  RowBox[{"dc12lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc12lag", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc12lag", "]"}]}], "//", "Simplify"}], "\n", 
 RowBox[{
  RowBox[{"dc12fw", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dc12fw", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dc12fw", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
   "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"dd", "[", 
     RowBox[{
      RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"2", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], "]"}],
    "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"4", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
      RowBox[{"3", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", 
    RowBox[{
     RowBox[{"4", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
     RowBox[{"3", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{
      RowBox[{"k1", " ", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
      RowBox[{"k2", " ", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"dd3", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd3", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd3", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd4", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "4", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd4", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd4", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "5", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd5", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd5", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5lag", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "5", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd5fw", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "5", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{
      RowBox[{"dd5lag", "+", "dd5fw"}], ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dd5lag", "+", "dd5fw"}], "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "12", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12lag", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "12"}], ",", "12", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12lag", "]"}]}], "//", "Simplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd12fw", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "+", "12"}], ",", "12", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondVarLong", "[", 
     RowBox[{"dd12fw", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondVar", "[", "dd12fw", "]"}]}], "//", "Simplify"}], "\n", 
  "\n", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], " ", "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", 
      RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "0", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "1", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "2", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "x", ",", "3", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", " ", 
      RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "x", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
   "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", 
      RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "0", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "1", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "2", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"ret", ",", "sx", ",", "3", ",", "i"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"ret", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
      RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "sx", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//", "Expand"}], "//", 
   "Simplify"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "4"}]}], "]"}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "pibar", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"pibar", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{"sg", "[", "t", "]"}]}], "]"}]}]}], "//", 
                    "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\n", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sg2", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//",
                     "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\n", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "0"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "2"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "3"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "sgeps", ",", "4"}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"sg", "[", 
                    RowBox[{"t", "-", "1"}], "]"}], " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}],
                     "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "4"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                    RowBox[{
                    RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "3"}]}], "]"}]}], "-", 
                    RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                  RowBox[{
                   RowBox[{"Simplify", "\[IndentingNewLine]", 
                    RowBox[{"covLong", "[", 
                    RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "2"}]}], "]"}]}], "-", 
                   RowBox[{"uncondCov", "[", 
                    RowBox[{
                    RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", " ", 
                    RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                    "]"}]}]}], "//", "Expand"}], "//", 
                RowBox[{
                 RowBox[{"Simplify", "\[IndentingNewLine]", 
                  RowBox[{"covLong", "[", 
                   RowBox[{"ret", ",", "eps", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], "-", 
                 RowBox[{"uncondCov", "[", 
                  RowBox[{
                   RowBox[{"ret", "[", 
                    RowBox[{
                    RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", " ", 
                   RowBox[{
                    SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                  "]"}]}]}], "//", "Expand"}], "//", 
              RowBox[{
               RowBox[{"Simplify", "\[IndentingNewLine]", 
                RowBox[{"covLong", "[", 
                 RowBox[{"ret", ",", "eps", ",", "0"}], "]"}]}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", " ", 
                 RowBox[{
                  SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
                "]"}]}]}], "//", "Expand"}], "//", 
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"ret", ",", "eps", ",", "1"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", " ", 
               RowBox[{
                SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
              "]"}]}]}], "//", "Expand"}], "//", 
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"ret", ",", "eps", ",", "2"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", " ", 
             RowBox[{
              SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
            "]"}]}]}], "//", "Expand"}], "//", 
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"ret", ",", "eps", ",", "3"}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", " ", 
           RowBox[{
            SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], 
          "]"}]}]}], "//", "Expand"}], "//", 
      RowBox[{
       RowBox[{"Simplify", "\[IndentingNewLine]", 
        RowBox[{"covLong", "[", 
         RowBox[{"ret", ",", "eps", ",", "4"}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}]}]}], 
     "//", "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", "\n", 
   "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", "testing", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", 
     RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"ret", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"ret", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}]}], "Input",\

 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.8957546278413677`*^9, 
   3.8957546760990753`*^9}, {3.895754771434485*^9, 3.895754785380404*^9}, 
   3.8958167756216*^9},
 CellLabel->"In[77]:=",
 CellID->537762824,ExpressionUUID->"304f2442-f638-4eb6-aa14-52471393d424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "4"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], " ", "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "3"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "2"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", 
         RowBox[{"-", "1"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "0"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "1"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "2"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "3"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "x", ",", "4"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
     "Expand"}], "//", "Simplify"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "4"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "3"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "2"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", 
        RowBox[{"-", "1"}]}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "0"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "1"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "2"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "3"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "sx", ",", "4"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\n", "\n", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", 
        RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "pd", ",", 
                 RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "4"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"pd", "[", 
                  RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"br", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                  RowBox[{"n", "->", "1"}]}], "/.", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
                RowBox[{"Equal", "->", "Rule"}]}], ")"}]}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"Simplify", "\[IndentingNewLine]", 
                RowBox[{"covLong", "[", 
                 RowBox[{"retrf", ",", "pd", ",", 
                  RowBox[{"-", "3"}], ",", "i"}], "]"}]}], "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "-", "3"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{"pd", "[", 
                  RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"br", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                  RowBox[{"n", "->", "1"}]}], "/.", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
                RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{"Simplify", "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "pd", ",", 
                 RowBox[{"-", "2"}], ",", "i"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}]}], ",", 
                RowBox[{"pd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"br", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                 RowBox[{"n", "->", "1"}]}], "/.", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
               RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"retrf", ",", "pd", ",", 
                RowBox[{"-", "1"}], ",", "i"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "1"}], ",", "1"}], "]"}]}], ",", 
               RowBox[{"pd", "[", 
                RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"br", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2", ",", 
                   RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
                RowBox[{"n", "->", "1"}]}], "/.", 
               RowBox[{
                RowBox[{
                 SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
              RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "\[IndentingNewLine]", 
             RowBox[{"covLong", "[", 
              RowBox[{"retrf", ",", "pd", ",", "0", ",", "i"}], "]"}]}], "-", 
            
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "1"}], "]"}]}], ",", 
              RowBox[{"pd", "[", 
               RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"br", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", 
                  RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
               RowBox[{"n", "->", "1"}]}], "/.", 
              RowBox[{
               RowBox[{
                SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
             
             RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"retrf", ",", "pd", ",", "1", ",", "i"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{
                RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "+", "1"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"br", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
              RowBox[{"n", "->", "1"}]}], "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
            RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "\[IndentingNewLine]", 
           RowBox[{"covLong", "[", 
            RowBox[{"retrf", ",", "pd", ",", "2", ",", "i"}], "]"}]}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "+", "2"}], ",", "1"}], "]"}]}], ",", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"br", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
             RowBox[{"n", "->", "1"}]}], "/.", 
            RowBox[{
             RowBox[{
              SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
           RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"retrf", ",", "pd", ",", "3", ",", "i"}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{
              RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "+", "3"}], ",", "1"}], "]"}]}], ",", 
           RowBox[{"pd", "[", 
            RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"br", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2", ",", 
               RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
            RowBox[{"n", "->", "1"}]}], "/.", 
           RowBox[{
            RowBox[{
             SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
          RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "\[IndentingNewLine]", 
         RowBox[{"covLong", "[", 
          RowBox[{"retrf", ",", "pd", ",", "4", ",", "i"}], "]"}]}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "+", "4"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{"pd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"br", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"2", ";;", "3"}]}], "]"}], "]"}], "/.", 
           RowBox[{"n", "->", "1"}]}], "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["R", "_"], "[", "0", "]"}], "->", "0"}]}], "/.", 
         RowBox[{"Equal", "->", "Rule"}]}], ")"}]}]}], "//", "Simplify"}], 
    "*)"}], "\n", "\n", "\n", "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"rf", ",", "pibar", ",", "4"}], "]"}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "3"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", "0"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "2"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "3"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "pibar", ",", 
                 RowBox[{"-", "4"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"pibar", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "4"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "3"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "2"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "1"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", "0"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "2"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "3"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg", ",", 
                 RowBox[{"-", "4"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
                 RowBox[{"sg", "[", "t", "]"}]}], "]"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg2", ",", "4"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}], "//", 
             RowBox[{
              RowBox[{"Simplify", "\[IndentingNewLine]", 
               RowBox[{"covLong", "[", 
                RowBox[{"rf", ",", "sg2", ",", "3"}], "]"}]}], "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
            RowBox[{
             RowBox[{"Simplify", "\[IndentingNewLine]", 
              RowBox[{"covLong", "[", 
               RowBox[{"rf", ",", "sg2", ",", "2"}], "]"}]}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
               RowBox[{
                RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
           
           RowBox[{
            RowBox[{"Simplify", "\[IndentingNewLine]", 
             RowBox[{"covLong", "[", 
              RowBox[{"rf", ",", "sg2", ",", "1"}], "]"}]}], "-", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
              RowBox[{
               RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
          RowBox[{
           RowBox[{"Simplify", "\[IndentingNewLine]", 
            RowBox[{"covLong", "[", 
             RowBox[{"rf", ",", "sg2", ",", "0"}], "]"}]}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
         RowBox[{
          RowBox[{"Simplify", "\[IndentingNewLine]", 
           RowBox[{"covLong", "[", 
            RowBox[{"rf", ",", "sg2", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
        RowBox[{
         RowBox[{"Simplify", "\[IndentingNewLine]", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "sg2", ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
       RowBox[{
        RowBox[{"Simplify", "\[IndentingNewLine]", 
         RowBox[{"covLong", "[", 
          RowBox[{"rf", ",", "sg2", ",", 
           RowBox[{"-", "3"}]}], "]"}]}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"bondyield", "[", 
           RowBox[{
            RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
      RowBox[{
       RowBox[{"Simplify", "\[IndentingNewLine]", 
        RowBox[{"covLong", "[", 
         RowBox[{"rf", ",", "sg2", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", "t", "]"}], "^", "2"}]}], "]"}]}]}], "//", 
     RowBox[{
      RowBox[{"Simplify", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "4"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", "0"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "2"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "sgeps", ",", 
         RowBox[{"-", "4"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sg", "[", 
           RowBox[{"t", "-", "1"}], "]"}], " ", 
          RowBox[{
           SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "4"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "3"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "2"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "1"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", "0"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "2"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "3"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"bondyield", "[", 
          RowBox[{
           RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", " ", 
         RowBox[{
          SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "eps", ",", 
         RowBox[{"-", "4"}]}], "]"}]}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["\[CurlyEpsilon]", "p"], "[", "t", "]"}]}], "]"}]}]}], 
    "*)"}], "\n", "\n", "\n", 
   RowBox[{"(*", "testing", "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"dc", ",", "dc", ",", "0"}], "]"}], "==", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dc", "[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"dd", ",", "dd", ",", "0", ",", "i"}], "]"}], "==", 
    RowBox[{"uncondVar", "[", 
     RowBox[{"dd", "[", 
      RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "check", " ", "that", " ", "all", " ", "that", " ", "matters", " ", "is",
       " ", "difference", " ", "in", " ", "t"}], ",", " ", 
     RowBox[{"not", " ", "absolute", " ", "distance"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "hh", "-", "qq"}], "]"}], ",", 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "hh"}], ",", "i"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"hh", ",", 
           RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "hh"}], "]"}], ",", 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "+", "hh", "-", "qq"}], ",", "i"}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"hh", ",", 
           RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "qq"}], ",", "i"}], "]"}]}], "]"}]}], " ", "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"pd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"pd", "[", 
          RowBox[{
           RowBox[{"t", "+", "qq"}], ",", "i"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", 
          RowBox[{"t", "-", "qq"}], "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"dc", "[", "t", "]"}], ",", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "qq"}], ",", "i"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"qq", ",", 
       RowBox[{"-", "4"}], ",", "4"}], "}"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "4"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "0"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "dd", ",", 
       RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "4"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "4"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "2"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "1"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "-", "0"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "1"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "2"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"dc", ",", "pd", ",", 
       RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "4"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dc", "[", "t", "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dc", "[", "t", "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"2", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], ",", "covLong"}], 
      "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"4", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
        RowBox[{"3", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "+", 
       RowBox[{"3", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k1", " ", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"k2", " ", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"k1", " ", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
        RowBox[{"2", 
         RowBox[{"dd", "[", 
          RowBox[{
           RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
        RowBox[{"k2", " ", 
         RowBox[{"dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}]}]}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{
       RowBox[{"k1", " ", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "+", 
       RowBox[{"2", 
        RowBox[{"dd", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "i"}], "]"}]}], "+", 
       RowBox[{"k2", " ", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{"t", "+", "3"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", "covLong"}], "]"}], 
     "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", "t", "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"dc", "[", "t", "]"}], "2"], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"dc", "[", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], "]"}]}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}], ",", "covLong"}],
       "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"dc", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}], ",", 
       RowBox[{"pd", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "+", "t"}], ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"dd3", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd3", ",", "dd3", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd3", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "4", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd4", ",", "dd4", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd4", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd5", ",", "dd5", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd5", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "12"}], ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd5fw", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "+", "12"}], ",", "5", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"dd5lag", "+", "dd5fw"}], ",", 
       RowBox[{"dd5lag", "+", "dd5fw"}], ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"dd5lag", "+", "dd5fw"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{"t", ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12", ",", "dd12", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "12"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12lag", ",", "dd12lag", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12lag", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd12fw", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "+", "12"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{"dd12fw", ",", "dd12fw", ",", "covLong"}], "]"}], "-", 
     RowBox[{"uncondVar", "[", "dd12fw", "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd3lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd3lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd4lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "pd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "pd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd4lag", "=", 
     RowBox[{"pdAGeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "pd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "pd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd3lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "dd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "dd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc3", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd3lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc3", ",", "dd3lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc3", ",", "dd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "3", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "dd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "dd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dc4", "=", 
     RowBox[{"dcagApproxeq", "[", 
      RowBox[{"t", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dd4lag", "=", 
     RowBox[{"ddagApproxeq", "[", 
      RowBox[{
       RowBox[{"t", "-", "4"}], ",", "12", ",", "i"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{"dc4", ",", "dd4lag", ",", "covLong"}], " ", "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{"dc4", ",", "dd4lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
    "Chop"}], "\n", 
   RowBox[{"(*", " ", "testing", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", 
       RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{"ret", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"ret", "[", 
        RowBox[{
         RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], ",", 
       RowBox[{"dd", "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.895742884147416*^9, 3.8957428847471857`*^9}, {3.895743277469316*^9, 
   3.8957432775878143`*^9}, 3.895743497762248*^9, 3.895743647941506*^9},
 CellLabel->"In[148]:=",
 CellID->1739871239,ExpressionUUID->"01323ad2-a4f2-4692-9a6a-05804ea0c7bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "testing", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", 
        RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "+", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "0", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "0"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "1", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "2", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "2"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "3", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "3"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"rf", ",", "dd", ",", "4", ",", "i"}], "]"}], "-", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"bondyield", "[", 
         RowBox[{
          RowBox[{"t", "-", "4"}], ",", "1"}], "]"}], ",", 
        RowBox[{"dd", "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}]}], "//.", "toA"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895742250908043*^9, 3.895742251787053*^9}, {
   3.8957432775903263`*^9, 3.895743277595463*^9}},
 CellLabel->"In[277]:=",
 CellID->171046095,ExpressionUUID->"305c0ee0-17c4-4377-8c58-a80c58d8c753"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ret2", "=", 
   RowBox[{"retageq", "[", 
    RowBox[{"t", ",", "2", ",", "i"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"rf2", " ", "=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"bondyield", "[", 
       RowBox[{
        RowBox[{"t", "-", "i"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"retrf2", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"retrf", "[", 
        RowBox[{"t", "-", "kk"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kk", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pd2lag", "=", 
   RowBox[{"pdAGeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "2"}], ",", "2", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc2lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "2"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd2", "=", 
    RowBox[{"ddagApproxeq", "[", 
     RowBox[{"t", ",", "2", ",", "i"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc2", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc2", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc2", ",", "dc2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc2", ",", "dc2lag"}], "]"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{"retrf2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret2", "-", "rf2"}], ",", "pd2lag"}], "]"}]}], "//.", 
      "toA"}], "//", "FullSimplify"}], "//", "Chop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc2", ",", "pd2lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dd2", ",", "pd2lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dd2", ",", "pd2lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "Chop"}], "\n", 
 RowBox[{
  RowBox[{"ret3", "=", 
   RowBox[{"retageq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rf3", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"bondyield", "[", 
      RowBox[{
       RowBox[{"t", "-", "i"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pd3lag", "=", 
   RowBox[{"pdAGeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "3"}], ",", "3", ",", "i"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc3", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{"t", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dc3lag", "=", 
   RowBox[{"dcagApproxeq", "[", 
    RowBox[{
     RowBox[{"t", "-", "3"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd3", "=", 
   RowBox[{"ddagApproxeq", "[", 
    RowBox[{"t", ",", "3", ",", "i"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVarLong", "[", 
    RowBox[{"dc3", ",", "covLong"}], "]"}], "-", 
   RowBox[{"uncondVar", "[", "dc3", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"uncondCovLong", "[", 
     RowBox[{"dc3", ",", "dc3lag", ",", "covLong"}], "]"}], "-", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"dc3", ",", "dc3lag"}], "]"}]}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{"retrf3", ",", "pd3lag", ",", "covLong"}], "]"}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"ret3", "-", "rf3"}], ",", "pd3lag"}], "]"}]}], " ", "//.", 
      "toA"}], "//", "FullSimplify"}], "//", "Chop"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"uncondCovLong", "[", 
         RowBox[{"dc3", ",", "pd3lag", ",", "covLong"}], "]"}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{"dc3", ",", "pd3lag"}], "]"}]}], "//", "FullSimplify"}], "//", 
      RowBox[{
       RowBox[{"Chop", "\[IndentingNewLine]", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{"dd3", ",", "pd3lag", ",", "covLong"}], "]"}]}], "-", 
       RowBox[{"uncondCov", "[", 
        RowBox[{"dd3", ",", "pd3lag"}], "]"}]}]}], "//", "FullSimplify"}], "//",
     "Chop"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "testing", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"am4", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"retrf", ",", "retrf", ",", 
          RowBox[{"-", "4"}], ",", "i"}], "]"}], "-", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{
             RowBox[{"t", "-", "4"}], ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{
             RowBox[{"t", "-", "4"}], ",", "1"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"ret", "[", 
            RowBox[{"t", ",", "i"}], "]"}], "-", 
           RowBox[{"bondyield", "[", 
            RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
      RowBox[{"Simplify", "\[IndentingNewLine]", "am3"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"retrf", ",", "retrf", ",", 
           RowBox[{"-", "3"}], ",", "i"}], "]"}], "-", 
         RowBox[{"uncondCov", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{
              RowBox[{"t", "-", "3"}], ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{
              RowBox[{"t", "-", "3"}], ",", "1"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"ret", "[", 
             RowBox[{"t", ",", "i"}], "]"}], "-", 
            RowBox[{"bondyield", "[", 
             RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
       RowBox[{"Simplify", "\[IndentingNewLine]", "am2"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"retrf", ",", "retrf", ",", 
            RowBox[{"-", "2"}], ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{
               RowBox[{"t", "-", "2"}], ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{
               RowBox[{"t", "-", "2"}], ",", "1"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"ret", "[", 
              RowBox[{"t", ",", "i"}], "]"}], "-", 
             RowBox[{"bondyield", "[", 
              RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
        RowBox[{"Simplify", "\[IndentingNewLine]", "am1"}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"retrf", ",", "retrf", ",", 
             RowBox[{"-", "1"}], ",", "i"}], "]"}], "-", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{
                RowBox[{"t", "-", "1"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"ret", "[", 
               RowBox[{"t", ",", "i"}], "]"}], "-", 
              RowBox[{"bondyield", "[", 
               RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
         RowBox[{"Simplify", "\[IndentingNewLine]", "a0"}]}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"covLong", "[", 
             RowBox[{"retrf", ",", "retrf", ",", 
              RowBox[{"-", "0"}], ",", "i"}], "]"}], "-", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{
                 RowBox[{"t", "-", "0"}], ",", "1"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"ret", "[", 
                RowBox[{"t", ",", "i"}], "]"}], "-", 
               RowBox[{"bondyield", "[", 
                RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], "//", 
          RowBox[{"Simplify", "\[IndentingNewLine]", "a1"}]}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"retrf", ",", "retrf", ",", "1", ",", "i"}], "]"}], "-", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{
                  RowBox[{"t", "+", "1"}], ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{
                  RowBox[{"t", "+", "1"}], ",", "1"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"ret", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], "-", 
                RowBox[{"bondyield", "[", 
                 RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}], 
           "//", 
           RowBox[{"Simplify", "\[IndentingNewLine]", "a2"}]}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"retrf", ",", "retrf", ",", "2", ",", "i"}], "]"}], 
              "-", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{
                   RowBox[{"t", "+", "2"}], ",", "1"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"ret", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], "-", 
                 RowBox[{"bondyield", "[", 
                  RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", "toA"}],
             "//", 
            RowBox[{"Simplify", "\[IndentingNewLine]", "a3"}]}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "retrf", ",", "3", ",", "i"}], "]"}], 
               "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "3"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{"t", ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", 
              "toA"}], "//", 
             RowBox[{"Simplify", "\[IndentingNewLine]", "a4"}]}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"covLong", "[", 
                RowBox[{"retrf", ",", "retrf", ",", "4", ",", "i"}], "]"}], 
               "-", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{
                    RowBox[{"t", "+", "4"}], ",", "1"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ret", "[", 
                   RowBox[{"t", ",", "i"}], "]"}], "-", 
                  RowBox[{"bondyield", "[", 
                   RowBox[{"t", ",", "1"}], "]"}]}]}], "]"}]}], "//.", 
              "toA"}], "//", "Simplify"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\n"}], "Input",
 CellChangeTimes->{{3.8117112197942486`*^9, 3.8117112289202447`*^9}, {
   3.811711727993037*^9, 3.8117117285726047`*^9}, {3.8117119058102875`*^9, 
   3.811711906189273*^9}, {3.8117814761707325`*^9, 3.8117814782853107`*^9}, {
   3.811781529827727*^9, 3.811781554646219*^9}, {3.8117815912068434`*^9, 
   3.8117816219108677`*^9}, {3.8117816583165884`*^9, 3.811781679347345*^9}, {
   3.8117820377562575`*^9, 3.8117820481081295`*^9}, 3.811797734519514*^9, {
   3.811841130754213*^9, 3.811841130907894*^9}, {3.811856521889971*^9, 
   3.811856538991959*^9}, {3.81185665764974*^9, 3.8118566763250885`*^9}, {
   3.811859544744793*^9, 3.8118595457005215`*^9}, {3.8118599553267417`*^9, 
   3.811859956329298*^9}, {3.8118618593784037`*^9, 3.8118619131166077`*^9}, {
   3.8118620246049175`*^9, 3.8118620277986884`*^9}, {3.811862864686257*^9, 
   3.8118628658363075`*^9}, {3.811929807831415*^9, 3.81192981410753*^9}, {
   3.862320016774708*^9, 3.862320025950768*^9}, {3.862320113911742*^9, 
   3.862320190078929*^9}, {3.862320492854546*^9, 3.862320495861684*^9}, {
   3.862322701074832*^9, 3.862322731069481*^9}, {3.862323313323612*^9, 
   3.8623233270160646`*^9}, 3.862323745956338*^9, {3.862384398448078*^9, 
   3.862384398952948*^9}, {3.862384432564468*^9, 3.862384479554916*^9}, {
   3.8623845098353024`*^9, 3.8623845179846163`*^9}, {3.862505637987726*^9, 
   3.8625056709565163`*^9}, {3.862505709579206*^9, 3.862505789868325*^9}, {
   3.862505988370454*^9, 3.8625060370511007`*^9}, {3.8625061280428667`*^9, 
   3.8625061992342052`*^9}, {3.862506392519856*^9, 3.862506415449131*^9}, {
   3.862506451682272*^9, 3.862506458007402*^9}, {3.862506571584297*^9, 
   3.8625065940253143`*^9}, {3.8625110518405457`*^9, 3.862511217560048*^9}, {
   3.8625112483125057`*^9, 3.862511271821577*^9}, 3.862511309084247*^9, {
   3.8625116874481497`*^9, 3.862511687698064*^9}, {3.86251227253645*^9, 
   3.862512334595408*^9}, 3.862517590507873*^9, {3.862563267114295*^9, 
   3.862563271409977*^9}, 3.8684646097980223`*^9, 3.868476720860319*^9, {
   3.868735762015476*^9, 3.868735762398068*^9}, {3.895716259019083*^9, 
   3.895716273603591*^9}, 3.895737619293734*^9, {3.89574076488087*^9, 
   3.8957408341190968`*^9}, {3.895741908886486*^9, 3.895741942052672*^9}, 
   3.895742040286768*^9, 3.8957420812235126`*^9, {3.8957421208228893`*^9, 
   3.895742216741891*^9}, {3.895743277597159*^9, 3.895743277604294*^9}},
 CellLabel->"In[286]:=",
 CellID->799257596,ExpressionUUID->"e98cc1a3-180d-4a06-a9cb-15ac15611263"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdc1"}], "=", 
   "\"\<covLong[{`1`,`2`}, `3`, q, r] does not match \
uncondCov[`1`[t]*`2`[t+q], `3`[t+r]] for some q,r\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdc2"}], "=", 
   "\"\<covLong[`1`, {`2`,`3`}, q, r] does not match uncondCov[`1`[t], \
`2`[t+q]*`3`[t+r]] for some q,r\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdd1"}], "=", 
   "\"\<covLong[{v1,v2},v3, q, r] does not match uncondCov[v1[t]*v2[t+q], \
v3[t+r]] for some q,r, and some {v1,v2,v3} where two elements come from `1` \
and one element comes from `2` \>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "::", "nomatchdd2"}], "=", 
   "\"\<covLong[v1,{v2,v3}, q, r] does not match \
uncondCov[v1[t],v2[t+q]*v3[t+r]] for some q,r, and some {v1,v2,v3} where two \
elements come from `1` and one element comes from `2` \>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868430617213367*^9, 3.868430624135852*^9}, {
  3.868430709822543*^9, 3.868430796505639*^9}, {3.868430839031724*^9, 
  3.868430839454426*^9}, {3.868430994563813*^9, 3.86843101498873*^9}},
 CellLabel->"In[304]:=",
 CellID->1496354362,ExpressionUUID->"7cc70058-0f88-4fdd-bc82-3427853c894e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"testing", " ", 
    RowBox[{"(", 
     RowBox[{"can", " ", "take", " ", "a", " ", "long", " ", "time"}], 
     ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maxLag", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"list", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "dc", ",", "pi", ",", "pibar"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList", "=", 
     RowBox[{"Permutations", "[", "list", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testListd", "=", 
     RowBox[{"Permutations", "[", 
      RowBox[{"list", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"all", " ", "length"}], "-", 
     RowBox[{"2", " ", "permutations", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"sx", ",", "x", ",", "dc", ",", "dd"}], "}"}], " ", "that", 
      " ", "contain", " ", "dd"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.868183290740081*^9, 3.868183322969268*^9}, {
   3.868183381714491*^9, 3.868183555451178*^9}, {3.868183979015998*^9, 
   3.868184143536919*^9}, {3.868184205160576*^9, 3.8681842432022867`*^9}, {
   3.868184364242258*^9, 3.86818440339872*^9}, {3.868184470693329*^9, 
   3.8681845579705057`*^9}, {3.868184733290329*^9, 3.8681847336338882`*^9}, {
   3.868184781905233*^9, 3.868184792905096*^9}, {3.8681850426787987`*^9, 
   3.868185132222588*^9}, {3.868185248545433*^9, 3.868185248762332*^9}, {
   3.868199582572283*^9, 3.868199603851144*^9}, {3.868199657653294*^9, 
   3.8681996578430967`*^9}, {3.868199812613455*^9, 3.868199822582457*^9}, {
   3.868200175760764*^9, 3.868200180769318*^9}, {3.868200258501315*^9, 
   3.8682003102398033`*^9}, 3.868200352941801*^9, {3.868217374130706*^9, 
   3.868217391901312*^9}, {3.868217422600671*^9, 3.868217432763451*^9}, {
   3.868217619476942*^9, 3.8682176457308083`*^9}, {3.868218215887637*^9, 
   3.868218243215564*^9}, 3.868380394899704*^9, 3.868430276347712*^9, 
   3.868430307659354*^9, {3.8684303390804996`*^9, 3.868430344950329*^9}, {
   3.868431040444603*^9, 3.868431052518409*^9}, {3.8687037969302053`*^9, 
   3.868703815953435*^9}, {3.8687042306188507`*^9, 3.86870425640793*^9}, {
   3.86870430443965*^9, 3.8687043053310013`*^9}, 3.8687047653808193`*^9, 
   3.868718660035314*^9, {3.8687192412827797`*^9, 3.868719248588983*^9}, 
   3.8687192987901297`*^9, 3.8687349064590282`*^9, {3.873075661582253*^9, 
   3.8730756659569674`*^9}},
 CellLabel->"In[308]:=",
 CellID->1874572404,ExpressionUUID->"13ad996b-df0a-46b4-aed4-d4f0c640ef20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "q", ",", "r"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testList"}], "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdc1"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8682174344804277`*^9, 3.868217615985887*^9}, {
   3.8682176980259457`*^9, 3.868217704857314*^9}, 3.8682177659547*^9, {
   3.868218149135633*^9, 3.868218181387199*^9}, {3.868218224666708*^9, 
   3.8682182273951473`*^9}, {3.868218279642826*^9, 3.86821828008319*^9}, {
   3.868380298916513*^9, 3.868380305282085*^9}, {3.868430340797443*^9, 
   3.868430354456196*^9}, {3.868430486141069*^9, 3.868430531860894*^9}, {
   3.8684310394667597`*^9, 3.8684310433442373`*^9}},
 CellLabel->"In[312]:=",
 CellID->1989471160,ExpressionUUID->"4855ff25-b8b5-492b-80f3-f82c0d254490"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"vars", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "q", ",", "r"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testList"}], "}"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdc2"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"list", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684303958241243`*^9, 3.868430429151132*^9}, {
  3.868430547948758*^9, 3.8684305489035397`*^9}},
 CellLabel->"In[314]:=",
 CellID->432055528,ExpressionUUID->"80548acb-a45d-4b8c-b985-bdaa0487b0a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"dd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd1"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t2d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dd", ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t3d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "dd"}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{"dd", "[", 
              RowBox[{
               RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t3d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t4d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"dd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t4d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t5d", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "dd", ",", "q", 
            ",", "r", ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{"t", "+", "r"}], ",", "i"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t5d"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "dd", "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684302788280888`*^9, 3.868430300141458*^9}, {
   3.868430370375915*^9, 3.8684303779666*^9}, {3.8684305755597687`*^9, 
   3.8684306017278147`*^9}, {3.868430675094701*^9, 3.868430691310279*^9}, {
   3.868430803588604*^9, 3.868430832143063*^9}, {3.8684309402859*^9, 
   3.868430982746119*^9}, {3.868431049574254*^9, 3.868431103113779*^9}, {
   3.8687192773373833`*^9, 3.868719292495607*^9}, {3.868719448718773*^9, 
   3.868719451047024*^9}, 3.86871982807099*^9, {3.8687200865274057`*^9, 
   3.868720108834371*^9}, 3.8687349396008863`*^9, {3.868735395161248*^9, 
   3.868735410518011*^9}, {3.868735461245483*^9, 3.8687354737154408`*^9}, {
   3.868735666973319*^9, 3.868735667128256*^9}},
 CellLabel->"In[316]:=",
 CellID->160108917,ExpressionUUID->"543f6144-c7ca-4dbc-8b1e-a87f724a8c97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], "*", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t1pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd1"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t2pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pd", ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t2pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t3pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "pd"}], "}"}], ",", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "q", ",", "r", ",", "i"}], 
           "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{"pd", "[", 
              RowBox[{
               RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"vars", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "\[IndentingNewLine]",
          "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", ",", 
        "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t3pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t4pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"pd", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "q", ",", "r", 
            ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t4pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"t5pd", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "pd", ",", "q", 
            ",", "r", ",", "i"}], "]"}], "-", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], 
             RowBox[{
              RowBox[{"vars", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"t", "+", "q"}], "]"}]}], ",", 
            RowBox[{"pd", "[", 
             RowBox[{
              RowBox[{"t", "+", "r"}], ",", "i"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\t\t", "]"}], "\[IndentingNewLine]", "\t\t", 
        ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"vars", ",", "testListd"}], "}"}], "\[IndentingNewLine]", ",", 
      
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLag"}], ",", "maxLag"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "t5pd"}], ",", 
     RowBox[{
      RowBox[{"Equal", "[", 
       RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], ",", 
   "\"\<Test passed\>\"", ",", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"covLong", "::", "nomatchdd2"}], ",", "varList", ",", 
     RowBox[{"{", "pd", "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8684302788280888`*^9, 3.868430300141458*^9}, {
   3.868430370375915*^9, 3.8684303779666*^9}, {3.8684305755597687`*^9, 
   3.8684306017278147`*^9}, {3.868430675094701*^9, 3.868430691310279*^9}, {
   3.868430803588604*^9, 3.868430832143063*^9}, {3.8684309402859*^9, 
   3.868430982746119*^9}, {3.868431049574254*^9, 3.868431103113779*^9}, {
   3.8687192773373833`*^9, 3.868719292495607*^9}, {3.868719448718773*^9, 
   3.868719451047024*^9}, 3.86871982807099*^9, {3.8687200865274057`*^9, 
   3.868720108834371*^9}, {3.8687349396008863`*^9, 3.8687350778754377`*^9}, {
   3.868735542725609*^9, 3.868735592837367*^9}, 3.8687356967617817`*^9, 
   3.8687357401462317`*^9},
 CellLabel->"In[326]:=",
 CellID->1021365996,ExpressionUUID->"70656be0-aa1e-414c-a53a-bc03466f5910"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellLabel->"In[401]:=",
 CellID->997759263,ExpressionUUID->"9e4cd370-846c-4007-833e-02dd8d608cba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "j"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "j"}], "]"}], 
      RowBox[{"dd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"pd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.868561751493519*^9, 3.868561754859425*^9}},
 CellLabel->"In[402]:=",
 CellID->1294489255,ExpressionUUID->"8becfc8d-44f5-40f0-b77f-0c4197dce588"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"pd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dd", "[", 
       RowBox[{"t", ",", "i"}], "]"}], 
      RowBox[{"pd", "[", 
       RowBox[{
        RowBox[{"t", "+", "2"}], ",", "i"}], "]"}]}], ",", 
     RowBox[{"dd", "[", 
      RowBox[{
       RowBox[{"t", "-", "3"}], ",", "i"}], "]"}]}], "]"}]}], " ", "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.868561763395924*^9, 3.868561772542441*^9}},
 CellLabel->"In[429]:=",
 CellID->1255539483,ExpressionUUID->"7666f660-9f31-41dd-a482-70be20b1bc95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"sx", "[", "t", "]"}], 
      RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
   RowBox[{"uncondCovLong", "[", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"sx", "[", "t", "]"}], 
      RowBox[{"x", "[", "t", "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"",
 CellID->387215999,ExpressionUUID->"e8be9159-73e8-4bc9-9613-41805008b746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.86864871445879*^9, 3.8686487421037683`*^9}, {
  3.8687047775690327`*^9, 3.868704784100897*^9}},
 CellID->309605539,ExpressionUUID->"3c2ea379-0fba-4592-88dc-c8131b98ece8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"x", "[", "t", "]"}], "2"], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "sx"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}],
   "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"sx", "[", "t", "]"}], "2"], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], 
     RowBox[{"sx", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], 
     RowBox[{"sx", "[", "t", "]"}]}], ",", 
    RowBox[{"x", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}], 
  "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "sx", ",", "0", ",", "0"}], "]"}], 
  "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{"sx", "[", "t", "]"}], ",", 
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}]}], "]"}], "==", 
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"sx", "[", "t", "]"}], 
     RowBox[{"x", "[", "t", "]"}]}], ",", 
    RowBox[{"sx", "[", "t", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.868649444323964*^9, 3.868649444578911*^9}},
 CellLabel->"In[301]:=",
 CellID->1741115415,ExpressionUUID->"42f96ecf-84c6-4726-80eb-7e07960443c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"test", " ", "totCov"}], ",", " ", "totCov2", ",", " ", 
    "totCovLong"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"totCov", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totCov2", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"ev", "[", 
        RowBox[{
         RowBox[{"x", "*", "y"}], ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], "]"}], 
       RowBox[{"uncondE", "[", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList1", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testList2", "=", 
     RowBox[{"{", 
      RowBox[{"sx", ",", "x", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCovLong", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t3", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"uncondCovLong", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t4", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCov", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t5", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"totCov2", "[", 
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], ",", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], ",", 
         RowBox[{"t", "+", 
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q2", ",", 
         RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"t1", "==", "t2", "==", "t3", "==", "t4", "==", "t5"}], ",", 
     "modelAssumptions"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8686497805231123`*^9, 3.868649812397028*^9}, {
   3.868649910876871*^9, 3.8686499175762*^9}, {3.868649969848742*^9, 
   3.868649972195404*^9}, {3.868650045635866*^9, 3.8686500522514353`*^9}, {
   3.868650083517132*^9, 3.8686501256458807`*^9}, 3.868650157866232*^9, {
   3.868650526693671*^9, 3.868650537224121*^9}, {3.868650580377983*^9, 
   3.868650617676289*^9}, {3.8730757546041117`*^9, 3.873075760773357*^9}},
 CellID->369571884,ExpressionUUID->"6389e088-8cb6-4969-a513-c7a1cac2846b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", "dc", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList2", "=", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868650459451703*^9, 3.868650486728876*^9}, {
  3.87307576416591*^9, 3.873075765981423*^9}},
 CellLabel->"In[554]:=",
 CellID->340783995,ExpressionUUID->"fd124a6b-ea34-4b7e-aea8-48989acbfea6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", "t", "]"}], 
        RowBox[{"v3", "[", "t", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", "t", "]"}], 
         RowBox[{"v3", "[", "t", "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868650554036792*^9, 3.86865056809198*^9}, {
   3.868650630488484*^9, 3.86865073824118*^9}, 3.868650786599669*^9, {
   3.868650860753031*^9, 3.8686509020681677`*^9}, 3.8686513001513968`*^9, {
   3.8686513319283113`*^9, 3.868651332124798*^9}, {3.873075775766135*^9, 
   3.873075777781489*^9}},
 CellID->538633863,ExpressionUUID->"d9145aec-21ec-4dd2-b903-59f7a2e7d6f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}], 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868651327352656*^9, 3.868651364722836*^9}, 
   3.868653325262486*^9, {3.8730757813256683`*^9, 3.873075783717208*^9}},
 CellID->1073921610,ExpressionUUID->"bf7f73c0-51b0-4a7a-8d55-96d194f6244d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8686533386180897`*^9, 3.8686533527307243`*^9}, {
  3.873075787166266*^9, 3.873075788677038*^9}},
 CellID->1914543127,ExpressionUUID->"2fda6806-18a8-46b9-9b15-15a6c25cbb7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}], ",", "x", ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "x"}], "}"}], ",", "x", ",", "0", ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"dc", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "dc"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{"dc", ",", 
    RowBox[{"{", 
     RowBox[{"dc", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dc", ",", "sx"}], "}"}], ",", "dc", ",", "0", ",", "0"}], "]"}],
   "==", 
  RowBox[{"covLong", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sx", ",", "dc"}], "}"}], ",", "dc", ",", "0", ",", "0"}], 
   "]"}]}]}], "Input",
 CellID->425500841,ExpressionUUID->"b085671d-90de-4e0a-9423-fd686494c5d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList3", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList4", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q3"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], 
         RowBox[{"v4", "[", 
          RowBox[{"t", "+", "q3"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.873075808947585*^9, 3.8730758713320103`*^9}},
 CellID->1922088329,ExpressionUUID->"bf4209fd-6826-45a3-aa6a-51ad8a3006ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", "t", "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"x", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"sx", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"sx", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.868564162034954*^9, 3.868564233092915*^9}, {
  3.868564312031789*^9, 3.868564314407172*^9}, {3.8686535310981293`*^9, 
  3.8686535389565687`*^9}, {3.868653578368771*^9, 3.868653690043038*^9}},
 CellLabel->"In[255]:=",
 CellID->1888953057,ExpressionUUID->"39c24a7e-be69-4df8-b81c-d5f8bc4f45f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uncondCov", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "s"}], "]"}], 
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "q"}], "]"}]}], ",", 
    RowBox[{"dc", "[", 
     RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "s"}], "]"}], 
     RowBox[{"dc", "[", 
      RowBox[{"t", "+", "q"}], "]"}]}], ",", 
    RowBox[{"dc", "[", 
     RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8686908444509983`*^9, 3.8686908478989153`*^9}, 
   3.8686909213270607`*^9, 3.868690986892284*^9},
 CellID->1824051709,ExpressionUUID->"2427736b-eb0b-4eef-9d63-fa7646701adc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "s"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}]}], ",", 
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "r"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ExpandAll", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}], "-", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "+", "s"}], "]"}], ",", 
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "q"}], "]"}], 
           RowBox[{"dc", "[", 
            RowBox[{"t", "+", "r"}], "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}], "]"}], 
   ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.86869088394128*^9, 3.86869095944561*^9}, {
  3.868690990326233*^9, 3.86869112102425*^9}, {3.868691381611908*^9, 
  3.8686913833701353`*^9}, {3.868691713564088*^9, 3.868691715370327*^9}},
 CellLabel->"In[254]:=",
 CellID->1934616487,ExpressionUUID->"26920505-3a3e-478c-bdd5-9e65a60b5faa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", 
          RowBox[{"t", "+", "q3"}], "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868703925769659*^9, 3.868703939416643*^9}},
 CellID->773307292,ExpressionUUID->"16ff98aa-39ad-4244-9a4f-3b9d4e1bcc5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList3", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", "[", 
        RowBox[{"t", "+", "q3"}], "]"}], ",", 
       RowBox[{
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}], "*", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], "*", 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q2", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"q3", ",", 
        RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}]}], "Input",
 CellChangeTimes->{{3.868703960713661*^9, 3.868703969849883*^9}},
 CellID->1176812697,ExpressionUUID->"57648cb4-e9ad-4cab-9afe-5b7e928b97f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLags", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList1", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList2", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testList3", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testList4", "=", 
    RowBox[{"{", 
     RowBox[{"x", ",", "sx", ",", "pi", ",", "pibar"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", "t", "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"uncondCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "q3"}], "]"}], 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"v3", "[", "t", "]"}], 
        RowBox[{"v4", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "testList1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v2", ",", "testList2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v3", ",", "testList3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"v4", ",", "testList4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q2", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q3", ",", 
       RowBox[{"-", "maxLags"}], ",", "maxLags"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.873075918451975*^9, 3.8730759353809547`*^9}},
 CellID->1173427227,ExpressionUUID->"c10d6709-23e5-4a37-8340-fa4d9a102d76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"excbondret3m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret6m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret12m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret24m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "24"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret60m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "60"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"excbondret120m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "120"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"excbondret240m", " ", "=", " ", 
   RowBox[{"excbondretAGeq", "[", 
    RowBox[{"t", ",", "12", ",", "240"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"excbondret360m", " ", "=", " ", 
    RowBox[{"excbondretAGeq", "[", 
     RowBox[{"t", ",", "12", ",", "360"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "6"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "12"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
     RowBox[{"uncondVar", "[", 
      RowBox[{"excbondretAGeq", "[", 
       RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "6"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "12"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "24"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "60"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "120"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "240"}], "]"}], "]"}], ",", 
      RowBox[{"uncondVarLong", "[", 
       RowBox[{"excbondretAGeq", "[", 
        RowBox[{"t", ",", "12", ",", "360"}], "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"t1", "==", "t2"}], ",", "modelAssumptions"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.868704481420594*^9, 3.868704569868958*^9}, {
  3.868704612638925*^9, 3.8687046685586033`*^9}},
 CellID->1048670426,ExpressionUUID->"d45b1289-5e74-46ad-a167-5e9dcd76c656"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"uncondVar", "[", "pd1", "]"}], "-", 
       RowBox[{"uncondVarLong", "[", "pd1", "]"}]}], ")"}], "//", 
     "ExpandAll"}], ",", "modelAssumptions"}], "]"}], "//", "Chop"}]], "Input",\

 CellID->1523198083,ExpressionUUID->"5d16d098-dfa1-45c9-a819-af32568d12de"],

Cell["Debug", "Section",
 CellChangeTimes->{{3.895715698844183*^9, 3.895715700449379*^9}, {
  3.895733486000606*^9, 3.895733486651452*^9}},
 CellID->217936585,ExpressionUUID->"f0e0c30c-6c48-4783-8372-7a0238f3d9f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895733773338502*^9, 3.895733788002239*^9}},
 CellLabel->"In[49]:=",
 CellID->948560129,ExpressionUUID->"b453214e-c12a-46bf-bcfb-50db272eb4f6"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->615780736,ExpressionUUID->"6303cc4c-1669-48c3-9163-1c6b9941009a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelShortName", "=", "\"\<NRCStochVol\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pacletDir", "=", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PacletDirectoryLoad", "[", "pacletDir", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"filenameModels", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<Models.wl\>\""}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"covLongFilename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{
      "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<.wl\>\""}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"covLongFilenameSave", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
       RowBox[{
       "\"\<covLong\>\"", "<>", "modelShortName", "<>", "\"\<Save.wl\>\""}]}],
       "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{"\"\<CreateMomentsDatabase\>\"", "<>", "\"\<.wl\>\""}]}], "}"}], 
   "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeUnconditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], 
    "}"}], "]"}]}], "\n", 
 RowBox[{"Get", "@", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
    "pacletDir", ",", "\"\<Kernel\>\"", ",", "\"\<ComputationalEngine\>\"", 
     ",", 
     RowBox[{
     "\"\<ComputeConditionalExpectations\>\"", "<>", "\"\<.wl\>\""}]}], "}"}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Parameters`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`Shocks`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"<<", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"AppendTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`\>\""}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$ContextPath", "=", 
   RowBox[{"AppendTo", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729862870124*^9}, 3.8957309499046583`*^9, 3.895733506641651*^9, {
   3.895777346719429*^9, 3.895777346999277*^9}, {3.908204834732432*^9, 
   3.908204836641664*^9}},
 CellID->1400565960,ExpressionUUID->"009f6e07-b0e8-4157-87bf-549518eea6b2"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[18]:=",
 CellID->1836688693,ExpressionUUID->"d20b5979-6696-4234-920b-0699042702f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataModels", "=", 
   RowBox[{"Get", "[", "filenameModels", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "@", "dataModels"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{
   "FernandoDuarte`LongRunRisk`Models", "[", "modelShortName", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895715713895854*^9, 3.895715738893158*^9}, {
   3.895715908596304*^9, 3.895715963401937*^9}, {3.8957160713052483`*^9, 
   3.895716083132218*^9}, {3.8957161377043962`*^9, 3.8957161882670193`*^9}, {
   3.895717393810329*^9, 3.895717394573805*^9}, 3.895717474417964*^9, {
   3.895718044728428*^9, 3.895718051443563*^9}, {3.895729385229898*^9, 
   3.895729385425364*^9}, 3.895729590394854*^9, {3.895729826427555*^9, 
   3.895729852714592*^9}, 3.895730962609375*^9, {3.895733797515676*^9, 
   3.895733801145486*^9}},
 CellLabel->"In[19]:=",
 CellID->233099349,ExpressionUUID->"0d2d0ce1-9bc4-4c28-9079-3bd95d16bedf"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[22]:=",
 CellID->1708634170,ExpressionUUID->"4a313c56-a737-43e3-826f-c889b47d6d23"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nproc", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"maxLag", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stateVars", "=", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Variables", "[", 
          RowBox[{
           RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
          " ", "]"}], ",", 
         RowBox[{
          RowBox[{"x_", "[", "_", "]"}], ":>", "x"}]}], "]"}], ",", "0"}], 
      "]"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", "dd", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"varListdd", "=", 
    RowBox[{
    "{", "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "}"}]}], 
   ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "equations", " ", "that", " ", "do", " ", "not", " ", "depend", " ", "on", 
    " ", "stocks", " ", "or", " ", "bonds"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"expandList", "=", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", ",", "\n", 
      "\t", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`sdf", ",", 
      "\n", "\t", 
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nomsdf"}], "\n", 
     "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", "stocks", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"expandListStocks", "=", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", ",", "\n", 
      "\t", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`ret"}], 
     "\n", "}"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", "bonds", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"expandListBond", "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
    "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bond", ",", "\n", 
     "\t", "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombond", 
     ",", "\n", "\t", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondret", ",", 
     "\n", "\t", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombondret", ",", 
     "\n", "\t", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`bondyield", ",", 
     "\n", "\t", 
     "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`nombondyield"}], 
    "\n", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"shocksList", " ", "=", " ", 
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
     "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", "]"}], 
     
     RowBox[{"(*", 
      RowBox[{",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<x\>\"", "]"}],
        ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pibar\>\"", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sx\>\"", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sc\>\"", 
        "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sp\>\"", 
        "]"}]}], "*)"}], "\n", "\t\t", "}"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"covariance", " ", "with", " ", "pd12lag"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars1", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<dc\>\"", ",", "\"\<dd\>\""}], 
    RowBox[{"(*", 
     RowBox[{
     ",", "\"\<pd\>\"", ",", "\"\<rf\>\"", ",", "\"\<excret\>\"", ",", 
      "\"\<pdpd\>\"", ",", "\"\<dcdc\>\"", ",", "\"\<dddd\>\"", ",", 
      "\"\<excretexcret\>\"", ",", "\"\<rfrf\>\"", ",", "\"\<dcpd\>\"", ",", 
      "\"\<ddpd\>\"", ",", "\"\<excretpd\>\"", ",", "\"\<rfpd\>\""}], "*)"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vars2", "=", 
    RowBox[{"{", "\"\<pd12lag\>\"", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", "$ProcessorCount", "]"}], ";", 
  RowBox[{"$ProcessorCount", "=", "nproc"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";", 
  RowBox[{"LaunchKernels", "[", "nproc", "]"}], ";", 
  RowBox[{"Kernels", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Needs", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Needs", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeConditionalExpectations`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stateVarsNoEps", " ", "=", " ", 
    RowBox[{"Complement", "[", 
     RowBox[{"stateVars", ",", 
      RowBox[{"Cases", "[", 
       RowBox[{"stateVars", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"x_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "y___", "]"}], ":>", 
         RowBox[{"x", "[", "y", "]"}]}], ",", "Infinity", ",", 
        RowBox[{"Heads", "->", "True"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"state", " ", "vars"}], ",", " ", 
    RowBox[{"dc", " ", "and", " ", "pi"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"stateVarsNoEps", ",", 
     RowBox[{"{", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", ",", 
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi"}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"covLong", "=", 
   RowBox[{"Symbol", "[", 
    RowBox[{
    "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`CreateMomentsDatabase`\
covLong\>\"", "<>", "modelShortName"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89573356249751*^9, 3.895733649353182*^9}, {
  3.8957338544111032`*^9, 3.895733854627788*^9}, {3.8957772460472393`*^9, 
  3.895777246320805*^9}, {3.895777385372488*^9, 3.895777386591341*^9}},
 CellLabel->"In[45]:=",
 CellID->572051971,ExpressionUUID->"3c792b57-d2cb-4a41-a2b1-6f96d8933130"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[30]:=",
 CellID->1857920609,ExpressionUUID->"86390011-5f65-48f0-9426-6044fe3de69e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"toExogenous", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondE", "[", "expr_", "]"}], ":=", 
   RowBox[{"uncondE", "[", 
    RowBox[{"expr", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondVar", "[", "expr_", "]"}], ":=", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"expr", ",", "model"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uncondCov", "[", 
     RowBox[{"expr1_", ",", "expr2_"}], "]"}], ":=", 
    RowBox[{"uncondCov", "[", 
     RowBox[{"expr1", ",", "expr2", ",", "model"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ev", "[", 
    RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"ev", "[", 
    RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", "[", 
    RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"var", "[", 
    RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cov", "[", 
     RowBox[{"expr1_", ",", "expr2_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"cov", "[", 
     RowBox[{"expr1", ",", "expr2", ",", "t", ",", "model"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"uncondCovLong", ",", "uncondVarLong"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCovLong", "[", 
   RowBox[{"expr1_", ",", " ", "expr2_", ",", " ", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondCovLongExo", "[", 
   RowBox[{
   "toExogenous", ",", "expr1", ",", " ", "expr2", ",", "  ", "covfun"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondVarLongExo", "[", 
   RowBox[{"toExogenous", ",", "expr", ",", "  ", "covfun"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.895733651816711*^9, 3.8957336677832947`*^9}},
 CellLabel->"In[62]:=",
 CellID->1513111601,ExpressionUUID->"90992321-d665-4212-96ae-e338bca8896e"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[72]:=",
 CellID->680891331,ExpressionUUID->"056f55c4-799c-4a3d-bb85-8ff72ccc332a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"law", " ", "of", " ", "total", " ", "variance"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_", ",", 
       RowBox[{"fun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], ",", "fun"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"notAllZero", "[", "q___", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          StyleBox[
           RowBox[{"Unequal", "[", 
            RowBox[{"#", ",", "0"}], "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], "&"}], "/@", 
        RowBox[{"{", "q", "}"}]}], ")"}]}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "at", " ", "least", " ", "one", " ", "input", " ", "argument", " ", "is",
       " ", "non"}], "-", "zero"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varlistWithEps", " ", "=", " ", 
     RowBox[{"Join", "[", 
      RowBox[{"varList", ",", "shocksList"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"tup1", "=", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"varlistWithEps", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ":>", 
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"tup2", "=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"{", 
      RowBox[{"varlistWithEps", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"varlistWithEps", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
  3.8957339017721653`*^9, 3.895733908424635*^9}, {3.895777303458351*^9, 
  3.895777315394703*^9}, {3.895777422565732*^9, 3.895777423689221*^9}},
 CellLabel->"In[78]:=",
 CellID->1793071465,ExpressionUUID->"689f5de4-dcd0-49b0-858f-6b2b4d4d36eb"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[47]:=",
 CellID->757035952,ExpressionUUID->"f82e1ded-b78d-41fd-a345-8e5029b71cc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv1", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733925734923*^9, 3.895733929727652*^9}, 
   3.895733990808304*^9, {3.895734158758215*^9, 3.895734162397365*^9}},
 CellLabel->"In[48]:=",
 CellID->1577972345,ExpressionUUID->"e9c7d9b6-5f8f-4ca2-a714-86cd7089813d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0"}], 
       "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
       "]"}]}], ")"}], "&"}], "/@", "tup1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"OrderlessPatternSequence", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"OrderlessPatternSequence", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
          "]"}], ",", "0", ",", "0"}], "]"}], "=", 
       RowBox[{"uncondCov", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
        "]"}]}], ")"}], "&"}], "/@", "tup2"}], ";"}], "\t"}]}], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
  3.8957339017721653`*^9, 3.8957339409958878`*^9}},
 CellLabel->"In[83]:=",
 CellID->91702224,ExpressionUUID->"99687550-6963-4e70-bb2e-755dd77cf613"],

Cell[BoxData[
 RowBox[{"DownValues", "[", "covLongDES", "]"}]], "Input",
 CellChangeTimes->{{3.8957774509120693`*^9, 3.895777460643166*^9}},
 CellLabel->"In[86]:=",
 CellID->959537086,ExpressionUUID->"5c2f99ab-47bc-46a3-8b00-b2f17ed4ab19"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.895777516534027*^9, 3.895777518812263*^9}},
 CellID->1615969172,ExpressionUUID->"022abf0d-20f6-4240-9cd0-3ad96b1bb9a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv2", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv2", ",", "dv1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8957339537971582`*^9, 3.895733984148233*^9}, {
  3.895734165365377*^9, 3.895734200929391*^9}},
 CellLabel->"In[59]:=",
 CellID->1751556299,ExpressionUUID->"0e36516a-7792-4338-9223-35e963fff9bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1_", ",", 
      RowBox[{"{", 
       RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
      "q2_Integer"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"notAllZero", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1", ",", 
      RowBox[{"{", 
       RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2"}], "]"}], 
    "=", 
    RowBox[{"totCovLong", "[", 
     RowBox[{
      RowBox[{"v1", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}], "*", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
      RowBox[{"t", "+", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
  3.8957339017721653`*^9, 3.895733921853109*^9}, {3.895734039033209*^9, 
  3.89573404216687*^9}},
 CellLabel->"In[61]:=",
 CellID->365982575,ExpressionUUID->"7287a881-3457-4a4c-ad29-06f6855187a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv3", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv3", ",", "dv2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8957340441396027`*^9, 3.895734050345619*^9}, {
   3.895734184526361*^9, 3.895734192337214*^9}, 3.895737876394084*^9},
 CellLabel->"In[62]:=",
 CellID->697052970,ExpressionUUID->"b92467ee-6aad-4585-9e76-a0a2b0eedf98"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "v3_", ",", "q1_Integer", 
       ",", "q2_Integer"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"notAllZero", "[", 
       RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", " ", 
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2"}], 
      "]"}], "=", 
     RowBox[{"totCovLong", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], "*", 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}], ",", 
       RowBox[{"t", "+", 
        RowBox[{"Min", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
      "]"}]}]}], ";"}], "\t"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, {
   3.895734119105364*^9, 3.895734125547876*^9}},
 CellLabel->"In[64]:=",
 CellID->1077642200,ExpressionUUID->"a16cd14f-c652-43c3-9321-e42ec285a976"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv4", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv4", ",", "dv3"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8957342149973*^9, 3.895734217975978*^9}, 
   3.8957378818502913`*^9},
 CellLabel->"In[65]:=",
 CellID->450224054,ExpressionUUID->"c76eada0-73a0-4208-9365-6f329ca13ee5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rp", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"{", 
      RowBox[{"pos_", ",", "i_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"ReplaceAt", "[", 
    RowBox[{"expr", ",", 
     RowBox[{
      RowBox[{"vv_", "[", 
       RowBox[{"t", "+", "q_."}], "]"}], ":>", 
      RowBox[{"vv", "[", 
       RowBox[{
        RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", "pos"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.895734246698497*^9}},
 CellLabel->"In[67]:=",
 CellID->99681556,ExpressionUUID->"a7f194c2-0255-433a-b3c3-6b900d89245a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1_", ",", 
      RowBox[{"{", 
       RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
      "q2_Integer", ",", "i__"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SymbolName", "@", "v1"}], ",", 
         RowBox[{"SymbolName", "@", "v2"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v3"}]}], "}"}], ",", 
       RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], "]"}],
      "==", 
     RowBox[{"Length", "[", 
      RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1", ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", "v3"}], "}"}], ",", "q1", ",", "q2", ",", "i"}], 
     "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SymbolName", "@", "v1"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SymbolName", "@", "v2"}], ",", 
              RowBox[{"SymbolName", "@", "v3"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], ",", 
          
          RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"vdd", "=", 
        RowBox[{"Activate", "[", 
         RowBox[{"Fold", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{
              RowBox[{"Inactive", "[", "Times", "]"}], "[", 
              RowBox[{
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q1"}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{"t", "+", "q2"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"pos", ",", 
              RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"tc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"totCovLong", "[", 
            RowBox[{"##", ",", 
             RowBox[{"t", "+", 
              RowBox[{"Min", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
              "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
     "\[IndentingNewLine]", "\t\t", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}},
 CellLabel->"In[68]:=",
 CellID->1510515935,ExpressionUUID->"e43ee5cf-bb5d-4e43-a67e-b393a8c6d5dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv5", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv5", ",", "dv4"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895734254748756*^9, 3.8957342654071627`*^9}, 
   3.895737889127407*^9},
 CellLabel->"In[69]:=",
 CellID->889293912,ExpressionUUID->"f7d89c5c-365a-4bdd-af86-8d6f0d65b5c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1_", " ", ",", "v2_"}], "}"}], ",", "v3_", ",", "q1_Integer",
       ",", "q2_Integer", ",", "i__"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SymbolName", "@", "v1"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v2"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v3"}]}], "}"}], ",", 
       RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], "]"}],
      "==", 
     RowBox[{"Length", "[", 
      RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"covLong", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2", 
       ",", "i"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SymbolName", "@", "v1"}], ",", " ", 
          RowBox[{"SymbolName", "@", "v2"}], ",", " ", 
          RowBox[{"SymbolName", "@", "v3"}]}], "}"}], ",", 
        RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
       "]"}], "==", 
      RowBox[{"Length", "[", 
       RowBox[{"List", "[", "i", "]"}], "]"}]}]}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SymbolName", "@", "v1"}], " ", ",", 
              RowBox[{"SymbolName", "@", "v2"}]}], "}"}], ",", 
            RowBox[{"SymbolName", "@", "v3"}]}], "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], ",", 
          
          RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"vdd", "=", 
        RowBox[{"Activate", "[", 
         RowBox[{"Fold", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Inactive", "[", "Times", "]"}], "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
             RowBox[{"v3", "[", 
              RowBox[{"t", "+", "q2"}], "]"}]}], " ", "}"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"pos", ",", 
              RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"tc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"totCovLong", "[", 
            RowBox[{"##", ",", 
             RowBox[{"t", "+", 
              RowBox[{"Min", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
              "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
     "\[IndentingNewLine]", "\t\t", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734306952661*^9}},
 CellLabel->"In[71]:=",
 CellID->1579513808,ExpressionUUID->"128ad873-70e8-4dbc-9fc1-5b22571e3453"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv6", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv6", ",", "dv5"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895734312946602*^9, 3.895734316874373*^9}, 
   3.89573789310507*^9},
 CellLabel->"In[72]:=",
 CellID->278228608,ExpressionUUID->"8c31c104-5559-4d88-b415-0b45ae2ea05a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
    RowBox[{"uncondCov", "[", 
     RowBox[{
      RowBox[{"v1", " ", "v2"}], ",", " ", 
      RowBox[{"v3", " ", "v4"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tup3", "=", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"varList", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ":>", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"tup4", "=", 
    RowBox[{"tup2", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", 
        RowBox[{"{", 
         RowBox[{"b_", ",", "c_"}], "}"}]}], "}"}], ":>", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "a"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"tup5", "=", 
    RowBox[{"Tuples", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{"varList", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"varList", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\t\t"}]}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734322859807*^9}},
 CellLabel->"In[74]:=",
 CellID->1493030434,ExpressionUUID->"bb76b19c-5c08-4edb-ab73-4da93ab5ceae"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[77]:=",
 CellID->1794562194,ExpressionUUID->"c81e7f03-7431-4694-bfdb-66abb1cc0215"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0", ",", 
        "0"}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
       "]"}]}], ")"}], "&"}], "/@", "tup3"}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734344699806*^9}},
 CellLabel->"In[78]:=",
 CellID->741108031,ExpressionUUID->"a821bfc4-975a-44f2-9ed5-ec4e4662bb65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv7", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Complement", "[", 
   RowBox[{"dv7", ",", "dv6"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895734349130229*^9, 3.895734354097411*^9}, 
   3.895737898305698*^9},
 CellLabel->"In[79]:=",
 CellID->1251698300,ExpressionUUID->"8b41af17-b7b6-48ab-9dbd-3bd0a5250fe9"],

Cell[BoxData[{
 RowBox[{"covLong", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sx", ",", "sx"}], "}"}], ",", "sx", ",", "0", ",", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covLong", "[", 
   RowBox[{"sx", ",", 
    RowBox[{"{", 
     RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"covLong", "[", 
  RowBox[{
  "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", 
   "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x", ",", "1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"covLong", "[", 
  RowBox[{"sx", ",", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.895734529042653*^9, 3.895734536898876*^9}, {
  3.895734670034378*^9, 3.895734677660541*^9}, {3.895737908286092*^9, 
  3.895737914995084*^9}, {3.89573798457906*^9, 3.895737986296974*^9}},
 CellLabel->"In[81]:=",
 CellID->1872547159,ExpressionUUID->"19209fe1-2ecf-470a-adbc-7ceb373620ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"OrderlessPatternSequence", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], "]"}],
         ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
       "]"}]}], ")"}], "&"}], "/@", "tup4"}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734344699806*^9}},
 CellLabel->"In[85]:=",
 CellID->262424894,ExpressionUUID->"4c0b28d8-7d37-417f-b372-b34ea63cbea9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv8", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Complement", "[", 
  RowBox[{"dv8", ",", "dv7"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8957343602499638`*^9, 3.895734365057713*^9}},
 CellLabel->"In[86]:=",
 CellID->2028199401,ExpressionUUID->"91e02323-f70e-42b0-ad95-0183bd4d2ff1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"OrderlessPatternSequence", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"OrderlessPatternSequence", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"OrderlessPatternSequence", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], "]"}],
         ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ", 
       "]"}]}], ")"}], "&"}], "/@", "tup5"}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734328657292*^9}, 3.895734368349573*^9},
 CellLabel->"In[88]:=",
 CellID->397524417,ExpressionUUID->"e6fc47b8-19ac-4cc9-afdc-4bd3deec53a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv9", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Complement", "[", 
  RowBox[{"dv9", ",", "dv8"}], "]"}]}], "Input",
 CellChangeTimes->{{3.895734373628908*^9, 3.895734376759459*^9}},
 CellLabel->"In[89]:=",
 CellID->900374862,ExpressionUUID->"6ec47a35-fd73-4a2e-b618-e36189e4b7d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
      "q2_Integer", ",", "q3_Integer"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"notAllZero", "[", 
      RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], ")"}]}], ":=", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", "q3"}], 
     "]"}], "=", 
    RowBox[{"totCovLong", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "[", "t", "]"}], "*", 
       RowBox[{"v2", "[", 
        RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"v3", "[", 
        RowBox[{"t", "+", "q2"}], "]"}], "*", " ", 
       RowBox[{"v4", "[", 
        RowBox[{"t", "+", "q3"}], "]"}]}], ",", 
      RowBox[{"t", "+", 
       RowBox[{"Min", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], "]"}], "-", 
       "1"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733704297078*^9, 3.895733739437861*^9}, {
   3.8957339017721653`*^9, 3.895733921853109*^9}, 3.895734039033209*^9, 
   3.895734119105364*^9, {3.895734246017921*^9, 3.8957342529685307`*^9}, {
   3.895734292088269*^9, 3.895734328657292*^9}, {3.895734795221305*^9, 
   3.895734796263288*^9}},
 CellLabel->"In[91]:=",
 CellID->964162515,ExpressionUUID->"a73c1f76-334d-4469-ad2e-e876a4624761"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv10", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Complement", "[", 
  RowBox[{"dv10", ",", "dv9"}], "]"}]}], "Input",
 CellChangeTimes->{{3.895734382641448*^9, 3.895734387788137*^9}},
 CellLabel->"In[92]:=",
 CellID->508647493,ExpressionUUID->"ac4db34c-e7d8-4e63-bc03-98edb11691b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
      "q2_Integer", ",", "q3_Integer", ",", "i__"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SymbolName", "@", "v1"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v2"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v3"}], ",", " ", 
         RowBox[{"SymbolName", "@", "v4"}]}], "}"}], ",", 
       RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], "]"}],
      "==", 
     RowBox[{"Length", "[", 
      RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", "q3", ",",
       "i"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SymbolName", "@", "v1"}], ",", 
              RowBox[{"SymbolName", "@", "v2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SymbolName", "@", "v3"}], ",", 
              RowBox[{"SymbolName", "@", "v4"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], ",", 
          
          RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"vdd", "=", 
        RowBox[{"Activate", "[", 
         RowBox[{"Fold", "[", 
          RowBox[{"rp", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Inactive", "[", "Times", "]"}], "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Inactive", "[", "Times", "]"}], "[", 
              RowBox[{
               RowBox[{"v3", "[", 
                RowBox[{"t", "+", "q2"}], "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q3"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"pos", ",", 
              RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"tc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"totCovLong", "[", 
            RowBox[{"##", ",", 
             RowBox[{"t", "+", 
              RowBox[{"Min", "[", 
               RowBox[{"{", 
                RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], "]"}], 
              "-", "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
     "\[IndentingNewLine]", "\t", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895733741352585*^9, 3.89573376691507*^9}},
 CellLabel->"In[94]:=",
 CellID->2083966409,ExpressionUUID->"9f4c9f22-d248-4701-8df2-9cc672c4674a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dv11", "=", 
   RowBox[{"DownValues", "@", "covLongBY"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Complement", "[", 
  RowBox[{"dv11", ",", "dv10"}], "]"}]}], "Input",
 CellChangeTimes->{{3.895734402079194*^9, 3.895734406405249*^9}},
 CellLabel->"In[95]:=",
 CellID->251142436,ExpressionUUID->"24b3b6f8-4c84-4469-aeb9-7320d6d4089d"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[97]:=",
 CellID->1670340009,ExpressionUUID->"d4e4849f-ca50-4c29-9711-d5737a6fb57f"],

Cell[BoxData[
 RowBox[{"v1", "=", 
  RowBox[{"varList", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.895734903804633*^9, 3.89573491044215*^9}},
 CellLabel->"In[98]:=",
 CellID->1079506773,ExpressionUUID->"17ec80f8-3a4f-422d-a818-01386c028e74"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[99]:=",
 CellID->1371800599,ExpressionUUID->"6bb1c077-c31c-4f8b-8aa6-4b9f102683c7"],

Cell[BoxData[{
 RowBox[{"tempNeg", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{
       RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
      RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{"tempPos", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{"v1", "[", 
         RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", "2", ",", 
      RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.895734922744803*^9, 3.895734926172679*^9}},
 CellLabel->"In[100]:=",
 CellID->968494393,ExpressionUUID->"c25af2b8-7c61-4b9b-9ada-1083822689b6"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[102]:=",
 CellID->1143904413,ExpressionUUID->"c6436106-2c76-440f-9d79-a0c951c8c848"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"v1", ",", 
     RowBox[{"q_", "/;", 
      RowBox[{"q", " ", "<", " ", 
       RowBox[{"-", "1"}]}]}]}], "]"}], "=", 
   RowBox[{"FindSequenceFunction", "[", 
    RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"v1", ",", 
     RowBox[{"-", "1"}]}], "]"}], "=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"v1", "[", "t", "]"}], ",", 
     RowBox[{"v1", "[", 
      RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"v1", ",", "0"}], "]"}], "=", 
   RowBox[{"uncondVar", "[", 
    RowBox[{"v1", "[", "t", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"v1", ",", "1"}], "]"}], "=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{
     RowBox[{"v1", "[", "t", "]"}], ",", 
     RowBox[{"v1", "[", 
      RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"covLong", "[", 
    RowBox[{"v1", ",", 
     RowBox[{"q_", "/;", 
      RowBox[{"q", " ", ">", " ", "1"}]}]}], "]"}], "=", 
   RowBox[{"FindSequenceFunction", "[", 
    RowBox[{"tempPos", ",", "q"}], "]"}]}], ";"}], "\n", 
 RowBox[{"\t\t\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"covLong", "[", 
     RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
    RowBox[{"covLong", "[", 
     RowBox[{"v1", ",", "q"}], "]"}]}], ";"}]}]}], "Input",
 CellChangeTimes->{{3.8957381967471037`*^9, 3.895738199905326*^9}, {
  3.895739641988693*^9, 3.895739655534886*^9}},
 CellLabel->"In[103]:=",
 CellID->390339947,ExpressionUUID->"91f483c2-4d2d-49fb-8333-2bdc6eca332d"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[109]:=",
 CellID->770682711,ExpressionUUID->"13ee1e3b-ef7b-461a-8a63-d32931879ff7"],

Cell[BoxData[
 RowBox[{"v2", "=", 
  RowBox[{"varList", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.895735418464312*^9, 3.895735419804861*^9}},
 CellLabel->"In[110]:=",
 CellID->525258147,ExpressionUUID->"ed7116e1-b531-4b23-86ac-a1ab39c94de5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dv11", "=", 
   RowBox[{"DownValues", "[", "covLongBY", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.895735451126194*^9, 3.895735462915708*^9}},
 CellLabel->"In[111]:=",
 CellID->52674018,ExpressionUUID->"c6a389e4-fbf6-4e82-96e9-23ece3b5dbbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"tempNeg", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v2", "[", 
              RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{
            RowBox[{"-", "maxLag"}], "-", "1"}], ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"tempPos", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"T", ",", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v2", "[", 
              RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"T", ",", "2", ",", 
           RowBox[{"maxLag", "+", "1"}]}], "}"}]}], "]"}]}]}], "\n", "\t", 
     "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", 
        RowBox[{"q_", "/;", 
         RowBox[{"q", " ", "<", " ", 
          RowBox[{"-", "1"}]}]}]}], "]"}], "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", 
        RowBox[{"-", "1"}]}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{"v2", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", "1"}], "]"}], "=", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{"v2", "[", 
         RowBox[{"t", "+", "1"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", 
        RowBox[{"q_", "/;", 
         RowBox[{"q", " ", ">", " ", "1"}]}]}], "]"}], "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v2", ",", 
        RowBox[{"-", "q"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.895735436441716*^9, 3.895735447888515*^9}},
 CellLabel->"In[112]:=",
 CellID->244547648,ExpressionUUID->"3bb2aca3-f2ab-40b7-a15c-b301c8c17c42"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Global`x*\>\"", "]"}]], "Input",
 CellLabel->"In[113]:=",
 CellID->40780546,ExpressionUUID->"9e982553-0e90-43a0-be02-74d9e107232f"],

Cell[BoxData[
 RowBox[{"Complement", "[", 
  RowBox[{
   RowBox[{"DownValues", "@", "covLongBY"}], ",", "dv11"}], "]"}]], "Input",
 CellChangeTimes->{{3.8957354689815693`*^9, 3.8957354790752907`*^9}},
 CellLabel->"In[110]:=",
 CellID->1394572344,ExpressionUUID->"91677f4b-8bf7-48fb-884b-50673626c942"],

Cell[BoxData[{
 RowBox[{"covLong", "[", 
  RowBox[{"sx", ",", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"covLong", "[", 
  RowBox[{"sx", ",", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sx"}], "}"}], ",", "0", ",", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8957356043295803`*^9, 3.895735604870776*^9}},
 CellLabel->"In[114]:=",
 CellID->1598307690,ExpressionUUID->"832896dd-f41c-4593-b0b1-87d14640306f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expandList", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"varList", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"covLongBY", "[", 
  RowBox[{"wc", ",", "wc", ",", "q"}], "]"}]}], "Input",
 CellChangeTimes->{{3.895735796929574*^9, 3.895735866449397*^9}, {
  3.8957360758330717`*^9, 3.895736107600329*^9}},
 CellLabel->"In[116]:=",
 CellID->397881860,ExpressionUUID->"da192d30-7452-4ba7-91f7-fef09b2065d5"],

Cell[BoxData[
 RowBox[{"covLongBY", "[", 
  RowBox[{"wc", ",", 
   RowBox[{"-", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8957358912322283`*^9, 3.895735895448435*^9}, {
  3.895736139001697*^9, 3.895736139247932*^9}},
 CellLabel->"In[119]:=",
 CellID->1660769731,ExpressionUUID->"5c0f7a25-3714-4cea-a0ca-3021f7ee75e4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", "\t\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "=", 
        RowBox[{"expandList", "[", 
         RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q_Integer"}], "]"}], "=", 
        RowBox[{"uncondCovLong", "[", 
         RowBox[{
          RowBox[{"v1", "[", "t", "]"}], ",", 
          RowBox[{"v1", "[", 
           RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], ";", 
       "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q"}], "]"}]}], ";", "\n", "\t\t\t\t", "\n", 
       "\t\t\t\t", 
       RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"v2", "=", 
           RowBox[{"varList", "[", 
            RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", "q_Integer"}], "]"}], "=", 
           RowBox[{"uncondCovLong", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v2", "[", 
              RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], ";", 
          "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t\t", ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"qq", ",", "1", ",", 
           RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "\n", 
        "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"v3", "=", 
           RowBox[{"varListdd", "[", 
            RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v3", ",", "q_Integer", ",", "i_"}], "]"}], 
           "=", 
           RowBox[{"uncondCovLong", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v3", "[", 
              RowBox[{
               RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}], 
            "]"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v3", ",", 
             RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], "\n", 
         "\t\t\t\t\t", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"zz", ",", "1", ",", 
           RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "\n", 
        "\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"v4", "=", 
           RowBox[{"expandList", "[", 
            RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v4", ",", "q_Integer"}], "]"}], "=", 
           RowBox[{"uncondCovLong", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v4", "[", 
              RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], ";", 
          "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v4", ",", "v1", ",", "q_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v4", ",", 
             RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\n", "\t\t\t\t\t", ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"pp", ",", 
           RowBox[{"kk", "+", "1"}], ",", 
           RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", 
        "\t\t\t\t", "]"}], ";"}], "\n", "\t\t\t\t", ",", "\n", "\t\t\t\t", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", 
        RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "\n", "\t\t\t",
      "]"}], ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.895736185804447*^9, 3.895736194965293*^9}},
 CellLabel->"In[120]:=",
 CellID->262378589,ExpressionUUID->"7c1f3936-972e-4135-b8c8-6c53ce25a2ec"],

Cell[BoxData[{
 RowBox[{"Echo", "[", 
  RowBox[{"\"\<Global`x\>\"", ",", "\"\<Global x\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Names", "[", 
  "\"\<FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`x\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.89573984562803*^9, 3.8957398504352827`*^9}, {
  3.8957398841781893`*^9, 3.895739904329247*^9}},
 CellID->1771401665,ExpressionUUID->"a8de87ec-91d3-4e99-8d97-e52a43adc12a"],

Cell[BoxData[
 RowBox[{"Remove", "[", "\"\<Global`x\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.895739860594863*^9, 3.8957398611034317`*^9}},
 CellLabel->"In[124]:=",
 CellID->1534933014,ExpressionUUID->"ba01b43c-ef47-4da4-b0a9-9b61f903ff14"],

Cell[BoxData[
 RowBox[{"DeleteDuplicates", "[", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Variables", "[", 
       RowBox[{
        RowBox[{"model", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}], 
       " ", "]"}], ",", 
      RowBox[{
       RowBox[{"x_", "[", "_", "]"}], ":>", "x"}]}], "]"}], ",", "0"}], "]"}],
   "]"}]], "Input",
 CellLabel->"In[127]:=",
 CellID->19936860,ExpressionUUID->"4d8bdf4b-5190-4607-9ec9-10c8ddcf8816"],

Cell[BoxData[
 RowBox[{"Complement", "[", 
  RowBox[{
   RowBox[{"DownValues", "@", "covLongBY"}], ",", "dv11"}], "]"}]], "Input",
 CellLabel->"In[121]:=",
 CellID->767408514,ExpressionUUID->"020a1264-974c-4f41-906d-4b127d32a422"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<PrettyForm\>\"", "]"}], "[", 
  RowBox[{"Keys", "@", 
   RowBox[{"DownValues", "[", "covLongBY", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.895735925131074*^9, 3.895735948178278*^9}},
 CellLabel->"In[134]:=",
 CellID->1380993541,ExpressionUUID->"1e1cfe9c-88e3-4f19-8d11-1c1fbb877e7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"countStockVars", "[", 
   RowBox[{"vars_List", ",", "patt_"}], "]"}], ":=", 
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ResourceFunction", "[", "\"\<SymbolQ\>\"", "]"}], "[", "#", 
         "]"}], ",", 
        RowBox[{"SymbolName", "[", "#", "]"}], " ", ",", " ", "Nothing"}], 
       "]"}], "&"}], "/@", "vars"}], ",", "patt"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"countStockVars", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], ",", 
     RowBox[{"eps", "[", "\"\<x\>\"", "]"}], ",", "LLR`c", ",", "LLR`pd", ",",
      "boo`pd"}], "}"}], ",", 
   RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8957462512642384`*^9, 3.895746392358282*^9}, {
  3.895746593045187*^9, 3.895746625502956*^9}, {3.89574667833634*^9, 
  3.895746694011442*^9}},
 CellLabel->"In[94]:=",
 CellID->1679340016,ExpressionUUID->"11558859-f9d2-4905-98bb-eb0dec9790c2"]
},
CellGrouping->Manual,
WindowSize->{1594, 879},
WindowMargins->{{Automatic, -1648}, {Automatic, 30}},
WindowTitle->Automatic,
DockedCells->Cell[
  BoxData[
   PanelBox[
    PaneBox[
     TagBox[
      GridBox[{{
         StyleBox[
          DynamicBox[
           FEPrivate`FrontEndResource[
           "MUnitStrings", "TestingNotebook-Title"], 
           ImageSizeCache -> {100., {3., 9.}}], StripOnInput -> False, 
          FontSize -> 12, FontColor -> GrayLevel[0.4]], "\[SpanFromLeft]", 
         "\[SpanFromLeft]", "\[SpanFromLeft]", "\[SpanFromLeft]", 
         "\[SpanFromLeft]"}, {
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "New"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "New-Label"], 
                    ImageSizeCache -> {26., {0., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteInsertTest[
                  InputNotebook[], "Test"]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource["MUnitStrings", "New-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource["MUnitStrings", "New-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {68., {11., 17.}}], DynamicModuleValues :> {}], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ConvertSelection"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ConvertSelectiontoTest-Label"], 
                    ImageSizeCache -> {99., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; 
                MUnit`buttonConvertCellGroup[
                  InputNotebook[]]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource[
              "MUnitStrings", "ConvertSelectiontoTest-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource[
               "MUnitStrings", "ConvertSelectiontoTest-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {141., {11., 17.}}], DynamicModuleValues :> {}], 
         
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             ButtonBox[
              PaneBox[
               TagBox[
                GridBox[{{
                   PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "Run"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                   StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "Run-Label"], 
                    ImageSizeCache -> {22., {0., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                 AutoDelete -> False, 
                 GridBoxItemSize -> {
                  "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                 GridBoxSpacings -> {
                  "Columns" -> {{0.3}}, "Rows" -> {{Automatic}}}], "Grid"], 
               ImageMargins -> {{0, 0}, {2, 0}}], Appearance -> 
              FEPrivate`FrontEndResource[
               "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
              Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteRun[
                  InputNotebook[]]], Evaluator -> Automatic, 
              FrameMargins -> {{10, 10}, {0, 0}}, 
              ImageSize -> {Automatic, 28}, Method -> "Queued"], 
             DynamicBox[
              FEPrivate`FrontEndResource["MUnitStrings", "Run-Tooltip"]], 
             TooltipDelay -> 0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource["MUnitStrings", "Run-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {63., {11., 17.}}], DynamicModuleValues :> {}], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           ActionMenuBox[
            ButtonBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  StyleBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource["MUnitStrings", "More-Label"], 
                    ImageSizeCache -> {30., {0., 9.}}], "ButtonText", 
                   StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]], 
                  PaneSelectorBox[{True -> DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "Arrow-Hover"], 
                    ImageSizeCache -> {9., {2., 7.}}], False -> DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "Arrow-Off"], 
                    ImageSizeCache -> {9., {2., 7.}}]}, 
                   Dynamic[$CellContext`hover$$], 
                   BaselinePosition -> (Center -> Scaled[0.5])]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{0.5}}, "Rows" -> {{Automatic}}}], "Grid"], 
              ImageMargins -> {{0, 0}, {0, 0}}], Appearance -> 
             FEPrivate`FrontEndResource[
              "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> {}, 
             ContentPadding -> True, Evaluator -> None, 
             FrameMargins -> {{10, 10}, {0, 0}}, ImageSize -> {Automatic, 28},
              Method -> "Preemptive"], {TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "AssignTestIDs"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "AssignTestIDs-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteAddTestIDs[
                 InputNotebook[]]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "SaveAsDotwlt"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "SaveAsDotwlt-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteSaveAs[
                 InputNotebook[]]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "NewEnvironCell"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "NewEnvironCell-Label"]]}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             Block[{$ContextPath}, Needs["MUnit`"]; MUnit`PaletteInsertTest[
                 InputNotebook[], "Environ"]], TagBox[
               GridBox[{{
                  PaneBox[
                   DynamicBox[
                    FEPrivate`FrontEndResource["MUnitExpressions", "Help"]], 
                   BaselinePosition -> (Center -> Scaled[0.55])], 
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitStrings", "Help-Label"]]}}, AutoDelete -> False, 
                GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
               "Grid"] :> 
             SystemOpen["paclet:tutorial/UsingTheTestingFramework"]}, 
            Appearance -> None, Method -> "Queued"], $CellContext`hover$$ = 
           CurrentValue["MouseOver"], ImageSizeCache -> {67., {10., 18.}}], 
          DynamicModuleValues :> {}], 
         ItemBox["\"\"", ItemSize -> Fit, StripOnInput -> False], 
         DynamicModuleBox[{$CellContext`hover$$ = False}, 
          DynamicWrapperBox[
           TagBox[
            TooltipBox[
             PaneSelectorBox[{True -> ButtonBox[
                 TagBox[
                  GridBox[{{
                    PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ClearTestResults-on"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                    StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ClearTestResults-Label"], 
                    ImageSizeCache -> {96., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, FontColor -> Dynamic[
                    If[$CellContext`hover$$, 
                    RGBColor[0.9059, 0.3451, 0.102], Inherited]]]}}, 
                   AutoDelete -> False, 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                   GridBoxSpacings -> {
                    "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
                 Appearance -> 
                 FEPrivate`FrontEndResource[
                  "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
                 Block[{$ContextPath}, Needs["MUnit`"]; 
                   MUnit`clearTestResults[]], Evaluator -> Automatic, 
                 FrameMargins -> {{10, 10}, {0, 0}}, 
                 ImageSize -> {Automatic, 28}, Method -> "Queued"], False -> 
               ButtonBox[
                 TagBox[
                  GridBox[{{
                    PaneBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitExpressions", "ClearTestResults-off"], 
                    ImageSizeCache -> {15., {5., 10.}}], 
                    BaselinePosition -> (Center -> Scaled[0.5])], 
                    StyleBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "MUnitStrings", "ClearTestResults-Label"], 
                    ImageSizeCache -> {96., {1., 9.}}], "ButtonText", 
                    StripOnInput -> False, LineColor -> GrayLevel[0.7], 
                    FrontFaceColor -> GrayLevel[0.7], BackFaceColor -> 
                    GrayLevel[0.7], GraphicsColor -> GrayLevel[0.7], 
                    FontColor -> GrayLevel[0.7]]}}, AutoDelete -> False, 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                   GridBoxSpacings -> {
                    "Columns" -> {{0.4}}, "Rows" -> {{Automatic}}}], "Grid"], 
                 Appearance -> 
                 FEPrivate`FrontEndResource[
                  "MUnitExpressions", "ButtonAppearances"], ButtonFunction :> 
                 Null, Enabled -> False, Evaluator -> Automatic, 
                 FrameMargins -> {{10, 10}, {0, 0}}, 
                 ImageSize -> {Automatic, 28}, Method -> "Queued"]}, 
              Dynamic[CurrentValue[
                 ButtonNotebook[], {TaggingRules, "$testsRun"}, False] === 
               True]], 
             DynamicBox[
              FEPrivate`FrontEndResource[
              "MUnitStrings", "ClearTestResults-Tooltip"]], TooltipDelay -> 
             0.5], Annotation[#, 
             Dynamic[
              RawBoxes[
               FEPrivate`FrontEndResource[
               "MUnitStrings", "ClearTestResults-Tooltip"]]], 
             "Tooltip"]& ], $CellContext`hover$$ = CurrentValue["MouseOver"], 
           ImageSizeCache -> {138., {10., 18.}}], 
          DynamicModuleValues :> {}]}}, AutoDelete -> False, 
       BaseStyle -> {
        "DialogStyle", Bold, FontColor -> 
         RGBColor[
          0.33333333333333337`, 0.33333333333333337`, 0.33333333333333337`]}, 
       GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Bottom}}}, 
       GridBoxDividers -> {"Columns" -> {{False}}}, 
       GridBoxItemSize -> {
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
       GridBoxSpacings -> {"Columns" -> {{Automatic}}, "Rows" -> {{1}}}], 
      "Grid"], ImageMargins -> {{5, 5}, {Automatic, Automatic}}], Appearance -> 
    FEPrivate`FrontEndResource["MUnitExpressions", "StaticToolbarNinePatch"], 
    FrameMargins -> {{26, 12}, {8, 12}}, ImageMargins -> -1]], "DockedCell", 
  CellFrameMargins -> 0, ShowCellTags -> False, CellTags -> 
  "MUnitStaticToolbar"],
TaggingRules-><|"$testsRun" -> False, "TryRealOnly" -> False|>,
CellContext->Notebook,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->FrontEnd`FileName[{"MUnit"}, "MUnit.nb", CharacterEncoding -> 
  "UTF-8"],
ExpressionUUID->"b9ea1237-83e0-4088-831a-59753d2dc05b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[581, 21, 165, 2, 101, "Section",ExpressionUUID->"61a2a9a5-6e2f-403b-95f1-35de97157c46",
 CellID->1569917085],
Cell[749, 25, 1601, 36, 163, "Input",ExpressionUUID->"27c686eb-a1eb-415c-806c-8ebb2b92ca61",
 CellID->733614014],
Cell[2353, 63, 3149, 80, 388, "Input",ExpressionUUID->"cb79919f-49cf-462d-a200-b3bf07f388e8",
 CellID->2078682862],
Cell[5505, 145, 574, 15, 109, "Input",ExpressionUUID->"96d943bb-6732-45f0-ae4b-0265036585cd",
 CellID->2074660696],
Cell[6082, 162, 424, 10, 78, "Input",ExpressionUUID->"aa531f0f-c536-4eb1-9076-eb9eac1542d0",
 CellID->1712451525],
Cell[6509, 174, 212, 3, 46, "Input",ExpressionUUID->"36fb5d7d-b42b-46db-b134-7023d5596133",
 CellID->45429000],
Cell[CellGroupData[{
Cell[6746, 181, 342, 6, 78, "Input",ExpressionUUID->"7998b3f8-a765-426c-9a43-8825cbf1061a",
 CellID->1404874192],
Cell[7091, 189, 307, 5, 52, "Output",ExpressionUUID->"98318cb1-fe75-45f1-98a7-3c3f369ea736",
 CellID->1747855584],
Cell[7401, 196, 647, 12, 115, "Output",ExpressionUUID->"63483dc0-2af1-4134-93f1-4e7b44015310",
 CellID->779992975]
}, Open  ]],
Cell[8063, 211, 317, 8, 46, "Input",ExpressionUUID->"2b23cb50-00da-45b8-a52a-bc8c4b074449",
 CellID->56683262],
Cell[CellGroupData[{
Cell[8405, 223, 307, 7, 46, "Input",ExpressionUUID->"d80b83dc-6c73-4a24-97e9-e36565a8e323",
 CellID->1209522482],
Cell[8715, 232, 195, 3, 52, "Output",ExpressionUUID->"e70918ca-09ae-4391-8fee-d6b1fc025f93",
 CellID->2020522930]
}, Open  ]],
Cell[8925, 238, 786, 19, 78, "Input",ExpressionUUID->"a0a3f1a9-f0eb-4d3a-a62b-88890394cde5",
 CellID->132995452],
Cell[9714, 259, 755, 21, 78, "Input",ExpressionUUID->"7c8ef76c-f32b-40d4-a6ef-4961d6f60d0d",
 CellID->1587735617],
Cell[10472, 282, 599, 16, 78, "Input",ExpressionUUID->"e80921b6-f693-4b7d-88bd-1332686e60c5",
 CellID->539510809],
Cell[11074, 300, 559, 18, 78, "Input",ExpressionUUID->"c4852883-f0ba-46cd-a81b-13b004200519",
 CellID->974302512],
Cell[11636, 320, 901, 20, 326, "Input",ExpressionUUID->"1e3f4971-7c4e-432d-ab0a-8abffcd57e31",
 CellID->185913993],
Cell[12540, 342, 695, 9, 46, "Input",ExpressionUUID->"2bee451d-7244-42e5-a208-2d63e952c17e",
 CellID->1932220874],
Cell[13238, 353, 475, 9, 46, "Input",ExpressionUUID->"5d2f8890-9cca-432c-92a2-de869f8f8c0e",
 CellID->1044897727],
Cell[13716, 364, 1191, 16, 46, "Input",ExpressionUUID->"13094034-fa4d-4258-b21b-5d14292f5416",
 CellID->1860891942],
Cell[14910, 382, 5089, 136, 574, "Input",ExpressionUUID->"b630a2db-f33f-44e9-84bb-b69529523181",
 CellID->974728071],
Cell[20002, 520, 3919, 93, 605, "Input",ExpressionUUID->"a8614cb3-82c4-4f55-84ce-4c855d04c4ee",
 CellID->1525518535],
Cell[CellGroupData[{
Cell[23946, 617, 785, 14, 78, "Input",ExpressionUUID->"4af02e96-2f8e-49ff-9bbb-3298dac12917",
 CellID->1308266627],
Cell[24734, 633, 8189, 212, 473, "Output",ExpressionUUID->"910ab496-0864-4076-808b-a857e46e62bc",
 CellID->2043697083]
}, Open  ]],
Cell[32938, 848, 1603, 48, 202, "Input",ExpressionUUID->"83c292d1-080d-4674-a781-8ecf6ab45da9",
 CellID->956735078],
Cell[34544, 898, 1948, 42, 574, "Input",ExpressionUUID->"29139246-942d-4c07-8a61-6f46ede13776",
 CellID->612713686],
Cell[CellGroupData[{
Cell[36517, 944, 2287, 66, 295, "Input",ExpressionUUID->"f26c85ae-6a2f-43ec-a4c3-93a709e3d580",
 CellID->807971430],
Cell[38807, 1012, 12203, 374, 857, "Output",ExpressionUUID->"947a13a1-2188-4563-a5e5-a74f08d329a2",
 CellID->137615520],
Cell[51013, 1388, 7739, 206, 473, "Output",ExpressionUUID->"4d0ef6dd-91f5-4418-9b68-052f51127053",
 CellID->64156821]
}, Open  ]],
Cell[CellGroupData[{
Cell[58789, 1599, 2047, 60, 233, "Input",ExpressionUUID->"85e16388-291d-4678-8980-0dc0a7231ab0",
 CellID->498799314],
Cell[60839, 1661, 795, 26, 90, "Output",ExpressionUUID->"dd3a0924-b83a-456b-8b9b-6e2e28f3de2c",
 CellID->906142558],
Cell[61637, 1689, 2624, 78, 216, "Output",ExpressionUUID->"d0a73fe7-b92d-46d5-8fa7-e77314f95244",
 CellID->1731431429]
}, Open  ]],
Cell[CellGroupData[{
Cell[64298, 1772, 2043, 60, 233, "Input",ExpressionUUID->"b764cb6d-25ea-4db3-8d60-d3d4bc75e58f",
 CellID->1691396157],
Cell[66344, 1834, 769, 24, 90, "Output",ExpressionUUID->"9da88888-e259-41cc-be19-5d6661ba7b5e",
 CellID->1764610353],
Cell[67116, 1860, 3597, 106, 251, "Output",ExpressionUUID->"fc9bafc7-b5d6-4fd5-b595-b12c87dea158",
 CellID->1057037801]
}, Open  ]],
Cell[CellGroupData[{
Cell[70750, 1971, 2045, 60, 233, "Input",ExpressionUUID->"ac0d2cbc-366c-4406-bcbc-48ef7d244ebb",
 CellID->1054175360],
Cell[72798, 2033, 806, 25, 90, "Output",ExpressionUUID->"f822d9b5-284b-4aff-995b-2666aa7b3c6b",
 CellID->1649593423],
Cell[73607, 2060, 6394, 157, 473, "Output",ExpressionUUID->"c70bcbab-a0ee-40f1-842f-827897c7969c",
 CellID->702777591]
}, Open  ]],
Cell[80016, 2220, 247, 3, 101, "Section",ExpressionUUID->"a766fa8e-3cd4-492a-a3c8-aaa5cda85d93",
 CellID->1245172077],
Cell[80266, 2225, 22653, 681, 2147, "Input",ExpressionUUID->"8e46033a-47e2-4014-932f-72f4a9ac8c26",
 CellID->86110327],
Cell[CellGroupData[{
Cell[102944, 2910, 9403, 246, 512, "Input",ExpressionUUID->"4789936a-5c37-4d9e-bb8b-8eafa33f338e",
 CellID->1319307510],
Cell[112350, 3158, 56864, 1487, 4749, "Input",ExpressionUUID->"304f2442-f638-4eb6-aa14-52471393d424",
 CellID->537762824],
Cell[169217, 4647, 89612, 2505, 7366, "Input",ExpressionUUID->"01323ad2-a4f2-4692-9a6a-05804ea0c7bf",
 CellID->1739871239],
Cell[258832, 7154, 6721, 159, 326, "Input",ExpressionUUID->"305c0ee0-17c4-4377-8c58-a80c58d8c753",
 CellID->171046095]
}, Open  ]],
Cell[265568, 7316, 15865, 405, 1194, "Input",ExpressionUUID->"e98cc1a3-180d-4a06-a9cb-15ac15611263",
 CellID->799257596],
Cell[281436, 7723, 1338, 29, 264, "Input",ExpressionUUID->"7cc70058-0f88-4fdd-bc82-3427853c894e",
 CellID->1496354362],
Cell[282777, 7754, 2634, 53, 202, "Input",ExpressionUUID->"13ad996b-df0a-46b4-aed4-d4f0c640ef20",
 CellID->1874572404],
Cell[285414, 7809, 2985, 72, 357, "Input",ExpressionUUID->"4855ff25-b8b5-492b-80f3-f82c0d254490",
 CellID->1989471160],
Cell[288402, 7883, 2629, 68, 357, "Input",ExpressionUUID->"80548acb-a45d-4b8c-b985-bdaa0487b0a1",
 CellID->432055528],
Cell[291034, 7953, 11477, 297, 1721, "Input",ExpressionUUID->"543f6144-c7ca-4dbc-8b1e-a87f724a8c97",
 CellID->160108917],
Cell[302514, 8252, 11468, 297, 1721, "Input",ExpressionUUID->"70656be0-aa1e-414c-a53a-bc03466f5910",
 CellID->1021365996],
Cell[313985, 8551, 834, 27, 46, "Input",ExpressionUUID->"9e4cd370-846c-4007-833e-02dd8d608cba",
 CellID->997759263],
Cell[314822, 8580, 901, 28, 46, "Input",ExpressionUUID->"8becfc8d-44f5-40f0-b77f-0c4197dce588",
 CellID->1294489255],
Cell[315726, 8610, 901, 28, 46, "Input",ExpressionUUID->"7666f660-9f31-41dd-a482-70be20b1bc95",
 CellID->1255539483],
Cell[316630, 8640, 3147, 100, 309, "Input",ExpressionUUID->"e8be9159-73e8-4bc9-9613-41805008b746",
 CellID->387215999],
Cell[319780, 8742, 3340, 95, 326, "Input",ExpressionUUID->"3c2ea379-0fba-4592-88dc-c8131b98ece8",
 CellID->309605539],
Cell[323123, 8839, 4771, 146, 310, "Input",ExpressionUUID->"42f96ecf-84c6-4726-80eb-7e07960443c8",
 CellID->1741115415],
Cell[327897, 8987, 6971, 196, 605, "Input",ExpressionUUID->"6389e088-8cb6-4969-a513-c7a1cac2846b",
 CellID->369571884],
Cell[334871, 9185, 1985, 58, 233, "Input",ExpressionUUID->"fd124a6b-ea34-4b7e-aea8-48989acbfea6",
 CellID->340783995],
Cell[336859, 9245, 2135, 60, 264, "Input",ExpressionUUID->"d9145aec-21ec-4dd2-b903-59f7a2e7d6f9",
 CellID->538633863],
Cell[338997, 9307, 2604, 75, 357, "Input",ExpressionUUID->"bf7f73c0-51b0-4a7a-8d55-96d194f6244d",
 CellID->1073921610],
Cell[341604, 9384, 2581, 75, 357, "Input",ExpressionUUID->"2fda6806-18a8-46b9-9b15-15a6c25cbb7c",
 CellID->1914543127],
Cell[344188, 9461, 1281, 38, 78, "Input",ExpressionUUID->"b085671d-90de-4e0a-9423-fd686494c5d5",
 CellID->425500841],
Cell[345472, 9501, 3236, 95, 388, "Input",ExpressionUUID->"bf4209fd-6826-45a3-aa6a-51ad8a3006ba",
 CellID->1922088329],
Cell[348711, 9598, 13702, 397, 1194, "Input",ExpressionUUID->"39c24a7e-be69-4df8-b81c-d5f8bc4f45f7",
 CellID->1888953057],
Cell[362416, 9997, 759, 22, 46, "Input",ExpressionUUID->"2427736b-eb0b-4eef-9d63-fa7646701adc",
 CellID->1824051709],
Cell[363178, 10021, 2795, 77, 233, "Input",ExpressionUUID->"26920505-3a3e-478c-bdd5-9e65a60b5faa",
 CellID->1934616487],
Cell[365976, 10100, 2730, 80, 357, "Input",ExpressionUUID->"16ff98aa-39ad-4244-9a4f-3b9d4e1bcc5b",
 CellID->773307292],
Cell[368709, 10182, 2741, 80, 357, "Input",ExpressionUUID->"57648cb4-e9ad-4cab-9afe-5b7e928b97f2",
 CellID->1176812697],
Cell[371453, 10264, 3038, 91, 326, "Input",ExpressionUUID->"c10d6709-23e5-4a37-8340-fa4d9a102d76",
 CellID->1173427227],
Cell[374494, 10357, 5604, 135, 729, "Input",ExpressionUUID->"d45b1289-5e74-46ad-a167-5e9dcd76c656",
 CellID->1048670426],
Cell[380101, 10494, 392, 11, 46, "Input",ExpressionUUID->"5d16d098-dfa1-45c9-a819-af32568d12de",
 CellID->1523198083],
Cell[380496, 10507, 214, 3, 101, "Section",ExpressionUUID->"f0e0c30c-6c48-4783-8372-7a0238f3d9f8",
 CellID->217936585],
Cell[380713, 10512, 235, 5, 38, "Input",ExpressionUUID->"b453214e-c12a-46bf-bcfb-50db272eb4f6",
 CellID->948560129],
Cell[380951, 10519, 172, 3, 46, "Input",ExpressionUUID->"6303cc4c-1669-48c3-9163-1c6b9941009a",
 CellID->615780736],
Cell[381126, 10524, 3759, 102, 543, "Input",ExpressionUUID->"009f6e07-b0e8-4157-87bf-549518eea6b2",
 CellID->1400565960],
Cell[384888, 10628, 174, 3, 46, "Input",ExpressionUUID->"d20b5979-6696-4234-920b-0699042702f5",
 CellID->1836688693],
Cell[385065, 10633, 990, 21, 109, "Input",ExpressionUUID->"0d2d0ce1-9bc4-4c28-9079-3bd95d16bedf",
 CellID->233099349],
Cell[386058, 10656, 174, 3, 46, "Input",ExpressionUUID->"4a313c56-a737-43e3-826f-c889b47d6d23",
 CellID->1708634170],
Cell[386235, 10661, 6502, 172, 1535, "Input",ExpressionUUID->"3c792b57-d2cb-4a41-a2b1-6f96d8933130",
 CellID->572051971],
Cell[392740, 10835, 174, 3, 46, "Input",ExpressionUUID->"86390011-5f65-48f0-9426-6044fe3de69e",
 CellID->1857920609],
Cell[392917, 10840, 2317, 65, 388, "Input",ExpressionUUID->"90992321-d665-4212-96ae-e338bca8896e",
 CellID->1513111601],
Cell[395237, 10907, 173, 3, 46, "Input",ExpressionUUID->"056f55c4-799c-4a3d-bb85-8ff72ccc332a",
 CellID->680891331],
Cell[395413, 10912, 2757, 78, 264, "Input",ExpressionUUID->"689f5de4-dcd0-49b0-858f-6b2b4d4d36eb",
 CellID->1793071465],
Cell[398173, 10992, 173, 3, 46, "Input",ExpressionUUID->"f82e1ded-b78d-41fd-a345-8e5029b71cc6",
 CellID->757035952],
Cell[398349, 10997, 348, 7, 46, "Input",ExpressionUUID->"e9c7d9b6-5f8f-4ca2-a714-86cd7089813d",
 CellID->1577972345],
Cell[398700, 11006, 2417, 70, 109, "Input",ExpressionUUID->"99687550-6963-4e70-bb2e-755dd77cf613",
 CellID->91702224],
Cell[401120, 11078, 239, 4, 46, "Input",ExpressionUUID->"5c2f99ab-47bc-46a3-8b00-b2f17ed4ab19",
 CellID->959537086],
Cell[401362, 11084, 168, 2, 46, "Input",ExpressionUUID->"022abf0d-20f6-4240-9cd0-3ad96b1bb9a5",
 CellID->1615969172],
Cell[401533, 11088, 439, 10, 78, "Input",ExpressionUUID->"0e36516a-7792-4338-9223-35e963fff9bd",
 CellID->1751556299],
Cell[401975, 11100, 1212, 35, 78, "Input",ExpressionUUID->"7287a881-3457-4a4c-ad29-06f6855187a3",
 CellID->365982575],
Cell[403190, 11137, 461, 10, 78, "Input",ExpressionUUID->"b92467ee-6aad-4585-9e76-a0a2b0eedf98",
 CellID->697052970],
Cell[403654, 11149, 1286, 36, 78, "Input",ExpressionUUID->"a16cd14f-c652-43c3-9321-e42ec285a976",
 CellID->1077642200],
Cell[404943, 11187, 413, 10, 78, "Input",ExpressionUUID->"c76eada0-73a0-4208-9365-6f329ca13ee5",
 CellID->450224054],
Cell[405359, 11199, 755, 20, 46, "Input",ExpressionUUID->"a7f194c2-0255-433a-b3c3-6b900d89245a",
 CellID->99681556],
Cell[406117, 11221, 3100, 82, 235, "Input",ExpressionUUID->"e43ee5cf-bb5d-4e43-a67e-b393a8c6d5dc",
 CellID->1510515935],
Cell[409220, 11305, 415, 10, 78, "Input",ExpressionUUID->"f7d89c5c-365a-4bdd-af86-8d6f0d65b5c8",
 CellID->889293912],
Cell[409638, 11317, 3631, 96, 267, "Input",ExpressionUUID->"128ad873-70e8-4dbc-9fc1-5b22571e3453",
 CellID->1579513808],
Cell[413272, 11415, 412, 10, 78, "Input",ExpressionUUID->"8c31c104-5559-4d88-b415-0b45ae2ea05a",
 CellID->278228608],
Cell[413687, 11427, 1856, 52, 171, "Input",ExpressionUUID->"bb76b19c-5c08-4edb-ab73-4da93ab5ceae",
 CellID->1493030434],
Cell[415546, 11481, 174, 3, 46, "Input",ExpressionUUID->"c81e7f03-7431-4694-bfdb-66abb1cc0215",
 CellID->1794562194],
Cell[415723, 11486, 1505, 41, 46, "Input",ExpressionUUID->"a821bfc4-975a-44f2-9ed5-ec4e4662bb65",
 CellID->741108031],
Cell[417231, 11529, 414, 10, 78, "Input",ExpressionUUID->"8b41af17-b7b6-48ab-9dbd-3bd0a5250fe9",
 CellID->1251698300],
Cell[417648, 11541, 1033, 25, 171, "Input",ExpressionUUID->"19209fe1-2ecf-470a-adbc-7ceb373620ea",
 CellID->1872547159],
Cell[418684, 11568, 1786, 48, 78, "Input",ExpressionUUID->"4c0b28d8-7d37-417f-b372-b34ea63cbea9",
 CellID->262424894],
Cell[420473, 11618, 371, 8, 78, "Input",ExpressionUUID->"91e02323-f70e-42b0-ad95-0183bd4d2ff1",
 CellID->2028199401],
Cell[420847, 11628, 2089, 55, 78, "Input",ExpressionUUID->"e6fc47b8-19ac-4cc9-afdc-4bd3deec53a5",
 CellID->397524417],
Cell[422939, 11685, 368, 8, 78, "Input",ExpressionUUID->"6ec47a35-fd73-4a2e-b618-e36189e4b7d3",
 CellID->900374862],
Cell[423310, 11695, 1626, 44, 78, "Input",ExpressionUUID->"a73c1f76-334d-4469-ad2e-e876a4624761",
 CellID->964162515],
Cell[424939, 11741, 370, 8, 78, "Input",ExpressionUUID->"ac4db34c-e7d8-4e63-bc03-98edb11691b2",
 CellID->508647493],
Cell[425312, 11751, 3485, 93, 266, "Input",ExpressionUUID->"9f4c9f22-d248-4701-8df2-9cc672c4674a",
 CellID->2083966409],
Cell[428800, 11846, 371, 8, 78, "Input",ExpressionUUID->"24b3b6f8-4c84-4469-aeb9-7320d6d4089d",
 CellID->251142436],
Cell[429174, 11856, 174, 3, 46, "Input",ExpressionUUID->"d4e4849f-ca50-4c29-9711-d5737a6fb57f",
 CellID->1670340009],
Cell[429351, 11861, 273, 6, 46, "Input",ExpressionUUID->"17ec80f8-3a4f-422d-a818-01386c028e74",
 CellID->1079506773],
Cell[429627, 11869, 174, 3, 46, "Input",ExpressionUUID->"6bb1c077-c31c-4f8b-8aa6-4b9f102683c7",
 CellID->1371800599],
Cell[429804, 11874, 1043, 31, 78, "Input",ExpressionUUID->"c25af2b8-7c61-4b9b-9ada-1083822689b6",
 CellID->968494393],
Cell[430850, 11907, 175, 3, 46, "Input",ExpressionUUID->"c6436106-2c76-440f-9d79-a0c951c8c848",
 CellID->1143904413],
Cell[431028, 11912, 1716, 53, 233, "Input",ExpressionUUID->"91f483c2-4d2d-49fb-8333-2bdc6eca332d",
 CellID->390339947],
Cell[432747, 11967, 174, 3, 46, "Input",ExpressionUUID->"13ee1e3b-ef7b-461a-8a63-d32931879ff7",
 CellID->770682711],
Cell[432924, 11972, 274, 6, 46, "Input",ExpressionUUID->"ed7116e1-b531-4b23-86ac-a1ab39c94de5",
 CellID->525258147],
Cell[433201, 11980, 281, 6, 46, "Input",ExpressionUUID->"c6a389e4-fbf6-4e82-96e9-23ece3b5dbbc",
 CellID->52674018],
Cell[433485, 11988, 3062, 83, 388, "Input",ExpressionUUID->"3bb2aca3-f2ab-40b7-a15c-b301c8c17c42",
 CellID->244547648],
Cell[436550, 12073, 173, 3, 46, "Input",ExpressionUUID->"9e982553-0e90-43a0-be02-74d9e107232f",
 CellID->40780546],
Cell[436726, 12078, 301, 6, 46, "Input",ExpressionUUID->"91677f4b-8bf7-48fb-884b-50673626c942",
 CellID->1394572344],
Cell[437030, 12086, 485, 12, 78, "Input",ExpressionUUID->"832896dd-f41c-4593-b0b1-87d14640306f",
 CellID->1598307690],
Cell[CellGroupData[{
Cell[437540, 12102, 487, 10, 109, "Input",ExpressionUUID->"da192d30-7452-4ba7-91f7-fef09b2065d5",
 CellID->397881860],
Cell[438030, 12114, 323, 7, 46, "Input",ExpressionUUID->"5c0f7a25-3714-4cea-a0ca-3021f7ee75e4",
 CellID->1660769731]
}, Open  ]],
Cell[438368, 12124, 4639, 112, 1039, "Input",ExpressionUUID->"7c1f3936-972e-4135-b8c8-6c53ce25a2ec",
 CellID->262378589],
Cell[443010, 12238, 435, 9, 78, "Input",ExpressionUUID->"a8de87ec-91d3-4e99-8d97-e52a43adc12a",
 CellID->1771401665],
Cell[443448, 12249, 243, 4, 46, "Input",ExpressionUUID->"ba01b43c-ef47-4da4-b0a9-9b61f903ff14",
 CellID->1534933014],
Cell[443694, 12255, 495, 14, 46, "Input",ExpressionUUID->"4d8bdf4b-5190-4607-9ec9-10c8ddcf8816",
 CellID->19936860],
Cell[444192, 12271, 230, 5, 46, "Input",ExpressionUUID->"020a1264-974c-4f41-906d-4b127d32a422",
 CellID->767408514],
Cell[444425, 12278, 353, 7, 46, "Input",ExpressionUUID->"1e1cfe9c-88e3-4f19-8d11-1c1fbb877e7a",
 CellID->1380993541],
Cell[444781, 12287, 1137, 29, 141, "Input",ExpressionUUID->"11558859-f9d2-4905-98bb-eb0dec9790c2",
 CellID->1679340016]
}
]
*)

