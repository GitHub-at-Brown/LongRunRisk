(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    185783,       4604]
NotebookOptionsPosition[    180814,       4532]
NotebookOutlinePosition[    181304,       4551]
CellTagsIndexPosition[    181261,       4548]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],

Cell[BoxData[{
 RowBox[{"testFileName", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DirectoryName", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"FileBaseName", "[", 
       RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
      "\"\<.wlt\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pacletDir", "=", 
  RowBox[{"DirectoryName", "[", 
   RowBox[{"testFileName", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PacletDirectoryLoad", "[", "pacletDir", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"testContextBase", "=", 
  RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$ContextPath", "=", 
  RowBox[{"Cases", "[", 
   RowBox[{"$ContextPath", ",", 
    RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],

Cell[CellGroupData[{

Cell["CI Tests", "Subsection",
 CellChangeTimes->{{3.8895791922306013`*^9, 3.889579196409403*^9}, {
  3.889905620469079*^9, 3.8899056207707977`*^9}, {3.889967624152501*^9, 
  3.889967626012704*^9}},ExpressionUUID->"2157750c-ae6d-47e9-b5dd-\
9c68ad40141b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FileNames", "[", "testFileName", "]"}], "===", 
    RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
   RowBox[{"DeleteFile", "[", "testFileName", "]"}]}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"f2799e55-a4bc-4cd6-9966-6392a845d852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"confirm", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testContext", "=", 
  RowBox[{
  "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\>\"", "<>", 
   "testContextBase", "<>", "\"\<`\>\""}]}]}], "Input",
 CellChangeTimes->{{3.8906795325443907`*^9, 3.8906795357982817`*^9}, 
   3.890679566064293*^9, {3.8906796081672497`*^9, 3.8906796258061447`*^9}, {
   3.890679757679096*^9, 3.890679766260743*^9}, 3.890679874010334*^9, 
   3.890710660724628*^9, 3.893104584960622*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"8eff5a9c-f1a4-4d23-af33-c77709b1754e"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<ComputationalEngine`Uncond`\>\"", "]"}]], "Input",\

 CellChangeTimes->{{3.890680288696157*^9, 3.8906802887021513`*^9}, 
   3.8907105705815163`*^9, {3.893104595723756*^9, 3.893104599289246*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"2f82b75d-42a0-4b76-b3ff-7172db85f4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "confirm"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.895423648276607*^9, 3.8954236486248627`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"eccf8930-58b0-4acf-8ec2-cc24c39a0278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Needs", "[", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8899652151465197`*^9, 3.889965235350771*^9}, 
   3.8899652808817787`*^9, {3.889967731242805*^9, 3.8899677356636972`*^9}, {
   3.889967971867523*^9, 3.889967975146998*^9}, {3.889968339451161*^9, 
   3.88996834001075*^9}, 3.889968619774049*^9, {3.8899688826075077`*^9, 
   3.88996888992594*^9}, {3.88996899475625*^9, 3.8899690018858624`*^9}, {
   3.8899691256166267`*^9, 3.8899691257757883`*^9}, {3.889969207667478*^9, 
   3.8899692141700287`*^9}, {3.8899692798779783`*^9, 3.889969288274632*^9}, 
   3.889969387087708*^9, 3.889969585993528*^9, {3.8899702972149563`*^9, 
   3.889970314454108*^9}, {3.890603045806611*^9, 3.890603046578224*^9}, 
   3.890603139674321*^9, {3.890676572733183*^9, 3.890676585108572*^9}, {
   3.890679071059198*^9, 3.890679121055434*^9}, {3.89067917308251*^9, 
   3.890679177122958*^9}, 3.890679328121275*^9, {3.8906795122187853`*^9, 
   3.890679514391316*^9}, {3.890679606901452*^9, 3.8906796293121653`*^9}, {
   3.890679668768669*^9, 3.890679669902752*^9}, {3.8906797200186*^9, 
   3.890679786626452*^9}, {3.890679828108779*^9, 3.890679882954316*^9}, 
   3.890710569438944*^9, 3.8907106646373167`*^9, {3.8931046613250093`*^9, 
   3.893104665209495*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0f0d628d-d6b9-4205-8e24-5e38623917fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\""}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.889901579125684*^9, {3.889965035911569*^9, 3.889965039550325*^9}, {
   3.889965296152458*^9, 3.889965305191854*^9}, 3.8899653858152437`*^9, 
   3.889967740469187*^9, {3.889968345370779*^9, 3.889968347169169*^9}, {
   3.889968526692542*^9, 3.8899685355316963`*^9}, {3.889968649261517*^9, 
   3.889968660343141*^9}, 3.889969395693264*^9, {3.88996958684683*^9, 
   3.8899695947482367`*^9}, {3.889970300225127*^9, 3.889970329366473*^9}, {
   3.890603050754869*^9, 3.8906030512673264`*^9}, 3.890603142316881*^9, 
   3.89067659639168*^9, {3.890679255090239*^9, 3.890679318737549*^9}, 
   3.890679634337233*^9, 3.890679895680545*^9, 3.8907105756061573`*^9, 
   3.89071066843771*^9, 3.893104682136538*^9, 3.895423668008821*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"0b6966dc-5fa6-470b-a745-2d3c09da3d4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "should", " ", "be", " ", "true", " ", "if", " ", "uncondE", " ", "can", 
     " ", "be", " ", "found"}], "*)"}], "\[IndentingNewLine]", "\t", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"Names", "[", "\"\<*uncondE\>\"", "]"}], "===", 
     RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8899706175264597`*^9, 3.889970628972746*^9}, 
   3.889972029349813*^9, {3.890016004516365*^9, 3.890016008058874*^9}, {
   3.890679266281045*^9, 3.8906792665642843`*^9}, {3.89067933542416*^9, 
   3.890679337313949*^9}, {3.8907105841635733`*^9, 3.890710593701932*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8845796e-7665-4c7d-8872-0aad8272ffea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "@", 
     RowBox[{"Get", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<FernandoDuarte/LongRunRisk\>\"", ",", "\"\<Models.wl\>\""}], 
        "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"modBY", "=", 
     RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"modNRC", "=", 
     RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "createSystem", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`createSystem"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "evNoEpsStateVarsProduct", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`evNoEpsStateVarsProduct"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "uncondEStep", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`uncondEStep"}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893104714075774*^9, 3.8931047694359703`*^9}, {
   3.893144359618079*^9, 3.893144383217063*^9}, 3.895419485208782*^9, 
   3.895419607947516*^9, 3.89542370777417*^9, {3.901529415675344*^9, 
   3.901529427733797*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d935faaf-50bc-4a8e-a3fd-9047b2c4629b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "system", " ", "of", " ", "equations", " ", "for", " ", "unconditional", 
     " ", "moments", " ", "of", " ", "state", " ", "variables"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules1", ",", "system1", ",", "unknowns1"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"1", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules2", ",", "system2", ",", "unknowns2"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"2", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules3", ",", "system3", ",", "unknowns3"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"3", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules4", ",", "system4", ",", "unknowns4"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"4", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"sol1", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system1", ",", "unknowns1"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol2", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system2", ",", "unknowns2"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol3", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system3", ",", "unknowns3"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol4", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system4", ",", "unknowns4"}], "]"}]}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules1", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system1", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns1", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\n", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules2", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system2", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns2", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules3", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system3", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns3", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules4", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system4", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns4", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{"there", " ", "is", " ", "a", " ", "solution"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"sol1", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol2", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol3", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol4", "===", 
            RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       ",", "\n", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "solutions", " ", "are", " ", "the", " ", "same", " ", "for", " ", 
         "same", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns1", ",", "unknowns3"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol1", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns2", ",", "unknowns3"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol2", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns1", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol1", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns2", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol2", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns3", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol3", ",", "sol4"}], "}"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8928872783997917`*^9, 3.8928872825022306`*^9}, {
   3.893058081176363*^9, 3.893058081797423*^9}, 3.8930584588887653`*^9, {
   3.893083667979657*^9, 3.893083681854567*^9}, {3.8930837480086393`*^9, 
   3.893083781840391*^9}, {3.893104751780423*^9, 3.893104773852371*^9}, {
   3.893104856764481*^9, 3.893104857098072*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"0958ce5d-a8a4-48ff-ba85-0ddb97fc37d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
     "hand"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pi1", "/.", "sol1"}], ")"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sg1", "/.", "sol1"}], ")"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"pi2", "/.", "sol2"}], "]"}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
           "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip",
               "2"], "+", 
             RowBox[{
             "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", 
              " ", "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
             " ", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "2"]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "2"]}], 
            ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"sg2", "/.", "sol2"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
          "2"], "+", 
         FractionBox[
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
           "2"], 
          RowBox[{"1", "-", 
           
           SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
            "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"pi1sg1", "/.", "sol2"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892524523636704*^9, 3.892524538980324*^9}, {
   3.892524963969441*^9, 3.892524997873*^9}, {3.8925250491209106`*^9, 
   3.892525102081677*^9}, {3.892525153236815*^9, 3.892525230281101*^9}, {
   3.8925712267857227`*^9, 3.89257122924771*^9}, {3.89305855312013*^9, 
   3.893058646744561*^9}, {3.893059266545212*^9, 3.893059334165757*^9}, {
   3.893083789529174*^9, 3.893083797521639*^9}, {3.89310478330639*^9, 
   3.893104783571576*^9}, 3.89310486326595*^9, {3.9015928480866127`*^9, 
   3.901592872558395*^9}, {3.9015929576938057`*^9, 3.901592958528323*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"53790e1b-0739-4af7-b71e-e7c4f97e09ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
     "hand"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"pi", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], 
         "]"}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
           "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip",
               "2"], "+", 
             RowBox[{
             "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", 
              " ", "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
             " ", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "2"]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "2"]}], 
            ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sg", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], "]"}],
        "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
          "2"], "+", 
         FractionBox[
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
           "2"], 
          RowBox[{"1", "-", 
           
           SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
            "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930848967948723`*^9, 3.893084935031836*^9}, {
   3.893085027101679*^9, 3.893085045144382*^9}, {3.8930857992167387`*^9, 
   3.893085830327442*^9}, {3.893085980007868*^9, 3.8930860239405127`*^9}, 
   3.893087085948606*^9, {3.893104787717243*^9, 3.893104788939777*^9}, 
   3.893104866818593*^9, {3.8954194852137537`*^9, 3.89541948521673*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8f6e6c22-7c31-4776-a49f-d2f5143966c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "moments", " ", "can", " ", "be", " ", "evaluated", " ", "numerically", 
     " ", "using", " ", "parameters", " ", "values", " ", "only"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol1"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol2"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol3"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol4"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.893082237801841*^9, {3.893082288507763*^9, 3.893082397545843*^9}, {
   3.89308380447088*^9, 3.893083826885064*^9}, {3.893104792410515*^9, 
   3.893104792601891*^9}, 3.89310486870549*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"10534701-86cc-4812-b9d1-583f080b6be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", "evNoEpsStateVarsProduct", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stateVarsNoEps", "=", 
     RowBox[{"{", 
      RowBox[{"sg", ",", "pi"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"model", "=", "modNRC"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"basic", " ", "use"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
          "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
            "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phig", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"",
               "]"}], "[", "t", "]"}]}]}], ")"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "-", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"",
               "]"}], "[", "t", "]"}], "2"]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t",
            "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], ")"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`mud", "[", "i", "]"}],
            " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "-", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`phidc", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
             "]"}], "[", "t", "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`xid", "[", "i", "]"}],
            " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893081708234816*^9, 3.8930817475700893`*^9}, {
   3.893082619951611*^9, 3.893082620668397*^9}, {3.8930826743611507`*^9, 
   3.893082674969939*^9}, {3.89308271889793*^9, 3.893082764899756*^9}, {
   3.893083300110649*^9, 3.8930833295765333`*^9}, {3.893083371906817*^9, 
   3.893083397811235*^9}, {3.8930835396615067`*^9, 3.8930836030394173`*^9}, {
   3.893104803562705*^9, 3.893104804045452*^9}, 3.893104872008975*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"ca14d8f1-7a77-428b-8c74-a7eb0de7af1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "context", " ", "for", " ", "shocks", " ", "is", " ", 
     "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"sg", "[", "t", "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930830724712353`*^9, 3.893083259734127*^9}, 
   3.893083445300497*^9, {3.893083843952413*^9, 3.893083861525839*^9}, {
   3.8931048140658007`*^9, 3.8931048143353853`*^9}, 3.893104874466271*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"8997ccda-5ae0-43a0-9042-48220e750fbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "if", " ", "variables", " ", "lagged", " ", "to", " ", 
     "the", " ", "right", " ", "time", " ", "period"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pi", "[", "t", "]"}], 
              RowBox[{"sg", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"pi", "[", 
               RowBox[{"t", "-", "1"}], "]"}], 
              RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pi", "[", "t", "]"}], 
              RowBox[{"sg", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"pi", "[", 
               RowBox[{"t", "-", "1"}], "]"}], 
              RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892837690169054*^9, 3.892837854348692*^9}, 
   3.89283864284869*^9, 3.892838715667156*^9, 3.893057562171788*^9, 
   3.893057898180541*^9, 3.893058027361483*^9, {3.893059945383209*^9, 
   3.893059945387575*^9}, 3.893059994856317*^9, {3.893060102391067*^9, 
   3.893060146717375*^9}, {3.893060178483892*^9, 3.893060220488847*^9}, 
   3.893081080462633*^9, 3.893083437165765*^9, {3.893083871926509*^9, 
   3.893083892419632*^9}, {3.893104819145041*^9, 3.8931048195063257`*^9}, 
   3.8931048764270763`*^9, {3.893105150897993*^9, 3.893105153599009*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e22bc11e-b400-47fc-b98c-49b5db95ac36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "use", " ", "variables", " ", "indexed", " ", "by", " ", "time", " ", 
     "that", " ", "are", " ", "not", " ", "lagged"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"foo", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}], 
        RowBox[{"foo", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ExpandAll", "@", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "+", "1"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{"ExpandAll", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}], "*", 
           RowBox[{"evNoEpsStateVarsProduct", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
              RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
             "stateVarsNoEps"}], "]"}]}], ")"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8928378645917997`*^9, 3.8928380134079*^9}, {
   3.89283856318399*^9, 3.892838569033311*^9}, {3.893059945388934*^9, 
   3.893059945395464*^9}, 3.893081075924605*^9, {3.893081367930172*^9, 
   3.893081370124003*^9}, 3.893083433344887*^9, {3.893083496494205*^9, 
   3.8930835310955772`*^9}, {3.893083900795011*^9, 3.8930839188691053`*^9}, {
   3.89310482263301*^9, 3.893104822995037*^9}, 3.893104878423732*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"43ab956e-5418-4766-8b40-61e18ece38fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "add", " ", "irrelevant", " ", "variables", " ", "to", " ", "lag"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
   RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "myVariable"}], "]"}]}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "irrelevantVar"}], "]"}]}], "]"}], "===", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"anotherIrrelevantVar", " ", 
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "anotherIrrelevantVar"}], "]"}]}], 
         "]"}], "===", 
        RowBox[{"anotherIrrelevantVar", "*", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
          "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
          "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8930839246758204`*^9, 3.893083937930691*^9}, {
   3.8930840322990923`*^9, 3.893084140616804*^9}, {3.89310482645893*^9, 
   3.89310482677431*^9}, 3.893104880770898*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"7223286e-e1a1-41e8-a6d2-dd8bb1b5b576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"lag", " ", "dd"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "lag", " ", "dd", " ", "and", " ", "expression", " ", "has", " ", 
        RowBox[{"eps", "[", "\"\<dd\>\"", "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "\"\<dd\>\"", "]"}], "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "_", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"uncondEStep", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], 
            "]"}], "&"}], ")"}]}], ",", "Infinity"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"uncondEStep", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.89283802890134*^9, 3.892838030900941*^9}, {
   3.892838083823448*^9, 3.892838092310711*^9}, {3.892838138034411*^9, 
   3.89283817641862*^9}, {3.892838220044372*^9, 3.892838228823832*^9}, {
   3.892838286807514*^9, 3.892838399679389*^9}, {3.892838547622286*^9, 
   3.89283855837638*^9}, {3.89305994539712*^9, 3.893059945404882*^9}, {
   3.893060330946208*^9, 3.893060396602564*^9}, 3.8930604807433987`*^9, {
   3.893066361049811*^9, 3.89306639221675*^9}, 3.893083429850601*^9, {
   3.893083954996154*^9, 3.893084012596081*^9}, {3.893104830026622*^9, 
   3.893104830331604*^9}, 3.893104885866941*^9, {3.8931051546625347`*^9, 
   3.893105161047236*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"20932644-ce55-47c6-a167-7c0a087a53af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"wc", ",", 
     RowBox[{"pd", " ", "ratios"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", "[", "t", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", 
           RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "1", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{"wc", "[", "t", "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{"wc", "[", "t", "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", "i", 
          "]"}], "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                 "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                 "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893086072267931*^9, 3.893086151775504*^9}, 
   3.893086247368884*^9, 3.8930863039185677`*^9, {3.893086419204494*^9, 
   3.893086419846327*^9}, {3.893086609193349*^9, 3.893086694155324*^9}, {
   3.893086761160204*^9, 3.8930868172023783`*^9}, {3.8930868600489817`*^9, 
   3.893086876039349*^9}, {3.893104834706069*^9, 3.8931048349199944`*^9}, 
   3.893104888456128*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"0e9025ae-9d2a-47ad-abbf-9a23b327cd2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"unconditional", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], ",", "modNRC"}], "]"}], "]"}], "===", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], ",", "modBY"}], "]"}], "]"}], "===", 
       
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
        "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"0", "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"uncondE", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"pi", "[", "t", "]"}], "3"], ",", "modNRC"}], "]"}], 
           RowBox[{"uncondE", "[", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}]}], "-", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"pi", "[", "t", "]"}], "3"], 
             RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}], ")"}],
         " ", "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"0", "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
          "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "*", "\n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "^", "2"}], 
            " ", "-", " ", "\n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "^", 
                  "2"}], " ", "+", "  ", 
                 RowBox[{
                 "2", "*", "FernandoDuarte`LongRunRisk`Model`Parameters`phip",
                   "*", "  ", 
                  "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "*", 
                  "FernandoDuarte`LongRunRisk`Model`Parameters`xip"}], " ", 
                 "+", "  ", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`Parameters`xip", "^", 
                  "2"}]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], " ", "+", " ", 
               RowBox[{
               "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "^", 
                "2"}]}], ")"}]}]}], ")"}]}]}], " ", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", "modNRC"}], "]"}]}]}], "===", 
       "muc"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"dc", "[", "t", "]"}], "2"], ",", "modNRC"}], 
           "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["muc", "2"], "+", 
           SuperscriptBox["phic", "2"], "+", 
           RowBox[{"2", " ", "Esg", " ", "phip", " ", "rhocp", " ", "xic"}], 
           "+", 
           RowBox[{
            SuperscriptBox["xic", "2"], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Esg", "2"], "+", 
              FractionBox[
               SuperscriptBox["phig", "2"], 
               RowBox[{"1", "-", 
                SuperscriptBox["rhog", "2"]}]]}], ")"}]}], " ", "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["rhocp", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", " ", "phip", " ", "rhop", " ", "xip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"muc", " ", "mup"}], "+", 
           RowBox[{"rhocp", " ", "xip", " ", "phip"}], "+", 
           RowBox[{"xic", " ", "rhop", " ", "phip", " ", "Esg"}], "+", 
           RowBox[{"xic", " ", "xip", " ", "Esg"}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rhocp", " ", "rhop"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["xip", "2"], "+", 
               RowBox[{"2", " ", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["phip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{"muc", " ", "Esg"}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Esg", "2"], "+", 
           RowBox[{
            FractionBox["rhog", 
             RowBox[{"1", "-", 
              SuperscriptBox["rhog", "2"]}]], 
            SuperscriptBox["phig", "2"]}]}], " ", ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Esg", "2"], "+", 
           RowBox[{
            FractionBox["rhog", 
             RowBox[{"1", "-", 
              SuperscriptBox["rhog", "2"]}]], 
            SuperscriptBox["phig", "2"]}]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"pi", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mup", "2"], "+", 
           RowBox[{"phip", " ", "xip"}], "+", 
           FractionBox[
            RowBox[{"rhop", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mup", "2"], "+", 
           RowBox[{"phip", " ", "xip"}], "+", 
           FractionBox[
            RowBox[{"rhop", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{"Esg", " ", "mup"}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"muc", " ", "mup"}], " ", "+", 
           RowBox[{"Esg", " ", "phip", "  ", "xic"}], "+", 
           FractionBox[
            RowBox[{"rhocp", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], " ", "+", " ", 
               RowBox[{"2", " ", "phip", " ", "rhop", "  ", "xip"}], "+", " ", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930931586861763`*^9, 3.893093169795704*^9}, {
   3.893102429143783*^9, 3.8931024298433332`*^9}, {3.893102466623125*^9, 
   3.893102586761202*^9}, {3.8931026368045473`*^9, 3.893102685312832*^9}, {
   3.893102716922923*^9, 3.8931028746270733`*^9}, {3.893102924509729*^9, 
   3.8931029338818493`*^9}, {3.893103097597286*^9, 3.893103302215263*^9}, 
   3.893103954197452*^9, {3.893104412861294*^9, 3.893104516056366*^9}, {
   3.8931048398447723`*^9, 3.8931048401145287`*^9}, 3.8931048923934526`*^9, {
   3.895419485222002*^9, 3.895419485233365*^9}, 3.8954196079500217`*^9, 
   3.895421241328764*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"e4884843-12f0-47a7-8451-879dcf79c5af"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 CellChangeTimes->{{3.890680295645965*^9, 3.89068029650622*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"985a3ae6-e130-4f8a-9b93-ae3fe10177bc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"add", " ", 
   RowBox[{"Begin", "[", "\"\<Context`\>\"", "]"}], " ", "and", " ", 
   RowBox[{"End", "[", "]"}], " ", "to", " ", "wlt", " ", "file"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.890686194230386*^9, 3.890686228283702*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"34eb60b3-650d-4879-853c-727ea9a613af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"helper", " ", "functions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"countLines", "[", "file_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"readStream", "=", 
        RowBox[{"OpenRead", "[", "file", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"n", "=", "1"}], ",", "\[IndentingNewLine]", "temp"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=!=", "EndOfFile"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"ReadLine", "[", "readStream", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"n", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "/@", 
       RowBox[{"{", "readStream", "}"}]}], ";", "\[IndentingNewLine]", 
      "n"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.890681841946844*^9, 3.890681899849094*^9}, {
  3.890682055663522*^9, 3.890682084827585*^9}, {3.890683635625399*^9, 
  3.890683720295089*^9}, {3.890685425949465*^9, 3.890685434516119*^9}, {
  3.890686231117095*^9, 3.890686238212121*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a85f5693-d085-4cc5-989a-a9500987950c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "replaceNthRecord", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replaceNthRecord", "[", 
   RowBox[{"file_String", ",", "n_Integer", ",", "replaceWith_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"readStream", "=", 
       RowBox[{"OpenRead", "[", "file", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"writeStream", "=", 
       RowBox[{"OpenWrite", "[", 
        RowBox[{"file", "<>", "\"\<temp\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "temp"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WriteLine", "[", 
        RowBox[{"writeStream", ",", 
         RowBox[{"ReadLine", "[", "readStream", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", "-", "1"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"writeStream", ",", 
       RowBox[{
        RowBox[{"ReadLine", "[", "readStream", "]"}], "<>", "\"\< \\r\\n\>\"",
         "<>", "replaceWith"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=!=", "EndOfFile"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"ReadLine", "[", "readStream", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{"temp", ",", "EndOfFile"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteLine", "[", 
           RowBox[{"writeStream", ",", "temp"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", 
     RowBox[{"Close", "/@", 
      RowBox[{"{", 
       RowBox[{"readStream", ",", "writeStream"}], "}"}]}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8906824011137114`*^9, 3.890682405708049*^9}, {
   3.890683066049664*^9, 3.8906830825042677`*^9}, {3.89068319056032*^9, 
   3.890683191547068*^9}, {3.89068338518532*^9, 3.890683430044886*^9}, {
   3.890683477495555*^9, 3.89068350860789*^9}, {3.890683563263863*^9, 
   3.890683572999384*^9}, {3.8906837588959513`*^9, 3.890683769652152*^9}, 
   3.890683975431652*^9, 3.890684184728485*^9, {3.890684538464937*^9, 
   3.890684546403357*^9}, 3.8906847013731937`*^9, 3.890684736359234*^9, {
   3.890684917937912*^9, 3.890684918964259*^9}, {3.890685003978653*^9, 
   3.8906850058353167`*^9}, {3.890685081266893*^9, 3.890685086440845*^9}, {
   3.890685162742771*^9, 3.890685164959052*^9}, {3.890685207547077*^9, 
   3.890685210133041*^9}, {3.890685379823967*^9, 3.890685396833392*^9}, {
   3.89068547363831*^9, 3.890685483195992*^9}, {3.8906856724322433`*^9, 
   3.890685672699678*^9}, {3.890685793209527*^9, 3.890685826416944*^9}, 
   3.8906858923977957`*^9, {3.890685924003189*^9, 3.890685959055036*^9}, {
   3.890686016304421*^9, 3.890686073140353*^9}, {3.890686249638393*^9, 
   3.8906862512145*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"ad25c99b-2683-4ce1-a7e6-bbce1e6ba9da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"insert", " ", "into", " ", "wlt", " ", "file"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"replaceNthRecord", "[", 
    RowBox[{
    "testFileName", ",", "1", ",", 
     "\"\<Begin[\\\"ComputationalEngine`Uncond`\\\"]\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CopyFile", "[", 
     RowBox[{
      RowBox[{"testFileName", "<>", "\"\<temp\>\""}], ",", "testFileName", 
      ",", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}], "\n", 
   RowBox[{"DeleteFile", "[", 
    RowBox[{"testFileName", "<>", "\"\<temp\>\""}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"numLines", "=", 
    RowBox[{"countLines", "[", "testFileName", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"replaceNthRecord", "[", 
    RowBox[{"testFileName", ",", 
     RowBox[{"numLines", "-", "3"}], ",", " ", "\"\<End[]\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CopyFile", "[", 
     RowBox[{
      RowBox[{"testFileName", "<>", "\"\<temp\>\""}], ",", "testFileName", 
      ",", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}], "\n", 
   RowBox[{"DeleteFile", "[", 
    RowBox[{"testFileName", "<>", "\"\<temp\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.890684439578331*^9, {3.8906861781312037`*^9, 3.890686181646003*^9}, {
   3.890686261099564*^9, 3.8906862940387907`*^9}, {3.890710614230303*^9, 
   3.8907106202002974`*^9}, 3.8931046283317003`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"315ef181-7d11-46ac-8819-a70759fefbb2"],

Cell[BoxData[
 RowBox[{"tr", "=", 
  RowBox[{"TestReport", "[", "testFileName", "]"}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"c5da93c9-aa05-4285-b981-eb34b61414e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Interactive Tests", "Subsection",
 CellChangeTimes->{{3.889905622471089*^9, 3.889905629759961*^9}, {
  3.889972063478182*^9, 
  3.889972065236586*^9}},ExpressionUUID->"d03dfeba-2718-41c7-9b3f-\
19ce5bed64e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.891595279589191*^9, 3.891616060767905*^9, 3.8916343707639523`*^9, {
   3.891913938964695*^9, 3.8919139392219143`*^9}, {3.891915985036783*^9, 
   3.8919159853773212`*^9}, {3.892039540791751*^9, 3.8920395410421963`*^9}, {
   3.892161069893014*^9, 3.892161073697487*^9}, {3.892167389746036*^9, 
   3.89216739021437*^9}, {3.892985575548376*^9, 3.892985579785521*^9}, {
   3.893087090785573*^9, 3.8930871021359863`*^9}, {3.893143287649158*^9, 
   3.893143311290959*^9}, {3.895419408907625*^9, 3.895419444813488*^9}, 
   3.895419558061615*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"050051e2-6c9d-4505-ae74-78e93d008436"],

Cell[BoxData[{
 RowBox[{"Get", "[", 
  "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Kernel/ComputationalEngine/\
ComputeUnconditionalExpectations.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "createSystem", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`createSystem"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "evNoEpsStateVarsProduct", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`evNoEpsStateVarsProduct"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "uncondEStep", "=", 
   "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`uncondEStep"}], ";"}]}], "Input",
 CellChangeTimes->{{3.891915640666362*^9, 3.891915642574032*^9}, 
   3.891974020991497*^9, {3.8923885202156773`*^9, 3.892388522699502*^9}, {
   3.893086966177046*^9, 3.8930869779756327`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"bd79e4cf-318a-4802-8fac-3ca0590440bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "system", " ", "of", " ", "equations", " ", "for", " ", "unconditional", 
    " ", "moments", " ", "of", " ", "state", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules1", ",", "system1", ",", "unknowns1"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"1", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules2", ",", "system2", ",", "unknowns2"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"2", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules3", ",", "system3", ",", "unknowns3"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"3", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules4", ",", "system4", ",", "unknowns4"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"4", ",", "modNRC"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol1", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system1", ",", "unknowns1"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol2", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system2", ",", "unknowns2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol3", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system3", ",", "unknowns3"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol4", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system4", ",", "unknowns4"}], "]"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules1", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system1", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns1", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\n", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules2", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system2", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns2", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules3", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system3", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns3", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"nameRules4", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"system4", "===", "$Failed"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"unknowns4", "===", "$Failed"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{"there", " ", "is", " ", "a", " ", "solution"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"sol1", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol2", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol3", "===", 
           RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Not", "[", 
          RowBox[{"sol4", "===", 
           RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ",",
       "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "solutions", " ", "are", " ", "the", " ", "same", " ", "for", " ", 
        "same", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns1", ",", "unknowns3"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol1", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns2", ",", "unknowns3"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol2", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns1", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol1", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns2", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol2", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"unknowns3", ",", "unknowns4"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"sol3", ",", "sol4"}], "}"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8928872783997917`*^9, 3.8928872825022306`*^9}, {
   3.893058081176363*^9, 3.893058081797423*^9}, 3.8930584588887653`*^9, {
   3.893083667979657*^9, 3.893083681854567*^9}, {3.8930837480086393`*^9, 
   3.893083781840391*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"741f13a5-567e-4f66-b177-95edd21cf048"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
    "hand"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi1", "/.", "sol1"}], ")"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`sg1", "/.", "sol1"}], ")"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi2", "/.", "sol2"}], "]"}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
          "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip", 
             "2"], "+", 
            RowBox[{
            "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ",
              "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
             "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
            " ", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phip",
              "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhop",
              "2"]}], ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`sg2", "/.", "sol2"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
         "2"], "+", 
        FractionBox[
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
          "2"], 
         RowBox[{"1", "-", 
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
           "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`pi1sg1", "/.", "sol2"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.892524523636704*^9, 3.892524538980324*^9}, {
   3.892524963969441*^9, 3.892524997873*^9}, {3.8925250491209106`*^9, 
   3.892525102081677*^9}, {3.892525153236815*^9, 3.892525230281101*^9}, {
   3.8925712267857227`*^9, 3.89257122924771*^9}, {3.89305855312013*^9, 
   3.893058646744561*^9}, {3.893059266545212*^9, 3.893059334165757*^9}, {
   3.893083789529174*^9, 3.893083797521639*^9}, 3.901592696340942*^9, 
   3.9015933817077312`*^9, {3.9015937701195107`*^9, 3.901593786181929*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"4d8b76a7-83c9-4e5f-899f-4d605e148904"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
    "hand"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{
        RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
      "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"pi", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], 
        "]"}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"ExpandAll", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
          "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip", 
             "2"], "+", 
            RowBox[{
            "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ",
              "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
             "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
            " ", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phip",
              "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            
            SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhop",
              "2"]}], ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"sg", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], "]"}], 
      "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
         "2"], "+", 
        FractionBox[
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
          "2"], 
         RowBox[{"1", "-", 
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
           "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "]"}], "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930848967948723`*^9, 3.893084935031836*^9}, {
   3.893085027101679*^9, 3.893085045144382*^9}, {3.8930857992167387`*^9, 
   3.893085830327442*^9}, {3.893085980007868*^9, 3.8930860239405127`*^9}, 
   3.893087085948606*^9, {3.895419479552326*^9, 3.895419482422165*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"501c7feb-247d-4334-9de7-0fa71b768d3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "moments", " ", "can", " ", "be", " ", "evaluated", " ", "numerically", 
    " ", "using", " ", "parameters", " ", "values", " ", "only"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol1"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol2"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol3"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{"NumberQ", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Values", "@", "sol4"}], "//.", 
          RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
       ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.893082237801841*^9, {3.893082288507763*^9, 3.893082397545843*^9}, {
   3.89308380447088*^9, 3.893083826885064*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"e83d351b-c874-4d7c-99ab-44974599b0ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "evNoEpsStateVarsProduct", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stateVarsNoEps", "=", 
     RowBox[{"{", 
      RowBox[{"sg", ",", "pi"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"model", "=", "modNRC"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.892838674699943*^9, 3.892838701015687*^9}, {
   3.8928871836412153`*^9, 3.892887201737369*^9}, {3.893057674036683*^9, 
   3.893057694298431*^9}, 3.89305790637994*^9, {3.893081993098256*^9, 
   3.89308199954256*^9}, 3.8930869590423203`*^9, 3.893087080903373*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"1ca27c4e-8300-4286-b456-8e0087140c55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"basic", " ", "use"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", "stateVarsNoEps"}], 
       "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
        "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
          "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
         RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phig", " ", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"", 
            "]"}], "[", "t", "]"}]}]}], ")"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
         "model", ",", "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "-", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
         SuperscriptBox[
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", "t", "]"}], "2"]}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], ")"}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandAll", "[", 
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], "]"}], "===", 
      RowBox[{"ExpandAll", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`mud", "[", "i", "]"}], 
         " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "-", 
        RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`phidc", "[", "i", "]"}],
          " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
           "]"}], "[", "t", "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "t"}], "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`xid", "[", "i", "]"}], 
         " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
           "]"}], "[", "t", "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sg", "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893081708234816*^9, 3.8930817475700893`*^9}, {
  3.893082619951611*^9, 3.893082620668397*^9}, {3.8930826743611507`*^9, 
  3.893082674969939*^9}, {3.89308271889793*^9, 3.893082764899756*^9}, {
  3.893083300110649*^9, 3.8930833295765333`*^9}, {3.893083371906817*^9, 
  3.893083397811235*^9}, {3.8930835396615067`*^9, 3.8930836030394173`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"d0db5667-2e97-4dc9-bbc8-c77fdd58913c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "context", " ", "for", " ", "shocks", " ", "is", " ", 
    "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
          "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
          "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"DeleteDuplicates", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"evNoEpsStateVarsProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pi", "[", 
                RowBox[{"t", "-", "1"}], "]"}], 
               RowBox[{"sg", "[", "t", "]"}], 
               RowBox[{"dd", "[", 
                RowBox[{"t", ",", "i"}], "]"}], 
               RowBox[{
                RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
              RowBox[{"Append", "[", 
               RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x_Symbol", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
              "[", 
              RowBox[{"__", ",", "___"}], "]"}], ":>", 
             RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
         ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930830724712353`*^9, 3.893083259734127*^9}, 
   3.893083445300497*^9, {3.893083843952413*^9, 3.893083861525839*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"0d475290-74ef-463d-bdaa-73a9ba95a45e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "if", " ", "variables", " ", "lagged", " ", "to", " ", "the",
     " ", "right", " ", "time", " ", "period"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], "===", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}]}],
     "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.892837690169054*^9, 3.892837854348692*^9}, 
   3.89283864284869*^9, 3.892838715667156*^9, 3.893057562171788*^9, 
   3.893057898180541*^9, 3.893058027361483*^9, {3.893059945383209*^9, 
   3.893059945387575*^9}, 3.893059994856317*^9, {3.893060102391067*^9, 
   3.893060146717375*^9}, {3.893060178483892*^9, 3.893060220488847*^9}, 
   3.893081080462633*^9, 3.893083437165765*^9, {3.893083871926509*^9, 
   3.893083892419632*^9}, {3.893105071113224*^9, 3.893105111747327*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"e41fa91e-6ca1-42d6-8c27-205431f20beb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "use", " ", "variables", " ", "indexed", " ", "by", " ", "time", " ", 
    "that", " ", "are", " ", "not", " ", "lagged"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"foo", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], 
       RowBox[{"foo", "[", 
        RowBox[{"t", "-", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExpandAll", "@", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ")"}], "===", 
      RowBox[{"(", 
       RowBox[{"ExpandAll", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{"t", "+", "1"}], "]"}], "*", 
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
             RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}]}], ")"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8928378645917997`*^9, 3.8928380134079*^9}, {
   3.89283856318399*^9, 3.892838569033311*^9}, {3.893059945388934*^9, 
   3.893059945395464*^9}, 3.893081075924605*^9, {3.893081367930172*^9, 
   3.893081370124003*^9}, 3.893083433344887*^9, {3.893083496494205*^9, 
   3.8930835310955772`*^9}, {3.893083900795011*^9, 3.8930839188691053`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"b055fca5-7668-425d-a906-e72bcf1b3be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "add", " ", "irrelevant", " ", "variables", " ", "to", " ", "lag"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "myVariable"}], "]"}]}], "]"}], "===", 
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}], 
         RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "irrelevantVar"}], "]"}]}], "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{"anotherIrrelevantVar", " ", 
         RowBox[{"pi", "[", "t", "]"}], 
         RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"stateVarsNoEps", ",", "anotherIrrelevantVar"}], "]"}]}], 
       "]"}], "===", 
      RowBox[{"anotherIrrelevantVar", "*", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
        "]"}], " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
        "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930839246758204`*^9, 3.893083937930691*^9}, {
  3.8930840322990923`*^9, 3.893084140616804*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"7b0db066-978b-4b92-9a55-c371cba1c20a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"lag", " ", "dd"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "\"\<pi\>\"", "]"}], "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "lag", " ", "dd", " ", "and", " ", "expression", " ", "has", " ", 
       RowBox[{"eps", "[", "\"\<dd\>\"", "]"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
            "]"}], "&"}], ")"}]}], "[", 
        RowBox[{
         RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "\"\<dd\>\"", "]"}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"dd", "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Not", "@", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "_", "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"uncondEStep", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
       RowBox[{"_Symbol", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], "]"}],
           "&"}], ")"}]}], ",", "Infinity"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"uncondEStep", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dc", "[", 
           RowBox[{"t", "-", "1"}], "]"}], 
          RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
       RowBox[{
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
            "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
      "]"}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.89283802890134*^9, 3.892838030900941*^9}, {
   3.892838083823448*^9, 3.892838092310711*^9}, {3.892838138034411*^9, 
   3.89283817641862*^9}, {3.892838220044372*^9, 3.892838228823832*^9}, {
   3.892838286807514*^9, 3.892838399679389*^9}, {3.892838547622286*^9, 
   3.89283855837638*^9}, {3.89305994539712*^9, 3.893059945404882*^9}, {
   3.893060330946208*^9, 3.893060396602564*^9}, 3.8930604807433987`*^9, {
   3.893066361049811*^9, 3.89306639221675*^9}, 3.893083429850601*^9, {
   3.893083954996154*^9, 3.893084012596081*^9}, {3.8931051334785633`*^9, 
   3.893105141267414*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"6cc4aa60-424a-40fe-a887-9b941e717d21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"wc", ",", 
    RowBox[{"pd", " ", "ratios"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", "[", "t", 
        "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"wc", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
          "model", ",", 
          RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "1", 
        "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"evNoEpsStateVarsProduct", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pd", "[", 
          RowBox[{"t", ",", "i"}], "]"}], 
         RowBox[{
          RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
        "stateVarsNoEps"}], "]"}], "===", 
      RowBox[{
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", "[", 
        RowBox[{"t", ",", "i"}], "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
          "model", ",", 
          RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
      RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", "i", 
         "]"}], "[", "1", "]"}], " ", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
         "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"x_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "0", "]"}], 
            RowBox[{
             RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
          RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
      
      RowBox[{
      "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
       "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.893086072267931*^9, 3.893086151775504*^9}, 
   3.893086247368884*^9, 3.8930863039185677`*^9, {3.893086419204494*^9, 
   3.893086419846327*^9}, {3.893086609193349*^9, 3.893086694155324*^9}, {
   3.893086761160204*^9, 3.8930868172023783`*^9}, {3.8930868600489817`*^9, 
   3.893086876039349*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"05a7cc59-3aea-496a-bb9e-cc18f5691b8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"unconditional", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"And", "@@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], ",", "modNRC"}], "]"}], "]"}], "===", 
      
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"wc", "[", "t", "]"}], ",", "modBY"}], "]"}], "]"}], "===", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
       "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"uncondE", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], ",", "modNRC"}], "]"}], 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}]}], "-", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}], ")"}], 
       " ", "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"0", "===", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"pi", "[", "t", "]"}], "3"], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "-", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "*", "\n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "^", "2"}], " ",
            "-", " ", "\n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "^", 
                 "2"}], " ", "+", "  ", 
                RowBox[{
                "2", "*", "FernandoDuarte`LongRunRisk`Model`Parameters`phip", 
                 "*", "  ", 
                 "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "*", 
                 "FernandoDuarte`LongRunRisk`Model`Parameters`xip"}], " ", 
                "+", "  ", 
                RowBox[{
                "FernandoDuarte`LongRunRisk`Model`Parameters`xip", "^", 
                 "2"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], " ", "+", " ", 
              RowBox[{
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "^", 
               "2"}]}], ")"}]}]}], ")"}]}]}], " ", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simplify", "@", 
       RowBox[{"SetSymbolsContext", "@", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"dc", "[", "t", "]"}], ",", "modNRC"}], "]"}]}]}], "===", 
      "muc"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"dc", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}]}]}]}],
       "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["muc", "2"], "+", 
          SuperscriptBox["phic", "2"], "+", 
          RowBox[{"2", " ", "Esg", " ", "phip", " ", "rhocp", " ", "xic"}], 
          "+", 
          RowBox[{
           SuperscriptBox["xic", "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Esg", "2"], "+", 
             FractionBox[
              SuperscriptBox["phig", "2"], 
              RowBox[{"1", "-", 
               SuperscriptBox["rhog", "2"]}]]}], ")"}]}], " ", "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["rhocp", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", " ", "phip", " ", "rhop", " ", "xip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muc", " ", "mup"}], "+", 
          RowBox[{"rhocp", " ", "xip", " ", "phip"}], "+", 
          RowBox[{"xic", " ", "rhop", " ", "phip", " ", "Esg"}], "+", 
          RowBox[{"xic", " ", "xip", " ", "Esg"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rhocp", " ", "rhop"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["xip", "2"], "+", 
              RowBox[{"2", " ", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["phip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{"muc", " ", "Esg"}], ")"}]}]}]}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Esg", "2"], "+", 
          RowBox[{
           FractionBox["rhog", 
            RowBox[{"1", "-", 
             SuperscriptBox["rhog", "2"]}]], 
           SuperscriptBox["phig", "2"]}]}], " ", ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sg", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Esg", "2"], "+", 
          RowBox[{
           FractionBox["rhog", 
            RowBox[{"1", "-", 
             SuperscriptBox["rhog", "2"]}]], 
           SuperscriptBox["phig", "2"]}]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"pi", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mup", "2"], "+", 
          RowBox[{"phip", " ", "xip"}], "+", 
          FractionBox[
           RowBox[{"rhop", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mup", "2"], "+", 
          RowBox[{"phip", " ", "xip"}], "+", 
          FractionBox[
           RowBox[{"rhop", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], "+", 
              RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{"Esg", " ", "mup"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
      RowBox[{"FullSimplify", "@", 
       RowBox[{"Expand", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muc", " ", "mup"}], " ", "+", 
          RowBox[{"Esg", " ", "phip", "  ", "xic"}], "+", 
          FractionBox[
           RowBox[{"rhocp", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["phip", "2"], " ", "+", " ", 
              RowBox[{"2", " ", "phip", " ", "rhop", "  ", "xip"}], "+", " ", 
              
              SuperscriptBox["xip", "2"]}], ")"}]}], 
           RowBox[{"1", "-", 
            SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8930931586861763`*^9, 3.893093169795704*^9}, {
   3.893102429143783*^9, 3.8931024298433332`*^9}, {3.893102466623125*^9, 
   3.893102586761202*^9}, {3.8931026368045473`*^9, 3.893102685312832*^9}, {
   3.893102716922923*^9, 3.8931028746270733`*^9}, {3.893102924509729*^9, 
   3.8931029338818493`*^9}, {3.893103097597286*^9, 3.893103302215263*^9}, 
   3.893103954197452*^9, {3.893104412861294*^9, 3.893104516056366*^9}, {
   3.895419485235199*^9, 3.895419485245006*^9}, 3.8954196079524612`*^9, 
   3.895419669406982*^9, {3.8954211643782167`*^9, 3.895421216998274*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"2b5a408f-d169-4811-a520-875e601018ac"]
}, Closed]]
},
WindowSize->{1276, 878},
WindowMargins->{{193, Automatic}, {21, Automatic}},
WindowStatusArea->"",
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1ef9b20d-f574-46df-8eff-fd603e24b0ef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 215, 4, 37, "Input",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],
Cell[618, 19, 1912, 37, 142, "Input",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],
Cell[CellGroupData[{
Cell[2555, 60, 255, 4, 67, "Subsection",ExpressionUUID->"2157750c-ae6d-47e9-b5dd-9c68ad40141b"],
Cell[2813, 66, 316, 7, 37, "Input",ExpressionUUID->"f2799e55-a4bc-4cd6-9966-6392a845d852"],
Cell[3132, 75, 601, 11, 64, "Input",ExpressionUUID->"8eff5a9c-f1a4-4d23-af33-c77709b1754e"],
Cell[3736, 88, 314, 5, 37, "Input",ExpressionUUID->"2f82b75d-42a0-4b76-b3ff-7172db85f4de"],
Cell[4053, 95, 506, 10, 90, "Input",ExpressionUUID->"eccf8930-58b0-4acf-8ec2-cc24c39a0278"],
Cell[4562, 107, 1700, 28, 90, "Input",ExpressionUUID->"0f0d628d-d6b9-4205-8e24-5e38623917fa"],
Cell[6265, 137, 1256, 21, 90, "Input",ExpressionUUID->"0b6966dc-5fa6-470b-a745-2d3c09da3d4b"],
Cell[7524, 160, 938, 17, 116, "Input",ExpressionUUID->"8845796e-7665-4c7d-8872-0aad8272ffea"],
Cell[8465, 179, 1736, 39, 324, "Input",ExpressionUUID->"d935faaf-50bc-4a8e-a3fd-9047b2c4629b"],
Cell[10204, 220, 7960, 191, 1546, "Input",ExpressionUUID->"0958ce5d-a8a4-48ff-ba85-0ddb97fc37d7"],
Cell[18167, 413, 3593, 84, 569, "Input",ExpressionUUID->"53790e1b-0739-4af7-b71e-e7c4f97e09ce"],
Cell[21763, 499, 3957, 97, 679, "Input",ExpressionUUID->"8f6e6c22-7c31-4776-a49f-d2f5143966c9"],
Cell[25723, 598, 2037, 49, 246, "Input",ExpressionUUID->"10534701-86cc-4812-b9d1-583f080b6be2"],
Cell[27763, 649, 12781, 303, 1849, "Input",ExpressionUUID->"ca14d8f1-7a77-428b-8c74-a7eb0de7af1a"],
Cell[40547, 954, 5561, 134, 506, "Input",ExpressionUUID->"8997ccda-5ae0-43a0-9042-48220e750fbc"],
Cell[46111, 1090, 6534, 167, 454, "Input",ExpressionUUID->"e22bc11e-b400-47fc-b98c-49b5db95ac36"],
Cell[52648, 1259, 2707, 63, 272, "Input",ExpressionUUID->"43ab956e-5418-4766-8b40-61e18ece38fb"],
Cell[55358, 1324, 2734, 63, 376, "Input",ExpressionUUID->"7223286e-e1a1-41e8-a6d2-dd8bb1b5b576"],
Cell[58095, 1389, 10787, 280, 714, "Input",ExpressionUUID->"20932644-ce55-47c6-a167-7c0a087a53af"],
Cell[68885, 1671, 11280, 276, 1208, "Input",ExpressionUUID->"0e9025ae-9d2a-47ad-abbf-9a23b327cd2c"],
Cell[80168, 1949, 12809, 324, 1482, "Input",ExpressionUUID->"e4884843-12f0-47a7-8451-879dcf79c5af"],
Cell[92980, 2275, 195, 3, 37, "Input",ExpressionUUID->"985a3ae6-e130-4f8a-9b93-ae3fe10177bc"],
Cell[93178, 2280, 356, 7, 37, "Input",ExpressionUUID->"34eb60b3-650d-4879-853c-727ea9a613af"],
Cell[93537, 2289, 1502, 33, 402, "Input",ExpressionUUID->"a85f5693-d085-4cc5-989a-a9500987950c"],
Cell[95042, 2324, 3288, 67, 558, "Input",ExpressionUUID->"ad25c99b-2683-4ce1-a7e6-bbce1e6ba9da"],
Cell[98333, 2393, 1587, 38, 246, "Input",ExpressionUUID->"315ef181-7d11-46ac-8819-a70759fefbb2"],
Cell[99923, 2433, 177, 3, 37, "Input",ExpressionUUID->"c5da93c9-aa05-4285-b981-eb34b61414e4"]
}, Closed]],
Cell[CellGroupData[{
Cell[100137, 2441, 214, 4, 46, "Subsection",ExpressionUUID->"d03dfeba-2718-41c7-9b3f-19ce5bed64e2"],
Cell[100354, 2447, 1427, 33, 168, "Input",ExpressionUUID->"050051e2-6c9d-4505-ae74-78e93d008436"],
Cell[101784, 2482, 1056, 25, 194, "Input",ExpressionUUID->"bd79e4cf-318a-4802-8fac-3ca0590440bd"],
Cell[102843, 2509, 7611, 195, 1494, "Input",ExpressionUUID->"741f13a5-567e-4f66-b177-95edd21cf048"],
Cell[110457, 2706, 3674, 86, 629, "Input",ExpressionUUID->"4d8b76a7-83c9-4e5f-899f-4d605e148904"],
Cell[114134, 2794, 3553, 89, 635, "Input",ExpressionUUID->"501c7feb-247d-4334-9de7-0fa71b768d3e"],
Cell[117690, 2885, 1703, 45, 194, "Input",ExpressionUUID->"e83d351b-c874-4d7c-99ab-44974599b0ce"],
Cell[119396, 2932, 683, 14, 90, "Input",ExpressionUUID->"1ca27c4e-8300-4286-b456-8e0087140c55"],
Cell[120082, 2948, 11600, 292, 1635, "Input",ExpressionUUID->"d0db5667-2e97-4dc9-bbc8-c77fdd58913c"],
Cell[131685, 3242, 5151, 131, 454, "Input",ExpressionUUID->"0d475290-74ef-463d-bdaa-73a9ba95a45e"],
Cell[136839, 3375, 6079, 163, 402, "Input",ExpressionUUID->"e41fa91e-6ca1-42d6-8c27-205431f20beb"],
Cell[142921, 3540, 2361, 59, 220, "Input",ExpressionUUID->"b055fca5-7668-425d-a906-e72bcf1b3be2"],
Cell[145285, 3601, 2319, 56, 324, "Input",ExpressionUUID->"7b0db066-978b-4b92-9a55-c371cba1c20a"],
Cell[147607, 3659, 10212, 274, 662, "Input",ExpressionUUID->"6cc4aa60-424a-40fe-a887-9b941e717d21"],
Cell[157822, 3935, 10760, 278, 1156, "Input",ExpressionUUID->"05a7cc59-3aea-496a-bb9e-cc18f5691b8f"],
Cell[168585, 4215, 12213, 314, 1438, "Input",ExpressionUUID->"2b5a408f-d169-4811-a520-875e601018ac"]
}, Closed]]
}
]
*)

