(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    275146,       6689]
NotebookOptionsPosition[    268410,       6587]
NotebookOutlinePosition[    268904,       6606]
CellTagsIndexPosition[    268861,       6603]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.889964198656839*^9, 3.889964203363894*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"testFileName", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DirectoryName", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"FileBaseName", "[", 
       RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
      "\"\<.wlt\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pacletDir", "=", 
  RowBox[{"DirectoryName", "[", 
   RowBox[{"testFileName", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PacletDirectoryLoad", "[", "pacletDir", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"testContextBase", "=", 
  RowBox[{"FileBaseName", "[", "testFileName", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$ContextPath", "=", 
  RowBox[{"Cases", "[", 
   RowBox[{"$ContextPath", ",", 
    RowBox[{"Except", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8890661685133457`*^9, 3.889066220685074*^9}, {
   3.8890662555512333`*^9, 3.889066299901951*^9}, {3.889066581166473*^9, 
   3.8890665847967653`*^9}, {3.889066731765956*^9, 3.889066745674687*^9}, {
   3.889431410824514*^9, 3.88943144002302*^9}, 3.889502968269744*^9, {
   3.889998928469849*^9, 3.889998928670561*^9}, {3.890676553021196*^9, 
   3.890676564028514*^9}, 3.890676636594749*^9, {3.890679618620262*^9, 
   3.89067961902995*^9}, {3.8908254134370813`*^9, 3.890825413876319*^9}, {
   3.890825459205497*^9, 3.890825473041605*^9}, {3.890825503118348*^9, 
   3.8908255374530487`*^9}, {3.891021675325671*^9, 3.891021675545487*^9}, {
   3.8911588731924877`*^9, 3.891158877904397*^9}, {3.8911592499395514`*^9, 
   3.8911592502376633`*^9}, {3.891244075958187*^9, 3.891244079885818*^9}, 
   3.891274440015959*^9, 3.891913898993636*^9, {3.893083620043439*^9, 
   3.893083620908062*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Tests/CreateMomentsDatabase.wlt\"\>"], \
"Output",
 CellChangeTimes->{3.895478492452496*^9, 3.895478986037311*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"9520f0b9-f9ca-4f20-893b-1fc76f563fba"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/\"\>"], "Output",
 CellChangeTimes->{3.895478492452496*^9, 3.895478986039302*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"83b47bba-d695-4331-85a4-657b80e3e8c1"],

Cell[BoxData[
 RowBox[{"{", "\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/\"\>", "}"}]], "Output",
 CellChangeTimes->{3.895478492452496*^9, 3.895478986099332*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"7a1108ea-73a3-4562-8898-9840de11018d"],

Cell[BoxData["\<\"CreateMomentsDatabase\"\>"], "Output",
 CellChangeTimes->{3.895478492452496*^9, 3.8954789861013536`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"ad5e26b3-ece4-4218-b5b1-2a62381f58f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Parallel`Debug`Perfmon`\"\>", ",", "\<\"Parallel`Debug`\"\>", 
   ",", "\<\"HighlightingCompatibility`\"\>", ",", "\<\"System`\"\>", 
   ",", "\<\"Global`\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.895478492452496*^9, 3.8954789861031303`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"7afc31ec-a8b6-4455-a677-22603a80c4db"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CI Tests", "Subsection",
 CellChangeTimes->{{3.8895791922306013`*^9, 3.889579196409403*^9}, {
  3.889905620469079*^9, 3.8899056207707977`*^9}, {3.889967624152501*^9, 
  3.889967626012704*^9}},ExpressionUUID->"2157750c-ae6d-47e9-b5dd-\
9c68ad40141b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FileNames", "[", "testFileName", "]"}], "===", 
    RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
   RowBox[{"DeleteFile", "[", "testFileName", "]"}]}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"f2799e55-a4bc-4cd6-9966-6392a845d852"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"confirm", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"testContext", "=", 
  RowBox[{
  "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\>\"", "<>", 
   "testContextBase", "<>", "\"\<`\>\""}]}]}], "Input",
 CellChangeTimes->{{3.8906795325443907`*^9, 3.8906795357982817`*^9}, 
   3.890679566064293*^9, {3.8906796081672497`*^9, 3.8906796258061447`*^9}, {
   3.890679757679096*^9, 3.890679766260743*^9}, 3.890679874010334*^9, 
   3.890710660724628*^9, 3.893104584960622*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"8eff5a9c-f1a4-4d23-af33-c77709b1754e"],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<ComputationalEngine`Uncond`\>\"", "]"}]], "Input",\

 CellChangeTimes->{{3.890680288696157*^9, 3.8906802887021513`*^9}, 
   3.8907105705815163`*^9, {3.893104595723756*^9, 3.893104599289246*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"2f82b75d-42a0-4b76-b3ff-7172db85f4de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "confirm"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.895423648276607*^9, 3.8954236486248627`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"eccf8930-58b0-4acf-8ec2-cc24c39a0278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Needs", "[", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8899652151465197`*^9, 3.889965235350771*^9}, 
   3.8899652808817787`*^9, {3.889967731242805*^9, 3.8899677356636972`*^9}, {
   3.889967971867523*^9, 3.889967975146998*^9}, {3.889968339451161*^9, 
   3.88996834001075*^9}, 3.889968619774049*^9, {3.8899688826075077`*^9, 
   3.88996888992594*^9}, {3.88996899475625*^9, 3.8899690018858624`*^9}, {
   3.8899691256166267`*^9, 3.8899691257757883`*^9}, {3.889969207667478*^9, 
   3.8899692141700287`*^9}, {3.8899692798779783`*^9, 3.889969288274632*^9}, 
   3.889969387087708*^9, 3.889969585993528*^9, {3.8899702972149563`*^9, 
   3.889970314454108*^9}, {3.890603045806611*^9, 3.890603046578224*^9}, 
   3.890603139674321*^9, {3.890676572733183*^9, 3.890676585108572*^9}, {
   3.890679071059198*^9, 3.890679121055434*^9}, {3.89067917308251*^9, 
   3.890679177122958*^9}, 3.890679328121275*^9, {3.8906795122187853`*^9, 
   3.890679514391316*^9}, {3.890679606901452*^9, 3.8906796293121653`*^9}, {
   3.890679668768669*^9, 3.890679669902752*^9}, {3.8906797200186*^9, 
   3.890679786626452*^9}, {3.890679828108779*^9, 3.890679882954316*^9}, 
   3.890710569438944*^9, 3.8907106646373167`*^9, {3.8931046613250093`*^9, 
   3.893104665209495*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0f0d628d-d6b9-4205-8e24-5e38623917fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
    "$ContextPath", ",", 
     "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\""}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.889901579125684*^9, {3.889965035911569*^9, 3.889965039550325*^9}, {
   3.889965296152458*^9, 3.889965305191854*^9}, 3.8899653858152437`*^9, 
   3.889967740469187*^9, {3.889968345370779*^9, 3.889968347169169*^9}, {
   3.889968526692542*^9, 3.8899685355316963`*^9}, {3.889968649261517*^9, 
   3.889968660343141*^9}, 3.889969395693264*^9, {3.88996958684683*^9, 
   3.8899695947482367`*^9}, {3.889970300225127*^9, 3.889970329366473*^9}, {
   3.890603050754869*^9, 3.8906030512673264`*^9}, 3.890603142316881*^9, 
   3.89067659639168*^9, {3.890679255090239*^9, 3.890679318737549*^9}, 
   3.890679634337233*^9, 3.890679895680545*^9, 3.8907105756061573`*^9, 
   3.89071066843771*^9, 3.893104682136538*^9, 3.895423668008821*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"0b6966dc-5fa6-470b-a745-2d3c09da3d4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "should", " ", "be", " ", "true", " ", "if", " ", "uncondE", " ", "can", 
     " ", "be", " ", "found"}], "*)"}], "\[IndentingNewLine]", "\t", 
   RowBox[{"Not", "[", 
    RowBox[{
     RowBox[{"Names", "[", "\"\<*uncondE\>\"", "]"}], "===", 
     RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8899706175264597`*^9, 3.889970628972746*^9}, 
   3.889972029349813*^9, {3.890016004516365*^9, 3.890016008058874*^9}, {
   3.890679266281045*^9, 3.8906792665642843`*^9}, {3.89067933542416*^9, 
   3.890679337313949*^9}, {3.8907105841635733`*^9, 3.890710593701932*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"8845796e-7665-4c7d-8872-0aad8272ffea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Get", "@", 
     RowBox[{"Get", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
        "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
        "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"modBY", "=", 
     RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"modNRC", "=", 
     RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
    "createSystem", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`createSystem"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "evNoEpsStateVarsProduct", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`evNoEpsStateVarsProduct"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "uncondEStep", "=", 
     "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`uncondEStep"}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893104714075774*^9, 3.8931047694359703`*^9}, {
   3.893144359618079*^9, 3.893144383217063*^9}, 3.895419485208782*^9, 
   3.895419607947516*^9, 3.89542370777417*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"d935faaf-50bc-4a8e-a3fd-9047b2c4629b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "system", " ", "of", " ", "equations", " ", "for", " ", "unconditional", 
     " ", "moments", " ", "of", " ", "state", " ", "variables"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules1", ",", "system1", ",", "unknowns1"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"1", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules2", ",", "system2", ",", "unknowns2"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"2", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules3", ",", "system3", ",", "unknowns3"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"3", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nameRules4", ",", "system4", ",", "unknowns4"}], "}"}], "=", 
     RowBox[{"createSystem", "[", 
      RowBox[{"4", ",", "modNRC"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"sol1", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system1", ",", "unknowns1"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol2", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system2", ",", "unknowns2"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol3", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system3", ",", "unknowns3"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sol4", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{"system4", ",", "unknowns4"}], "]"}]}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules1", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system1", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns1", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\n", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules2", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system2", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns2", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules3", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system3", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns3", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\n", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"system", " ", "is", " ", "well"}], "-", "formed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"nameRules4", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"system4", "===", "$Failed"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"unknowns4", "===", "$Failed"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{"there", " ", "is", " ", "a", " ", "solution"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"sol1", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol2", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol3", "===", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Not", "[", 
           RowBox[{"sol4", "===", 
            RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       ",", "\n", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "solutions", " ", "are", " ", "the", " ", "same", " ", "for", " ", 
         "same", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"And", "@@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns1", ",", "unknowns3"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol1", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns2", ",", "unknowns3"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol2", ",", "sol3"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns1", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol1", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns2", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol2", ",", "sol4"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MatchQ", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"unknowns3", ",", "unknowns4"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"sol3", ",", "sol4"}], "}"}]}], ")"}]}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8928872783997917`*^9, 3.8928872825022306`*^9}, {
   3.893058081176363*^9, 3.893058081797423*^9}, 3.8930584588887653`*^9, {
   3.893083667979657*^9, 3.893083681854567*^9}, {3.8930837480086393`*^9, 
   3.893083781840391*^9}, {3.893104751780423*^9, 3.893104773852371*^9}, {
   3.893104856764481*^9, 3.893104857098072*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"0958ce5d-a8a4-48ff-ba85-0ddb97fc37d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
     "hand"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pi1", "/.", "sol1"}], ")"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sg1", "/.", "sol1"}], ")"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"pi2", "/.", "sol2"}], "]"}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
           "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip",
               "2"], "+", 
             RowBox[{
             "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", 
              " ", "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
             " ", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "2"]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "2"]}], 
            ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"sg2", "/.", "sol2"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
          "2"], "+", 
         FractionBox[
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
           "2"], 
          RowBox[{"1", "-", 
           
           SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
            "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"pi1sg1", "/.", "sol2"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892524523636704*^9, 3.892524538980324*^9}, {
   3.892524963969441*^9, 3.892524997873*^9}, {3.8925250491209106`*^9, 
   3.892525102081677*^9}, {3.892525153236815*^9, 3.892525230281101*^9}, {
   3.8925712267857227`*^9, 3.89257122924771*^9}, {3.89305855312013*^9, 
   3.893058646744561*^9}, {3.893059266545212*^9, 3.893059334165757*^9}, {
   3.893083789529174*^9, 3.893083797521639*^9}, {3.89310478330639*^9, 
   3.893104783571576*^9}, 3.89310486326595*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"53790e1b-0739-4af7-b71e-e7c4f97e09ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "with", " ", "moments", " ", "computed", " ", "by", " ", 
     "hand"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"pi", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"uncondE", "[", 
        RowBox[{
         RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}], "===", 
       "FernandoDuarte`LongRunRisk`Model`Parameters`Esg"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"pi", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], 
         "]"}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`mup", 
           "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             
             SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`xip",
               "2"], "+", 
             RowBox[{
             "2", " ", "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", 
              " ", "FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip"}], " ", "+", 
             " ", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "2"]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             
             SuperscriptBox[
              "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "2"]}], 
            ")"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"sg", "[", "t", "]"}], "2"], ",", "modNRC"}], "]"}], "]"}],
        "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`Esg", 
          "2"], "+", 
         FractionBox[
          
          SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`phig", 
           "2"], 
          RowBox[{"1", "-", 
           
           SuperscriptBox["FernandoDuarte`LongRunRisk`Model`Parameters`rhog", 
            "2"]}]]}], "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "]"}], "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
         "FernandoDuarte`LongRunRisk`Model`Parameters`mup"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930848967948723`*^9, 3.893084935031836*^9}, {
   3.893085027101679*^9, 3.893085045144382*^9}, {3.8930857992167387`*^9, 
   3.893085830327442*^9}, {3.893085980007868*^9, 3.8930860239405127`*^9}, 
   3.893087085948606*^9, {3.893104787717243*^9, 3.893104788939777*^9}, 
   3.893104866818593*^9, {3.8954194852137537`*^9, 3.89541948521673*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8f6e6c22-7c31-4776-a49f-d2f5143966c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "moments", " ", "can", " ", "be", " ", "evaluated", " ", "numerically", 
     " ", "using", " ", "parameters", " ", "values", " ", "only"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol1"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol2"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol3"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"NumberQ", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Values", "@", "sol4"}], "//.", 
           RowBox[{"modNRC", "[", "\"\<parameters\>\"", "]"}]}], ")"}]}], 
        ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.893082237801841*^9, {3.893082288507763*^9, 3.893082397545843*^9}, {
   3.89308380447088*^9, 3.893083826885064*^9}, {3.893104792410515*^9, 
   3.893104792601891*^9}, 3.89310486870549*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"10534701-86cc-4812-b9d1-583f080b6be2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", "evNoEpsStateVarsProduct", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stateVarsNoEps", "=", 
     RowBox[{"{", 
      RowBox[{"sg", ",", "pi"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"model", "=", "modNRC"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"basic", " ", "use"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
          "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
          "]"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "-", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", " ", 
            "FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhog", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}]}], "+", 
           RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phig", " ", 
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
            RowBox[{
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<sg\>\"",
               "]"}], "[", "t", "]"}]}]}], ")"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "-", 
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`xip", " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`phip", " ", 
           SuperscriptBox[
            RowBox[{
             RowBox[{
             "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"",
               "]"}], "[", "t", "]"}], "2"]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t",
            "]"}], " ", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
            "]"}], "[", 
           RowBox[{"1", "+", "t"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], ")"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExpandAll", "[", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], "]"}], "===", 
        RowBox[{"ExpandAll", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`mud", "[", "i", "]"}],
            " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "-", 
          RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`mup", " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`rhodp", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`phidc", "[", "i", 
            "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<dc\>\"", 
             "]"}], "[", "t", "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "t"}], "]"}], " ", 
           RowBox[{
           "FernandoDuarte`LongRunRisk`Model`Parameters`xid", "[", "i", "]"}],
            " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], "]"}], " ", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", "t", "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sg", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          "stateVarsNoEps"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893081708234816*^9, 3.8930817475700893`*^9}, {
   3.893082619951611*^9, 3.893082620668397*^9}, {3.8930826743611507`*^9, 
   3.893082674969939*^9}, {3.89308271889793*^9, 3.893082764899756*^9}, {
   3.893083300110649*^9, 3.8930833295765333`*^9}, {3.893083371906817*^9, 
   3.893083397811235*^9}, {3.8930835396615067`*^9, 3.8930836030394173`*^9}, {
   3.893104803562705*^9, 3.893104804045452*^9}, 3.893104872008975*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"ca14d8f1-7a77-428b-8c74-a7eb0de7af1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "context", " ", "for", " ", "shocks", " ", "is", " ", 
     "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
           "#", ",", "\"\<FernandoDuarte`LongRunRisk`Model`Shocks`\>\""}], 
           "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"DeleteDuplicates", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"evNoEpsStateVarsProduct", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pi", "[", 
                 RowBox[{"t", "-", "1"}], "]"}], 
                RowBox[{"sg", "[", "t", "]"}], 
                RowBox[{"dd", "[", 
                 RowBox[{"t", ",", "i"}], "]"}], 
                RowBox[{
                 RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
                 RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
               RowBox[{"Append", "[", 
                RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"x_Symbol", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"SymbolName", "[", "#", "]"}], ",", 
                    "\"\<eps\>\""}], "]"}], "&"}], ")"}]}], "[", "__", "]"}], 
               "[", 
               RowBox[{"__", ",", "___"}], "]"}], ":>", 
              RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], 
          ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930830724712353`*^9, 3.893083259734127*^9}, 
   3.893083445300497*^9, {3.893083843952413*^9, 3.893083861525839*^9}, {
   3.8931048140658007`*^9, 3.8931048143353853`*^9}, 3.893104874466271*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"8997ccda-5ae0-43a0-9042-48220e750fbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "check", " ", "if", " ", "variables", " ", "lagged", " ", "to", " ", 
     "the", " ", "right", " ", "time", " ", "period"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"sg", "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "===", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pi", "[", "t", "]"}], 
              RowBox[{"sg", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"pi", "[", 
               RowBox[{"t", "-", "1"}], "]"}], 
              RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{
        RowBox[{"{", "}"}], "===", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pi", "[", "t", "]"}], 
              RowBox[{"sg", "[", 
               RowBox[{"t", "-", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"pi", "[", 
               RowBox[{"t", "-", "1"}], "]"}], 
              RowBox[{"sg", "[", "t", "]"}]}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<sg\>\""}], 
               "]"}], "&"}], ")"}]}], "[", 
           RowBox[{"t", "-", "1"}], "]"}], ",", "Infinity"}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.892837690169054*^9, 3.892837854348692*^9}, 
   3.89283864284869*^9, 3.892838715667156*^9, 3.893057562171788*^9, 
   3.893057898180541*^9, 3.893058027361483*^9, {3.893059945383209*^9, 
   3.893059945387575*^9}, 3.893059994856317*^9, {3.893060102391067*^9, 
   3.893060146717375*^9}, {3.893060178483892*^9, 3.893060220488847*^9}, 
   3.893081080462633*^9, 3.893083437165765*^9, {3.893083871926509*^9, 
   3.893083892419632*^9}, {3.893104819145041*^9, 3.8931048195063257`*^9}, 
   3.8931048764270763`*^9, {3.893105150897993*^9, 3.893105153599009*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e22bc11e-b400-47fc-b98c-49b5db95ac36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "use", " ", "variables", " ", "indexed", " ", "by", " ", "time", " ", 
     "that", " ", "are", " ", "not", " ", "lagged"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], 
          RowBox[{"foo", "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}], 
        RowBox[{"foo", "[", 
         RowBox[{"t", "-", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ExpandAll", "@", 
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "+", "1"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
            RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
           "stateVarsNoEps"}], "]"}]}], ")"}], "===", 
       RowBox[{"(", 
        RowBox[{"ExpandAll", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
             "]"}], "[", 
            RowBox[{"t", "+", "1"}], "]"}], "*", 
           RowBox[{"evNoEpsStateVarsProduct", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}], 
              RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
             "stateVarsNoEps"}], "]"}]}], ")"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8928378645917997`*^9, 3.8928380134079*^9}, {
   3.89283856318399*^9, 3.892838569033311*^9}, {3.893059945388934*^9, 
   3.893059945395464*^9}, 3.893081075924605*^9, {3.893081367930172*^9, 
   3.893081370124003*^9}, 3.893083433344887*^9, {3.893083496494205*^9, 
   3.8930835310955772`*^9}, {3.893083900795011*^9, 3.8930839188691053`*^9}, {
   3.89310482263301*^9, 3.893104822995037*^9}, 3.893104878423732*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"43ab956e-5418-4766-8b40-61e18ece38fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "add", " ", "irrelevant", " ", "variables", " ", "to", " ", "lag"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
   RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
    RowBox[{"And", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "myVariable"}], "]"}]}], "]"}], "===", 
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"pi", "[", "t", "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"pi", "[", "t", "]"}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "irrelevantVar"}], "]"}]}], "]"}], "===", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{"anotherIrrelevantVar", " ", 
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "anotherIrrelevantVar"}], "]"}]}], 
         "]"}], "===", 
        RowBox[{"anotherIrrelevantVar", "*", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", "t", 
          "]"}], " ", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`sg", "[", "t", 
          "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8930839246758204`*^9, 3.893083937930691*^9}, {
   3.8930840322990923`*^9, 3.893084140616804*^9}, {3.89310482645893*^9, 
   3.89310482677431*^9}, 3.893104880770898*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"7223286e-e1a1-41e8-a6d2-dd8bb1b5b576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"lag", " ", "dd"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
             RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "\"\<pi\>\"", "]"}], "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
            RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{"t", ",", "i"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "lag", " ", "dd", " ", "and", " ", "expression", " ", "has", " ", 
        RowBox[{"eps", "[", "\"\<dd\>\"", "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{"t", ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dd\>\""}], 
             "]"}], "&"}], ")"}]}], "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", 
             RowBox[{"t", "-", "1"}], "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"_Symbol", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<eps\>\""}], 
               "]"}], "&"}], ")"}]}], "[", "\"\<dd\>\"", "]"}], "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"evNoEpsStateVarsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pi", "[", "t", "]"}], 
           RowBox[{"dd", "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
           RowBox[{
            RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
            RowBox[{
             RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
          
          RowBox[{"Append", "[", 
           RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Not", "@", 
       RowBox[{"FreeQ", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "[", "t", "]"}], 
            RowBox[{"dd", "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<dd\>\"", "]"}], "[", 
             RowBox[{
              RowBox[{"t", "-", "1"}], ",", "i"}], "]"}]}], ",", "model", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"stateVarsNoEps", ",", "dd"}], "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"_Symbol", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
              "]"}], "&"}], ")"}]}], "[", "_", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"uncondEStep", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
        RowBox[{"_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<dc\>\""}], 
            "]"}], "&"}], ")"}]}], ",", "Infinity"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"uncondEStep", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dc", "[", 
            RowBox[{"t", "-", "1"}], "]"}], 
           RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], ",", 
        RowBox[{
         RowBox[{"_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<pi\>\""}], 
             "]"}], "&"}], ")"}]}], "[", "t", "]"}], ",", "Infinity"}], 
       "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.89283802890134*^9, 3.892838030900941*^9}, {
   3.892838083823448*^9, 3.892838092310711*^9}, {3.892838138034411*^9, 
   3.89283817641862*^9}, {3.892838220044372*^9, 3.892838228823832*^9}, {
   3.892838286807514*^9, 3.892838399679389*^9}, {3.892838547622286*^9, 
   3.89283855837638*^9}, {3.89305994539712*^9, 3.893059945404882*^9}, {
   3.893060330946208*^9, 3.893060396602564*^9}, 3.8930604807433987`*^9, {
   3.893066361049811*^9, 3.89306639221675*^9}, 3.893083429850601*^9, {
   3.893083954996154*^9, 3.893084012596081*^9}, {3.893104830026622*^9, 
   3.893104830331604*^9}, 3.893104885866941*^9, {3.8931051546625347`*^9, 
   3.893105161047236*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"20932644-ce55-47c6-a167-7c0a087a53af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"wc", ",", 
     RowBox[{"pd", " ", "ratios"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`wc", "[", "t", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wc", "[", "t", "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", 
           RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "1", 
         "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{"wc", "[", "t", "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{"wc", "[", "t", "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "wc", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"evNoEpsStateVarsProduct", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pd", "[", 
           RowBox[{"t", ",", "i"}], "]"}], 
          RowBox[{
           RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
           RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
         "stateVarsNoEps"}], "]"}], "===", 
       RowBox[{
        RowBox[{
        "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`pd", "[", 
         RowBox[{"t", ",", "i"}], "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "t"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"evNoEpsStateVarsProduct", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pd", "[", 
             RowBox[{"t", ",", "i"}], "]"}], 
            RowBox[{
             RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", "t", "]"}]}], ",", 
           "model", ",", 
           RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi", "[", 
          RowBox[{"t", "-", "1"}], "]"}]}], "]"}], "===", 
       RowBox[{"FernandoDuarte`LongRunRisk`Model`Parameters`rhop", " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`B", "[", "i", 
          "]"}], "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Shocks`eps", "[", "\"\<pi\>\"", 
          "]"}], "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            "stateVarsNoEps"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                 "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x_Symbol", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<A\>\""}], 
                "]"}], "&"}], ")"}]}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"evNoEpsStateVarsProduct", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"B", "[", "i", "]"}], "[", "1", "]"}], " ", 
             RowBox[{"pd", "[", 
              RowBox[{"t", ",", "i"}], "]"}], 
             RowBox[{
              RowBox[{"eps", "[", "\"\<pi\>\"", "]"}], "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "model", ",", 
            RowBox[{"{", "pd", "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"SymbolName", "[", "#", "]"}], ",", "\"\<B\>\""}], 
                 "]"}], "&"}], ")"}]}], "[", "_", "]"}], "[", "_", "]"}], ":>", 
           RowBox[{"Context", "@", "x"}]}], ",", "Infinity"}], "]"}]}], "===", 
       RowBox[{
       "{", "\"\<FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`\>\"", 
        "}"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.893086072267931*^9, 3.893086151775504*^9}, 
   3.893086247368884*^9, 3.8930863039185677`*^9, {3.893086419204494*^9, 
   3.893086419846327*^9}, {3.893086609193349*^9, 3.893086694155324*^9}, {
   3.893086761160204*^9, 3.8930868172023783`*^9}, {3.8930868600489817`*^9, 
   3.893086876039349*^9}, {3.893104834706069*^9, 3.8931048349199944`*^9}, 
   3.893104888456128*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"0e9025ae-9d2a-47ad-abbf-9a23b327cd2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<WriteUnitTest\>\"", "]"}], "[", 
  RowBox[{"testFileName", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"unconditional", " ", "moments"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{"And", "@@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], ",", "modNRC"}], "]"}], "]"}], "===", 
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"uncondE", "[", 
         RowBox[{
          RowBox[{"wc", "[", "t", "]"}], ",", "modBY"}], "]"}], "]"}], "===", 
       
       RowBox[{
       "FernandoDuarte`LongRunRisk`Model`EndogenousEq`Private`A", "[", "0", 
        "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"0", "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"uncondE", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"pi", "[", "t", "]"}], "3"], ",", "modNRC"}], "]"}], 
           RowBox[{"uncondE", "[", 
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], ",", "modNRC"}], "]"}]}], "-", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"pi", "[", "t", "]"}], "3"], 
             RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}], ")"}],
         " ", "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"0", "===", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"pi", "[", "t", "]"}], "3"], 
            RowBox[{"sg", "[", "t", "]"}]}], ",", "modNRC"}], "]"}], "-", 
         RowBox[{
         "FernandoDuarte`LongRunRisk`Model`Parameters`Esg", "*", 
          "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "*", "\n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "FernandoDuarte`LongRunRisk`Model`Parameters`mup", "^", "2"}], 
            " ", "-", " ", "\n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`Parameters`phip", "^", 
                  "2"}], " ", "+", "  ", 
                 RowBox[{
                 "2", "*", "FernandoDuarte`LongRunRisk`Model`Parameters`phip",
                   "*", "  ", 
                  "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "*", 
                  "FernandoDuarte`LongRunRisk`Model`Parameters`xip"}], " ", 
                 "+", "  ", 
                 RowBox[{
                 "FernandoDuarte`LongRunRisk`Model`Parameters`xip", "^", 
                  "2"}]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], " ", "+", " ", 
               RowBox[{
               "FernandoDuarte`LongRunRisk`Model`Parameters`rhop", "^", 
                "2"}]}], ")"}]}]}], ")"}]}]}], " ", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Simplify", "@", 
        RowBox[{"SetSymbolsContext", "@", 
         RowBox[{"uncondE", "[", 
          RowBox[{
           RowBox[{"dc", "[", "t", "]"}], ",", "modNRC"}], "]"}]}]}], "===", 
       "muc"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"dc", "[", "t", "]"}], "2"], ",", "modNRC"}], 
           "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["muc", "2"], "+", 
           SuperscriptBox["phic", "2"], "+", 
           RowBox[{"2", " ", "Esg", " ", "phip", " ", "rhocp", " ", "xic"}], 
           "+", 
           RowBox[{
            SuperscriptBox["xic", "2"], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Esg", "2"], "+", 
              FractionBox[
               SuperscriptBox["phig", "2"], 
               RowBox[{"1", "-", 
                SuperscriptBox["rhog", "2"]}]]}], ")"}]}], " ", "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["rhocp", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", " ", "phip", " ", "rhop", " ", "xip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"muc", " ", "mup"}], "+", 
           RowBox[{"rhocp", " ", "xip", " ", "phip"}], "+", 
           RowBox[{"xic", " ", "rhop", " ", "phip", " ", "Esg"}], "+", 
           RowBox[{"xic", " ", "xip", " ", "Esg"}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rhocp", " ", "rhop"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["xip", "2"], "+", 
               RowBox[{"2", " ", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["phip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{"muc", " ", "Esg"}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Esg", "2"], "+", 
           RowBox[{
            FractionBox["rhog", 
             RowBox[{"1", "-", 
              SuperscriptBox["rhog", "2"]}]], 
            SuperscriptBox["phig", "2"]}]}], " ", ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"sg", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Esg", "2"], "+", 
           RowBox[{
            FractionBox["rhog", 
             RowBox[{"1", "-", 
              SuperscriptBox["rhog", "2"]}]], 
            SuperscriptBox["phig", "2"]}]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"pi", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mup", "2"], "+", 
           RowBox[{"phip", " ", "xip"}], "+", 
           FractionBox[
            RowBox[{"rhop", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["mup", "2"], "+", 
           RowBox[{"phip", " ", "xip"}], "+", 
           FractionBox[
            RowBox[{"rhop", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], "+", 
               RowBox[{"2", "rhop", " ", "xip", " ", "phip"}], "+", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", "t", "]"}], 
             RowBox[{"sg", "[", 
              RowBox[{"t", "+", "1"}], "]"}]}], ",", "modNRC"}], "]"}]}]}]}], 
       "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{"Esg", " ", "mup"}], ")"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"SetSymbolsContext", "@", 
          RowBox[{"uncondE", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi", "[", 
              RowBox[{"t", "-", "1"}], "]"}], 
             RowBox[{"dc", "[", "t", "]"}]}], ",", "modNRC"}], "]"}]}]}]}], "===", 
       RowBox[{"FullSimplify", "@", 
        RowBox[{"Expand", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"muc", " ", "mup"}], " ", "+", 
           RowBox[{"Esg", " ", "phip", "  ", "xic"}], "+", 
           FractionBox[
            RowBox[{"rhocp", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["phip", "2"], " ", "+", " ", 
               RowBox[{"2", " ", "phip", " ", "rhop", "  ", "xip"}], "+", " ", 
               SuperscriptBox["xip", "2"]}], ")"}]}], 
            RowBox[{"1", "-", 
             SuperscriptBox["rhop", "2"]}]]}], ")"}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"\"\<ConfirmResults\>\"", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8930931586861763`*^9, 3.893093169795704*^9}, {
   3.893102429143783*^9, 3.8931024298433332`*^9}, {3.893102466623125*^9, 
   3.893102586761202*^9}, {3.8931026368045473`*^9, 3.893102685312832*^9}, {
   3.893102716922923*^9, 3.8931028746270733`*^9}, {3.893102924509729*^9, 
   3.8931029338818493`*^9}, {3.893103097597286*^9, 3.893103302215263*^9}, 
   3.893103954197452*^9, {3.893104412861294*^9, 3.893104516056366*^9}, {
   3.8931048398447723`*^9, 3.8931048401145287`*^9}, 3.8931048923934526`*^9, {
   3.895419485222002*^9, 3.895419485233365*^9}, 3.8954196079500217`*^9, 
   3.895421241328764*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"e4884843-12f0-47a7-8451-879dcf79c5af"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 CellChangeTimes->{{3.890680295645965*^9, 3.89068029650622*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"985a3ae6-e130-4f8a-9b93-ae3fe10177bc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"add", " ", 
   RowBox[{"Begin", "[", "\"\<Context`\>\"", "]"}], " ", "and", " ", 
   RowBox[{"End", "[", "]"}], " ", "to", " ", "wlt", " ", "file"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.890686194230386*^9, 3.890686228283702*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"34eb60b3-650d-4879-853c-727ea9a613af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"helper", " ", "functions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"countLines", "[", "file_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"readStream", "=", 
        RowBox[{"OpenRead", "[", "file", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"n", "=", "1"}], ",", "\[IndentingNewLine]", "temp"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=!=", "EndOfFile"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"ReadLine", "[", "readStream", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"n", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "/@", 
       RowBox[{"{", "readStream", "}"}]}], ";", "\[IndentingNewLine]", 
      "n"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.890681841946844*^9, 3.890681899849094*^9}, {
  3.890682055663522*^9, 3.890682084827585*^9}, {3.890683635625399*^9, 
  3.890683720295089*^9}, {3.890685425949465*^9, 3.890685434516119*^9}, {
  3.890686231117095*^9, 3.890686238212121*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a85f5693-d085-4cc5-989a-a9500987950c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "replaceNthRecord", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replaceNthRecord", "[", 
   RowBox[{"file_String", ",", "n_Integer", ",", "replaceWith_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"readStream", "=", 
       RowBox[{"OpenRead", "[", "file", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"writeStream", "=", 
       RowBox[{"OpenWrite", "[", 
        RowBox[{"file", "<>", "\"\<temp\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", "temp"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WriteLine", "[", 
        RowBox[{"writeStream", ",", 
         RowBox[{"ReadLine", "[", "readStream", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", "-", "1"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{"writeStream", ",", 
       RowBox[{
        RowBox[{"ReadLine", "[", "readStream", "]"}], "<>", "\"\< \\r\\n\>\"",
         "<>", "replaceWith"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=!=", "EndOfFile"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"ReadLine", "[", "readStream", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"UnsameQ", "[", 
           RowBox[{"temp", ",", "EndOfFile"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteLine", "[", 
           RowBox[{"writeStream", ",", "temp"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", 
     RowBox[{"Close", "/@", 
      RowBox[{"{", 
       RowBox[{"readStream", ",", "writeStream"}], "}"}]}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8906824011137114`*^9, 3.890682405708049*^9}, {
   3.890683066049664*^9, 3.8906830825042677`*^9}, {3.89068319056032*^9, 
   3.890683191547068*^9}, {3.89068338518532*^9, 3.890683430044886*^9}, {
   3.890683477495555*^9, 3.89068350860789*^9}, {3.890683563263863*^9, 
   3.890683572999384*^9}, {3.8906837588959513`*^9, 3.890683769652152*^9}, 
   3.890683975431652*^9, 3.890684184728485*^9, {3.890684538464937*^9, 
   3.890684546403357*^9}, 3.8906847013731937`*^9, 3.890684736359234*^9, {
   3.890684917937912*^9, 3.890684918964259*^9}, {3.890685003978653*^9, 
   3.8906850058353167`*^9}, {3.890685081266893*^9, 3.890685086440845*^9}, {
   3.890685162742771*^9, 3.890685164959052*^9}, {3.890685207547077*^9, 
   3.890685210133041*^9}, {3.890685379823967*^9, 3.890685396833392*^9}, {
   3.89068547363831*^9, 3.890685483195992*^9}, {3.8906856724322433`*^9, 
   3.890685672699678*^9}, {3.890685793209527*^9, 3.890685826416944*^9}, 
   3.8906858923977957`*^9, {3.890685924003189*^9, 3.890685959055036*^9}, {
   3.890686016304421*^9, 3.890686073140353*^9}, {3.890686249638393*^9, 
   3.8906862512145*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"ad25c99b-2683-4ce1-a7e6-bbce1e6ba9da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"insert", " ", "into", " ", "wlt", " ", "file"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"replaceNthRecord", "[", 
    RowBox[{
    "testFileName", ",", "1", ",", 
     "\"\<Begin[\\\"ComputationalEngine`Uncond`\\\"]\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CopyFile", "[", 
     RowBox[{
      RowBox[{"testFileName", "<>", "\"\<temp\>\""}], ",", "testFileName", 
      ",", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}], "\n", 
   RowBox[{"DeleteFile", "[", 
    RowBox[{"testFileName", "<>", "\"\<temp\>\""}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"numLines", "=", 
    RowBox[{"countLines", "[", "testFileName", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"replaceNthRecord", "[", 
    RowBox[{"testFileName", ",", 
     RowBox[{"numLines", "-", "3"}], ",", " ", "\"\<End[]\>\""}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CopyFile", "[", 
     RowBox[{
      RowBox[{"testFileName", "<>", "\"\<temp\>\""}], ",", "testFileName", 
      ",", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}], "\n", 
   RowBox[{"DeleteFile", "[", 
    RowBox[{"testFileName", "<>", "\"\<temp\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.890684439578331*^9, {3.8906861781312037`*^9, 3.890686181646003*^9}, {
   3.890686261099564*^9, 3.8906862940387907`*^9}, {3.890710614230303*^9, 
   3.8907106202002974`*^9}, 3.8931046283317003`*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"315ef181-7d11-46ac-8819-a70759fefbb2"],

Cell[BoxData[
 RowBox[{"tr", "=", 
  RowBox[{"TestReport", "[", "testFileName", "]"}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"c5da93c9-aa05-4285-b981-eb34b61414e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Interactive Tests", "Subsection",
 CellChangeTimes->{{3.889905622471089*^9, 3.889905629759961*^9}, {
  3.889972063478182*^9, 
  3.889972065236586*^9}},ExpressionUUID->"d03dfeba-2718-41c7-9b3f-\
19ce5bed64e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "functions", " ", "not", " ", "available", " ", "before", " ", 
    "Mathematica", " ", "13"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"$VersionNumber", "<", "13"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "LexicographicSort", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", "LexicographicSort", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LexicographicSort", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"_", ":", "None"}]}], "]"}], ":=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LexicographicSort", "[", 
        RowBox[{
         RowBox[{"{", "x_", "}"}], ",", 
         RowBox[{"_", ":", "None"}]}], "]"}], ":=", 
       RowBox[{"{", "x", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LexicographicSort", "[", "l_List", "]"}], ":=", 
       RowBox[{"LexicographicSort", "[", 
        RowBox[{"l", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LexicographicSort", "[", 
        RowBox[{"l_List", ",", "lev_"}], "]"}], ":=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"min", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"Length", "/@", "l"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Composition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                "#", ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"smallest", "=", 
                    RowBox[{"LengthWhile", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "lev"}], 
                    "&"}]}], "]"}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"Take", "[", 
                    RowBox[{"#", ",", "smallest"}], "]"}], "~", "Join", "~", 
                   RowBox[{"LexicographicSort", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", "smallest"}], "]"}], ",", 
                    RowBox[{"lev", "+", "1"}]}], "]"}]}]}], "]"}]}], "]"}], 
              "&"}], "]"}], ",", 
            RowBox[{
             RowBox[{"SplitBy", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"lev", ",", "min"}], "}"}]}], "]"}], "&"}]}], 
              "]"}], "&"}], ",", 
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"lev", ",", "min"}], "}"}]}], "]"}], "&"}], "]"}]}], 
           "]"}], "@", "l"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", "ReplaceAt", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ClearAll", "[", "ReplaceAt", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReplaceAt", "[", 
        RowBox[{"expr_", ",", "rules_", ",", "part_"}], "]"}], ":=", 
       RowBox[{"MapAt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"#", ",", "rules"}], "]"}], "&"}], ",", "expr", ",", 
         "part"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "protect", " ", "so", " ", "that", " ", "save", " ", "does", " ", 
         "not", " ", "save", " ", "functions", " ", "to", " ", "file"}], ",", 
        " ", 
        RowBox[{
         RowBox[{
         "which", " ", "will", " ", "clash", " ", "with", " ", "built"}], "-", 
         RowBox[{"in", " ", "definitions", " ", "in", " ", "version"}], " ", 
         "+", "13"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Protect", "[", "ReplaceAt", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Protect", "[", "LexicographicSort", "]"}], ";"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<ReplaceAt\>\"", "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LexicographicSort", "[", 
       RowBox[{"list", ",", "p"}], "]"}], " ", "is", " ", "equivalent", " ", 
      "to", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"list", ",", 
        RowBox[{"LexicographicOrder", "[", "p", "]"}]}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.895471910319063*^9, 3.895471921105378*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"199e6c2d-9aa0-445a-a1bb-94ecc86b456f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PacletizedResourceFunctions`\>\"", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Get", "@", 
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "pacletDir", ",", "\"\<Resources\>\"", ",", "\"\<Models.wl\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"msp", "=", "FernandoDuarte`LongRunRisk`Models"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modBY", "=", 
   RowBox[{"msp", "[", "\"\<BY\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modNRC", "=", 
   RowBox[{"msp", "[", "\"\<NRC\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modDES", "=", 
   RowBox[{"msp", "[", "\"\<DES\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.891595279589191*^9, 3.891616060767905*^9, 3.8916343707639523`*^9, {
   3.891913938964695*^9, 3.8919139392219143`*^9}, {3.891915985036783*^9, 
   3.8919159853773212`*^9}, {3.892039540791751*^9, 3.8920395410421963`*^9}, {
   3.892161069893014*^9, 3.892161073697487*^9}, {3.892167389746036*^9, 
   3.89216739021437*^9}, {3.892985575548376*^9, 3.892985579785521*^9}, {
   3.893087090785573*^9, 3.8930871021359863`*^9}, {3.893143287649158*^9, 
   3.893143311290959*^9}, {3.895419408907625*^9, 3.895419444813488*^9}, 
   3.895419558061615*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"050051e2-6c9d-4505-ae74-78e93d008436"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Kernel/ComputationalEngine/\
CreateMomentsDatabase.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.891915640666362*^9, 3.891915642574032*^9}, 
   3.891974020991497*^9, {3.8923885202156773`*^9, 3.892388522699502*^9}, {
   3.893086966177046*^9, 3.8930869779756327`*^9}, {3.895441004867774*^9, 
   3.895441008103544*^9}, {3.8954426886721897`*^9, 3.895442689828601*^9}, 
   3.8954434642229233`*^9, {3.895470862236112*^9, 3.8954708628089447`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"bd79e4cf-318a-4802-8fac-3ca0590440bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Get", "[", 
    "\"\<FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeConditionalExpectations`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"model", "=", "modBY"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toExogenous", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"model", "[", "\"\<endogenousEq\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondE", "[", "expr_", "]"}], ":=", 
  RowBox[{"uncondE", "[", 
   RowBox[{"expr", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVar", "[", "expr_", "]"}], ":=", 
  RowBox[{"uncondVar", "[", 
   RowBox[{"expr", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uncondCov", "[", 
    RowBox[{"expr1_", ",", "expr2_"}], "]"}], ":=", 
   RowBox[{"uncondCov", "[", 
    RowBox[{"expr1", ",", "expr2", ",", "model"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ev", "[", 
   RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"ev", "[", 
   RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "[", 
   RowBox[{"expr_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"var", "[", 
   RowBox[{"expr", ",", "t", ",", "model"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cov", "[", 
    RowBox[{"expr1_", ",", "expr2_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"cov", "[", 
    RowBox[{"expr1", ",", "expr2", ",", "t", ",", "model"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondCovLong", "[", 
   RowBox[{"expr1_", ",", " ", "expr2_", ",", " ", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondCovLong", "[", 
   RowBox[{
   "expr1", ",", " ", "expr2", ",", " ", "toExogenous", ",", " ", "covfun"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"covfun_", ":", "covLong"}]}], "]"}], ":=", 
  RowBox[{"uncondVarLong", "[", 
   RowBox[{"expr", ",", " ", "toExogenous", ",", " ", "covfun"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8954425507789497`*^9, 3.895442551073287*^9}, {
   3.895442611639639*^9, 3.89544266632174*^9}, {3.895442778509056*^9, 
   3.8954429208181267`*^9}, {3.895443064490199*^9, 3.895443081297099*^9}, 
   3.895443142205739*^9, {3.895443203563892*^9, 3.895443325262887*^9}, 
   3.895444437943017*^9, 3.895444478648745*^9, {3.895444828217681*^9, 
   3.895444830639021*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"540d848e-b4ef-4102-af8c-932b5f37cc14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "uncondVar"}]], "Input",
 CellChangeTimes->{{3.895476751436339*^9, 3.895476751649746*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"a00715c6-d674-45fc-93eb-7e18fd876317"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"uncondVar[x,model] gives the unconditional variance \
of x for model.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"uncondVar", "[", 
                    
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x_", ",", 
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model_"}], "]"}], ":=", 
                    RowBox[{"uncondE", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x", "-", 
                    RowBox[{"uncondE", "[", 
                    
                    RowBox[{
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x", ",", 
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model"}], "]"}]}], ")"}], "2"], ",", 
                    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model"}], "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"uncondVar", "[", "expr_", "]"}], ":=", 
                    RowBox[{"uncondVar", "[", 
                    RowBox[{"expr", ",", "model"}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], \
"\<\"FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"uncondVar[x,model] gives the unconditional variance \
of x for model.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {2., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{13., {2., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "uncondVar[x,model] gives the unconditional variance of x for model.", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, 
      FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar, {
      FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar[
         Pattern[
         FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x, 
          Blank[]], 
         Pattern[
         FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model, 
          Blank[]]] :> 
       FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondE[(
          FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x - 
          FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondE[
          FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`x, 
           FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model])^2, 
         FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`Private`model], 
       FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar[
         Pattern[$CellContext`expr, 
          Blank[]]] :> 
       FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar[$CellContext`expr, \
$CellContext`model]}], "SubValues" -> None, "DefaultValues" -> None, 
    "NValues" -> None, "FormatValues" -> None, "Options" -> None, 
    "Attributes" -> {}, "FullName" -> 
    "FernandoDuarte`LongRunRisk`ComputationalEngine`\
ComputeUnconditionalExpectations`uncondVar"|>, False]]], "Output",
 CellChangeTimes->{3.895478495627797*^9, 3.895478989724923*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"47b41940-7847-4ef2-a674-603de52c5c30"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "i", ",", "j", ",", "q", ",", "n1", ",", "n2", ",", "n", ",", "rf"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "kk", ",", "qq", ",", "zz", ",", "pp", ",", "rr", ",", "vv", ",", "v", ",",
     "v1", ",", "v2", ",", "v3", ",", "v4", ",", "v5", ",", "v6"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"totCovLong", ",", "notAllZero"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "tup1", ",", "tup2", ",", "tup3", ",", "tup4", ",", "tup5", ",", "rp"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "covLong", "]"}], ";"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"c60e6e2d-256a-4e0a-8e0e-0db4f7bd0dbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"Head", "/@", 
      RowBox[{
       RowBox[{"modBY", "[", "\"\<stateVars\>\"", "]"}], "[", "t", "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`dc", ",", 
       "FernandoDuarte`LongRunRisk`Model`ExogenousEq`Private`pi"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8954424158422737`*^9, 3.8954424590027*^9}, 
   3.895443511550273*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"e99da723-cb71-4b23-b942-0429b225fa84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"law", " ", "of", " ", "total", " ", "variance"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_", ",", 
       RowBox[{"fun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], ",", "fun"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"notAllZero", "[", "q___", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          StyleBox[
           RowBox[{"Unequal", "[", 
            RowBox[{"#", ",", "0"}], "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], "&"}], "/@", 
        RowBox[{"{", "q", "}"}]}], ")"}]}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "at", " ", "least", " ", "one", " ", "input", " ", "argument", " ", "is",
       " ", "non"}], "-", "zero"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup1", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varList", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup2", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"varList", ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0"}], 
         "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup2"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1_", ",", 
        RowBox[{"{", 
         RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"{", 
         RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2"}], "]"}],
       "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], "*", 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "v3_", ",", "q1_Integer", 
        ",", "q2_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", " ", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2"}], 
       "]"}], "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], "*", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rp", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"{", 
        RowBox[{"pos_", ",", "i_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vv", ",", "q"}], "}"}], ",", 
       RowBox[{"ReplaceAt", "[", 
        RowBox[{"expr", ",", 
         RowBox[{
          RowBox[{"vv_", "[", 
           RowBox[{"t", "+", "q_."}], "]"}], ":>", 
          RowBox[{"vv", "[", 
           RowBox[{
            RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", "pos"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1_", ",", 
        RowBox[{"{", 
         RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"SymbolName", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}]}], ",", 
         RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
        "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"{", 
         RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2", ",", 
        "i"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SymbolName", "@", "v1"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SymbolName", "@", "v2"}], ",", 
                RowBox[{"SymbolName", "@", "v3"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], 
            ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}], ",", 
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", " ", ",", "v2_"}], "}"}], ",", "v3_", ",", 
        "q1_Integer", ",", "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"SymbolName", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}]}], ",", 
         RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
        "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", " ", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", 
         "q2", ",", "i"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"SymbolName", "/@", 
           RowBox[{"{", 
            RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}]}], ",", 
          RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
         "]"}], "==", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "i", "]"}], "]"}]}]}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SymbolName", "@", "v1"}], " ", ",", 
                RowBox[{"SymbolName", "@", "v2"}]}], "}"}], ",", 
              RowBox[{"SymbolName", "@", "v3"}]}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], 
            ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{"t", "+", "q2"}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
     RowBox[{"uncondCov", "[", 
      RowBox[{
       RowBox[{"v1", " ", "v2"}], ",", " ", 
       RowBox[{"v3", " ", "v4"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup3", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varList", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup4", "=", 
     RowBox[{"tup2", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"{", 
          RowBox[{"b_", ",", "c_"}], "}"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup5", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0", ",",
           "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup5"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", " ", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", 
        "q3"}], "]"}], "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], "*", 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], "*", " ", 
         RowBox[{"v4", "[", 
          RowBox[{"t", "+", "q3"}], "]"}]}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], "]"}], "-", 
         "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"SymbolName", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", " ", ",", "v3", ",", "v4"}], "}"}]}], ",", 
         RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}]}], 
        "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", " ", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", 
        "q3", ",", "i"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SymbolName", "@", "v1"}], ",", 
                RowBox[{"SymbolName", "@", "v2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SymbolName", "@", "v3"}], ",", 
                RowBox[{"SymbolName", "@", "v4"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"\"\<dd\>\"", "|", "\"\<pd\>\"", "|", "\"\<ret\>\""}], 
            ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}], ",", 
                 RowBox[{"v4", "[", 
                  RowBox[{"t", "+", "q3"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], 
                 "]"}], "-", "1"}]}], "]"}], "&"}], ")"}], "@@", 
           "vdd"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"tup1", ",", "tup2", ",", "tup3", ",", "tup4", ",", "tup5"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8954438350219793`*^9, 3.895443839388576*^9}, {
  3.895443871200287*^9, 3.895444002649342*^9}, {3.8954440418696957`*^9, 
  3.895444139985724*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"192f329e-b6ba-481d-a4ca-87fc54a46e90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxLag", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"v1", "=", 
      RowBox[{"varList", "[", 
       RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"tempNeg", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"-", "maxLag"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"tempPos", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"q_", "/;", 
         RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "0"}], "]"}], "=", 
      RowBox[{"uncondVar", "[", 
       RowBox[{"v1", "[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"q_", "/;", 
         RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
      RowBox[{"FindSequenceFunction", "[", 
       RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", "q"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v2", "=", 
          RowBox[{"varList", "[", 
           RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempNeg", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", "t", "]"}], ",", 
                RowBox[{"v2", "[", 
                 RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"-", "maxLag"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempPos", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", "t", "]"}], ",", 
                RowBox[{"v2", "[", 
                 RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v2", ",", 
            RowBox[{"q_", "/;", 
             RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
          RowBox[{"FindSequenceFunction", "[", 
           RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
          RowBox[{"uncondCov", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v2", ",", 
            RowBox[{"q_", "/;", 
             RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
          RowBox[{"FindSequenceFunction", "[", 
           RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v2", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"Clear", "[", 
             RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"tempNeg", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"T", ",", 
                 RowBox[{"uncondCov", "[", 
                  RowBox[{
                   RowBox[{"v1", "[", "t", "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"T", ",", 
                 RowBox[{"-", "maxLag"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"tempPos", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"T", ",", 
                 RowBox[{"uncondCov", "[", 
                  RowBox[{
                   RowBox[{"v1", "[", "t", "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
             RowBox[{"FindSequenceFunction", "[", 
              RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
             RowBox[{"uncondCov", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"q_", "/;", 
                RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
             RowBox[{"FindSequenceFunction", "[", 
              RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
           "\t", "\[IndentingNewLine]", "\t", ",", 
           RowBox[{"{", 
            RowBox[{"mm", ",", 
             RowBox[{"qq", "+", "1"}], ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"qq", ",", 
          RowBox[{"kk", "+", "1"}], ",", 
          RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";"}], 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"kk", ",", "1", ",", 
      RowBox[{"Length", "[", "varList", "]"}]}], "}"}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"DistributedContexts", "->", "All"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8954424927554092`*^9, 3.89544249289802*^9}, 
   3.895444546692024*^9, {3.895445668563222*^9, 3.895445673547887*^9}, {
   3.895445832958193*^9, 3.895445835101041*^9}, {3.895474517926977*^9, 
   3.895474520395884*^9}, {3.895475565679372*^9, 3.895475566245124*^9}, {
   3.895475611947233*^9, 3.89547562970107*^9}, {3.89547582213666*^9, 
   3.895475829746037*^9}, {3.895476609467979*^9, 3.8954766166502247`*^9}, 
   3.89547666879874*^9, {3.895476780715889*^9, 3.895476818499092*^9}, {
   3.895476923186275*^9, 3.8954769234985847`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"0e000aac-5a88-4b08-a2c1-a2694ee92ff4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"retrieve", " ", "from", " ", "parallel", " ", "kernels"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"evaluate", " ", "outside", " ", "ParallelDo"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}], 
    ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8954424927554092`*^9, 3.89544249289802*^9}, 
   3.895444546692024*^9, {3.895445668563222*^9, 3.895445673547887*^9}, {
   3.895445832958193*^9, 3.895445835101041*^9}, {3.895474517926977*^9, 
   3.895474520395884*^9}, {3.895475565679372*^9, 3.895475566245124*^9}, {
   3.895475611947233*^9, 3.89547562970107*^9}, {3.89547582213666*^9, 
   3.895475829746037*^9}, {3.895476609467979*^9, 3.8954766166502247`*^9}, 
   3.89547666879874*^9, 3.895477054076919*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"4fe38fe2-f091-4f3a-a807-e766e3de5090"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fd0", "=", 
   RowBox[{"FullDefinition", "[", "covLong", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d0", "=", 
   RowBox[{"Definition", "[", "covLong", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895479634019824*^9, 
  3.89547964985771*^9}},ExpressionUUID->"8b6d8a0d-7421-430a-8152-\
f3e92affcfa9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"filename", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"resourcesDir", ",", 
     RowBox[{"\"\<temp\>\"", "<>", 
      RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "<>", 
      "\"\<.wl\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Save", "[", 
    RowBox[{
    "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/tempBY.wl\>\"", ",", "covLong"}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "remove", " ", "function", " ", "evaluation", " ", "condition", " ", "in", 
    " ", "memoized", " ", "DownValues", " ", "of", " ", "covLong"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          TagBox[
           StyleBox[
            RowBox[{"RuleDelayed", "[", 
             RowBox[{
              RowBox[{"HoldPattern", "[", 
               RowBox[{
                RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
                RowBox[{
                 RowBox[{"Verbatim", "[", "Condition", "]"}], "[", 
                 RowBox[{"a__", ",", "b__"}], "]"}], "]"}], "]"}], ",", 
              "c__"}], "]"}],
            ShowSpecialCharacters->False,
            ShowStringCharacters->True,
            NumberMarks->True],
           FullForm], 
          StyleBox[")",
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True]}], 
         StyleBox["/;",
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True], 
         StyleBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"HoldPattern", "[", "b", "]"}], ",", "Count"}], 
              "]"}]}], " ", "&&", " ", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"HoldPattern", "[", "c", "]"}], ",", "Module"}], 
             "]"}]}], ")"}],
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True]}], 
        StyleBox[":>",
         ShowSpecialCharacters->False,
         ShowStringCharacters->True,
         NumberMarks->True], 
        StyleBox[
         RowBox[{"(", 
          RowBox[{"RuleDelayed", "[", 
           RowBox[{
            RowBox[{"HoldPattern", "[", "a", "]"}], ",", "c"}], "]"}], ")"}],
         ShowSpecialCharacters->False,
         ShowStringCharacters->True,
         NumberMarks->True]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"DownValues", "[", "covLong", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895474557977515*^9, 3.895474633611429*^9}, {
   3.895475084034642*^9, 3.8954750897813*^9}, {3.895478022377481*^9, 
   3.895478027146517*^9}, 3.895478080713297*^9, {3.8954781615658417`*^9, 
   3.895478184466508*^9}, {3.8954782502907476`*^9, 3.895478250650189*^9}, {
   3.8954783684328947`*^9, 3.895478394509297*^9}, {3.895478436076972*^9, 
   3.895478465779293*^9}, {3.8954796099637947`*^9, 3.8954796103087053`*^9}, 
   3.895479655571065*^9},ExpressionUUID->"d0904225-a3f2-41aa-8e3d-\
b3cb2bf9c0f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fd1", "=", 
   RowBox[{"FullDefinition", "[", "covLong", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", "=", 
   RowBox[{"Definition", "[", "covLong", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.895479659786104*^9, 
  3.895479660792527*^9}},ExpressionUUID->"f96a61fe-a6b0-4af2-99a4-\
1c9a071084df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"filename3", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
     RowBox[{"\"\<covLong\>\"", "<>", 
      RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "<>", 
      "\"\<SavePre.wl\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{
   "\"\</Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/MomentsLookupTables/\
covLongBYSavePre.wl\>\"", ",", "covLong"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.895474557977515*^9, 3.895474633611429*^9}, {
   3.895475084034642*^9, 3.8954750897813*^9}, {3.895478022377481*^9, 
   3.895478027146517*^9}, 3.895478080713297*^9, {3.8954781615658417`*^9, 
   3.895478184466508*^9}, {3.8954782502907476`*^9, 3.895478250650189*^9}, {
   3.8954783684328947`*^9, 3.895478394509297*^9}, {3.895478436076972*^9, 
   3.895478465779293*^9}, {3.8954796099637947`*^9, 3.8954796103087053`*^9}, 
   3.895479655571065*^9},ExpressionUUID->"04c552a6-ea22-4270-89d1-\
3878ed01033b"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/tempBY.wl\"\>"], "Output",
 CellChangeTimes->{3.895478501549745*^9, 3.895478995469697*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"e88ec73c-caf8-446f-aab3-ee784f0e12ba"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/MomentsLookupTables/\
covLongBYSavePre.wl\"\>"], "Output",
 CellChangeTimes->{3.895478501549745*^9, 3.8954789956086082`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"69ff9ff0-96ed-4e78-9555-b46e8825a153"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FernandoDuarte`LongRunRisk`covLong", "=", "Global`covLong"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resourcesDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"pacletDir", ",", "\"\<Resources\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<DefinitionData\>\"", "]"}], "@", 
    "FernandoDuarte`LongRunRisk`covLong"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
      RowBox[{"\"\<covLong\>\"", "<>", 
       RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "<>", 
       "\"\<.wl\>\""}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{"data", ",", "filename"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8948050447264233`*^9, 3.894805112353306*^9}, 
   3.8948056672060127`*^9, {3.894881085617537*^9, 3.894881092515324*^9}, {
   3.894881235174959*^9, 3.8948812390050297`*^9}, {3.8948813037267857`*^9, 
   3.894881320322372*^9}, {3.894881427157349*^9, 3.894881438908939*^9}, {
   3.8948816842385817`*^9, 3.8948816850611353`*^9}, 3.8948819636639023`*^9, 
   3.894882111550132*^9, {3.894882167427806*^9, 3.894882167501503*^9}, 
   3.894884609110717*^9, {3.8954449483382998`*^9, 3.895444960382224*^9}, {
   3.8954709543601027`*^9, 3.895470957561273*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"36a25865-4435-4558-9f6a-2229594bd4e0"],

Cell[BoxData[
 TemplateBox[{
  "Symbol", "symname", 
   "\"The string \
\\\"\\!\\(\\*RowBox[{\\\"\\\\\\\"ResourceSystemClient`DefinitionUtilities`\
WithContext\\\\\\\"\\\"}]\\)\\\" cannot be used for a symbol name. A symbol \
name must start with a letter followed by letters and numbers.\"", 2, 68, 81, 
   28990689955002469697, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.895478502899488*^9, 3.89547899684336*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"695f85a9-fcb6-4f0b-b7af-5dbf48536931"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"filename2", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"resourcesDir", ",", "\"\<MomentsLookupTables\>\"", ",", 
     RowBox[{"\"\<covLong\>\"", "<>", 
      RowBox[{"model", "[", "\"\<shortname\>\"", "]"}], "<>", 
      "\"\<Save.wl\>\""}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"filename2", ",", "covLong"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8954451258546743`*^9, 3.895445140999813*^9}, 
   3.8954749080459948`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"b4df43a2-ef68-41fc-84b3-2597cd4e7c04"],

Cell[BoxData["\<\"/Users/fernandoduarte/Dropbox \
(Personal)/MyPackages/LongRunRisk/Resources/MomentsLookupTables/covLongBYSave.\
wl\"\>"], "Output",
 CellChangeTimes->{3.895478502944536*^9, 3.895478996900303*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"9913a530-3691-4d82-9c4b-73941e5dac2d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TO", " ", 
     RowBox[{"DO", ":", " ", 
      RowBox[{"explore", " ", "https"}], ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"github", ".", "com"}], "/", "rhennigan"}], "/", 
     "OptimizationToolkit"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TO", " ", 
    RowBox[{"DO", ":", " ", 
     RowBox[{"explore", " ", 
      RowBox[{"ResourceFunction", "[", "\"\<DefinitionData\>\"", "]"}]}]}]}], 
   "*)"}]}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"3c1577df-b5e8-4541-bfee-7b78a4af769d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8954434989484673`*^9, 3.89544350111043*^9}, {
  3.895479475646863*^9, 
  3.895479485824552*^9}},ExpressionUUID->"f8227287-32d6-4a48-9950-\
77ea6ec21836"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.895479482091799*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"5bb9b30b-76d1-4829-82ee-cf9e619ea572"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Copy", "Section",
 CellChangeTimes->{{3.895475150520686*^9, 
  3.895475151776119*^9}},ExpressionUUID->"62a79710-5cd5-4df1-9024-\
35ad57bc16bc"],

Cell[BoxData[
 RowBox[{"Switch", "[", 
  RowBox[{
  "reRunCovLong", ",", "\[IndentingNewLine]", "True", "\[IndentingNewLine]", 
   ",", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "create", " ", "lookup", " ", "tables", " ", "for", " ", "moments"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "i", ",", "j", ",", "q", ",", "n1", ",", "n2", ",", "n", ",", "rf"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "kk", ",", "qq", ",", "zz", ",", "pp", ",", "rr", ",", "vv", ",", "v", 
      ",", "v1", ",", "v2", ",", "v3", ",", "v4", ",", "v5", ",", "v6"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "[", 
     RowBox[{"totCovLong", ",", "notAllZero"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "tup1", ",", "tup2", ",", "tup3", ",", "tup4", ",", "tup5", ",", "rp"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "[", "covLong", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "state", " ", "variables", " ", "and", " ", "dc", " ", "and", " ", 
      "inflation"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"varList", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"stateVars", ",", 
        RowBox[{"{", 
         RowBox[{"dc", ",", "pi"}], "}"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"law", " ", "of", " ", "total", " ", "variance"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"totCovLong", "[", 
      RowBox[{"x_", ",", "y_", ",", "s_", ",", 
       RowBox[{"fun_", ":", "covLong"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"uncondE", "[", 
       RowBox[{"cov", "[", 
        RowBox[{"x", ",", "y", ",", "s"}], "]"}], "]"}], "+", 
      RowBox[{"uncondCovLong", "[", 
       RowBox[{
        RowBox[{"ev", "[", 
         RowBox[{"x", ",", "s"}], "]"}], ",", 
        RowBox[{"ev", "[", 
         RowBox[{"y", ",", "s"}], "]"}], ",", "fun"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"notAllZero", "[", "q___", "]"}], ":=", 
     RowBox[{"Or", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         TagBox[
          StyleBox[
           RowBox[{"Unequal", "[", 
            RowBox[{"#", ",", "0"}], "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm], "&"}], "/@", 
        RowBox[{"{", "q", "}"}]}], ")"}]}]}], " ", ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "at", " ", "least", " ", "one", " ", "input", " ", "argument", " ", 
       "is", " ", "non"}], "-", "zero"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", " ", "v2"}], ",", " ", "v3"}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"tup1", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varList", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"a", ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tup2", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"varList", ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0"}], 
         "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "t", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup2"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1_", ",", 
        RowBox[{"{", 
         RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"{", 
         RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2"}], "]"}],
       "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{"v1", "[", "t", "]"}], ",", 
        RowBox[{
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}], " ", 
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}]}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "v3_", ",", "q1_Integer", 
        ",", "q2_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2"}], "]"}], ")"}]}], ":=", " ", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", "q2"}], 
       "]"}], "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
        RowBox[{"v3", "[", 
         RowBox[{"t", "+", "q2"}], "]"}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", "1"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rp", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"{", 
        RowBox[{"pos_", ",", "i_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vv", ",", "q"}], "}"}], ",", 
       RowBox[{"ReplaceAt", "[", 
        RowBox[{"expr", ",", 
         RowBox[{
          RowBox[{"vv_", "[", 
           RowBox[{"t", "+", "q_."}], "]"}], ":>", 
          RowBox[{"vv", "[", 
           RowBox[{
            RowBox[{"t", "+", "q"}], ",", "i"}], "]"}]}], ",", "pos"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1_", ",", 
        RowBox[{"{", 
         RowBox[{"v2_", " ", ",", "v3_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}], ",", 
         RowBox[{"dd", "|", "pd", "|", "ret"}]}], "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{"v1", ",", 
        RowBox[{"{", 
         RowBox[{"v2", " ", ",", "v3"}], "}"}], ",", "q1", ",", "q2", ",", 
        "i"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v1", ",", 
              RowBox[{"{", 
               RowBox[{"v2", ",", "v3"}], "}"}]}], "}"}], ",", 
            RowBox[{"dd", "|", "pd", "|", "ret"}], ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}], ",", 
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", " ", ",", "v2_"}], "}"}], ",", "v3_", ",", 
        "q1_Integer", ",", "q2_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}], ",", 
         RowBox[{"dd", "|", "pd", "|", "ret"}]}], "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", " ", ",", "v2"}], "}"}], ",", "v3", ",", "q1", ",", 
         "q2", ",", "i"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", " ", ",", "v3"}], "}"}], ",", 
          RowBox[{"dd", "|", "pd", "|", "ret"}]}], "]"}], "==", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "i", "]"}], "]"}]}]}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", " ", ",", "v2"}], "}"}], ",", "v3"}], "}"}], ",", 
            RowBox[{"dd", "|", "pd", "|", "ret"}], ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{"t", "+", "q2"}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2"}], "}"}], "]"}], "-", 
                "1"}]}], "]"}], "&"}], ")"}], "@@", "vdd"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"moments", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{"uncondCov", "[", 
       RowBox[{
        RowBox[{"v1", " ", "v2"}], ",", " ", 
        RowBox[{"v3", " ", "v4"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"tup3", "=", 
     RowBox[{
      RowBox[{"Tuples", "[", 
       RowBox[{"varList", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tup4", "=", 
     RowBox[{"tup2", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a_", ",", 
         RowBox[{"{", 
          RowBox[{"b_", ",", "c_"}], "}"}]}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "a"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"tup5", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"varList", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "0", ",", "0", ",",
           "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup3"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup4"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{
          RowBox[{"OrderlessPatternSequence", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"OrderlessPatternSequence", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], "}"}]}], 
           "]"}], ",", "0", ",", "0", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "[", "t", "]"}], 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "[", "t", "]"}]}]}], " ",
          "]"}]}], ")"}], "&"}], "/@", "tup5"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"notAllZero", "[", 
        RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", " ", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", 
        "q3"}], "]"}], "=", 
      RowBox[{"totCovLong", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "[", "t", "]"}], 
         RowBox[{"v2", "[", 
          RowBox[{"t", "+", "q1"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"v3", "[", 
          RowBox[{"t", "+", "q2"}], "]"}], " ", 
         RowBox[{"v4", "[", 
          RowBox[{"t", "+", "q3"}], "]"}]}], ",", 
        RowBox[{"t", "+", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], "]"}], "-", 
         "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1_", ",", "v2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3_", " ", ",", "v4_"}], "}"}], ",", "q1_Integer", ",", 
        "q2_Integer", ",", "q3_Integer", ",", "i__"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", " ", ",", "v3", ",", "v4"}], "}"}], ",", 
         RowBox[{"dd", "|", "pd", "|", "ret"}]}], "]"}], "==", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "[", "i", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"covLong", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v3", " ", ",", "v4"}], "}"}], ",", "q1", ",", "q2", ",", 
        "q3", ",", "i"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", "vdd", ",", "tc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"v3", ",", "v4"}], "}"}]}], "}"}], ",", 
            RowBox[{"dd", "|", "pd", "|", "ret"}], ",", 
            RowBox[{"Heads", "->", "False"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vdd", "=", 
          RowBox[{"Activate", "[", 
           RowBox[{"Fold", "[", 
            RowBox[{"rp", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "q1"}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Inactive", "[", "Times", "]"}], "[", 
                RowBox[{
                 RowBox[{"v3", "[", 
                  RowBox[{"t", "+", "q2"}], "]"}], ",", 
                 RowBox[{"v4", "[", 
                  RowBox[{"t", "+", "q3"}], "]"}]}], "]"}]}], " ", "}"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"pos", ",", 
                RowBox[{"List", "[", "i", "]"}]}], "}"}], "]"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tc", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"totCovLong", "[", 
              RowBox[{"##", ",", 
               RowBox[{"t", "+", 
                RowBox[{"Min", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "q1", ",", "q2", ",", "q3"}], "}"}], 
                 "]"}], "-", "1"}]}], "]"}], "&"}], ")"}], "@@", 
           "vdd"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{"tup1", ",", "tup2", ",", "tup3", ",", "tup4", ",", "tup5"}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"maxLag", "=", "4"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "=", 
        RowBox[{"varList", "[", 
         RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempNeg", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", "t", "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"-", "maxLag"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempPos", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", "t", "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"q_", "/;", 
           RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "0"}], "]"}], "=", 
        RowBox[{"uncondVar", "[", 
         RowBox[{"v1", "[", "t", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"q_", "/;", 
           RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"v2", "=", 
           RowBox[{"varList", "[", 
            RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Clear", "[", 
           RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempNeg", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"-", "maxLag"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tempPos", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", "t", "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", "t", "]"}], ",", 
             RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"-", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
          
          RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"v3", "=", 
              RowBox[{"varList", "[", 
               RowBox[{"[", "mm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\t", 
             RowBox[{"Clear", "[", 
              RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"tempNeg", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"-", "maxLag"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"tempPos", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"T", ",", 
                  RowBox[{"uncondCov", "[", 
                   RowBox[{
                    RowBox[{"v1", "[", "t", "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", "<", "0"}]}]}], "]"}], "=", 
              RowBox[{"FindSequenceFunction", "[", 
               RowBox[{"tempNeg", ",", "q"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", "0"}], "]"}], "=", 
              RowBox[{"uncondCov", "[", 
               RowBox[{
                RowBox[{"v1", "[", "t", "]"}], ",", 
                RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"q_", "/;", 
                 RowBox[{"q", ">", " ", "0"}]}]}], "]"}], "=", 
              RowBox[{"FindSequenceFunction", "[", 
               RowBox[{"tempPos", ",", "q"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"covLong", "[", 
               RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
              RowBox[{"covLong", "[", 
               RowBox[{"v1", ",", "v2", ",", 
                RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            "\t", "\[IndentingNewLine]", "\t", ",", 
            RowBox[{"{", 
             RowBox[{"mm", ",", 
              RowBox[{"qq", "+", "1"}], ",", 
              RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"qq", ",", 
           RowBox[{"kk", "+", "1"}], ",", 
           RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"kk", ",", "1", ",", 
        RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "qq", ",", "kk", ",", "v1", ",", "v2", ",", "tempNeg", ",", "tempPos"}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "dd", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"varListdd", "=", 
     RowBox[{"{", "dd", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"one", " ", "stock"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "=", 
        RowBox[{"varListdd", "[", 
         RowBox[{"[", "jj", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempNeg", "[", "i_", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", 
               RowBox[{"t", ",", "i"}], "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{
                RowBox[{"t", "+", "T"}], ",", "i"}], "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"-", "maxLag"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempPos", "[", "i_", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", 
               RowBox[{"t", ",", "i"}], "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{
                RowBox[{"t", "+", "T"}], ",", "i"}], "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"q_", "/;", 
           RowBox[{"q", "<", "0"}]}], ",", "i_"}], "]"}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{
          RowBox[{"tempNeg", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "0", ",", "i_"}], "]"}], "=", 
        RowBox[{"uncondVar", "[", 
         RowBox[{"v1", "[", 
          RowBox[{"t", ",", "i"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"q_", "/;", 
           RowBox[{"q", ">", " ", "0"}]}], ",", "i_"}], "]"}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{
          RowBox[{"tempPos", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}], "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}], 
        "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"two", " ", "stocks"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", 
        RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempNeg", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", 
               RowBox[{"t", ",", "i"}], "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{
                RowBox[{"t", "+", "T"}], ",", "j"}], "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"-", "maxLag"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempPos", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"uncondCov", "[", 
             RowBox[{
              RowBox[{"v1", "[", 
               RowBox[{"t", ",", "i"}], "]"}], ",", 
              RowBox[{"v1", "[", 
               RowBox[{
                RowBox[{"t", "+", "T"}], ",", "j"}], "]"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"v1", ",", 
           RowBox[{"q_", "/;", 
            RowBox[{"q", "<", "0"}]}], ",", "i_", ",", "j_"}], "]"}], "/;", 
         RowBox[{"Not", "[", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{
          RowBox[{"tempNeg", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", "q"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"v1", ",", "0", ",", "i_", ",", "j_"}], "]"}], "/;", 
         RowBox[{"Not", "[", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
        RowBox[{"uncondCov", "[", 
         RowBox[{
          RowBox[{"v1", "[", 
           RowBox[{"t", ",", "i"}], "]"}], ",", 
          RowBox[{"v1", "[", 
           RowBox[{"t", ",", "j"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"v1", ",", 
           RowBox[{"q_", "/;", 
            RowBox[{"q", ">", " ", "0"}]}], ",", "i_", ",", "j_"}], "]"}], "/;", 
         RowBox[{"Not", "[", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
        RowBox[{"FindSequenceFunction", "[", 
         RowBox[{
          RowBox[{"tempPos", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", "q"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covLong", "[", 
          RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], "]"}], "/;", 
         RowBox[{"Not", "[", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "=", 
        RowBox[{"covLong", "[", 
         RowBox[{"v1", ",", "q", ",", "i", ",", "j"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"v2", "=", 
           RowBox[{"varList", "[", 
            RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Clear", "[", 
           RowBox[{"tempNeg", ",", "tempPos"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tempNeg", "[", "i_", "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"-", "maxLag"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tempPos", "[", "i_", "]"}], "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"T", ",", 
               RowBox[{"uncondCov", "[", 
                RowBox[{
                 RowBox[{"v1", "[", 
                  RowBox[{"t", ",", "i"}], "]"}], ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"t", "+", "T"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"T", ",", "1", ",", "maxLag"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", "<", "0"}]}], ",", "i_"}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempNeg", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", "0", ",", "i_"}], "]"}], "=", 
           RowBox[{"uncondCov", "[", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"t", ",", "i"}], "]"}], ",", 
             RowBox[{"v2", "[", "t", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"q_", "/;", 
              RowBox[{"q", ">", " ", "0"}]}], ",", "i_"}], "]"}], "=", 
           RowBox[{"FindSequenceFunction", "[", 
            RowBox[{
             RowBox[{"tempPos", "[", "i", "]"}], ",", "q"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"covLong", "[", 
            RowBox[{"v2", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
           RowBox[{"covLong", "[", 
            RowBox[{"v1", ",", "v2", ",", 
             RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"kk", ",", "1", ",", 
           RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ParallelEvaluate", "[", 
           RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}],
        ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", "1", ",", 
        RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "jj", ",", "kk", ",", "v1", ",", "v2", ",", "tempNeg", ",", "tempPos"}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "equations", " ", "that", " ", "do", " ", "not", " ", "depend", " ", 
      "on", " ", "stocks", " ", "or", " ", "bonds"}], " ", "*)"}], "\n", 
    RowBox[{"expandList", "=", 
     RowBox[{"{", 
      RowBox[{"wc", ",", "sdf", ",", "nomsdf"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandList", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", "t", "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", "t", "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"pp", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "]"}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "]"}], ";"}],
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "kk", ",", "qq", ",", "zz", ",", "pp", ",", "v1", ",", "v2", ",", "v3", 
      ",", "v4"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "stocks", " ", "*)"}], "\n", 
    RowBox[{"expandListStocks", "=", 
     RowBox[{"{", 
      RowBox[{"pd", ",", "ret"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandListStocks", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", 
             RowBox[{"t", ",", "i"}], "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{
              RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "i_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_", ",", "i_", ",", "i_"}], "]"}], 
          "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v3", ",", "q_Integer", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "j"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "j", ",", "i"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", "q", ",", "i", ",", "i"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "i", ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer", ",", "i_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pp", ",", "1", ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v5", "=", 
             RowBox[{"expandListStocks", "[", 
              RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v5", ",", "q_Integer", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "i"}], "]"}], ",", 
               RowBox[{"v5", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "j"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_", ",", "j_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "j", ",", "i"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", "q", ",", "i", ",", "i"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "i", ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"rr", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{
       "kk", ",", "qq", ",", "zz", ",", "pp", ",", "rr", ",", "v1", ",", "v2",
         ",", "v3", ",", "v4", ",", "v5"}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "bonds", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"expandListBond", "=", 
       RowBox[{"{", 
        RowBox[{
        "bond", ",", "nombond", ",", "bondret", ",", "nombondret", ",", 
         "bondyield", ",", "nombondyield"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v1", "=", 
          RowBox[{"expandListBond", "[", 
           RowBox[{"[", "kk", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "n_"}], "]"}], "=", 
          RowBox[{"uncondCovLong", "[", 
           RowBox[{
            RowBox[{"v1", "[", 
             RowBox[{"t", ",", "n"}], "]"}], ",", 
            RowBox[{"v1", "[", 
             RowBox[{
              RowBox[{"t", "+", "q"}], ",", "n"}], "]"}], ",", "covLong"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q_Integer", ",", "n_", ",", "n_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_Integer", ",", "n_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "v1", ",", "q_Integer", ",", "n_", ",", "n_"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"v1", ",", "q", ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v2", "=", 
             RowBox[{"varList", "[", 
              RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v2", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v2", ",", "v1", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v2", ",", 
               RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"qq", ",", "1", ",", 
             RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v3", "=", 
             RowBox[{"varListdd", "[", 
              RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v3", ",", "q_Integer", ",", "n_", ",", "i_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v3", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v3", ",", "v1", ",", "q_", ",", "i_", ",", "n_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v3", ",", 
               RowBox[{"-", "q"}], ",", "n", ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "1", ",", 
             RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v4", "=", 
             RowBox[{"expandList", "[", 
              RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", "q_Integer", ",", "n_"}], "]"}], 
             "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v4", "[", 
                RowBox[{"t", "+", "q"}], "]"}], ",", "covLong"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v4", ",", "v1", ",", "q_", ",", "n_"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v4", ",", 
               RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"pp", ",", "1", ",", 
             RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v5", "=", 
             RowBox[{"expandListStocks", "[", 
              RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v5", ",", "q_Integer", ",", "n_", ",", "i_"}], 
              "]"}], "=", 
             RowBox[{"uncondCovLong", "[", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n"}], "]"}], ",", 
               RowBox[{"v5", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "i"}], "]"}], ",", "covLong"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{"v5", ",", "v1", ",", "q_", ",", "i_", ",", "n_"}], 
              "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v5", ",", 
               RowBox[{"-", "q"}], ",", "n", ",", "i"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"rr", ",", "1", ",", 
             RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"v6", "=", 
             RowBox[{"expandListBond", "[", 
              RowBox[{"[", "vv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v1", ",", "v6", ",", "q_Integer", ",", "n1_Integer", ",", 
               "n2_Integer"}], "]"}], "=", 
             RowBox[{"uncondCovLong", "[", " ", 
              RowBox[{
               RowBox[{"v1", "[", 
                RowBox[{"t", ",", "n1"}], "]"}], ",", 
               RowBox[{"v6", "[", 
                RowBox[{
                 RowBox[{"t", "+", "q"}], ",", "n2"}], "]"}], ",", 
               "covLong"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"covLong", "[", 
              RowBox[{
              "v6", ",", "v1", ",", "q_Integer", ",", "n1_Integer", ",", 
               "n2_Integer"}], "]"}], "=", 
             RowBox[{"covLong", "[", 
              RowBox[{"v1", ",", "v6", ",", 
               RowBox[{"-", "q"}], ",", "n2", ",", "n1"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"vv", ",", 
             RowBox[{"kk", "+", "1"}], ",", 
             RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "]"}],
          ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"kk", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "kk", ",", "qq", ",", "zz", ",", "pp", ",", "rr", ",", "vv", ",", "v1", 
      ",", "v2", ",", "v3", ",", "v4", ",", "v5", ",", "v6"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "risk", " ", "free", " ", "rates", " ", "are", " ", "yields", " ", "on",
        " ", "one"}], "-", 
      RowBox[{"period", " ", "bonds"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{"Parallelize", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "q_Integer"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{"bondyield", ",", "q", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "rf", ",", "q_"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{"rf", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"nomrf", ",", "q_Integer"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{"nombondyield", ",", "q", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"covLong", "[", 
        RowBox[{"nomrf", ",", "nomrf", ",", "q_"}], "]"}], "=", 
       RowBox[{"covLong", "[", 
        RowBox[{"nomrf", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v2", "=", 
          RowBox[{"varList", "[", 
           RowBox[{"[", "qq", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v2", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"bondyield", ",", "v2", ",", "q", ",", "1"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v2", ",", "rf", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v2", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v2", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nombondyield", ",", "v2", ",", "q", ",", "1"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v2", ",", "nomrf", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v2", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"{", 
         RowBox[{"qq", ",", "1", ",", 
          RowBox[{"Length", "[", "varList", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v3", "=", 
          RowBox[{"varListdd", "[", 
           RowBox[{"[", "zz", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v3", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"bondyield", ",", "v3", ",", "q", ",", "1", ",", "i"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v3", ",", "rf", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v3", ",", 
            RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v3", ",", "q_Integer", ",", "i_"}], "]"}], 
          "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nombondyield", ",", "v3", ",", "q", ",", "1", ",", "i"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v3", ",", "nomrf", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v3", ",", 
            RowBox[{"-", "q"}], ",", "i"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"zz", ",", "1", ",", 
          RowBox[{"Length", "[", "varListdd", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v4", "=", 
          RowBox[{"expandList", "[", 
           RowBox[{"[", "pp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v4", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"bondyield", ",", "v4", ",", "q", ",", "1"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v4", ",", "rf", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v4", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v4", ",", "q_Integer"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nombondyield", ",", "v4", ",", "q", ",", "1"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v4", ",", "nomrf", ",", "q_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v4", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"{", 
         RowBox[{"pp", ",", "1", ",", 
          RowBox[{"Length", "[", "expandList", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v5", "=", 
          RowBox[{"expandListStocks", "[", 
           RowBox[{"[", "rr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v5", ",", "q_Integer", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"bondyield", ",", "v5", ",", "q", ",", "1", ",", "i"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v5", ",", "rf", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v5", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v5", ",", "q_Integer", ",", "i_"}], "]"}], 
          "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nombondyield", ",", "v5", ",", "q", ",", "1", ",", "i"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v5", ",", "nomrf", ",", "q_", ",", "i_"}], "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v5", ",", 
            RowBox[{"-", "q"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"{", 
         RowBox[{"rr", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListStocks", "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"v6", "=", 
          RowBox[{"expandListBond", "[", 
           RowBox[{"[", "vv", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v6", ",", "q_Integer", ",", "n_Integer"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"bondyield", ",", "v6", ",", "q", ",", "1", ",", "n"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v6", ",", "rf", ",", "q_Integer", ",", "n_Integer"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"rf", ",", "v6", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v6", ",", "q_Integer", ",", "n_Integer"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nombondyield", ",", "v6", ",", "q", ",", "1", ",", "n"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"covLong", "[", 
           RowBox[{"v6", ",", "nomrf", ",", "q_Integer", ",", "n_Integer"}], 
           "]"}], "=", 
          RowBox[{"covLong", "[", 
           RowBox[{"nomrf", ",", "v6", ",", 
            RowBox[{"-", "q"}], ",", "n"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"vv", ",", "1", ",", 
          RowBox[{"Length", "[", "expandListBond", "]"}]}], "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ParallelEvaluate", "[", 
        RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "qq", ",", "zz", ",", "pp", ",", "rr", ",", "vv", ",", "v2", ",", "v3", 
      ",", "v4", ",", "v5", ",", "v6"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Save", "[", 
     RowBox[{"covLongFileName", ",", "covLong"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"vars1", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<dc\>\"", ",", "\"\<dd\>\""}], 
      RowBox[{"(*", 
       RowBox[{
       ",", "\"\<pd\>\"", ",", "\"\<rf\>\"", ",", "\"\<excret\>\"", ",", 
        "\"\<pdpd\>\"", ",", "\"\<dcdc\>\"", ",", "\"\<dddd\>\"", ",", 
        "\"\<excretexcret\>\"", ",", "\"\<rfrf\>\"", ",", "\"\<dcpd\>\"", 
        ",", "\"\<ddpd\>\"", ",", "\"\<excretpd\>\"", ",", "\"\<rfpd\>\""}], 
       "*)"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vars2", "=", 
     RowBox[{"{", "\"\<pd12lag\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"hor", "=", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", 
       RowBox[{"12", ",", "24"}], 
       RowBox[{"(*", 
        RowBox[{",", "36", ",", "48", ",", "60", ",", "72"}], "*)"}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vars1cov", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"#1", ",", "#1", ",", "#2"}], "]"}], ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"#1", ",", "\"\<pd\>\"", ",", "#2"}], "]"}]}], "}"}], 
          "&"}], ",", "vars1", ",", "hor"}], "]"}], ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vars1cov", "=", 
     RowBox[{"Flatten", "@", 
      RowBox[{"LexicographicSort", "@", 
       RowBox[{"Transpose", "[", "vars1cov", "]"}]}]}]}], ";", "\n", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"memo", "=", 
           RowBox[{"uncondCovLong", "[", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"vars1cov", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "]"}], ",", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"vars2", "[", 
               RowBox[{"[", "qq", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Inactive", "[", "covLong", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"memovec", "=", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Expand", "[", "memo", "]"}], ",", 
              RowBox[{
               RowBox[{"a_.", " ", 
                RowBox[{
                 RowBox[{"Inactive", "[", "covLong", "]"}], "[", "x__", 
                 "]"}]}], "->", 
               RowBox[{
                RowBox[{"Inactive", "[", "covLong", "]"}], "[", "x", "]"}]}], 
              ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{"Activate", ",", "memovec"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"retrieve", " ", "from", " ", "parallel", " ", "kernels"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"ParallelEvaluate", "[", 
              RowBox[{"DownValues", "[", "covLong", "]"}], "]"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "remove", " ", "function", " ", "evaluation", " ", "condition", 
            " ", "in", " ", "memoized", " ", "DownValues", " ", "of", " ", 
            "covLong"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DownValues", "[", "covLong", "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  TagBox[
                   StyleBox[
                    RowBox[{"RuleDelayed", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", 
                    RowBox[{
                    RowBox[{"Verbatim", "[", "HoldPattern", "]"}], "[", 
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Condition", "]"}], "[", 
                    RowBox[{"a__", ",", "b__"}], "]"}], "]"}], "]"}], ",", 
                    "c__"}], "]"}],
                    ShowSpecialCharacters->False,
                    ShowStringCharacters->True,
                    NumberMarks->True],
                   FullForm], 
                  StyleBox[")",
                   ShowSpecialCharacters->False,
                   ShowStringCharacters->True,
                   NumberMarks->True]}], 
                 StyleBox["/;",
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True], 
                 StyleBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", "b", "]"}], ",", "Count"}], 
                    "]"}]}], " ", "&&", " ", 
                    RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"HoldPattern", "[", "c", "]"}], ",", "Module"}], 
                    "]"}]}], ")"}],
                  ShowSpecialCharacters->False,
                  ShowStringCharacters->True,
                  NumberMarks->True]}], 
                StyleBox["->",
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True], 
                StyleBox[
                 RowBox[{
                  RowBox[{"HoldPattern", "[", "a", "]"}], ":>", "c"}],
                 ShowSpecialCharacters->False,
                 ShowStringCharacters->True,
                 NumberMarks->True]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}], "/@", 
            RowBox[{"DownValues", "[", "covLong", "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", 
           RowBox[{"Length", "[", "vars1cov", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"qq", ",", "1", ",", 
        RowBox[{"Length", "[", "vars2", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Save", "[", 
     RowBox[{"covLongFileName", ",", "covLong"}], "]"}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "False", 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "covLong", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Get", "[", "covLongFileName", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.862350702311915*^9, 3.862350734661271*^9}, {
   3.862350793812736*^9, 3.862350844487877*^9}, {3.862350912769215*^9, 
   3.862350972292989*^9}, {3.862351235632867*^9, 3.8623512368743687`*^9}, {
   3.862351314828351*^9, 3.862351547734563*^9}, 3.862352110252185*^9, {
   3.8623523009706*^9, 3.862352301138883*^9}, {3.862352350990403*^9, 
   3.862352494406149*^9}, {3.862353087523719*^9, 3.862353091614513*^9}, {
   3.862353171032086*^9, 3.8623531736676407`*^9}, {3.862353241573086*^9, 
   3.862353319064934*^9}, {3.862354661945158*^9, 3.862354671792529*^9}, {
   3.8623846850938997`*^9, 3.8623846997441874`*^9}, {3.8623856901679277`*^9, 
   3.862385735263433*^9}, {3.862385818355006*^9, 3.862385868517775*^9}, {
   3.86238589908585*^9, 3.862385957984171*^9}, {3.862402719634437*^9, 
   3.862402734916499*^9}, {3.862402772982959*^9, 3.8624027792395077`*^9}, {
   3.862402855965029*^9, 3.8624028569828444`*^9}, {3.862404669730109*^9, 
   3.862404676748328*^9}, 3.862405178569352*^9, {3.862405361938642*^9, 
   3.862405374382827*^9}, {3.862405406836688*^9, 3.862405440837274*^9}, {
   3.8624054771550694`*^9, 3.862405507844762*^9}, {3.8624060038783693`*^9, 
   3.862406012951881*^9}, {3.862406078746071*^9, 3.862406097688148*^9}, {
   3.862406217991742*^9, 3.862406251864534*^9}, {3.862406282430126*^9, 
   3.862406309363958*^9}, {3.862406394242697*^9, 3.86240639585366*^9}, {
   3.8624064417949457`*^9, 3.862406446582555*^9}, {3.862406526374146*^9, 
   3.862406531693637*^9}, {3.8624067609711733`*^9, 3.862406784384482*^9}, 
   3.862406821282708*^9, {3.862406887154149*^9, 3.8624068885682287`*^9}, {
   3.862414415462784*^9, 3.862414454295766*^9}, {3.8624145810713*^9, 
   3.8624145899984713`*^9}, {3.862414641541274*^9, 3.862414643504209*^9}, {
   3.8624147381232557`*^9, 3.862414749593062*^9}, {3.862414814642922*^9, 
   3.862414838248252*^9}, {3.862414892993223*^9, 3.862414904511257*^9}, {
   3.862414949464604*^9, 3.8624149672317247`*^9}, {3.862415032873561*^9, 
   3.862415046854319*^9}, 3.862415111092688*^9, 3.862415270276617*^9, {
   3.862415303694833*^9, 3.862415317441133*^9}, {3.862416934440516*^9, 
   3.862416959172553*^9}, {3.862417022663211*^9, 3.862417120317875*^9}, {
   3.862417178557468*^9, 3.8624172187352743`*^9}, {3.862417315126553*^9, 
   3.862417326842935*^9}, {3.862417406385769*^9, 3.862417410626384*^9}, {
   3.862417548784665*^9, 3.862417631419075*^9}, {3.8624177182816963`*^9, 
   3.862417731617147*^9}, {3.86241781405614*^9, 3.862417877412527*^9}, {
   3.862417923344884*^9, 3.862417934704562*^9}, {3.862418002407742*^9, 
   3.86241801216717*^9}, {3.8624181032464542`*^9, 3.8624181109349337`*^9}, 
   3.862418166128471*^9, {3.862418220836873*^9, 3.8624182230584*^9}, {
   3.862418437069672*^9, 3.862418494648439*^9}, 3.862418549887815*^9, {
   3.862418630168425*^9, 3.8624186312046022`*^9}, {3.8624187544160023`*^9, 
   3.8624187982816143`*^9}, {3.862418830117673*^9, 3.862418830350094*^9}, 
   3.86241903130114*^9, {3.862419218389141*^9, 3.8624192265846*^9}, {
   3.862419593630164*^9, 3.86241960820006*^9}, {3.862419650197076*^9, 
   3.862419711936866*^9}, {3.862424766926461*^9, 3.862424793103525*^9}, {
   3.8624248788095217`*^9, 3.8624248820126257`*^9}, {3.862425143542412*^9, 
   3.8624251830874968`*^9}, {3.86242546365823*^9, 3.862425464936151*^9}, {
   3.86242550400418*^9, 3.862425638797187*^9}, 3.8624257260938787`*^9, {
   3.8624259432430964`*^9, 3.862425944380851*^9}, {3.8624260190897818`*^9, 
   3.862426019941992*^9}, {3.862426134726715*^9, 3.862426137193017*^9}, {
   3.862426334402453*^9, 3.862426334509409*^9}, 3.862426615441951*^9, 
   3.8624272944477797`*^9, {3.862427418281089*^9, 3.8624274837253933`*^9}, {
   3.862427580717041*^9, 3.862427581263177*^9}, 3.862427622423223*^9, {
   3.862427756286498*^9, 3.862427793384934*^9}, {3.862427990914899*^9, 
   3.862428015708571*^9}, {3.862428061642435*^9, 3.8624280618860188`*^9}, {
   3.8624282253693647`*^9, 3.862428248586713*^9}, 3.862428756838862*^9, {
   3.8624288163496523`*^9, 3.862428816712083*^9}, {3.862428887652622*^9, 
   3.862429080193939*^9}, {3.862429207779625*^9, 3.862429382801414*^9}, {
   3.862429415690826*^9, 3.8624294224221087`*^9}, {3.862429621730296*^9, 
   3.862429631034007*^9}, {3.862429944264182*^9, 3.862429966015946*^9}, {
   3.862430132019352*^9, 3.862430170445487*^9}, {3.862430229393075*^9, 
   3.86243023144983*^9}, {3.8624304216183443`*^9, 3.862430428066325*^9}, {
   3.862430475406402*^9, 3.862430489586735*^9}, {3.862430556826105*^9, 
   3.862430563898878*^9}, 3.862430790545219*^9, {3.8624308816937733`*^9, 
   3.862430917172838*^9}, {3.862431007199813*^9, 3.86243103465668*^9}, {
   3.862431316320573*^9, 3.8624313196833887`*^9}, {3.862431383013442*^9, 
   3.8624315075751143`*^9}, {3.862431553931142*^9, 3.8624316015240383`*^9}, {
   3.862431701645947*^9, 3.8624317349196243`*^9}, {3.8624318511039963`*^9, 
   3.862431924889002*^9}, {3.862432133193737*^9, 3.8624321608232317`*^9}, {
   3.862432201157134*^9, 3.862432212788786*^9}, {3.862432375310956*^9, 
   3.8624323907353992`*^9}, {3.862437168474441*^9, 3.8624371742349577`*^9}, {
   3.862437208537739*^9, 3.862437237362605*^9}, 3.862437531953599*^9, {
   3.862437596289649*^9, 3.862437671661667*^9}, {3.862437704073841*^9, 
   3.86243770877129*^9}, {3.862437782215638*^9, 3.8624377854613867`*^9}, {
   3.862438023598069*^9, 3.862438067206314*^9}, 3.8624381038221827`*^9, {
   3.862469721053966*^9, 3.862470088238523*^9}, {3.862470220116372*^9, 
   3.862470388775527*^9}, 3.8624705889012117`*^9, 3.862470645866086*^9, 
   3.862470900247751*^9, {3.862471007161413*^9, 3.862471008756921*^9}, {
   3.862471452295199*^9, 3.86247152356262*^9}, 3.862471638454171*^9, {
   3.862473153724031*^9, 3.862473193374702*^9}, {3.86247507363968*^9, 
   3.862475077494668*^9}, {3.8624751751591597`*^9, 3.86247521474889*^9}, 
   3.8624756048316793`*^9, {3.86247573555974*^9, 3.862475748545351*^9}, {
   3.862476391984315*^9, 3.862476394141944*^9}, {3.862476426513183*^9, 
   3.862476464399827*^9}, {3.86250098636518*^9, 3.862501010982305*^9}, {
   3.862501111695632*^9, 3.862501196141819*^9}, {3.862501243952731*^9, 
   3.862501434639811*^9}, {3.86250147883041*^9, 3.8625016107332907`*^9}, {
   3.86250164923878*^9, 3.8625018797528048`*^9}, {3.862502025709219*^9, 
   3.862502088002898*^9}, {3.862502204980413*^9, 3.862502275707019*^9}, {
   3.86250230700385*^9, 3.862502330793304*^9}, {3.862502367637063*^9, 
   3.862502578281816*^9}, 3.862502731424883*^9, 3.862502797839444*^9, {
   3.862502828170384*^9, 3.862502828339963*^9}, {3.8625028756192913`*^9, 
   3.862503251567038*^9}, {3.862503299211978*^9, 3.8625033243276377`*^9}, {
   3.862503385432372*^9, 3.8625034636163177`*^9}, {3.862503516665821*^9, 
   3.862503558711681*^9}, {3.862503598413231*^9, 3.86250365122653*^9}, {
   3.8625042000044622`*^9, 3.86250421234126*^9}, {3.8625042424404707`*^9, 
   3.862504312577334*^9}, {3.8625043454421787`*^9, 3.862504769272814*^9}, {
   3.862504957540689*^9, 3.862504958007613*^9}, {3.862505041861176*^9, 
   3.8625050450579443`*^9}, 3.862505375319232*^9, {3.86250540564299*^9, 
   3.86250545700457*^9}, {3.862505525257826*^9, 3.862505563484332*^9}, {
   3.8625117918492403`*^9, 3.862511818231121*^9}, {3.862511857799423*^9, 
   3.862511883807005*^9}, {3.862512075295952*^9, 3.862512097156251*^9}, {
   3.862514152335994*^9, 3.862514153668419*^9}, {3.862514796062072*^9, 
   3.8625148284101143`*^9}, 3.862514975026452*^9, {3.8625279976465807`*^9, 
   3.8625280005878487`*^9}, {3.86252803731362*^9, 3.8625280423219423`*^9}, {
   3.862528121060927*^9, 3.862528132878315*^9}, 3.862528234408836*^9, {
   3.862528342274645*^9, 3.862528343440988*^9}, {3.86252861982802*^9, 
   3.862528623625765*^9}, {3.862529653999789*^9, 3.862529674323821*^9}, 
   3.862530281979412*^9, {3.862530333155669*^9, 3.862530335217477*^9}, {
   3.8625304504210167`*^9, 3.862530467915781*^9}, 3.8625305248759336`*^9, {
   3.8625308172546167`*^9, 3.862530830427835*^9}, {3.86253087733676*^9, 
   3.8625308785681133`*^9}, {3.862530925349709*^9, 3.862530987160103*^9}, {
   3.862531166296419*^9, 3.86253116678218*^9}, {3.862531267044805*^9, 
   3.86253126985321*^9}, {3.862531338569508*^9, 3.8625313467574577`*^9}, {
   3.8625314656517363`*^9, 3.862531486010154*^9}, {3.8625631473045063`*^9, 
   3.86256316347894*^9}, {3.862563201062077*^9, 3.862563244106723*^9}, {
   3.867747910078289*^9, 3.867747933814742*^9}, {3.8677480029664793`*^9, 
   3.867748003790011*^9}, {3.8680953966385183`*^9, 3.8680954093564997`*^9}, {
   3.868095645024425*^9, 3.8680956495420933`*^9}, 3.868096906530595*^9, {
   3.86810166132471*^9, 3.8681017119217987`*^9}, {3.8681017784805183`*^9, 
   3.868101778709207*^9}, 3.8681019197643127`*^9, {3.868104036783813*^9, 
   3.8681040846368847`*^9}, {3.8681821182656803`*^9, 3.868182169766021*^9}, 
   3.8681822002297897`*^9, {3.868367530164819*^9, 3.868367531455357*^9}, 
   3.868376701326054*^9, {3.868431514703587*^9, 3.868431514896459*^9}, {
   3.868431796469858*^9, 3.868431806593511*^9}, {3.868431936910551*^9, 
   3.868431953597198*^9}, {3.868561153273467*^9, 3.868561160270288*^9}, {
   3.872867928683345*^9, 3.872867936875663*^9}, {3.873011332116123*^9, 
   3.873011332645072*^9}, {3.873029263351184*^9, 3.873029264543239*^9}, {
   3.873029379181241*^9, 3.873029385917018*^9}, {3.873029644162488*^9, 
   3.8730296465215397`*^9}, {3.8730296766158648`*^9, 3.873029682351357*^9}, {
   3.87302978519617*^9, 3.8730298046006203`*^9}, {3.873029981099674*^9, 
   3.873030019525323*^9}, 3.873070243943321*^9, {3.873070312840123*^9, 
   3.873070329173931*^9}, {3.873073894459015*^9, 3.873073898735021*^9}, 
   3.873073953454659*^9, {3.8730745621080923`*^9, 3.873074694914427*^9}, 
   3.873076090045442*^9, {3.873077727455674*^9, 3.873077746447804*^9}, {
   3.873079462051194*^9, 3.8730794951117496`*^9}, {3.8730795397226677`*^9, 
   3.873079559300145*^9}, {3.873080140550044*^9, 3.873080163148911*^9}, {
   3.873086661890317*^9, 3.873086667418324*^9}, {3.8731579319059153`*^9, 
   3.873157954053512*^9}, {3.873649669130928*^9, 3.873649671697345*^9}, 
   3.873719596564131*^9, {3.8737625750575237`*^9, 3.873762587968845*^9}, 
   3.873762685769421*^9, {3.8737627203355827`*^9, 3.87376280727964*^9}, {
   3.8737628641200047`*^9, 3.873762912622855*^9}, {3.873762974446753*^9, 
   3.873763034835766*^9}, {3.873763075836042*^9, 3.873763094355691*^9}, {
   3.873763153843395*^9, 3.8737631911763763`*^9}, 3.8750009477570333`*^9, {
   3.875001799109872*^9, 3.8750018078125877`*^9}, {3.875002528791143*^9, 
   3.875002574029523*^9}, {3.875002675816141*^9, 3.875002744470306*^9}, {
   3.875002775304494*^9, 3.875002840214137*^9}, {3.875002998450718*^9, 
   3.875003003390636*^9}, {3.875003122605246*^9, 3.8750031230407124`*^9}, {
   3.875003170891759*^9, 3.875003196092566*^9}, 3.875003601712331*^9, {
   3.88712946580888*^9, 3.887129476352728*^9}, 3.887563227892111*^9, {
   3.887563371030773*^9, 3.887563376728505*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"5a40898f-a3a1-4e7e-9d0e-dde0ef17afe9"]
}, Open  ]]
},
WindowSize->{1175, 942},
WindowMargins->{{-1459, Automatic}, {Automatic, 6}},
WindowStatusArea->"",
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"55897af3-0630-4409-aa94-98e1d5fbdf22"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 215, 4, 37, "Input",ExpressionUUID->"22feddcb-b3fc-478d-8077-4a914f160da7"],
Cell[CellGroupData[{
Cell[640, 21, 1912, 37, 168, "Input",ExpressionUUID->"3678a217-ed8d-42c6-86a2-75c1ea1115fd"],
Cell[2555, 60, 276, 4, 42, "Output",ExpressionUUID->"9520f0b9-f9ca-4f20-893b-1fc76f563fba"],
Cell[2834, 66, 243, 3, 42, "Output",ExpressionUUID->"83b47bba-d695-4331-85a4-657b80e3e8c1"],
Cell[3080, 71, 265, 4, 42, "Output",ExpressionUUID->"7a1108ea-73a3-4562-8898-9840de11018d"],
Cell[3348, 77, 200, 2, 42, "Output",ExpressionUUID->"ad5e26b3-ece4-4218-b5b1-2a62381f58f6"],
Cell[3551, 81, 368, 6, 42, "Output",ExpressionUUID->"7afc31ec-a8b6-4455-a677-22603a80c4db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3956, 92, 255, 4, 67, "Subsection",ExpressionUUID->"2157750c-ae6d-47e9-b5dd-9c68ad40141b"],
Cell[4214, 98, 316, 7, 37, "Input",ExpressionUUID->"f2799e55-a4bc-4cd6-9966-6392a845d852"],
Cell[4533, 107, 601, 11, 64, "Input",ExpressionUUID->"8eff5a9c-f1a4-4d23-af33-c77709b1754e"],
Cell[5137, 120, 314, 5, 37, "Input",ExpressionUUID->"2f82b75d-42a0-4b76-b3ff-7172db85f4de"],
Cell[5454, 127, 506, 10, 90, "Input",ExpressionUUID->"eccf8930-58b0-4acf-8ec2-cc24c39a0278"],
Cell[5963, 139, 1700, 28, 90, "Input",ExpressionUUID->"0f0d628d-d6b9-4205-8e24-5e38623917fa"],
Cell[7666, 169, 1256, 21, 116, "Input",ExpressionUUID->"0b6966dc-5fa6-470b-a745-2d3c09da3d4b"],
Cell[8925, 192, 938, 17, 116, "Input",ExpressionUUID->"8845796e-7665-4c7d-8872-0aad8272ffea"],
Cell[9866, 211, 1687, 38, 376, "Input",ExpressionUUID->"d935faaf-50bc-4a8e-a3fd-9047b2c4629b"],
Cell[11556, 251, 7960, 191, 1546, "Input",ExpressionUUID->"0958ce5d-a8a4-48ff-ba85-0ddb97fc37d7"],
Cell[19519, 444, 3493, 83, 649, "Input",ExpressionUUID->"53790e1b-0739-4af7-b71e-e7c4f97e09ce"],
Cell[23015, 529, 3957, 97, 759, "Input",ExpressionUUID->"8f6e6c22-7c31-4776-a49f-d2f5143966c9"],
Cell[26975, 628, 2037, 49, 246, "Input",ExpressionUUID->"10534701-86cc-4812-b9d1-583f080b6be2"],
Cell[29015, 679, 12781, 303, 2005, "Input",ExpressionUUID->"ca14d8f1-7a77-428b-8c74-a7eb0de7af1a"],
Cell[41799, 984, 5561, 134, 506, "Input",ExpressionUUID->"8997ccda-5ae0-43a0-9042-48220e750fbc"],
Cell[47363, 1120, 6534, 167, 454, "Input",ExpressionUUID->"e22bc11e-b400-47fc-b98c-49b5db95ac36"],
Cell[53900, 1289, 2707, 63, 272, "Input",ExpressionUUID->"43ab956e-5418-4766-8b40-61e18ece38fb"],
Cell[56610, 1354, 2734, 63, 402, "Input",ExpressionUUID->"7223286e-e1a1-41e8-a6d2-dd8bb1b5b576"],
Cell[59347, 1419, 10787, 280, 714, "Input",ExpressionUUID->"20932644-ce55-47c6-a167-7c0a087a53af"],
Cell[70137, 1701, 11280, 276, 1260, "Input",ExpressionUUID->"0e9025ae-9d2a-47ad-abbf-9a23b327cd2c"],
Cell[81420, 1979, 12809, 324, 1645, "Input",ExpressionUUID->"e4884843-12f0-47a7-8451-879dcf79c5af"],
Cell[94232, 2305, 195, 3, 37, "Input",ExpressionUUID->"985a3ae6-e130-4f8a-9b93-ae3fe10177bc"],
Cell[94430, 2310, 356, 7, 37, "Input",ExpressionUUID->"34eb60b3-650d-4879-853c-727ea9a613af"],
Cell[94789, 2319, 1502, 33, 402, "Input",ExpressionUUID->"a85f5693-d085-4cc5-989a-a9500987950c"],
Cell[96294, 2354, 3288, 67, 558, "Input",ExpressionUUID->"ad25c99b-2683-4ce1-a7e6-bbce1e6ba9da"],
Cell[99585, 2423, 1587, 38, 246, "Input",ExpressionUUID->"315ef181-7d11-46ac-8819-a70759fefbb2"],
Cell[101175, 2463, 177, 3, 37, "Input",ExpressionUUID->"c5da93c9-aa05-4285-b981-eb34b61414e4"]
}, Closed]],
Cell[CellGroupData[{
Cell[101389, 2471, 214, 4, 46, "Subsection",ExpressionUUID->"d03dfeba-2718-41c7-9b3f-19ce5bed64e2"],
Cell[101606, 2477, 5140, 125, 636, "Input",ExpressionUUID->"199e6c2d-9aa0-445a-a1bb-94ecc86b456f"],
Cell[106749, 2604, 1426, 33, 168, "Input",ExpressionUUID->"050051e2-6c9d-4505-ae74-78e93d008436"],
Cell[108178, 2639, 630, 10, 90, "Input",ExpressionUUID->"bd79e4cf-318a-4802-8fac-3ca0590440bd"],
Cell[108811, 2651, 2866, 73, 428, "Input",ExpressionUUID->"540d848e-b4ef-4102-af8c-932b5f37cc14"],
Cell[CellGroupData[{
Cell[111702, 2728, 197, 3, 37, "Input",ExpressionUUID->"a00715c6-d674-45fc-93eb-7e18fd876317"],
Cell[111902, 2733, 12488, 304, 119, "Output",ExpressionUUID->"47b41940-7847-4ef2-a674-603de52c5c30"]
}, Open  ]],
Cell[124405, 3040, 853, 23, 142, "Input",ExpressionUUID->"c60e6e2d-256a-4e0a-8e0e-0db4f7bd0dbc"],
Cell[125261, 3065, 604, 16, 90, "Input",ExpressionUUID->"e99da723-cb71-4b23-b942-0429b225fa84"],
Cell[125868, 3083, 24635, 690, 1657, "Input",ExpressionUUID->"192f329e-b6ba-481d-a4ca-87fc54a46e90"],
Cell[150506, 3775, 9506, 228, 1130, "Input",ExpressionUUID->"0e000aac-5a88-4b08-a2c1-a2694ee92ff4"],
Cell[160015, 4005, 1132, 24, 90, "Input",ExpressionUUID->"4fe38fe2-f091-4f3a-a807-e766e3de5090"],
Cell[161150, 4031, 360, 10, 64, "Input",ExpressionUUID->"8b6d8a0d-7421-430a-8152-f3e92affcfa9"],
Cell[161513, 4043, 3589, 96, 220, "Input",ExpressionUUID->"d0904225-a3f2-41aa-8e3d-b3cb2bf9c0f3"],
Cell[165105, 4141, 361, 10, 64, "Input",ExpressionUUID->"f96a61fe-a6b0-4af2-99a4-1c9a071084df"],
Cell[CellGroupData[{
Cell[165491, 4155, 1077, 21, 142, "Input",ExpressionUUID->"04c552a6-ea22-4270-89d1-3878ed01033b"],
Cell[166571, 4178, 263, 3, 42, "Output",ExpressionUUID->"e88ec73c-caf8-446f-aab3-ee784f0e12ba"],
Cell[166837, 4183, 297, 4, 69, "Output",ExpressionUUID->"69ff9ff0-96ed-4e78-9555-b46e8825a153"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167171, 4192, 1607, 34, 142, "Input",ExpressionUUID->"36a25865-4435-4558-9f6a-2229594bd4e0"],
Cell[168781, 4228, 548, 12, 57, "Message",ExpressionUUID->"695f85a9-fcb6-4f0b-b7af-5dbf48536931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169366, 4245, 608, 13, 64, "Input",ExpressionUUID->"b4df43a2-ef68-41fc-84b3-2597cd4e7c04"],
Cell[169977, 4260, 292, 4, 69, "Output",ExpressionUUID->"9913a530-3691-4d82-9c4b-73941e5dac2d"]
}, Open  ]],
Cell[170284, 4267, 598, 17, 64, "Input",ExpressionUUID->"3c1577df-b5e8-4541-bfee-7b78a4af769d"],
Cell[CellGroupData[{
Cell[170907, 4288, 714, 12, 584, "Input",ExpressionUUID->"f8227287-32d6-4a48-9950-77ea6ec21836"],
Cell[171624, 4302, 166, 3, 42, "Output",ExpressionUUID->"5bb9b30b-76d1-4829-82ee-cf9e619ea572"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171839, 4311, 149, 3, 84, "Section",ExpressionUUID->"62a79710-5cd5-4df1-9024-35ad57bc16bc"],
Cell[171991, 4316, 96403, 2268, 9327, "Input",ExpressionUUID->"5a40898f-a3a1-4e7e-9d0e-dde0ef17afe9"]
}, Open  ]]
}
]
*)

